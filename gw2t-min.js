$(window).on("load",function(){"use strict";var A,B,C,D,E,G,H,I,J,K,M,O,P,Q,T,U,V,W,X,Z;O={cLengthOfPrefixes:3,cPrefixOption:"opt_",cPrefixLabel:"lbl_",legalLocalStorageKeys:{},isServerReset:!1,Utilities:{programVersion:{key:"int_utlProgramVersion",value:170928},buildVersion:{key:"int_utlBuildVersion",value:0},timestampDaily:{key:"int_utlTimestampDaily",value:0},timestampWeekly:{key:"int_utlTimestampWeekly",value:0},APITokens:{key:"obj_utlAPITokens",value:[]},APICache:{key:"obj_utlAPICache",value:{}},AuditHistory:{key:"obj_utlAuditHistory",value:{}},CustomCatalog:{key:"obj_utlCustomCatalog",value:[]},GemSubscription:{key:"obj_utlGemSubscription",value:{}},BackupPins:{key:"obj_utlBackupPins",value:[]},BackupPinsWvW:{key:"obj_utlBackupPinsWvW",value:[]},BackupCompasses:{key:"obj_utlBackupCompasses",value:[]},BackupCompassesWvW:{key:"obj_utlBackupCompassesWvW",value:[]},StoredPins:{key:"obj_utlStoredPins",value:[]},StoredPinsWvW:{key:"obj_utlStoredPinsWvW",value:[]},StoredCompasses:{key:"obj_utlStoredCompasses",value:[]},StoredCompassesWvW:{key:"obj_utlStoredCompassesWvW",value:[]}},enforceProgramVersion:function(){var e=O.Utilities.programVersion.value,t=parseInt(localStorage[O.Utilities.programVersion.key]);if(isFinite(t)&&t!==e){var a=I.ModeCurrent===I.ModeEnum.Overlay?15:30;I.clear(),I.greet(I.cSiteName+" was updated since your last visit.<br />This version: "+e+"<br />Your version: "+t+"<br />Would you like to see the <a class='urlUpdates' href='"+U.URL_META.News+"'>changes</a>?<br />",a),U.convertExternalLink(".urlUpdates")}localStorage[O.Utilities.programVersion.key]=O.Utilities.programVersion.value},enforceBuildVersion:function(){$.getJSON(U.URL_API.Build,function(e){if(e&&e.id){var t=O.Utilities.buildVersion.key,a=parseInt(e.id),n=localStorage[t];if(O.Utilities.buildVersion.value=a,void 0!==n&&parseInt(n)!==a){var i="New game build available";I.print("<a"+U.convertExternalAnchor(U.URL_META.BuildNotes)+">"+i+"!</a> GW2 Build ID: "+a+" "+I.Symbol.ArrowLeft+" "+n+" Diff: "+(a-parseInt(n))+"<br />"+T.formatWeektime(new Date,!0)+" - <a href='./?bol_alertBuild=false'>Turn off patch alarm?</a>"),D.speak("Alert! "+i),I.notify({aTitle:"New Patch",aBody:i,aIcon:"img/notification/game.png"}),localStorage[t]=a}else void 0!==n&&parseInt(n)===a||(localStorage[t]=a)}})},Options:{enu_Language:"en",enu_Server:"1008",bol_showSecondHand:!0,bol_hideChecked:!1,bol_expandWB:!0,bol_collapseChains:!0,int_setClock:0,int_setDimming:0,int_setPredictor:0,bol_alignPanelRight:!0,bol_ignoreTouch:!1,bol_showPanel:!0,bol_showHUD:!0,bol_showHUDWvW:!0,bol_showDashboard:!0,bol_showTimeline:!0,bol_opaqueTimeline:!1,bol_condenseTimelineLine:!0,bol_condenseTimelineHeader:!0,bol_hideHUD:!0,int_setFloor:1,int_setFloorWvW:1,int_setInitialZoom:3,int_setInitialZoomWvW:4,bol_showCoordinatesBar:!0,bol_showZoneBorders:!1,bol_showZoneGateways:!1,bol_showChainPaths:!0,bol_tourPrediction:!0,bol_showWorldCompletion:!1,bol_showZoneOverview:!0,bol_displaySectors:!0,bol_displayWaypoints:!0,bol_displayPOIs:!0,bol_displayVistas:!0,bol_displayChallenges:!0,bol_displayMasteries:!0,bol_displayHearts:!0,bol_displayHeartsArea:!1,bol_displaySectorsArea:!1,bol_displayEvents:!1,bol_showWorldCompletionWvW:!1,bol_showZoneOverviewWvW:!0,bol_displaySectorsWvW:!0,bol_displayWaypointsWvW:!0,bol_displayPOIsWvW:!0,bol_displayVistasWvW:!0,bol_displayChallengesWvW:!0,bol_displaySectorsAreaWvW:!0,str_colorPersonalPath:"#ffffff",int_opacityPersonalPath:40,int_secWvWRefresh:10,int_numLogEntries:128,bol_showLog:!0,bol_opaqueLog:!1,bol_maximizeLog:!1,bol_logRedHome:!0,bol_logBlueHome:!0,bol_logGreenHome:!0,bol_logCenter:!0,bol_logNarrate:!1,bol_narrateRedHome:!0,bol_narrateBlueHome:!0,bol_narrateGreenHome:!0,bol_narrateCenter:!0,bol_narrateClaimed:!1,bol_narrateRuins:!1,bol_narrateCamp:!0,bol_narrateTower:!0,bol_narrateKeep:!0,bol_narrateCastle:!0,bol_showLeaderboard:!0,bol_opaqueLeaderboard:!1,bol_condenseLeaderboard:!1,bol_showDestructibles:!1,bol_showObjectiveLabels:!0,bol_showSecondaries:!1,int_setFollow:1,bol_displayCharacter:!0,int_setFollowWvW:2,bol_displayCharacterWvW:!0,int_msecGPSRefresh:50,int_setAlarm:0,int_setVolume:75,int_secAlertDesktop:10,bol_alertSpeech:!0,bol_alertDesktop:!1,bol_alertArrival:!0,bol_alertAtStart:!0,bol_alertAtEnd:!0,bol_alertChecked:!1,int_alertSubscribedFirst:1,int_alertSubscribedSecond:15,bol_alertAutosubscribe:!0,bol_alertUnsubscribe:!0,bol_alertBuild:!1,bol_alertDaylight:!1,bol_alertMystic:!1,bol_alertGem:!1,bol_showRarity:!1,bol_condenseBank:!1,bol_auditTransactions:!0,bol_auditVault:!0,bol_auditAccountOnReset:!1,bol_auditHistoryConverted:!1,int_numAuditReports:1024,bol_refreshPrices:!0,int_numTradingCalculators:25,int_numTradingResults:50,int_secTradingRefresh:60,int_minStopwatchAlert:5,str_textStopwatchAlert:"Alert, alert, alert!",int_sizeStopwatchFont:64,int_sizeNotepadFont:12,int_sizeNotepadHeight:400,bol_clearChainChecklistOnReset:!0,bol_clearPersonalChecklistOnReset:!0,int_numChecklistDaily:12,int_numChecklistWeekly:12,bol_use24Hour:!0,bol_detectDST:!0,bol_useSiteTag:!0},OptionRange:{},LanguageMeta:{ISOCode:{en:"en-US",de:"de-DE",es:"es-ES",fr:"fr-FR",cs:"cs-CZ",it:"it-IT",pl:"pl-PL",pt:"pt-BR",ru:"ru-RU",zh:"zh-CN",tw:"zh-CN"},VoiceCode:{en:"Google US English",de:"Google Deutsch",es:"Google español",fr:"Google français",cs:"native",it:"Google italiano",pl:"Google polski",pt:"Google português do Brasil",ru:"Google русский",zh:"Google 國語（臺灣）",tw:"Google 國語（臺灣）"},isFullySupported:{en:!0,es:!0,fr:!0,de:!0},isModifierFirst:{en:!0,de:!0,cs:!0,pl:!0,ru:!0},isLogographic:{zh:!0,tw:!0}},OptionEnum:{Language:{Default:"en",English:"en",German:"de",Spanish:"es",French:"fr",Czech:"cs",Italian:"it",Polish:"pl",Portuguese:"pt",Russian:"ru",ChineseSimplified:"zh",ChineseTraditional:"tw"},Server:{AnvilRock:"1001",BorlisPass:"1002",YaksBend:"1003",HengeofDenravi:"1004",Maguuma:"1005",SorrowsFurnace:"1006",GateofMadness:"1007",JadeQuarry:"1008",FortAspenwood:"1009",EhmryBay:"1010",StormbluffIsle:"1011",Darkhaven:"1012",SanctumofRall:"1013",CrystalDesert:"1014",IsleofJanthir:"1015",SeaofSorrows:"1016",TarnishedCoast:"1017",NorthernShiverpeaks:"1018",Blackgate:"1019",FergusonsCrossing:"1020",Dragonbrand:"1021",Kaineng:"1022",DevonasRest:"1023",EredonTerrace:"1024",FissureofWoe:"2001",Desolation:"2002",Gandara:"2003",Blacktide:"2004",RingofFire:"2005",Underworld:"2006",FarShiverpeaks:"2007",WhitesideRidge:"2008",RuinsofSurmia:"2009",SeafarersRest:"2010",Vabbi:"2011",PikenSquare:"2012",AuroraGlade:"2013",GunnarsHold:"2014",JadeSea:"2101",FortRanik:"2102",AuguryRock:"2103",VizunahSquare:"2104",Arborstone:"2105",Kodash:"2201",Riverside:"2202",ElonaReach:"2203",AbaddonsMouth:"2204",DrakkarLake:"2205",MillersSound:"2206",Dzagonur:"2207",BaruchBay:"2301"}},IntEnum:{Predictor:{Auto:0,Min:1,MinAvg:2,Avg:3},Clock:{Compact:0,Full:1,Bar:2,None:3},Alarm:{Off:0,Checklist:1,Subscription:2},Follow:{Off:0,Character:1,Zone:2}},validateEnum:function(e,t){var a,n=O.OptionEnum[U.getVariableSuffix(e)];for(a in n)if(n[a]===t)return t;return O.Options[e]},initializeLegalLocalStorageKeys:function(){var e;for(e in O.Utilities)O.legalLocalStorageKeys[O.Utilities[e].key]=!0;for(e in O.Options)O.legalLocalStorageKeys[e]=!0;for(e in X.Checklists)O.legalLocalStorageKeys[X.Checklists[e].key]=!0;for(e in X.Collectibles)O.legalLocalStorageKeys[X.Collectibles[e].key]=!0;for(e in X.Textlists)O.legalLocalStorageKeys[X.Textlists[e].key]=!0},cleanLocalStorage:function(){for(var e,t=0;t<localStorage.length;t++)e=localStorage.key(t),void 0===O.legalLocalStorageKeys[e]&&localStorage.removeItem(e)},convertLocalStorageDataType:function(e){var t=e.toLowerCase();return"true"===t||"false"!==t&&(isFinite(t)?t%0==0?parseInt(t):parseFloat(t):e)},loadCompressedObject:function(e){var t=localStorage[e];if(t)try{return JSON.parse(t)}catch(e){try{return JSON.parse(LZString.decompressFromUTF16(t))}catch(e){}}return null},saveCompressedObject:function(e,t){localStorage[e]=LZString.compressToUTF16(JSON.stringify(t))},initializeTimestamp:function(e){var t=T.getUNIXSeconds(),a=parseInt(localStorage[e.key]);void 0===localStorage[e.key]||!1===isFinite(a)||a>t?(e.value=t,localStorage[e.key]=e.value):e.value=a},updateResetTimestamp:function(e){e.value=T.getUNIXSeconds(),localStorage[e.key]=e.value},checkResetTimestamps:function(){var e=T.getUNIXSeconds(),t=T.getTimeSinceMidnight(),a=T.getSecondsSinceWeekstart(t),n=e-t,i=a>T.cWEEKLY_RESET_SECONDS?e-(a-T.cWEEKLY_RESET_SECONDS):e-T.cSECONDS_IN_WEEK+(T.cWEEKLY_RESET_SECONDS-a),r=0===t,o=a===T.cWEEKLY_RESET_SECONDS;(O.Utilities.timestampDaily.value<n||r)&&(O.clearDailySensitiveOptions(r),O.updateResetTimestamp(O.Utilities.timestampDaily)),(O.Utilities.timestampWeekly.value<i||o)&&(O.clearWeeklySensitiveOptions(o),O.updateResetTimestamp(O.Utilities.timestampWeekly));var s=T.getUNIXSeconds()-t,c=s+T.cSECONDS_IN_DAY;T.ResetToday=new Date(s*T.cMSECONDS_IN_SECOND),T.ResetTomorrow=new Date(c*T.cMSECONDS_IN_SECOND),$("#optTimestampLocalReset").text(O.Utilities.timestampDaily.value),$("#optTimestampServerReset").text(c)},getIndexOfSelectedRadioButton:function(e){var t=$("fieldset[name="+e+"] input:radio[name="+e+"]");return t.index(t.filter(":checked"))},initializeOptions:function(){O.initializeLegalLocalStorageKeys();var e,t,a,n=function(e){return void 0!==U.Args[e]&&0!==e.lastIndexOf("int_num",0)&&0!==e.lastIndexOf("str_",0)};for(e in O.Options)"radio"===(t=(a=$("#"+O.cPrefixOption+e)).attr("type"))?O.OptionRange[e]=new Array(0,$("fieldset[name="+e+"] input").length-1):"number"===t||"range"===t?O.OptionRange[e]=new Array(a.prop("min"),a.prop("max")):"checkbox"===t&&X.wrapCheckbox(a),I.isProgramEmbedded?(!1===I.isProgramExternal&&void 0!==localStorage[e]&&(O.Options[e]=O.convertLocalStorageDataType(localStorage[e])),n(e)&&(O.Options[e]=O.convertLocalStorageDataType(U.sanitizeURLOptionsValue(e,U.Args[e])))):(n(e)&&(localStorage[e]=U.sanitizeURLOptionsValue(e,U.Args[e])),void 0===localStorage[e]?localStorage[e]=O.Options[e]:O.Options[e]=O.convertLocalStorageDataType(localStorage[e])),O.setInputValue(a,O.Options[e]),"radio"===t?$("fieldset[name="+e+"]").change(function(){var e=$(this).attr("name");O.Options[e]=O.getIndexOfSelectedRadioButton(e),localStorage[e]=O.Options[e]}):a.change(function(){var e=$(this).attr("id").slice(O.cPrefixOption.length);O.Options[e]=O.getInputValue($(this),e),localStorage[e]=O.Options[e]}).click(function(){$(this).select()});O.bindOptionsInputs(),D.initializeLanguage()},setInputValue:function(e,t){var a=$(e),n=a.attr("type");"checkbox"===n?a.prop("checked",t):"number"===n||"range"===n?a.val(t):"radio"===n?$("input:radio[name="+a.attr("name")+"]:eq("+t+")").prop("checked",!0):a.val(t)},getInputValue:function(e,t){var a=$(e),n=a.attr("type");if("checkbox"===n)i=a.prop("checked");else if("number"===n||"range"===n){var i=a.val(),r=parseInt(i);i=isFinite(i)&&r>=O.OptionRange[t][0]&&r<=O.OptionRange[t][1]?r:O.OptionRange[t][0],a.val(i)}else if("text"===n){i=a.val();var o=a.attr("maxlength");i.length>o&&(i=i.substring(0,o))}else i=a.val();return i},mimicInput:function(e,t){var a=$(e);O.setInputValue(a,O.Options[t]);var n=$("#"+O.cPrefixOption+t);return a.change(function(){var e=O.getInputValue($(this),t);O.setInputValue(n,e),n.trigger("change")}),n.change(function(){O.setInputValue(a,O.Options[t])}),a},clearDailySensitiveOptions:function(e){O.isServerReset=!0;var t=5,a=e?"Daily Reset!":"Expired daily checklists cleared.";T.getDaily({aIsReset:!0});var n,i;if(O.Options.bol_clearChainChecklistOnReset){I.greet(a,t);for(n in C.Chains)i=C.Chains[n],$("#chnCheck_"+i.nexus).removeClass("chnChecked"),$("#chnBar_"+i.nexus).removeClass("chnFaded"),X.getChecklistItem(X.Checklists.Chain,i.nexus)!==X.ChecklistEnum.Disabled&&$("#chnBar_"+i.nexus).show();X.clearChecklist(X.Checklists.Chain,X.ChecklistJob.UncheckTheChecked)}O.Options.bol_clearPersonalChecklistOnReset&&X.clearCustomChecklistDaily();var r=1e4;I.isSectionLoaded_Daily&&setTimeout(function(){G.generateAndInitializeDailies()},r),O.Options.bol_auditAccountOnReset&&void 0===U.Args[U.KeyEnum.AutoAudit]&&(document.getElementById("jsAuditFrame").src="./?page=Audit&"+U.KeyEnum.AutoAudit+"=true",I.greet("Automatic account audit started.",t)),I.write("",t)},clearWeeklySensitiveOptions:function(e){var t=5,a=e?"Weekly Reset!":"Expired weekly checklists cleared.";O.Options.bol_clearPersonalChecklistOnReset&&(I.greet(a,t),X.clearCustomChecklistWeekly())},bindOptionsInputs:function(){var e;for(e in O.Enact)!function(e){var t,a=O.cPrefixOption+e;t="radio"===$("#"+a).attr("type")?"fieldset[name="+e+"]":"#"+a,$(t).change(function(){O.Enact[e]()})}(e);$("#opt_bol_showWorldCompletion").change(function(){!0===O.Options.bol_showWorldCompletion&&!1===M.isMappingIconsGenerated&&document.location.reload(),$("#mapDisplayCompletion label input").not(".jsIgnore").each(function(){X.setCheckboxEnumState($(this),X.boolToChecklistEnum(O.Options.bol_showWorldCompletion))})}),$("#opt_bol_showWorldCompletionWvW").change(function(){!0===O.Options.bol_showWorldCompletionWvW&&!1===W.isMappingIconsGenerated&&location.reload(),$("#wvwDisplayCompletion label input").each(function(){X.setCheckboxEnumState($(this),X.boolToChecklistEnum(O.Options.bol_showWorldCompletionWvW))})}),$("#opt_bol_displayEvents").change(function(){!0===O.Options.bol_displayEvents&&!1===M.isEventIconsGenerated&&location.reload(),M.isEventIconsGenerated&&M.refreshCurrentZone()}),$("#mapDisplayCompletion label input").each(function(){$(this).change(function(){M.isAPIRetrieved_MAPFLOOR&&M.refreshCurrentZone()})}),$("#wvwDisplayCompletion label input").each(function(){$(this).change(function(){W.isAPIRetrieved_MAPFLOOR&&W.refreshCurrentZone()})}),O.Enact.bol_showSecondHand(),O.Enact.int_setAlarm(),O.Enact.bol_detectDST(),O.Enact.bol_useSiteTag(),O.Enact.bol_alignPanelRight(!0),O.Enact.bol_showPanel(),I.ModeCurrent!==I.ModeEnum.Simple&I.ModeCurrent!==I.ModeEnum.Tile&&(O.Enact.int_setClock(),O.Enact.int_setDimming()),$("#optRestoreAllChains").click(function(){U.interpretPage(I.PlateEnum.Chains);var e,t=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";for(var a in C.Chains)e=C.Chains[a],$("#chnCheck_"+e.nexus).removeClass("chnChecked"),$("#chnBar_"+e.nexus).show().removeClass("chnFaded").css({display:t}),$(".chnSlot_"+e.nexus).each(function(){$(this).show().css({display:t}).removeClass("chnFaded").find(".chnCheck").removeClass("chnChecked"),$(this).hasClass("tmlIcon")&&$(this).css({display:"inline-block"})});for(X.clearChecklist(X.Checklists.Chain),a=0;a<T.cNUM_TIMEFRAMES_IN_HOUR;a++){K.checkoffChainIcon(T.getStandardChain(a).nexus);var n=T.getHardcoreChain(a);n&&K.checkoffChainIcon(n.nexus)}}),$("#optChainsExpand").click(function(){U.interpretPage(I.PlateEnum.Chains),$(".chnDetails").show()}),$("#optChainsCollapse").click(function(){U.interpretPage(I.PlateEnum.Chains),$(".chnDetails").hide(),I.scrollToElement("#plateChains")}),$("#optClearLocalStorage").click(function(){confirm(I.cSiteName+" Reset: This is will clear all options and everything you have written in this website. Continue?")&&(localStorage.clear(),location.reload())}),$("#optPrintLocalStorage").click(function(){var e,t=[];for(e=0;e<localStorage.length;e++){var a=U.escapeHTML(localStorage.key(e));t.push(a)}t.sort();var n="",i="";for(e in t){var r=localStorage.getItem(t[e]);n+=t[e]+I.cOptionsDelimiter+U.escapeHTML(r)+"<br />",i+=t[e]+I.cOptionsDelimiter+r.replace(/(?:\r\n|\r|\n)/g,"\\r\\n")+"\r\n"}I.print("Please click the link below to save the options file.<br />Or copy and paste all the text below to a text file.",!0),Z.createFile(i,"gw2t_options.txt"),I.print(n)}),Z.bindFileInput("#optImportLocalStorage",function(e){var t,a,n,i=0,r=e.split(/\r\n/);for(var o in r)a=(t=U.toHalf(r[o],I.cOptionsDelimiter))[0],n=t[1],O.legalLocalStorageKeys[a]&&(a.substring(0,O.cLengthOfPrefixes)===U.TypeEnum.isString&&(n=n.replace(/\\r\\n/g,"\r\n")),localStorage[a]=n,i++);i>0?I.print(i+" options loaded. Please refresh your browser."):I.print("No options loaded. Please make sure the file is properly formatted.")})},Enact:{bol_showSecondHand:function(){$("#clkSecondHand").toggle(O.Options.bol_showSecondHand)},bol_alertDesktop:function(){I.askNotifications()},int_setAlarm:function(){var e=U.URL_IMG.Placeholder;switch(O.Options.int_setAlarm){case O.IntEnum.Alarm.Checklist:e="img/ui/check.png";break;case O.IntEnum.Alarm.Subscription:e="img/ui/subscription.png"}O.Options.int_setAlarm===O.IntEnum.Alarm.Off?D.stopSpeech():D.verifyNativeTTS(),$("#optAlarmIcon").attr("src",e)},int_setVolume:function(){!1===D.isSpeaking()&&D.speak(D.getWord("alarm"))},bol_logNarrate:function(){O.Options.bol_logNarrate?D.verifyNativeTTS():D.stopSpeech()},bol_hideChecked:function(){$(".chnBar").each(function(){X.hideCheckedChainBar(U.getSubintegerFromHTMLID($(this)))})},bol_expandWB:function(){var e=I.ModeCurrent===I.ModeEnum.Tile?C.RegularChains:C.CurrentChains;for(var t in e)if(C.isChainRegular(e[t])){var a=$("#chnDetails_"+e[t].nexus);O.Options.bol_expandWB?a.show("fast"):a.hide("fast")}},bol_use24Hour:function(){C.initializeTimetableHTML(),C.updateChainsTimeHTML(),K.updateDigitalClockMinutely(),H.updateTimelineHeader(),H.updateTimelineSegments()},bol_detectDST:function(){T.checkDST()},int_setClock:function(){K.setClock()},int_setDimming:function(){switch(O.Options.int_setDimming){case 1:$("#paneClockBackground").css({opacity:1});break;case 2:$("#paneClockBackground").css({opacity:0})}},int_setFloor:function(){M.changeFloor()},int_setFloorWvW:function(){W.changeFloor()},int_setInitialZoom:function(){M.Map.setZoom(O.Options.int_setInitialZoom)},int_setInitialZoomWvW:function(){W.Map.setZoom(O.Options.int_setInitialZoomWvW)},bol_showZoneBorders:function(){P.drawZoneBorders()},bol_showZoneGateways:function(){P.drawZoneGateways()},str_colorPersonalPath:function(){P.refreshPersonalPath()},int_opacityPersonalPath:function(){P.refreshPersonalPath()},bol_showChainPaths:function(){M.toggleLayerArray(P.LayerArray.ChainPath,O.Options.bol_showChainPaths)},bol_tourPrediction:function(){C.isTouringAuto=O.Options.bol_tourPrediction,O.Options.bol_tourPrediction&&(C.isTouringManual=!1)},int_setFollow:function(){O.Options.int_setFollow!==O.IntEnum.Follow.Off&&(M.GPSPreviousZoneID="",P.updateCharacter(0))},int_setFollowWvW:function(){O.Options.int_setFollowWvW!==O.IntEnum.Follow.Off&&(W.GPSPreviousZoneID="",P.updateCharacter(0))},bol_displayCharacter:function(){O.Options.bol_displayCharacter?(P.tickGPS(),P.updateCharacter(0)):(M.movePin(M.Pin.Character),M.movePin(M.Pin.Camera))},bol_displayCharacterWvW:function(){O.Options.bol_displayCharacterWvW?(P.tickGPS(),P.updateCharacter(0)):(W.movePin(W.Pin.Character),W.movePin(W.Pin.Camera))},bol_showPanel:function(){I.isMapEnabled&&($("#panelApp").toggle(O.Options.bol_showPanel),$("#mapDisplayButton, #wvwDisplayButton, #accDisplayButton").toggle(!O.Options.bol_showPanel),M.refreshMap(),W.isMapInitialized&&W.refreshMap(),A.isAccountInitialized&&A.adjustAccountPanel())},bol_alignPanelRight:function(e){I.isMapEnabled&&(O.Options.bol_alignPanelRight?!0!==e&&($("#panelApp").insertAfter("#panelMap"),$(".paneApp").css({right:"0px",borderLeft:"1px solid #444",borderRight:"none",boxShadow:"-5px 0px 5px #223"}),$(".mapDisplayButton").css({right:0,left:"auto"}),$("#itemDisplayButton").css({right:"auto",left:"auto","margin-left":"-16px"}),$("#prjController").css({right:"auto"})):($("#panelApp").insertBefore("#panelMap"),$(".paneApp").css({right:"auto",borderLeft:"none",borderRight:"1px solid #444",boxShadow:"5px 0px 5px #223"}),$(".mapDisplayButton").css({right:"auto",left:0}),$("#itemDisplayButton").css({right:"auto",left:"auto","margin-left":I.cPANEL_WIDTH-16+"px"}),$("#prjController").css({right:0})))},bol_showHUD:function(){$("#mapHUDContainer, #mapHUDContainerInner").toggle(O.Options.bol_showHUD)},bol_showHUDWvW:function(){$("#wvwHUDContainer, #wvwHUDContainerInner").toggle(O.Options.bol_showHUDWvW)},bol_showCoordinatesBar:function(){M.toggleCoordinatesBar()},bol_hideHUD:function(){!1===O.Options.bol_hideHUD&&$("#mapHUDContainerInner").show()},bol_showDashboard:function(){H.toggleDashboard()},bol_showTimeline:function(){H.toggleTimeline()},bol_opaqueTimeline:function(){H.opaqueTimeline()},bol_condenseTimelineLine:function(e){(void 0===e||e&&!1===O.Options.bol_condenseTimelineLine)&&($(".tmlLineWB").show(),I.toggleElement(".tmlLineStandard",O.Options.bol_condenseTimelineLine),!1===O.Options.bol_condenseTimelineLine&&X.clearChecklist(X.Checklists.Timeline))},bol_condenseTimelineHeader:function(e){H.minutesInTimelineSpacing=O.Options.bol_condenseTimelineHeader?T.cMINUTES_IN_TIMEFRAME:T.cMINUTES_IN_MINIFRAME,H.updateTimelineHeader(),!0!==e&&H.updateTimelineSegments()},bol_refreshPrices:function(){O.Options.bol_refreshPrices&&E.isTradingCalculatorsInitialized?E.loopRefresh():E.cancelLoopRefresh()},bol_useSiteTag:function(){O.Options.bol_useSiteTag?I.siteTagCurrent=I.siteTagDefault:I.siteTagCurrent=""},bol_showLog:function(){W.toggleLog()},bol_opaqueLog:function(){W.opaqueLog()},bol_maximizeLog:function(){W.toggleLogHeight()},bol_showLeaderboard:function(){W.toggleLeaderboard()},bol_opaqueLeaderboard:function(){W.opaqueLeaderboard()},bol_condenseLeaderboard:function(){W.toggleLeaderboardWidth(!0)},bol_showSecondaries:function(){W.toggleSecondaries(!0)},bol_showDestructibles:function(){W.toggleWalls(!0)},bol_showObjectiveLabels:function(){W.toggleObjectiveLabels()}}},X={Checklists:{Directory:{key:"str_chlDirectory"},Chain:{key:"str_chlChain"},ChainSubscription:{key:"str_chlChainSubscription"},Timeline:{key:"str_chlTimeline"},JP:{key:"str_chlJP"},Chest:{key:"str_chlChest"},ResourceRich:{key:"str_chlResourceRich"},ResourcePermanent:{key:"str_chlResourcePermanent"},ResourceRegular:{key:"str_chlResourceRegular"},ResourceHotspot:{key:"str_chlResourceHotspot"},Dungeon:{key:"str_chlDungeon",money:0},Raid:{key:"str_chlRaid",money:0},CustomDaily:{key:"str_chlCustomDaily"},CustomWeekly:{key:"str_chlCustomWeekly"},TradingOverwrite:{key:"str_chlTradingOverwrite"},TradingNotify:{key:"str_chlTradingNotify"}},Collectibles:{WaterloggedChests:{key:"str_chlWaterloggedChests",urlkey:"waterloggedchests"},HarathiStrongboxes:{key:"str_chlHarathiStrongboxes",urlkey:"harathistrongboxes"},IceboundChests:{key:"str_chlIceboundChests",urlkey:"iceboundchests"},SkrittStashes:{key:"str_chlSkrittStashes",urlkey:"skrittstashes"},NoxiousPods:{key:"str_chlNoxiousPods",urlkey:"noxiouspods"},CrystallizedCaches:{key:"str_chlCrystallizedCaches",urlkey:"crystallizedcaches"},ExaltedChests:{key:"str_chlExaltedChests",urlkey:"exaltedchests"},AirshipCargo:{key:"str_chlAirshipCargo",urlkey:"airshipcargo"},BuriedChests:{key:"str_chlBuriedChests",urlkey:"chests"},BanditChests:{key:"str_chlBanditChests",urlkey:"banditchests"},MatrixCubeKey:{key:"str_chlMatrixCubeKey",urlkey:"matrixcubekey"},SkrittBurglar:{key:"str_chlSkrittBurglar",urlkey:"skrittburglar"},PumpkinCarving:{key:"str_chlPumpkinCarving",urlkey:"pumpkins"},DonationDrive:{key:"str_chlDonationDrive",urlkey:"orphans"},LessonsLearned:{key:"str_chlLessonsLearned",urlkey:"lessonslearned"},PeopleWatching:{key:"str_chlPeopleWatching",urlkey:"peoplewatching"},RockCollector:{key:"str_chlRockCollector",urlkey:"rockcollector"},CinsGoods:{key:"str_chlCinsGoods",urlkey:"cinsgoods"},LettersFromE:{key:"str_chlLettersFromE",urlkey:"lettersfrome"},CaudecusLetters:{key:"str_chlCaudecusLetters",urlkey:"caudecusletters"},ThoroughSampling:{key:"str_chlThoroughSampling",urlkey:"thoroughsampling"},MursaatTokens:{key:"str_chlMursaatTokens",urlkey:"mursaattokens"},MursaatTablets:{key:"str_chlMursaatTablets",urlkey:"mursaattablets"},CamiJournals:{key:"str_chlCamiJournals",urlkey:"camijournals"},RiftStabilizer:{key:"str_chlRiftStabilizer",urlkey:"riftstabilizer"},BloodstoneCreatures:{key:"str_chlBloodstoneCreatures",urlkey:"creatures"},BloodstoneSlivers:{key:"str_chlBloodstoneSlivers",urlkey:"slivers"},PaperScraps:{key:"str_chlPaperScraps",urlkey:"paperscraps"},TigerSpirit:{key:"str_chlTigerSpirit",urlkey:"tigerspirit"},ItzelTotems:{key:"str_chlItzelTotems",urlkey:"itzeltotems"},PriorySeals:{key:"str_chlPriorySeals",urlkey:"prioryseals"},AuricTablets:{key:"str_chlAuricTablets",urlkey:"aurictablets"},ExaltedMasks:{key:"str_chlExaltedMasks",urlkey:"exaltedmasks"},LionsArchExterminator:{key:"str_chlLionsArchExterminator",urlkey:"lionsarchexterminator"},CoinProspect:{key:"str_chlCoinProspect",urlkey:"coinprospect"},CoinUplands:{key:"str_chlCoinUplands",urlkey:"coinuplands"},CoinChallenger:{key:"str_chlCoinChallenger",urlkey:"coinchallenger"},LostBadges:{key:"str_chlLostBadges",urlkey:"lostbadges"},GoldenLostBadges:{key:"str_chlGoldenLostBadges",urlkey:"goldenlostbadges"},DiveMaster:{key:"str_chlDiveMaster",urlkey:"divemaster"},SpeedyReader:{key:"str_chlSpeedyReader",urlkey:"speedyreader"},CleaningUp:{key:"str_chlCleaningUp",urlkey:"cleaningup"},HistoryBuff:{key:"str_chlHistoryBuff",urlkey:"historybuff"},HungryCats:{key:"str_chlHungryCats",urlkey:"hungrycats"},Strongboxes:{key:"str_chlStrongboxes",urlkey:"strongboxes"},MasteryInsight:{key:"str_chlMasteryInsight",urlkey:"masteryinsight"},HeroChallenge:{key:"str_chlHeroChallenge",urlkey:"herochallenge"},ImportantWaypoints:{key:"str_chlImportantWaypoints",urlkey:"importantwaypoints"},RangerPets:{key:"str_chlRangerPets",urlkey:"pets"}},ChecklistEnum:{Unchecked:"0",Checked:"1",Disabled:"2",Unfound:"0",Tracked:"1",Found:"2"},ChecklistJob:{UncheckAll:0,CheckAll:1,UncheckTheChecked:2},Textlists:{SlotPins:{key:"str_txlSlotPins"},SlotPinsWvW:{key:"str_txlSlotPinsWvW"},SlotCompasses:{key:"str_txlSlotCompasses"},SlotCompassesWvW:{key:"str_txlSlotCompassesWvW"},CustomTextDaily:{key:"str_txlCustomTextDaily",valueDefault:[]},CustomTextWeekly:{key:"str_txlCustomTextWeekly",valueDefault:[]},NotepadText:{key:"str_txlNotepadText",valueDefault:[]},TradingItem:{key:"str_txlTradingItem"},TradingName:{key:"str_txlTradingName"},TradingBuy:{key:"str_txlTradingBuy"},TradingSell:{key:"str_txlTradingSell"},TradingQuantity:{key:"str_txlTradingQuantity"},NotifyBuyLow:{key:"str_txlNotifyBuyLow"},NotifyBuyHigh:{key:"str_txlNotifyBuyHigh"},NotifySellLow:{key:"str_txlNotifySellLow"},NotifySellHigh:{key:"str_txlNotifySellHigh"},ExchangeUnit:{key:"str_txlExchangeUnit"}},boolToChecklistEnum:function(e){return e?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked},initializeChecklist:function(e,t,a,n,i){var r,o,s=localStorage[e.key];if(e.value="",e.length=t,a){if(X.clearChecklist(e),r=a.split(","),i)for(var c=0;c<r.length;c++)r[c]=i[r[c]];for(c in r)o=parseInt(r[c]),isFinite(o)&&X.setChecklistItem(e,o-1,X.ChecklistEnum.Checked)}else if(void 0===s)X.clearChecklist(e,n);else if(s.length>t)localStorage[e.key]=s.substring(0,t);else if(s.length<t){var l=U.repeatChar(X.ChecklistEnum.Unchecked,t-s.length);localStorage[e.key]=s+l}e.value=localStorage[e.key]},setChecklistItem:function(e,t,a){t=parseInt(t);var n=a.toString();if(1===n.length&&e.value[t]!==n&&t>=0&&t<e.value.length){var i=U.replaceCharAt(e.value,t,n);localStorage[e.key]=i,e.value=i}},trackChecklistItem:function(e,t){t=parseInt(t);var a=e.value.charAt(t);switch(a){case X.ChecklistEnum.Unfound:a=X.ChecklistEnum.Tracked;break;case X.ChecklistEnum.Tracked:a=X.ChecklistEnum.Found;break;case X.ChecklistEnum.Found:a=X.ChecklistEnum.Unfound;break;default:a=X.ChecklistEnum.Unfound}var n=U.replaceCharAt(e.value,t,a);return localStorage[e.key]=n,e.value=n,a},getChecklistItem:function(e,t,a){var n=e.value.charAt(t);return void 0===a?n:a===U.TypeEnum.isInteger?parseInt(n):a===U.TypeEnum.isBoolean?U.intToBool(parseInt(n)):n},isChecked:function(e,t){var a=U.getSubintegerFromHTMLID(t);return X.getChecklistItem(e,a)===X.ChecklistEnum.Checked},getCheckedIndexes:function(e,t){var a,n="",i=e.value;for(a=0;a<i.length;a++)i[a]===X.ChecklistEnum.Checked&&(n+=t?t[a]+",":a+1+",");return n=n.slice(0,-1)},clearChecklist:function(e,t){var a,n="",i="";switch(t){case X.ChecklistJob.CheckAll:for(a=0;a<e.length;a++)n+=X.ChecklistEnum.Checked;break;case X.ChecklistJob.UncheckTheChecked:if((i=localStorage[e.key]?localStorage[e.key]:e.value)&&i.length)for(a=0;a<i.length;a++)i[a]===X.ChecklistEnum.Checked?n+=X.ChecklistEnum.Unchecked:n+=i[a];break;default:for(a=0;a<e.length;a++)n+=X.ChecklistEnum.Unchecked}e.value=n,localStorage[e.key]=n},countChecklist:function(e,t){return U.countOccurrence(e.value,t)},getCheckboxEnumState:function(e){return!0===e.prop("disabled")?X.ChecklistEnum.Disabled:!0===e.prop("checked")?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked},setCheckboxEnumState:function(e,t){switch(t){case X.ChecklistEnum.Disabled:e.prop("disabled",!0),e.prop("checked",!1);break;case X.ChecklistEnum.Checked:e.prop("checked",!0);break;default:e.prop("checked",!1)}e.trigger("change")},setFieldsetState:function(e,t){$("fieldset[name='"+e+"'] input:eq("+t+")").trigger("click")},triggerCheckbox:function(e,t){var a=X.getCheckboxEnumState(e);t===X.ChecklistEnum.Checked&&a===X.ChecklistEnum.Unchecked||t===X.ChecklistEnum.Unchecked&&a===X.ChecklistEnum.Checked?e.trigger("click"):t===X.ChecklistEnum.Disabled&&a!==X.ChecklistEnum.Disabled&&e.trigger("dblclick")},triggerCheckboxEnumState:function(e,t,a){var n=X.getChecklistItem(e,t);X.triggerCheckbox(a,n)},setCheckboxStyle:function(e,t,a){var n=X.getChecklistItem(e,t),i=X.getCheckboxLabel(a);switch(n){case X.ChecklistEnum.Disabled:i.removeClass("chlCheckboxChecked").addClass("chlCheckboxDisabled");break;case X.ChecklistEnum.Checked:i.removeClass("chlCheckboxDisabled").addClass("chlCheckboxChecked");break;default:i.removeClass("chlCheckboxDisabled").removeClass("chlCheckboxChecked")}},wrapCheckbox:function(e){$(e).addClass("jsCheckbox").wrap("<span class='cssCheckbox'></span>").after("<kbd class='cssCheckboxImage'></kbd>")},rewrapCheckboxes:function(){$("input[type='checkbox']").not(".jsCheckbox").each(function(){X.wrapCheckbox($(this))})},getCheckboxLabel:function(e){return $(e).closest("label")},relabelCheckbox:function(e,t){var a=$(e),n=X.getCheckboxLabel(a).attr("id",a.attr("id").replace(O.cPrefixOption,O.cPrefixLabel));n.find(".jsCheckboxText").remove(),n.append("<var class='jsCheckboxText'> "+t+"</var>")},initializeCheckboxlist:function(e,t,a,n,i){X.initializeChecklist(e,t.length,null,a),t.each(function(t){$(this).change(function(){var a=X.getCheckboxEnumState($(this));X.setChecklistItem(e,t,a),!1!==i&&X.setCheckboxStyle(e,t,$(this))}),X.triggerCheckboxEnumState(e,t,$(this)),!1!==i&&X.setCheckboxStyle(e,t,$(this))}),n&&n.click(function(){X.clearCheckboxes(t)})},clearCheckboxes:function(e){e.each(function(){X.setCheckboxEnumState($(this),X.ChecklistEnum.Unchecked),$(this).trigger("change")})},initializeTextlist:function(e,t,a,n,i){e.value=[],$(t).each(function(){var t=$(this).val();e.value.push(t),e.valueDefault&&e.valueDefault.push(t)});var r;if(void 0===localStorage[e.key])localStorage[e.key]=e.value.join(I.cTextDelimiterChar);else{var o=localStorage[e.key].split(I.cTextDelimiterChar);for(r=0;r<e.value.length;r++)o[r]?e.value[r]=o[r]:e.value[r]="";localStorage[e.key]=e.value.join(I.cTextDelimiterChar)}var s=function(){$(t).each(function(t){e.value[t]=$(this).val().replace(I.cTextDelimiterRegex,"")}),localStorage[e.key]=e.value.join(I.cTextDelimiterChar)};$(t).each(function(t){$(this).attr("maxlength",n),$(this).val(e.value[t]),$(this).change(function(){a&&I.write(a+" #"+(t+1)+" updated."),s()})}),i&&i.click(function(){confirm("Reset texts to default?")&&$(t).each(function(t){$(this).val(e.valueDefault[t]).trigger("change")})})},bindTextlistSwap:function(e,t,a){var n=$(e),i=n.children(),r=function(e){return e.closest(".jsSwappable")};(t?$(t):i).each(function(){$(this).append("<span class='btnSwap'><button class='btnSwapUp'></button><button class='btnSwapDown'></button></span>")}),i.each(function(){$(this).addClass("jsSwappable")}),n.find(".btnSwap").each(function(){$(this).hover(function(){r($(this)).find("input[type='text']").addClass("cssInputFocused")},function(){r($(this)).find("input[type='text']").removeClass("cssInputFocused")})}),n.find(".btnSwapUp, .btnSwapDown").click(function(){var e=r($(this));if($(this).hasClass("btnSwapUp")){var t=e.prev();t.length?e.insertBefore(t):e.insertAfter(n.find(".jsSwappable").last())}else{var i=e.next();i.length?e.insertAfter(i):e.insertBefore(n.find(".jsSwappable").first())}a?a():e.find("input").trigger("change")})},initializeChainChecklist:function(e){var t=$("#chnBar_"+e.nexus),a=$("#chnCheck_"+e.nexus),n=$("#chnTime_"+e.nexus);X.reapplyChainBarState(e.nexus,t,a,n),C.isChainRegular(e)&&n.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=$(".chnSlot_"+e).find("time");X.getChecklistItem(X.Checklists.ChainSubscription,e)===X.ChecklistEnum.Checked?($(this).removeClass("chnTimeSubscribed"),t.removeClass("chnTimeSubscribed"),X.setChecklistItem(X.Checklists.ChainSubscription,e,X.ChecklistEnum.Unchecked)):($(this).addClass("chnTimeSubscribed"),t.addClass("chnTimeSubscribed"),X.setChecklistItem(X.Checklists.ChainSubscription,e,X.ChecklistEnum.Checked),O.Options.int_setAlarm!==O.IntEnum.Alarm.Subscription&&X.setFieldsetState("int_setAlarm",O.IntEnum.Alarm.Subscription))}),a.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=$("#chnBar_"+e),a=$(".chnSlot_"+e),n=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";switch(X.getChecklistItem(X.Checklists.Chain,e)){case X.ChecklistEnum.Unchecked:t.addClass("chnFaded"),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).hide("fast"),$(this).addClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Checked),a.addClass("chnFaded").find(".chnCheck").addClass("chnChecked");break;case X.ChecklistEnum.Checked:t.removeClass("chnFaded").show("fast").css({display:n}),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).show("fast").css({display:n}),$(this).removeClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Unchecked),a.show("fast").each(function(){$(this).css({display:n}).removeClass("chnFaded").find(".chnCheck").removeClass("chnChecked"),$(this).hasClass("tmlIcon")&&$(this).css({display:"inline-block"})});break;case X.ChecklistEnum.Disabled:t.removeClass("chnFaded").show("fast").css({display:n}),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).show("fast").css({display:n}),$(this).removeClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Unchecked),a.hide().removeClass("chnFaded").find(".chnCheck").removeClass("chnChecked")}X.hideCheckedChainBar(e),K.checkoffChainIcon(e)}),$("#chnDelete_"+e.nexus).click(function(){var e=U.getSubintegerFromHTMLID($(this));$("#chnBar_"+e).hide("slow"),$(".chnSlot_"+e).hide("slow"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Disabled),K.checkoffChainIcon(e)})},reapplyChainBarState:function(e,t,a,n){switch(X.getChecklistItem(X.Checklists.Chain,e)){case X.ChecklistEnum.Unchecked:break;case X.ChecklistEnum.Checked:t.addClass("chnFaded"),a.addClass("chnChecked"),O.Options.bol_hideChecked&&t.hide();break;case X.ChecklistEnum.Disabled:t.hide()}C.isChainRegular(C.Chains[e])&&X.getChecklistItem(X.Checklists.ChainSubscription,e)===X.ChecklistEnum.Checked&&n.addClass("chnTimeSubscribed")},reapplyChainIconState:function(e,t,a){switch(X.getChecklistItem(X.Checklists.Chain,e.nexus)){case X.ChecklistEnum.Unchecked:t.removeClass("chnFaded");break;case X.ChecklistEnum.Checked:t.addClass("chnFaded");break;case X.ChecklistEnum.Disabled:a?t.hide():t.addClass("chnFaded")}},hideCheckedChainBar:function(e){var t=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";X.getChecklistItem(X.Checklists.Chain,e)===X.ChecklistEnum.Checked&&(O.Options.bol_hideChecked?($("#chnBar_"+e).hide("fast"),$(".chnSlot_"+e).hide("fast")):($("#chnBar_"+e).show("fast").css({display:t}),$(".chnSlot_"+e).each(function(){$(this).show("fast").css({display:t}),$(this).hasClass("tmlIcon")&&$(this).css({display:"inline-block"})})))},getChainChecklistState:function(e){return X.getChecklistItem(X.Checklists.Chain,e.nexus)},initializePersonalChecklist:function(){T.isChecklistCountdownsStarted=!0,T.updateChecklistCountdowns(),$("#chlDungeon, #chlCustomWeekly").hide();var e=$("#chlCustomTabs button"),t=$("#chlCustom"),a=$("#chlDungeon"),n=$("#chlRaid"),i=$("#chlCustomDaily"),r=$("#chlCustomWeekly"),o=$("#chlCountdownToDaily").hide(),s=$("#chlCountdownToWeekly").hide(),c=function(c,l,u,d){e.removeClass("btnActive"),c.addClass("btnActive"),t.hide(),a.hide(),n.hide(),i.hide(),r.hide(),o.hide(),s.hide(),d.show(),l.show(),u.show().css({opacity:.5}).animate({opacity:1},400)};$("#chlDungeonButton").click(function(){c($(this),a,a,o)}),$("#chlCustomDailyButton").click(function(){c($(this),t,i,o)}).trigger("click"),$("#chlCustomWeeklyButton").click(function(){c($(this),t,r,s)}),$("#chlRaidButton").click(function(){c($(this),n,n,s)}),X.initializeDungeonChecklist(),X.initializeCustomChecklist(),X.initializeRaidChecklist(),X.rewrapCheckboxes()},initializeDungeonChecklist:function(){X.initializeChecklist(X.Checklists.Dungeon,$("#chlDungeon input").length),$("#chlDungeon .chlDungeonBar").each(function(){$(this).prepend("<ins class='chl_dungeon chl_"+$(this).data("name").toLowerCase()+"'></ins>")});var e=function(){var e=X.Checklists.Dungeon.money,t=~~(e/E.Exchange.COPPER_IN_GOLD),a=~~(e/E.Exchange.SILVER_IN_GOLD)%E.Exchange.COPPER_IN_SILVER,n=e%E.Exchange.COPPER_IN_SILVER;$("#chlDungeonCalculator_Gold").text(t),$("#chlDungeonCalculator_Silver").text(a),$("#chlDungeonCalculator_Copper").text(n)};$("#chlDungeon input").each(function(t){$(this).change(function(){var a=X.getCheckboxEnumState($(this));X.setChecklistItem(X.Checklists.Dungeon,t,a),X.setCheckboxStyle(X.Checklists.Dungeon,t,$(this));var n=$("#chlDungeonCalculator"),i=X.Checklists.Dungeon.money,r=$(this).data("money");switch($(this).data("mode")){case"E":r+=n.data("moneyaddexp")}switch(a){case X.ChecklistEnum.Disabled:X.Checklists.Dungeon.money=i-r;break;case X.ChecklistEnum.Checked:X.Checklists.Dungeon.money=i+r;break;default:X.Checklists.Dungeon.money=i-r}e()})}),$("#chlDungeon label").each(function(e){$(this).dblclick(function(){var t=$(this).find("input:first-child");!1===t.prop("disabled")?(!0===t.prop("checked")&&X.triggerCheckbox(t,X.ChecklistEnum.Unchecked),t.prop("disabled",!0).prop("checked",!1)):t.prop("disabled",!1),X.setChecklistItem(X.Checklists.Dungeon,e,X.getCheckboxEnumState(t)),X.setCheckboxStyle(X.Checklists.Dungeon,e,t)})}),$("#chlDungeon input").each(function(e){X.triggerCheckboxEnumState(X.Checklists.Dungeon,e,$(this))}),$("#chlDungeonUncheck").click(function(){X.clearChecklist(X.Checklists.Dungeon,X.ChecklistJob.UncheckTheChecked),$("#chlDungeon input").each(function(e){!0===$(this).prop("checked")&&$(this).trigger("click"),X.setCheckboxStyle(X.Checklists.Dungeon,e,$(this))})})},initializeRaidChecklist:function(){X.initializeCheckboxlist(X.Checklists.Raid,$("#chlRaid input"),X.ChecklistJob.UncheckAll,$("#chlRaidUncheck")),$("#chlRaid input").each(function(){$(this).before("<ins class='chl_raid chl_"+$(this).data("name")+"'></ins>")})},initializeCustomChecklist:function(){for(var e="<li><label><input type='checkbox' />"+I.Symbol.Filler+"</label><input class='cssInputTextLine' type='text' /></li>",t=$("#chlCustomListDaily"),a=$("#chlCustomListWeekly"),n=0;n<O.Options.int_numChecklistDaily;n++)t.append(e);for(n=0;n<O.Options.int_numChecklistWeekly;n++)a.append(e);var i=function(e){for(var t=e.attr("data-samples").split(I.cTextDelimiterChar),a=0;a<t.length;a++)e.find("input[type='text']:eq("+a+")").val(t[a])};i(t),i(a);var r=function(e,t,a){var n="#chlCustomList"+a,i=$(n),r=i.find("input:checkbox");X.initializeChecklist(e,r.length),r.each(function(t){$(this).change(function(){var a=X.getCheckboxEnumState($(this));X.setChecklistItem(e,t,a),X.setCheckboxStyle(e,t,$(this));var n=X.getCheckboxLabel($(this)).next();a===X.ChecklistEnum.Checked?n.addClass("chlCustomTextChecked"):n.removeClass("chlCustomTextChecked")}),X.triggerCheckboxEnumState(e,t,$(this))}),$("#chlCustomUncheck"+a).click(function(){X.clearChecklist(e,X.ChecklistJob.UncheckTheChecked),i.find("input:checkbox").each(function(t){$(this).prop("checked")&&$(this).trigger("click"),X.setCheckboxStyle(e,t,$(this))})});var o=$("#chlCustomRestore"+a);X.initializeTextlist(t,n+" input:text",null,48,o),X.bindTextlistSwap(i)};r(X.Checklists.CustomDaily,X.Textlists.CustomTextDaily,"Daily"),r(X.Checklists.CustomWeekly,X.Textlists.CustomTextWeekly,"Weekly")},clearCustomChecklistDaily:function(){$("#chlCustomUncheckDaily").trigger("click"),$("#chlDungeonUncheck").trigger("click"),X.clearChecklist(X.Checklists.CustomDaily,X.ChecklistJob.UncheckTheChecked),X.clearChecklist(X.Checklists.Dungeon,X.ChecklistJob.UncheckTheChecked)},clearCustomChecklistWeekly:function(){$("#chlCustomUncheckWeekly").trigger("click"),$("#chlRaidUncheck").trigger("click"),X.clearChecklist(X.Checklists.CustomWeekly,X.ChecklistJob.UncheckTheChecked),X.clearChecklist(X.Checklists.Raid,X.ChecklistJob.UncheckTheChecked)},initializeNotepad:function(){$("#chlNotepadButtons button").each(function(e){$(this).click(function(){$("#chlNotepadSheets textarea").hide().eq(e).show().css({opacity:.5}).animate({opacity:1},400),$("#chlNotepadButtons button").removeClass("btnActive"),$(this).addClass("btnActive")})}).first().click();var e=$("#chlNotepadSheets textarea"),t=$("#chlNotepadRestore");X.initializeTextlist(X.Textlists.NotepadText,e,"Notepad sheet",4096,t),e.css("height",O.Options.int_sizeNotepadHeight),e.css("font-size",O.Options.int_sizeNotepadFont),e.first().show()}},U={URL_META:{Forum:"http://forum.renaka.com/forum/368355/",News:"http://forum.renaka.com/topic/5500046/",Overlay:"http://forum.renaka.com/topic/5546166/",BuildNotes:"https://{0}-forum.guildwars2.com/categories/game-release-notes"},ScriptURLs:{},APIKey:null,APIKeyLength:72,ServerIDLength:4,URL_API:{Achievements:"https://api.guildwars2.com/v2/achievements",Daily:"https://api.guildwars2.com/v2/achievements/daily",Tomorrow:"https://api.guildwars2.com/v2/achievements/daily/tomorrow",LangKey:"",Maps:"https://api.guildwars2.com/v1/maps",MapFloorTyria:"https://api.guildwars2.com/v1/map_floor.json?continent_id=1&floor=1",MapFloorMists:"https://api.guildwars2.com/v1/map_floor.json?continent_id=2&floor=1",EventDetails:"https://api.guildwars2.com/v1/event_details.json",ItemListing:"https://api.guildwars2.com/v2/commerce/listings",ItemPrice:"https://api.guildwars2.com/v2/commerce/prices",ItemDetail:"https://api.guildwars2.com/v2/items",CoinPrice:"https://api.guildwars2.com/v2/commerce/exchange/gems?quantity=",GemPrice:"https://api.guildwars2.com/v2/commerce/exchange/coins?quantity=",Guild:"https://api.guildwars2.com/v2/guild/",Match:"https://api.guildwars2.com/v2/wvw/matches?world=",Matches:"https://api.guildwars2.com/v2/wvw/matches/",MatchFallback:"https://api.guildwars2.com/v1/wvw/match_details.json?match_id=",MatchesFallback:"https://api.guildwars2.com/v1/wvw/matches.json",Root:"https://api.guildwars2.com/v2.json",Support:"https://en-forum.guildwars2.com/categories/api-development",Build:"https://api.guildwars2.com/v2/build",Worlds:"https://api.guildwars2.com/v2/worlds",Prefix:"https://api.guildwars2.com/v2/",Prefix1:"https://api.guildwars2.com/v1/",TextToSpeech:"http://code.responsivevoice.org/getvoice.php?tl=",TextToSpeechNative:"bin/tts/mespeak.js",ThreeDimensional:"https://ajax.googleapis.com/ajax/libs/threejs/r76/three.min.js",Charts:"bin/highstock.js"},PageLimit:200,IDsLimit:200,URL_IMG:{Placeholder:"img/ui/placeholder.png",Sector:"img/map/scope.png",Waypoint:"img/map/waypoint.png",WaypointOver:"img/map/waypoint_h.png",Landmark:"img/map/landmark.png",LandmarkOver:"img/map/landmark_h.png",Vista:"img/map/vista.png",Mastery:"img/map/mastery.png",Challenge:"img/map/challenge.png",Heart:"img/map/heart.png"},URL_DATA:{Maps:"cache/maps_{0}.json",Events:"cache/events_{0}.json",Account:"data/account.js",WvW:"data/wvw.js",Itinerary:"data/itinerary.js",Materials:"data/materials.js",Skins:"data/skins.js",Outfits:"data/outfits.js",Gliders:"data/gliders.js",Dyes:"data/dyes.js",Minis:"data/minis.js",Carriers:"data/carriers.js",Champions:"data/champions.js",Finishers:"data/finishers.js",Nodes:"data/nodes.js",Cats:"data/cats.js",Raids:"data/raids.js",Dungeons:"data/dungeons.js",Catalog:"data/catalog.js",Cleanup:"data/cleanup.js",Ascended:"data/ascended.js",Recipes:"data/recipes.js",SAB:"data/sab.js",Prices:"cache/prices.json",Gem:"data/gem.js",Sale:"data/sale.js",Museum:"data/museum.js",Pact:"data/pact.js",Unscheduled:"data/chains-add.js",Daily:"data/daily.js",DryTop:"data/drytop.js",Resource:"data/resource.js",JP:"data/jp.js",Collectible:"data/collectible.js",Guild:"data/guild.js"},initializeAPIURLs:function(){var e=D.langPartiallySupported;U.URL_API.LangKey="lang="+e;var t=I.cTextReplace;U.URL_META.BuildNotes=U.URL_META.BuildNotes.replace(t,e),U.URL_DATA.Maps=U.URL_DATA.Maps.replace(t,e),U.URL_DATA.Events=U.URL_DATA.Events.replace(t,e),U.URL_API.Worlds+="?"+U.URL_API.LangKey+"&ids=",U.URL_API.TextToSpeech+=e+"&sv=&vn=&pitch=0.5&rate=0.4"},getScript:function(e,t,a){var n=void 0===a||a;return void 0===U.ScriptURLs[e]||!1===n?(U.ScriptURLs[e]=!0,$.ajax({dataType:"script",url:e,cache:n,success:function(){t&&t()}})):(t&&t(),{fail:function(){}})},getJSON:function(e,t,a){var n=void 0===a||a;return $.ajax({dataType:"json",url:e,cache:n,success:function(e){t&&t(e)}})},fetchPaginated:function(e,t){var a,n=t||{},i=50,r=0,o=e+"&page_size="+U.PageLimit,s=void 0!==n.aWantCache&&n.aWantCache,c=[],l=[],u=function(){r===a&&(c.forEach(function(e){e&&(l=l.concat(e))}),n.aCallback(l))};$.ajax({dataType:"json",url:o,cache:s,success:function(e,t,d){if(r++,(a=parseInt(d.getResponseHeader("X-Page-Total")))>i){for(var p=[],h=1;h<a;h++)p.push(h);Z.scrapeAPIArray(o+"&page=",p,{aIsStandard:!1,aCooldown:30,aNumRetries:10,aCallback:function(t){l=l.concat(e),t.forEach(function(e){l=l.concat(e)}),n.aCallback(l)}})}else if(a>1){(c=new Array(a))[0]=e;for(h=1;h<a;h++)!function(e){$.ajax({dataType:"json",url:o+"&page="+e,cache:s,success:function(t){c[e]=t,r++,u()},error:function(){a--,u()}})}(h)}else 1===a?(c[0]=e,u()):n.aCallback(null)},error:function(e,t){n.aError?n.aError():n.aPermission&&A.printError(n.aPermission,t)}})},fetchPattern:function(e,t,a){for(var n,i=a||{},r=void 0===i.aWantCache||i.aWantCache,o={},s={},c=0,l=t.length,u=function(){if(A.setProgressBar(c,l),c===l){for(var e in t)(n=o[t[e]])&&(s[t[e]]=n);i.aCallback&&i.aCallback(s,c)}},d=0;d<t.length;d++)!function(t){U.getJSON(e.replace(I.cTextReplace,U.encodeURL(t)),function(e){o[t]=e,c++,u()},r).fail(function(){l--,u()})}(t[d])},fetchAPI:function(e,t,a){var n=a||{},i=void 0!==n.aWantCache&&n.aWantCache,r=[],o=[],s=[],c=0,l=0,u=function(){if(r.length!==o.length){var e=[];for(var t in o)o[t].id&&e.push(o[t].id);s=U.getDifference(r,e)}A.fillProgressBar(),n.aCallback&&n.aCallback(o,s)},d=function(t,a){var r,s=t;s.length>U.IDsLimit&&(s=t.slice(0,U.IDsLimit),r=t.slice(U.IDsLimit));var p=function(){r?(c+=U.IDsLimit,A.setProgressBar(c,l),d(r)):u()};$.ajax({dataType:"json",url:U.getLangURL(e,n.aLanguage)+"&ids="+s.join(","),cache:i,success:function(e){o=o.concat(e),p()},error:function(){a?p():d(t,!0)}})};t.length?(r=U.getUnique(t),l=r.length,d(r)):n.aCallback&&n.aCallback()},getDivider:function(e){return-1!==e.indexOf("?")?"&":"?"},getLangURL:function(e,t){return e+U.getDivider(e)+(t?"lang="+t:U.URL_API.LangKey)},getAPI:function(e,t){var a=void 0===t?"":!0===t?"?ids=all":"/"+t;return U.getLangURL(U.URL_API.Prefix+e+a)},getAPIURL:function(e){return U.URL_API.Prefix+e.toLowerCase()},getAPIMap:function(e){return U.getAPI("maps",e)},getAPIAchievement:function(e){return U.getAPI("achievements",e)},getAPIItem:function(e){return U.getAPI("items",e)},getAPISkin:function(e){return U.getAPI("skins",e)},getAPIRecipe:function(e){return U.getAPI("recipes",e)},getAPIMaterial:function(e){return U.getAPI("materials",e)},getAPIMini:function(e){return U.getAPI("minis",e)},getAPISkill:function(e){return U.getAPI("skills",e)},getAPITrait:function(e){return U.getAPI("traits",e)},getAPISpecialization:function(e){return U.getAPI("specializations",e)},getAPITitle:function(e){return U.getAPI("titles",e)},getAPIPrice:function(e){return U.URL_API.ItemPrice+"/"+e},getAPIListings:function(e){return U.URL_API.ItemListing+"/"+e},getDatabaseURL:function(e,t){return"test/"+e+"_"+t+I.cTXT},getItemsDatabaseURL:function(e){return"test/items_"+e+I.cTXT},getDataScriptURL:function(e){return"data/"+e.toLowerCase()+".js"},getCacheURL:function(e,t){return"cache/"+e.toLowerCase()+"_"+(t||D.langPartiallySupported)+I.cJSON},getRecordHeader:function(e){return window["GW2T_"+e.toUpperCase()+"_HEADERS"]},getRecordMetadata:function(e){return window["GW2T_"+e.toUpperCase()+"_METADATA"]},getRecordBlacklist:function(e){return window["GW2T_"+e.toUpperCase()+"_BLACKLIST"]},getRecordData:function(e){return window["GW2T_"+e.toUpperCase()+"_DATA"]},Args:{},KeyEnum:{Page:"page",Section:"section",Article:"article",Mode:"mode",Go:"go",Draw:"draw",Fragment:"fragment",AutoAudit:"isAutoAudit"},TypeEnum:{isObject:"obj",isAssoc:"asc",isArray:"arr",isString:"str",isEnum:"enu",isInteger:"int",isFloat:"flt",isBoolean:"bol"},CaseEnum:{Original:-1,None:0,Lower:1,Sentence:2,Title:3,Every:4,Upper:5},isEnumWithin:function(e,t){for(var a in t)if(t[a].toLowerCase()===e.toLowerCase())return!0;return!1},convertQueryString:function(e){var t=e.substr(1).replace(/&amp;/g,"&").split("&");if(""===t)return{};for(var a={},n=0;n<t.length;++n){var i=t[n].split("=");2===i.length&&(a[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return a},getURLArguments:function(){var e=window.location,t=U.convertQueryString(e.search);return e.hash.length&&(t[U.KeyEnum.Fragment]=e.hash.substr(1)),t},enforceURLArgumentsFirst:function(){U.Args=U.getURLArguments(),I.cSiteTitle=document.title,I.ArticleCurrent=U.Args[U.KeyEnum.Article],U.Args[U.KeyEnum.Article]=null,U.enforceURLArgumentsSpecial();var e,t=U.Args[U.KeyEnum.Mode];if(t)for(e in I.ModeEnum)if(I.ModeEnum[e].toLowerCase()===t.toLowerCase()){I.ModeCurrent=I.ModeEnum[e];break}null===I.ModeCurrent&&(I.ModeCurrent=I.ModeEnum.Website)},enforceURLArgumentsLast:function(){U.interpretPage(U.Args[U.KeyEnum.Page])},enforceURLArgumentsSpecial:function(){var e,t,a=function(e){$("body").hide(),document.location=e},n=U.Args[U.KeyEnum.Page],i=U.Args[U.KeyEnum.Fragment];if(i&&i.length===U.APIKeyLength&&(U.APIKey=U.stripToAlphanumericDash(i).toUpperCase(),void 0===n&&(U.Args[U.KeyEnum.Page]=I.SpecialPageEnum.Account)),n)if("a"===(n=n.toLowerCase()))U.Args[U.KeyEnum.Page]=I.SpecialPageEnum.Account;else if("audit"===n)U.Args[U.KeyEnum.Page]=I.SpecialPageEnum.Account,U.Args[U.KeyEnum.Section]=I.PageEnum.Account.Characters,I.ArticleCurrent=I.SpecialPageEnum.Audit;else if(!1===U.isEnumWithin(n,I.PlateEnum))if("forum"!==n&&"forums"!==n||a(U.URL_META.Forum),"navi"===n||"overlay"===n)a(U.URL_META.Overlay);else if("m"===n||"mobile"===n)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Mobile;else if("s"===n||"simple"===n)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Simple;else if("t"===n||"tile"===n)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Tile;else if("draw"===n)localStorage.bol_showWorldCompletion="true",U.Args[U.KeyEnum.Page]=I.PlateEnum.Map,U.Args[U.KeyEnum.Draw]=U.Args[U.KeyEnum.Section];else{for(r in I.PageEnum){t=I.PageEnum[r];for(e in t)if(e.toLowerCase()===n)return void 0!==U.Args[U.KeyEnum.Section]&&(I.ArticleCurrent=U.Args[U.KeyEnum.Section]),U.Args[U.KeyEnum.Page]=r,void(U.Args[U.KeyEnum.Section]=e)}if(!1===isNaN(n)&&n.length===U.ServerIDLength)for(var r in O.OptionEnum.Server)if(O.OptionEnum.Server[r]===n)return U.Args.enu_Server=n,void(U.Args[U.KeyEnum.Page]=I.SpecialPageEnum.WvW)}void 0!==U.Args[U.KeyEnum.Page]&&(I.PageInitial=U.Args[U.KeyEnum.Page].toLowerCase());for(r in X.Collectibles)if((t=X.Collectibles[r].urlkey)===n||void 0!==U.Args[t])return U.Args[U.KeyEnum.Page]=I.PlateEnum.Map,U.Args[U.KeyEnum.Section]=I.PageEnum.Map.Collectible,void(I.ArticleCurrent=t);if(n)for(r in M.Zones)if(-1!==n.indexOf(r))return void(U.Args[U.KeyEnum.Go]=r)},verifyArticle:function(e,t){return!(!I.ArticleCurrent||I.ArticleCurrent.toLowerCase()!==e.toLowerCase())&&(I.ArticleCurrent=null,t&&t(),!0)},nullifyArticle:function(){I.ArticleCurrent=null},openSectionFromURL:function(e){var t=$.extend({aPrefix:I.cHeaderPrefix+I.PageCurrent+"_",aSection:null,aInitialSection:null,aButton:null},e);setTimeout(function(){var e=U.Args[U.KeyEnum.Section]?U.Args[U.KeyEnum.Section].toString():null;if(e){U.Args[U.KeyEnum.Section]=null,e=U.stripToAlphanumeric(e);var a=$(null);"string"==typeof t.aButton?void 0!==t.aSection&&t.aSection.toLowerCase()===e.toLowerCase()&&(a=$(t.aButton)):((a=$(t.aPrefix+U.toFirstUpperCase(e))).length||(a=$(t.aPrefix+e.toUpperCase())),I.PageCurrent===I.PlateEnum.Chains&&$("#headerChains_Scheduled").trigger("click")),a.trigger("click")}else"string"==typeof t.aInitialSection&&$(t.aPrefix+t.aInitialSection).trigger("click")},0)},interpretPage:function(e){if("string"==typeof e){var t,a=U.toFirstUpperCase(e),n=e.toUpperCase(),i=$("#panelAccount").is(":visible"),r=P.MapSwitchWebsite===P.MapEnum.Mists,o=function(){i&&I.toggleAccount(),r&&I.switchMap()},s=function(){i&&I.toggleAccount(),!1===r&&I.switchMap(a)},c=function(e){(t=$("#accMenu_"+e)).length?(!1===i&&I.toggleAccount(),t.trigger("click")):(I.toggleAccount(),I.loadAccountPanel(e))};I.PlateEnum[a]?($(I.cPlateMenuPrefix+a).trigger("click"),a!==I.PlateEnum.Chains&&a!==I.PlateEnum.Map||o()):I.PageEnum.Map[a]||I.PageEnum.Map[n]?(a=I.PageEnum.Map[n]?n:a,I.Directory.Map[a]&&o(),(t=$("#plateBeamIcon_"+a)).length?($(I.cPlateMenuPrefix+I.PlateEnum.Map).trigger("click"),t.trigger("click")):I.loadMapPlate(a)):I.PageEnum.Chains[a]||I.PageEnum.Chains[n]?(a=I.PageEnum.Chains[n]?n:a,o(),$(I.cPlateMenuPrefix+I.PlateEnum.Chains).trigger("click"),I.openChainsSection(a)):I.PageEnum.Account[a]||I.PageEnum.Account[n]||a===I.SpecialPageEnum.Account?c(a=I.PageEnum.Account[n]?n:a):a===I.SpecialPageEnum.Audit?$("#audExecute").is(":visible")?$("#audExecute").trigger("click"):(I.ArticleCurrent=I.SpecialPageEnum.Audit,c(I.PageEnum.Account.Characters)):a===U.toFirstUpperCase(I.SpecialPageEnum.WvW)?s():a===I.SpecialPageEnum.Leaderboard?(r&&$("#lboRegion").trigger("click"),s()):I.ModeEnum[a]&&(document.location="./?mode="+a)}},sanitizeURLOptionsValue:function(e,t){var a=e.substring(0,O.cLengthOfPrefixes),n=t.toLowerCase();switch(a){case U.TypeEnum.isBoolean:return"true"===n||"false"===n?n:O.Options[e].toString();case U.TypeEnum.isInteger:if(isFinite(n)){var i=parseInt(n);if(i>=O.OptionRange[e][0]&&i<=O.OptionRange[e][1])return i.toString()}return O.Options[e].toString();case U.TypeEnum.isFloat:if(isFinite(n)){var r=parseFloat(n);if(r>=O.OptionRange[e][0]&&r<=O.OptionRange[e][1])return r.toString()}return O.Options[e].toString();case U.TypeEnum.isEnum:return O.validateEnum(e,t);case U.TypeEnum.isString:return U.escapeHTML(t)}return"null"},sortObjects:function(e,t){var a=t||{},n=a.aKeyName?a.aKeyName:D.getNameKey();a.aIsDescending?e.sort(function(e,t){var i=a.aIsNumbers&&"string"==typeof e[n]?U.stripToNumbers(e[n]):e[n],r=a.aIsNumbers&&"string"==typeof t[n]?U.stripToNumbers(t[n]):t[n];return i<r?1:i>r?-1:0}):e.sort(function(e,t){var i=a.aIsNumbers&&"string"==typeof e[n]?U.stripToNumbers(e[n]):e[n],r=a.aIsNumbers&&"string"==typeof t[n]?U.stripToNumbers(t[n]):t[n];return i>r?1:i<r?-1:0})},sortAscending:function(e){e.sort(function(e,t){return e-t})},sortDescending:function(e){e.sort(function(e,t){return t-e})},convertArrayToAssoc:function(e,t){for(var a,n={},i=t||"id",r=0;r<e.length;r++)n[(a=e[r])[i]]=a;return n},convertAssocToArray:function(e,t){var a=[];if(t)for(var n in e)e[n][t]=n,a.push(e[n]);else for(var n in e)a.push(n);return a},convertAssocToInts:function(e){var t=[];for(var a in e)t.push(parseInt(a));return t},getExistAssoc:function(e,t){for(var a,n={},i=0;i<e.length;i++)a=e[i],(void 0===t||t&&t[a])&&(n[a]=!0);return n},getDifference:function(e,t){return e.concat(t).filter(function(e,t,a){return a.indexOf(e)===a.lastIndexOf(e)})},getUnique:function(e){return e.filter(function(t,a){return e.indexOf(t)===a})},getUnion:function(e,t){return U.getUnique(e.concat(t))},getRandomElement:function(e){return e.length?e[T.getRandomIntRange(0,e.length-1)]:null},getObjectLength:function(e){var t=0;for(var a in e)t++;return t},intToBool:function(e){return e>0},boolToInt:function(e){return e?1:0},stringToBool:function(e){return"true"===e.toLowerCase()},boolToString:function(e){return e?"true":"false"},randomBool:function(){return Math.random()>.5},isInteger:function(e){return!isNaN(e)&&function(e){return(0|e)===e}(parseFloat(e))},isObject:function(e){return!(!e||"[object Object]"!==Object.prototype.toString.call(e))},objToBool:function(e){return!!e},convertRGBToHex:function(e){for(var t,a="",n=0;n<e.length;n++)a+=((t=parseInt(e[n]))<T.cBASE_16?"0":"")+t.toString(T.cBASE_16);return"#"+a},getRGBToHex:function(e){var t=e.split(",");return U.convertRGBToHex([U.stripToNumbers(t[0]),U.stripToNumbers(t[1]),U.stripToNumbers(t[2])])},convertHexToRGB:function(e){var t="string"==typeof e&&"#"===e.charAt(0)?e.substring(1,e.length):e,a=parseInt(t,16);return[a>>16&255,a>>8&255,255&a]},getHexToRGB:function(e){var t=U.convertHexToRGB(e);return"rgba("+t[0]+", "+t[1]+", "+t[2]+", 1)"},convertRGBToHSL:function(e){var t,a,n=e[0]/255,i=e[1]/255,r=e[2]/255,o=Math.max(n,i,r),s=Math.min(n,i,r),c=(o+s)/2;if(o===s)t=a=0;else{var l=o-s;switch(a=c>.5?l/(2-o-s):l/(o+s),o){case n:t=(i-r)/l+(i<r?6:0);break;case i:t=(r-n)/l+2;break;case r:t=(n-i)/l+4}t/=6}return[360*t,100*a,100*c]},sortRGBs:function(e){for(var t=[],a=[],n=[],i=0;i<e.length;i++)n[i]=[U.convertRGBToHSL(e[i]),i],t.push(i);for(var r=[],i=0;i<n.length;i++){for(var o=!1,s=0;s<r.length;s++)if(r[s][0][0]>n[i][0][0]){r.splice(s,0,n[i]),a.splice(s,0,i),o=!0;break}o||(r.push(n[i]),a.push(i))}for(var c=[],i=0;i<r.length;i++)c[i]=e[r[i][1]];return{oRGBs:c,oIndexes:a}},convertRatioToPercent:function(e,t){return void 0===e||!1===isFinite(e)?"0%":(void 0===t&&(t=0),(e<0?I.Symbol.Negative:"")+Math.abs(100*e).toFixed(t)+"%")},formatPercentage:function(e,t,a){return e===parseInt(e)?void 0!==a?e.toFixed(a).toLocaleString()+"%":e.toLocaleString()+"%":e.toFixed(void 0===t?2:t).toLocaleString()+"%"},formatJSON:function(e){var t="failedstringify";try{t=JSON.stringify(e,null,"\t")}catch(e){}return t},escapeJSON:function(e){return U.escapeHTML(U.formatJSON(e))},lineJSON:function(e,t){var a=JSON.stringify(e,null,1);return!1===t&&(a=U.stripJSONQuotations(a)),a.replace(/[\r\n]/g,"").replace(/  +/g," ").replace(/ }/g,"}").replace(/{ /g,"{").replace(/ \]/g,"]").replace(/\[ /g,"[")},compressToJS:function(e){return U.stripJSONQuotations(JSON.stringify(e))},stripToAlphanumeric:function(e){return e.replace(/\W/g,"")},stripToAlphanumericDash:function(e){return e.replace(/[^a-zA-Z0-9\-]/g,"")},stripToNumbers:function(e){return parseInt(e.replace(/[^0-9]/g,""))},stripToColorString:function(e){return e.replace(/[^a-zA-Z0-9#]/g,"")},stripToVariable:function(e){return e.replace(/ /g,"_").replace(/[0-9\u0021-\u002f\u003a-\u0040\u005b-\u005e\u0060\u007b-\u007e]/g,"")},stripJSONQuotations:function(e){return e.replace(/\"([^(\")"]+)\":/g,"$1:")},stripToSentence:function(e){return e.replace(/[^\w\s\'\"\:\,]/gi,"")},stripToCalculation:function(e){return e.replace(/[^0-9.()\-+/*]/gi,"")},toFirstUpperCase:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},toCase:function(e,t){var a,n=[];if(void 0===t||t===U.CaseEnum.None)return e;switch(t!==U.CaseEnum.Title&&t!==U.CaseEnum.Every||(n=e.split(" ")),t){case U.CaseEnum.Lower:return e.toLowerCase();case U.CaseEnum.Sentence:return U.toFirstUpperCase(e);case U.CaseEnum.Title:if(n.length>1){for(n[0]=U.toFirstUpperCase(n[0]),a=1;a<n.length;a++)2!==n[a].length&&(n[a]=U.toFirstUpperCase(n[a]));return n.join(" ")}return U.toFirstUpperCase(e);case U.CaseEnum.Every:if(n.length>1){for(a in n)n[a]=U.toFirstUpperCase(n[a]);return n.join(" ")}return U.toFirstUpperCase(e);case U.CaseEnum.Upper:return e.toUpperCase()}return e},toText:function(e){return $("<div>"+e+"</div>").text()},toHalf:function(e,t){var a=e.indexOf(t);return-1!==a?[e.substr(0,a),e.substr(a+t.length,e.length)]:[e,""]},truncateString:function(e,t,a){return a=a||"",e.length>t?e.substring(0,t)+a:e},highlightSubstring:function(e,t,a){for(var n,i=a||"u",r=e.replace(/{{|}}/g,""),o=t.split(" "),s=0;s<o.length;s++)(n=o[s]).length&&(r=r.replace(new RegExp(U.escapeRegEx(n),"gi"),"{{$&}}"));return r=r.replace(/{{/g,"<"+i+">"),r=r.replace(/}}/g,"</"+i+">")},escapeHTML:function(e){return"string"==typeof e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):void 0===e?"undefined":"null"},escapeRegEx:function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},replaceCharAt:function(e,t,a){return e.substr(0,t)+a+e.substr(t+a.length)},repeatChar:function(e,t){return Array(t+1).join(e)},countOccurrence:function(e,t){return e.split(t).length-1},updateAddressBar:function(e){history.replaceState("",null,e),K.reapplyFilters()},updateQueryString:function(e){if(""!==I.PageCurrent){var t=I.SectionCurrent[I.PageCurrent],a=I.ArticleCurrent,n=U.Args[U.KeyEnum.Go],i="?"+U.KeyEnum.Page+"="+I.PageCurrent,r="",o="",s="",c="";e=void 0===e?"":"&"+e;var l=I.PageCurrent;I.ModeCurrent!==I.ModeEnum.Website&&(c="&mode="+I.getMode()),t?(r="&"+U.KeyEnum.Section+"="+t,l=t):I.ModeCurrent===I.ModeEnum.Website&&I.PageCurrent===I.PlateEnum.Directory&&(i=".",l=null),a&&(o="&"+U.KeyEnum.Article+"="+a),n&&(s="&"+U.KeyEnum.Go+"="+n),U.updateAddressBar(i+r+o+s+c+e),U.updateTitle(l),U.updateLanguageLinks(i+r+c)}},updateTitle:function(e){document.title=e?I.cSiteName+"/"+e:I.cSiteTitle},updateLanguageLinks:function(e){$(".linkLanguage").each(function(){var t=$(this).attr("data-lang"),a="";a=void 0===e||"."===e?I.ModeCurrent===I.ModeEnum.Website?"?enu_Language="+t:"?enu_Language="+t+"&mode="+I.getMode():e+"&enu_Language="+t,$(this).attr("href","./"+a)})},initializeLanguageButton:function(){$("#itemLanguageButton").html(O.Options.enu_Language.toUpperCase()),$("#itemLanguagePopup").click(function(e){e.stopPropagation()})},convertInternalLink:function(e){$(e).each(function(){var e=$(this).attr(I.cPageAttribute);e&&$(this).removeAttr(I.cPageAttribute).click(function(){U.interpretPage(e)})})},convertExternalLink:function(e){$(e).each(function(){var e=$(this).attr("href");e&&0!==e.indexOf("./")&&0!==e.indexOf(I.cSiteExternal)&&(I.ModeCurrent===I.ModeEnum.Overlay&&-1!==e.indexOf(I.cSiteURL+"?")?$(this).attr("href",e+U.getDivider(e)+"mode="+I.getMode()):$(this).attr("href",I.cSiteExternal+U.encodeURL(e)).attr("target","_blank"))})},convertExternalURL:function(e){return I.cSiteExternal+U.encodeURL(e)},convertExternalAnchor:function(e){return" href='"+I.cSiteExternal+U.encodeURL(e)+"' target='_blank' "},convertPrivateAnchor:function(e){return" href='"+e+"' target='_blank' "},convertExternalString:function(e){return e.replace(/href='/g,"target='_blank' href='"+I.cSiteExternal)},convertModeLink:function(e){I.ModeCurrent!==I.ModeEnum.Website&&$(e).each(function(){var e=$(this).attr("href");!e||0===e.indexOf(I.cSiteExternal)||0!==e.indexOf(I.cSiteURL)&&0!==e.indexOf("./")||$(this).attr("href",e+U.getDivider(e)+"mode="+I.getMode())})},openExternalURL:function(e){window.open(I.cSiteExternal+U.encodeURL(e),"_blank")},openPrivateURL:function(e){window.open(e,"_blank")},getVariableSuffix:function(e){var t=e.indexOf("_");return e.substring(t+1,e.length)},getVariablePrefix:function(e){var t=e.indexOf("_");return e.substring(0,t)},getSubstringFromHTMLID:function(e){return U.getVariableSuffix(e.attr("id"))},getSubintegerFromHTMLID:function(e){return parseInt(U.getVariableSuffix(e.attr("id")))},getPageSrc:function(e){return"page/"+e.toLowerCase()+".html"},encodeURL:function(e){return encodeURI(e).replace(/'/g,"%27")},getWikiLinkDefault:function(e){return e=e.replace(/ /g,"_"),"http://wiki.guildwars2.com/wiki/"+U.encodeURL(e)},getWikiLinkLanguage:function(e){return e=e.replace(/ /g,"_"),"http://wiki-"+D.langFullySupported+".guildwars2.com/wiki/"+U.encodeURL(e)},getWikiLinkObject:function(e){return D.isLanguageFullySupported?U.getWikiLinkLanguage(D.getObjectName(e)):U.getWikiLinkDefault(D.getObjectDefaultName(e))},getWikiLinkCode:function(e,t){var a=U.getChatlinkFromPoiID(e),n=t?"&name="+t.replace(/ /g,"_"):"";return"https://wiki.guildwars2.com/index.php?search="+encodeURIComponent(a)+n},getWikiSearchDefault:function(e){return e=e.replace(/ /g,"+"),"https://wiki.guildwars2.com/index.php?search="+U.encodeURL(e)},getWikiSearchLanguage:function(e){return e=e.replace(/ /g,"_"),"http://wiki-"+D.langFullySupported+".guildwars2.com/index.php?search="+U.encodeURL(e)},getWikiItemDefault:function(e){return D.isLanguageFullySupported&&!1===D.isLanguageDefault?U.getWikiSearchDefault(e.id.toString()):U.getWikiLinkDefault(e.name)},getGW2OfficialLink:function(e){return"https://www.guildwars2.com/"+D.langFullySupported+"/"+e},getYouTubeLink:function(e){return"http://www.youtube.com/results?search_query="+U.encodeURL(e+" "+I.cGameNick)},getTradingSearchLink:function(e){return"https://www.gw2tp.com/search?name="+U.encodeURL(e)},getTradingItemLink:function(e,t){return"http://www.gw2spidy.com/item/"+U.encodeURL(e)+"?name="+U.stripToSentence(t).replace(/ /g,"_")},getGuildBannerURL:function(e){return e?"http://guilds.gw2w2w.com/guilds/"+U.escapeHTML(e.split(" ").join("-").toLowerCase())+"/128.svg":U.URL_IMG.Placeholder},getGuildBannerRaw:function(e){try{return U.getAPIImage(GW2T_EMBLEM_DATA.foreground[e.emblem.foreground.id])}catch(e){}return"img/ui/unavailable.png"},getAPIImage:function(e){return"https://render.guildwars2.com/file/"+e+".png"},getChatlinkFromPoiID:function(e){for(var t=String.fromCharCode(4),a=0;a<4;a++)t+=String.fromCharCode(e>>8*a&255);return I.cChatcodePrefix+btoa(t)+I.cChatcodeSuffix},getChatlinkFromItemID:function(e){var t="";try{t=I.cChatcodePrefix+btoa(String.fromCharCode(2)+String.fromCharCode(1)+String.fromCharCode(e%256)+String.fromCharCode(Math.floor(e/256))+String.fromCharCode(0)+String.fromCharCode(0))+I.cChatcodeSuffix}catch(e){}return t},getGameIDFromChatlink:function(e,t){var a=function(e){for(var t=window.atob(e),a=new Array(t.length),n=0;n<t.length;n++)a[n]=t.charCodeAt(n);return a},n=null;"string"==typeof e&&0===e.indexOf(I.cChatcodePrefix)&&e.indexOf(I.cChatcodeSuffix===e.length-1)&&(e=e.substring(2,e.length-1));try{var i=a(e),n=i[2]<<8|i[1],r=null;switch(i[0]){case 2:r="item",n=i[3]<<8|i[2],n=(i.length>4?i[4]<<16:0)|n;break;case 4:r="location";break;case 6:r="skill";break;case 8:r="trait";break;case 9:r="recipe";break;case 10:r="skin";break;case 11:r="outfit"}}catch(e){I.write("Invalid chatlink to decode.")}if(t){var o=n+" ("+r+")";I.print("<input class='cssInputText' type='text' value='"+n+"'></input>&nbsp;<span>"+o+"</span>"),I.bindConsoleInput()}return n}},Z={cCommandPrefix:"/",APICacheFiles:[],APICacheArrayOfIDs:null,APICacheArrayOfObjects:null,APICacheConsole:null,DatabaseCache:{},DatabaseLanguages:["en","de","es","fr","zh"],loadAPICache:function(){var e=localStorage[O.Utilities.APICache.key];if(e)try{return Z.APICacheConsole=JSON.parse(e),!0}catch(e){I.print("Error loading API cache object.")}return!1},saveAPICache:function(){return Z.APICacheConsole?(localStorage[O.Utilities.APICache.key]=JSON.stringify(Z.APICacheConsole),!0):(I.print("Error saving cache object."),!1)},interpretCommand:function(e,t,a,n){if(0===e.indexOf(Z.cCommandPrefix))Z.parseCommand(e,t);else if(-1!==e.indexOf(I.cChatencodedPrefix))try{var i=decodeURIComponent(decodeURIComponent(e));U.getGameIDFromChatlink(i.substring(i.indexOf("["),i.indexOf("]")),!0)}catch(e){}else 0===e.indexOf(I.cChatcodePrefix)?U.getGameIDFromChatlink(e,!0):!1===t.parsePersonalPath(e)&&t.goToArguments(e,a,n)},parseCommand:function(e,t){var a=t||M,n=e.substring(1,e.length).split(" "),i=e.substring(e.indexOf(" ")+1,e.length),r=n[0].toLowerCase(),o={clear:{usage:"Clears the console screen. Or just press the Esc key.",f:function(){I.clear()}},speak:{usage:"Speaks the given text. <em>Parameters: str_text</em>",f:function(){D.speak(i)}},notify:{usage:"Notifies the given text. <em>Parameters: str_text</em>",f:function(){I.notify(i)}},gps:{usage:"Prints GPS location information (overlay only).",f:function(){I.print("Position: "+U.formatJSON(GPSPositionArray)+"<br />Direction: "+U.formatJSON(GPSDirectionArray)+"<br />Perspective: "+U.formatJSON(GPSPerspectiveArray)+"<br />Camera: "+U.formatJSON(GPSCameraArray))}},identity:{usage:"Prints GPS general information (overlay only).",f:function(){I.prettyJSON(GPSIdentityJSON)}},trace:{usage:"Prints GPS information continuously by toggle (overlay only).",f:function(){P.isGPSPrinting=!P.isGPSPrinting,P.isGPSPrinting?I.print("Trace started."):I.print("Trace stopped.")}},agent:{usage:"Prints browser's navigator object.",f:function(){var e,t,a="";for(var n in window.navigator)t="string"==typeof(e=window.navigator[n])||"number"==typeof e?e:U.formatJSON(e),a+=U.escapeHTML(n+": "+t)+"<br />";I.print(a)}},cal:{usage:"Prints a HTML calendar input element.",f:function(){I.print("<br /><input id='cslCalendar' type='date' /><br />"),$("#cslCalendar")[0].valueAsDate=new Date}},floor:{usage:"Sets the map floor. <em>Parameters: int_floornumber</em>",f:function(){a.changeFloor(parseInt(n[1]))}},lock:{usage:"Map cannot be moved.",f:function(){a.Map.dragging.disable(),a.Map.scrollWheelZoom.disable(),I.write("Map locked.")}},unlock:{usage:"Map can be moved.",f:function(){a.Map.dragging.enable(),a.Map.scrollWheelZoom.enable(),I.write("Map unlocked.")}},nct:{usage:"Disables the map's context menu.",f:function(){a.Map.off("contextmenu"),I.write("Map context menu disabled.")}},link:{usage:"Prints a coordinates URL of the current map view.",f:function(){I.paste(I.cSiteURL+a.convertLCtoGC(a.Map.getCenter()),!0)}},dart:{usage:"Draws personal pins at random map coordinates. <em>Parameters: int_quantity</em>",f:function(){a.drawRandom(n[1])}},nodes:{usage:"Sorts and prints a list coordinates. <em>Parameters: arr_coordinates</em>",f:function(){P.printNodes(P.sortCoordinates(M.parseCoordinatesMulti(n[1])))}},needles:{usage:"Numbers and prints a list of coordinates. <em>Parameters: arr_coordinates</em>",f:function(){P.printNodes(M.parseCoordinatesMulti(n[1]),!0)}},latlngs:{usage:"Converts an array of LatLng's to standard coordinates. <em>Parameters: arr_latlngs</em>",f:function(){a.convertLatLngs(JSON.parse(i))}},jsonparse:{usage:"Converts a JSON string into an object for testing. <em>Parameters: str_json</em>",f:function(){try{Z.APICacheConsole=JSON.parse(i),I.print("Parse JSON successful.")}catch(e){I.print("Parse JSON failed.")}}},url:{usage:"Prints the result of a URL. <em>Parameters: str_url</em>",f:function(){U.getJSON(i,function(e){e&&I.prettyJSON(e)}).fail(function(){I.print("No results from URL.")})}},api:{usage:"Prints the output of an API URL &quot;"+U.URL_API.Prefix+"&quot;. <em>Parameters: str_apiurlsuffix, str_querystring (optional)</em>",f:function(){n[1]?Z.printAPI(n[1],n[2],n[3]):U.openExternalURL("https://api.guildwars2.com/v2")}},apicache:{usage:"Prints the cache of the previous console API call as an associative array. <em>Parameters: bol_wantoutputasfile (optional)</em>",f:function(){Z.printAPICache(U.TypeEnum.isAssoc,{aFileName:"true"===n[1]})}},apicachearray:{usage:"...as an array.",f:function(){Z.printAPICache(U.TypeEnum.isArray,!1)}},apicacheobject:{usage:"...as an object.",f:function(){Z.printAPICache(U.TypeEnum.isObject,!1)}},apicacheids:{usage:"...as IDs.",f:function(){Z.printAPICache(U.TypeEnum.isInteger,!1)}},apilang:{usage:"Prints all languages of an API data point. <em>Parameters: str_endpoint, int_id</em>",f:function(){Z.printAPIMultilingual(n[1],n[2])}},acc:{usage:"Prints the output of an account API URL &quot;"+U.URL_API.Prefix+"&quot;. Token must be initialized from the account page. <em>Parameters: str_apiurlsuffix</em>. Type &quot;acc&quot; alone to see list of URL suffixes. Please replace spaces in character's name with &quot;%20&quot;",f:function(){A.printAccount(n[1])}},daily:{usage:"Prints today's and tomorrow's daily achievements.",f:function(){Z.printDaily()}},item:{usage:"Prints an item's information. <em>Parameters: int_itemid</em>",f:function(){Z.scrapeAPIArrayMultilingual("items",parseInt(n[1]),function(e){I.clear();for(var t in e)for(var a in e[t])Q.printItemInfo(e[t][a])})}},items:{usage:"Prints the highest numbered item IDs in the API. <em>Parameters: int_offset</em>",f:function(){Z.printItemsAPI(n[1])}},sortitems:{usage:"Sorts an array of item IDs by item type. <em>Parameters: arr_itemids</em>",f:function(){try{Q.sortItems(JSON.parse(n[1]),function(e,t){I.paste(U.lineJSON(t))})}catch(e){}}},events:{usage:"Prints the event names of the current zone, dynamic events option must be enabled.",f:function(){P.printZoneEvents()}},lower:{usage:"Converts a string to all lower case. <em>Parameters: str_string</em>",f:function(){n[1]&&I.paste(U.toCase(i,U.CaseEnum.Lower))}},upper:{usage:"Converts a string to all upper case. <em>Parameters: str_string</em>",f:function(){n[1]&&I.paste(U.toCase(i,U.CaseEnum.Upper))}},rgba:{usage:"Converts a hex color to RGBA format. <em>Parameters: str_hex</em>",f:function(){I.paste(U.getHexToRGB(i))}},hex:{usage:"Converts an RGBA color to hex format. <em>Parameters: str_rgba</em>",f:function(){I.paste(U.getRGBToHex(i))}},help:{usage:"Prints this help message.",f:function(){I.write("Available console commands:<br />");var e="";for(var t in o)e+="<b>"+t+"</b> - "+o[t].usage+"<br />";e+="<br />The console also accepts: coordinates, array of coordinates, zone names, and chatcodes.<br />",I.print(e)}},wiki:{usage:"Search the game wiki. <em>Parameters: str_keywords</em>",f:function(){U.openExternalURL(U.getWikiSearchLanguage(i))}},test:{usage:"Test function for debugging.",f:function(){}},updatedb:{usage:"Prints an updated database of items. <em>Parameters: bol_wantrebuild (optional).",f:function(){Z.collateDatabase("items","true"===n[1])}},subdb:{usage:"Prints a subset database of items used by an account page's section. <em>Parameters: str_section</em>",f:function(){n[1]&&Z.updateItemsSubdatabase(n[1])}},collate:{usage:"Executes a function to update and categorize an unlockables record. <em>Parameters: str_section</em>",f:function(){Z.executeCollate(n[1],n[2])}}};void 0!==o[r]&&o[r].f()},createFile:function(e,t){var a=new Blob([e],{type:"text/plain;charset=UTF-8"}),n=window.URL.createObjectURL(a);Z.APICacheFiles.push(n);var i="string"==typeof t,r=i?t:"",o=i?"<input class='cslFilename cssInputText' type='text' value='"+t+"' /> ":"";return I.print(o+"<a href='"+n+"' download='"+r+"'>"+n+"</a>"),n},openTextFile:function(e,t){var a=new FileReader;a.readAsText(e),a.onload=function(){t(a.result)}},bindFileInput:function(e,t){$(e).change(function(){try{var e=$(this)[0].files[0];Z.openTextFile(e,function(a){t(a,e)})}catch(e){I.write("Error loading file.")}})},freeFiles:function(){for(var e=0;e<Z.APICacheFiles.length;e++)Z.APICacheFiles[e]&&window.URL.revokeObjectURL(Z.APICacheFiles[e]);Z.APICacheFiles=null,Z.APICacheFiles=[]},printAPI:function(e,t,a){I.print("Gathering elements...");var n="v1",i=null,r=void 0===t?"":t,o=U.URL_API.Prefix+e;try{i=JSON.parse(a||t)}catch(e){}var s=function(){I.clear(),Z.APICacheArrayOfObjects.length>0&&Z.APICacheArrayOfObjects[0].id&&U.sortObjects(Z.APICacheArrayOfObjects,{aKeyName:"id",aIsNumbers:!0}),Z.printAPICache(U.TypeEnum.isArray)},c=function(e){var t="string"==typeof e?JSON.parse(e):e;t.icon&&I.print("<img class='cssRight' src='"+U.escapeHTML(t.icon)+"' />")},l=function(e){if(Array.isArray(e)){var t=U.convertQueryString(r);U.fetchAPI(o,e,{aLanguage:t.lang?t.lang:null,aCallback:function(t){Z.APICacheArrayOfIDs=e,Z.APICacheArrayOfObjects=t,s()}})}else c(e),I.prettyJSON(e)};e===n&&(o=U.URL_API.Prefix1+t,r=a||""),i&&Array.isArray(i)?l(i):$.get(o+r,function(e){l(e)}).fail(function(){I.warn(U.escapeHTML(o),!0)})},printAPIMultilingual:function(e,t){Z.scrapeAPIArrayMultilingual(e,parseInt(t),function(e){for(var t in e)for(var a in e[t])Q.printItemInfo(e[t][a])})},printAPICache:function(e,t){var a,n=t||{},i="",r=void 0!==n.aFileName&&!1!==n.aFileName,o=void 0===n.aWantQuotes?r:n.aWantQuotes,s=n.aCustomCache||Z.APICacheArrayOfObjects,c=e;if(void 0===c||c===U.TypeEnum.isAssoc||c===U.TypeEnum.isArray)if(s){var l=s.length,u=r?"\r\n":"<br />",d=r?'"':"&quot;";i+=(c===U.TypeEnum.isAssoc?"{":"[")+u;for(var p=0;p<l;p++)i+=((a=s[p]).icon&&!r?"<img src='"+a.icon+"' />":"")+(c===U.TypeEnum.isAssoc?d+a.id+d+": ":"")+U.lineJSON(a,o)+(p===l-1?"":",")+u;i+=c===U.TypeEnum.isAssoc?"}":"]"}else i="API Objects Array is empty.";else c===U.TypeEnum.isObject?i=s?r?U.lineJSON(s):U.escapeJSON(s):"API Objects Array is empty.":c===U.TypeEnum.isInteger&&(i=Z.APICacheArrayOfIDs?r?U.lineJSON(Z.APICacheArrayOfIDs):U.escapeJSON(Z.APICacheArrayOfIDs):"API IDs Array is empty.");r?Z.createFile(i,"string"==typeof n.aFileName?n.aFileName:"apicache"):I.print(i)},printUnlockables:function(e,t,a){var n,i,r="",o=U.getObjectLength(e),s=0;for(var c in e){i=(n=e[c]).length;var l=!1===isNaN(c.charAt(0))?'"':"";if(t)r+=l+c+l+": ["+n.toString()+"]";else{r+=l+c+l+": [\r\n";for(var u=0;u<i;u++)r+="\t"+U.lineJSON(n[u],!1)+(u===i-1?"":",")+"\r\n";r+="]"}r+=(s===o-1?"":",")+"\r\n",s++}!0===a&&I.paste(r),Z.createFile(r,a)},printItemsAPI:function(e){if(!1!==U.isInteger(e))if(I.write("Retrieving items..."),e=parseInt(e),0===E.ItemsArray.length)$.get(U.URL_API.ItemDetail,function(e){E.ItemsArray=e}).done(function(){Z.printItemsAPI(e)}).fail(function(){I.warn("items database")});else{var t=0,a=0;if(e<=0)a=E.ItemsArray.length+e-1,t=E.ItemsArray[a],Q.getItem(t,function(e){I.print("<img class='cssLeft' src='"+e.icon+"' />"+U.escapeJSON(e))}).fail(function(){I.warn("item: "+a)});else{I.clear();for(var n=0;n<e;n++)a=E.ItemsArray.length-e-1-n,t=E.ItemsArray[a],Q.getItem(t,function(e){I.print("<img class='cssLeft' src='"+e.icon+"' />"+U.escapeJSON(e))}).fail(function(){I.warn("item: "+a)})}}else I.write("Invalid reverse index.")},scrapeAPIArray:function(e,t,a){var n=a||{},i=n.aQueryStr||"",r=!1===n.aIsStandard?"":"/",o=!1===n.aIsStandard?"":U.URL_API.Prefix,s=[],c=[],l=[],u=0,d=n.aNumRetries||3,p=500,h=(n.aCooldown||30)*T.cMSECONDS_IN_SECOND,m=0,g=0,f=n.aCacheArray||new Array(t.length);if(0!==t.length){var C=function(){if(A.setProgressBar(m,g),m===g)if(c.length>0?I.print("WARNING - Failed to retrieve some IDs: "+c):I.print("All IDs successfully retrieved."),0!==n.aRetryCount&&c.length>0){var t=(n.aRetryCount||d)-1;I.print("Retrying "+t+" times to fetch failed IDs..."),Z.scrapeAPIArray(e,c,{aNumRetries:d,aRetryCount:t,aCacheArray:f,aFailedIndexes:l,aIsStandard:n.aIsStandard,aWantSort:n.aWantSort,aCooldown:n.aCooldown,aIterator:n.aIterator,aCallback:n.aCallback})}else f.length>0&&f[0].id&&!1!==n.aWantSort&&U.sortObjects(f,{aKeyName:"id",aIsNumbers:!0}),Z.APICacheArrayOfObjects=f,n.aCallback?n.aCallback(f,c):I.print("Scrape completed. Enter /apicache to print the results.")},v=function(){for(var e=0,t=u;t<s.length;t++){if(e===p)return void S();b(s[t],n.aFailedIndexes?n.aFailedIndexes[u]:u),u++,e++}},b=function(t,a){$.getJSON(o+e+r+t+i,function(e){f[a]=e,n.aIterator&&n.aIterator(e),m++,C()}).fail(function(){c.push(t),l.push(a),g--,C()})},S=function(){var e=U.convertRatioToPercent(u/s.length),t=Math.ceil((s.length-u)/p)*~~(h/T.cMSECONDS_IN_SECOND);I.print(D.getWordCapital("cooldown")+"... "+u+" / "+s.length+" ("+e+") "+T.formatTimeLetter(t,!0)+" "+D.getWord("remaining")+"."),setTimeout(function(){v()},h)};void 0===n.aRetryCount&&(Z.APICacheArrayOfIDs=t,Z.APICacheArrayOfObjects=[]),g=(s=t).length,v()}else n.aCallback(null,null)},scrapeAPIArrayMultilingual:function(e,t,a,n){var i=n||{};Z.DatabaseCache[e]={};var r,o=Z.DatabaseCache[e],s=0,c=function(){s<Z.DatabaseLanguages.length?(!function(t){i.aQueryStr="?lang="+t,i.aCallback=function(e){o[t]={},e.forEach(function(e){o[t][e.id]=e}),c()},Z.scrapeAPIArray(e,r,i)}(Z.DatabaseLanguages[s]),s++):a(o)};Array.isArray(t)?(r=t,c()):"number"==typeof t?(r=[t],c()):$.getJSON(U.getAPI(e),function(e){r=e,c()})},fetchAPIMultilingual:function(e,t){var a={},n=0,i=Z.DatabaseLanguages.length,r=function(){n<i?(!function(t){var o=e+U.getDivider(e)+"lang="+t;$.getJSON(o,function(e){a[t]=e,r(),A.setProgressBar(n,i)}).fail(function(){I.print("Error retrieving "+U.escapeHTML(o)+". Fetch aborted.")})}(Z.DatabaseLanguages[n]),n++):t(a)};r()},processDye:function(e,t){for(var a=Z.DatabaseCache.items[O.OptionEnum.Language.Default][e.item],n=["cloth","leather","metal"],i=[],r=0;r<n.length;r++){var o=n[r];i.push(U.convertRGBToHex(e[o].rgb))}var s={};return s.u=e.id,e.item?(s.i=e.item,s.n=a.name):s.n=e.name,s.c=i,s.h=e.categories[0],s.m=e.categories[1],s.l=a.chat_link,Z.DatabaseLanguages.forEach(function(a){s[a]=t[a][e.id].name}),s},printDaily:function(e){var t=0,a=0,n={},i=function(){if(a===t){void 0===e&&I.print("TODAY'S DAILIES");for(var i in n){I.print(i);for(var r in n[i]){var o=n[i][r];I.prettyJSON(o)}}void 0===e&&(I.print("<br />"),I.print("TOMORROW'S DAILIES"),Z.printDaily(!0))}},r=e?U.URL_API.Tomorrow:U.URL_API.Daily;$.getJSON(U.getLangURL(r),function(e){for(var r in e)a+=e[r].length;for(var r in e){n[r]=[];for(var o in e[r]){var s=e[r][o];!function(e,a){$.getJSON(U.getAPIAchievement(a.id),function(t){t.level=a.level,e.push(t)}).always(function(){t++,i()})}(n[r],s)}}})},loadMultilingualDatabase:function(e,t){var a=e.toLowerCase(),n={},i=!0;if(Z.DatabaseLanguages.forEach(function(e){void 0===Z.DatabaseCache[e]&&(i=!1)}),i)t(Z.DatabaseCache[a]);else{var r=function(){var e=!0;Z.DatabaseLanguages.forEach(function(t){void 0===n[t]&&(e=!1)}),e&&(Z.DatabaseCache[a]=n,t(Z.DatabaseCache[a]))};Z.DatabaseLanguages.forEach(function(e){$.getJSON(U.getItemsDatabaseURL(e),function(t){n[e]=t,r()})})}},getItemsDatabase:function(e){var t=O.OptionEnum.Language.Default,a=Z.DatabaseCache.items;a&&a[t]?e(a[t]):$.getJSON(U.getItemsDatabaseURL(t),function(a){void 0===Z.DatabaseCache.items&&(Z.DatabaseCache.items={}),Z.DatabaseCache.items[t]=a,e(a)})},loadItemsDatabase:function(e){Z.loadMultilingualDatabase("items",e)},updateItemsSubdatabase:function(e,t){var a,n=U.getDataScriptURL(e.toLowerCase()),i=[],r=function(){i=U.getUnique(i);for(var t in a){Z.APICacheArrayOfObjects=null,Z.APICacheArrayOfObjects=[];for(var n,r=a[t],o=0;o<i.length;o++)r[n=i[o]]?Z.APICacheArrayOfObjects.push(r[n]):!1===isNaN(n)&&I.print("Error looking up item: "+n);U.sortObjects(Z.APICacheArrayOfObjects,{aKeyName:"id"});var s=e.toLowerCase()+"_"+t+I.cJSON;Z.printAPICache(U.TypeEnum.isAssoc,{aWantQuotes:!0,aFileName:s})}};I.print("Loading items database..."),Z.loadItemsDatabase(function(o){a=o,t?(i=t,r()):(I.print("Loading section record..."),U.getScript(n,function(){Z.freeFiles();var t=U.getRecordData(e);for(var a in t)for(var n=t[a],o=0;o<n.length;o++)n[o].i?i.push(n[o].i):"number"==typeof n[o]&&i.push(n[o]);r()}).fail(function(){I.print("Error retrieving script: "+n)}))})},getNewAPIEntries:function(e,t,a){var n,i,r,o,s=e,c=e.toLowerCase(),l=Array.isArray(t),u=function(){var e,t,s=[];for(var u in i){e=i[u];for(var d=0;d<e.length;d++)t=e[d],l?s.push(t.i):s.push(t.u)}o=A.flattenUnlocks(o);var p=U.getDifference(o,s),h=void 0===r?p:p.filter(function(e){if(void 0===r[e])return e});0!==h.length?l?a({oRecord:i,oBlacklist:r,oEntries:h,oNewIDs:h}):U.fetchAPI(U.URL_API.Prefix+n,h,{aCallback:function(e){a({oRecord:i,oBlacklist:r,oEntries:e,oNewIDs:h})}}):I.print("No difference found between stored "+c+" record and post-blacklisted API array.")};U.getScript(U.getDataScriptURL(s),function(){i=U.getRecordData(s),r=U.getRecordBlacklist(s),l?(o=t,u()):(n=t.toLowerCase(),$.getJSON(U.getAPI(n),function(e){o=e,u()}))})},printRecordEntry:function(e,t){if(I.print(""),e.length){I.print("New items added:");var a,n,i,r,o,s,c,l,u,d,p,h,m=t||{},g="",f=[];for(var C in e){if(a=e[C],l=a.icon?"<img src='"+a.icon+"' />":"",u=$("<div style='margin-bottom:24px'><span>"+l+U.escapeHTML(U.lineJSON(a))+"</span></div>").appendTo(I.getConsole()),d=$("<div></div>").appendTo(u),h=a.unlock_items,r=h?h||h[0]:a[m.aItemIDsKey]){o=Array.isArray(r)?r:[r];for(var v=0;v<o.length;v++)s=o[v],c=m.aItemDB?m.aItemDB[s].name:a.name,(n=a.oRecordEntry||{u:a.id,i:s,n:c,p:{gem:null}}).u===n.i&&delete n.u,i=U.lineJSON(n,!1)+",",p=$("<aside>&nbsp;<a"+U.convertExternalAnchor(U.getWikiLinkDefault(c))+">"+c+"</a></aside>").appendTo(d),$("<input class='cssInputText' type='text' />").prependTo(p).val(i),$("<input class='cssInputText' type='text' />").prependTo(p).val(s),f.push(i),g+="&quot;"+a.id+"&quot;: &quot;<a"+U.convertExternalAnchor(U.getWikiLinkDefault(c))+"'>"+c+"</a>&quot;,<br />"}I.bindInputSelect(u.find(".cssInputText"))}I.print(g),I.print(f.join("<br />")),I.bindConsoleInput()}else I.print("No new items added. Record is up-to-date.")},executeCollate:function(e,t){var a,n="collate",i=function(){I.print("Collate function not found, available functions:");for(var e in Z)-1!==e.indexOf(n)&&(a=e.substring(e.indexOf(n)+n.length,e.length).toLowerCase(),I.print(a))};if(e){var r=n+U.toFirstUpperCase(e);Z[r]?Z[r](t):i()}else i()},collateDatabase:function(e,t){var a,n,i,r=e.toLowerCase(),o=U.toFirstUpperCase(r),s=!0===t,c=0,l="items"===r,u=function(){if(c>=Z.DatabaseLanguages.length)return I.print(o+" database of all languages updated."),void(n&&!s&&(l?Q.sortItems(i,function(e,t){Z.printRecordEntry(e,{aItemIDsKey:"id"}),Z.collateMuseum(t)}):Z.printRecordEntry(n,{aItemIDsKey:"id"})));var e=Z.DatabaseLanguages[c],t=l?U.getItemsDatabaseURL(e):U.getCacheURL(r,e);$.getJSON(t,function(t){var d=[],p=[];for(var h in t)s||d.push(t[h]),p.push(parseInt(h));(i=s?p:void 0===i?U.getDifference(a,p):i).length?U.fetchAPI(U.getAPIURL(r),i,{aLanguage:e,aCallback:function(t){for(var a=0;a<t.length;a++)d.push(t[a]);e===O.OptionEnum.Language.Default&&(n=t),U.sortObjects(d,{aKeyName:"id"}),Z.APICacheArrayOfObjects=d;var i=Z.APICacheArrayOfObjects[0];e===O.OptionEnum.Language.English&&-1===i.name.indexOf(I.Symbol.Unicode)&&(i.name+=I.Symbol.Unicode),Z.printAPICache(U.TypeEnum.isAssoc,{aWantQuotes:!0,aFileName:r+"_"+e+(l?I.cTXT:I.cJSON)}),c++,u()}}):I.print(o+" database is up-to-date. No difference found in IDs list.")})};I.print("Retrieving "+r+" index..."),$.getJSON(U.getAPIURL(r),function(e){I.print("Looking for difference..."),a=e,u()})},collateSearch:function(){I.print("Loading items database..."),Z.loadItemsDatabase(function(){I.print("Generating language search files..."),Z.DatabaseLanguages.forEach(function(e){var t,a=[],n=[],i=Z.DatabaseCache.items[e];for(var r in i)(t=i[r]).name&&n.push({i:t.id,n:t.name.toLowerCase(),l:t.name.length});U.sortObjects(n,{aKeyName:"l"});for(r=0;r<n.length;r++)t=n[r],a.push([t.i,t.n]);var o=U.compressToJS(a);Z.createFile(o,"search_"+e+I.cJSON)})})},collateMaterials:function(){var e="Materials";U.getScript(U.getDataScriptURL(e),function(){var t,a,n={},i=U.getRecordHeader(e),r=U.getRecordMetadata(e).CategoryAssoc;for(var o in i)n[o]=[];$.getJSON(U.getAPIMaterial(),function(i){Z.scrapeAPIArray(e.toLowerCase(),i,{aCallback:function(e){for(var i in e)a=e[i],t=r[a.id],n[t]=a.items;Z.printUnlockables(n,!0,!0)}})})})},collateSkins:function(){var e,t,a,n,i,r="Skins",o={},s=function(e,t){e.i=t.id,void 0===i[e.u].oAssocItems&&(i[e.u].oAssocItems=[]),i[e.u].oAssocItems.push(t.id),Q.isTradeable(t)?(void 0===e.b&&(e.b=[]),e.b.push(t.id)):e.p={gem:null}},c=function(){var a,i,r;for(var c in e)if(a=e[c],i=null,a.default_skin?i=a.default_skin:a.details&&a.details.skins&&(i=a.details.skins),i){r=Array.isArray(i)?i:[i];for(var l=0;l<r.length;l++)o[r[l]]&&s(o[r[l]],a)}Z.printUnlockables(t,null,!0),Z.printRecordEntry(n,{aItemDB:e,aItemIDsKey:"oAssocItems"})};Z.getNewAPIEntries(r,r,function(r){t=r.oRecord,a=r.oBlacklist,n=r.oEntries;var s,l,u=!1;i={};for(var d=0;d<n.length;d++)if(l=n[d],i[l.id]=l,""===l.name||void 0===l.type)u=!0,a[l.id]=l.name;else{s="","Armor"===l.type&&l.details&&l.details.type&&l.details.weight_class?s=l.type+"_"+l.details.weight_class+"_"+l.details.type:"Weapon"===l.type&&l.details&&l.details.type?s=l.type+"_"+l.details.type:"Back"===l.type&&(s=l.type);var p={u:l.id,i:null,n:l.name};t[s]?(t[s].push(p),o[l.id]=p):(I.print("Warning uncategorizable skin:"),I.prettyJSON(l))}u&&I.prettyJSON(a),Z.getItemsDatabase(function(t){e=t,c()})})},collateUnlockables:function(e,t){var a=e;Z.getNewAPIEntries(a,t||a,function(e){Z.printRecordEntry(e.oEntries,{aItemIDsKey:"item_id"})})},collateOutfits:function(){Z.collateUnlockables("Outfits")},collateGliders:function(){Z.collateUnlockables("Gliders")},collateMinis:function(){Z.collateUnlockables("Minis")},collateCarriers:function(){Z.collateUnlockables("Carriers","mailcarriers")},collateFinishers:function(){Z.collateUnlockables("Finishers")},collateDyes:function(){var e,t,a="Dyes";I.print("Loading items database..."),Z.getItemsDatabase(function(){I.print("Looking for difference..."),Z.getNewAPIEntries(a,"colors",function(a){e=a.oRecord,t=a.oEntries,I.print("Downloading color translations..."),Z.scrapeAPIArrayMultilingual("colors",a.oNewIDs,function(e){I.clear(),t.forEach(function(t){var a=Z.processDye(t,e);I.print(U.lineJSON(a,!1)+",")})})})})},collateCatalog:function(){var e="Catalog",t=function(e){var t=e.name.toLowerCase(),a=e.description?e.description.toLowerCase():"";if(-1!==a.indexOf("to transform")||-1!==a.indexOf("to become")){if(e.type===Q.ItemEnum.Gizmo)return"TonicEndless";if(e.type===Q.ItemEnum.Consumable)return"TonicConsumable"}return e.type===Q.ItemEnum.Gathering&&e.rarity===Q.RarityEnum.Exotic?"Gathering":e.type===Q.ItemEnum.UpgradeComponent&&-1!==t.indexOf("infusion")?"Aura":e.rarity===Q.RarityEnum.Legendary&&e.type===Q.ItemEnum.Weapon?"Legendary":null};I.print("Loading items database..."),Z.getItemsDatabase(function(a){I.print("Loading "+e),U.getScript(U.getDataScriptURL(e),function(){var n,i,r=[],o=U.getRecordData(e),s=A.flattenRecord(o),c=U.getRecordBlacklist(e);for(var l in a)c[(n=a[l]).id]||(i=t(n))&&void 0===s[n.id]&&(r.push(n),o[i].push({i:n.id,n:n.name,p:{gem:null}}));Z.printUnlockables(o),Z.printRecordEntry(r,{aItemIDsKey:"id"})})})},collateCleanup:function(){var e,t="Cleanup",a={},n=function(){var n=U.getRecordHeader(t);for(var i in n)a[i]=[];var r,o={},s=U.getRecordData("Catalog");for(var i in s){r=s[i];for(u=0;u<r.length;u++)o[r[u].i]=!0}var c=U.getRecordData("Materials");for(var i in c)for(var l=c[i],u=0;u<l.length;u++)o[l[u]]=!0;var d,p;for(var i in e)o[(d=e[i]).id]||(p=Q.categorizeCleanableItem(d))&&a[p].push(d.id);Z.printUnlockables(a,!0,!0);var h={};for(var i in e)(d=e[i]).rarity===Q.RarityEnum.Junk&&d.vendor_value>0&&(h[d.id]=d.vendor_value);I.paste(U.lineJSON(h))};U.getScript(U.getDataScriptURL(t),function(){U.getScript(U.getDataScriptURL("Catalog"),function(){U.getScript(U.getDataScriptURL("Materials"),function(){Z.getItemsDatabase(function(t){e=t,n()})})})})},collateAscended:function(){var e=function(e){var t=e.name.toLowerCase();if(e.type===Q.ItemEnum.Container&&-1===t.indexOf("recipe")){if(-1!==t.indexOf("weapon"))return"ContainerWeapon";if(-1!==t.indexOf("armor"))return"ContainerArmor"}else{if(e.type===Q.ItemEnum.Weapon||e.type===Q.ItemEnum.Trinket)return e.details.type;if(e.type===Q.ItemEnum.Armor)return e.details.weight_class+e.details.type;if(e.type===Q.ItemEnum.Back)return e.type}return null},t=[];Z.getItemsDatabase(function(a){var n,i,r;for(var o in a)(n=a[o]).type,n.rarity===Q.RarityEnum.Ascended&&e(n)&&t.push(n.id);Z.getNewAPIEntries("ascended",t,function(t){var o=[];for(var s in t.oEntries)n=a[t.oEntries[s]],i=U.escapeHTML(n.name),(r=e(n))&&(t.oRecord[r].push({i:n.id,n:n.name,p:{coin:-1}}),o.push(n));Z.printUnlockables(t.oRecord,null,!0),Z.printRecordEntry(o,{aItemIDsKey:"id"})})})},collateRecipes:function(){var e,t,a,n,i={},r={},o={},s=function(s){i=s.oRecord,n=s.oEntries;for(var c in e)(t=e[c]).details&&"CraftingRecipe"===t.details.unlock_type&&(Q.isTradeable(t)&&(o[t.details.recipe_id]=t.id),r[t.details.recipe_id]=t.id);var l,u,d,p,h,m=[];for(var c in n){(l=n[c]).type,h=l.output_item_id;for(var g=0;g<l.disciplines.length;g++)u=(d=l.disciplines[g])+"_"+l.type,"RefinementObsidian"!==l.type&&"RefinementEctoplasm"!==l.type||(u=d+"_Refinement"),e[h]&&i[u]&&(p=[],l.ingredients.forEach(function(e){p.push([e.item_id,e.count])}),a={u:l.id,i:h,n:e[h].name,r:p},r[l.id]&&(a.s=r[l.id]),o[l.id]&&(a.b=o[l.id]),i[u].push(a),m.push(e[h]))}var f={};for(var c in i)i[c].length&&(f[c]=i[c]);Z.printUnlockables(f),Z.printRecordEntry(m)};I.print("Loading items database..."),Z.getItemsDatabase(function(t){I.print("Looking for difference..."),Z.getNewAPIEntries("Recipes","Recipes",function(a){e=t,s(a)})})},collateAchievements:function(){U.getJSON(U.getAPI("achievements/categories"),function(e){var t=[],a=A.Metadata.AchievementCategories;for(var n in e){var i=e[n],r=!1;for(var o in a)if(a[o]===i){r=!0;break}!1===r&&t.push(i)}t.length&&U.fetchAPI(U.getAPIURL("achievements/categories"),t,{aCallback:function(e){I.print("New achievement categories:"),e.forEach(function(e){Q.printItemInfo(e)})}}),Z.collateDatabase("achievements")})},collateFractals:function(){$.getJSON("test/achievements_en.json",function(e){var t=[];for(var a in e){var n=e[a];-1!==n.name.indexOf("Daily Recommended Fractal—Scale")&&void 0===T.DailyAssociation[n.id]&&t.push(n)}I.print(t)})},collatePrices:function(){var e,t,a,n=["materials","skins","dyes","minis","carriers","champions","finishers","nodes","recipes"],i=0,r={},o=0,s=n.length,c=function(t){var a=t.blacklist;for(var n in e)!1===Q.isTradeable(e[n])&&void 0===a[n]&&(a[n]=1);var i,o=U.getRecordMetadata("ascended").CompositeIngredients;for(var n in o)for(var s=0;s<o[n].length;s++)i=o[n][s][0],void 0===a[i]&&(r[i]=!0);var c=[];for(var n in r)void 0===a[n]&&c.push(parseInt(n));I.print("Fetching prices..."),E.getPrices(c,function(e,t){var n,i={};for(var r in e)n=e[r],i[r]=[n.oPriceBuy,n.oPriceSell];var o='{\r\n"data":'+U.lineJSON(i).replace(/ /g,"")+',\r\n"blacklist":'+U.lineJSON(a).replace(/ /g,"")+"\r\n}";Z.createFile(o,"prices.json")})},l=function(){I.print("Loading prices data..."),U.getScript(U.URL_DATA.Ascended,function(){$.getJSON(U.URL_DATA.Prices,function(e){c(e)})})},u=function(e){var r=n[i];i++,U.getScript(U.getDataScriptURL(r),function(){t=U.getRecordData(r);for(var n in t)(a=t[n]).forEach(function(t){e(t)});++o===s&&l()})};I.print("Loading items database..."),Z.getItemsDatabase(function(t){e=t,u(function(t){Q.isTradeable(e[t])&&(r[t]=!0)}),u(function(t){void 0===t.p&&Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(t){Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(t){Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(t){Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(t){Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(t){Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(t){Q.isTradeable(e[t.i])&&(r[t.i]=!0)}),u(function(e){e.b&&(r[e.b]=!0)})})},collateMuseum:function(e){var t,a=(new Date).toISOString().split("T")[0].split("-"),n=a[0]+"-"+a[1];U.getScript(U.URL_DATA.Museum,function(){var a=U.getRecordData("museum"),i={};t=a[n]?U.getUnion(a[n],e):e,Q.sortItems(t,function(e,t){a[n]=t,i[n]=t,Z.printUnlockables(i,!0,!0),Z.printUnlockables(a,!0,!0)})},!1)},collatePact:function(){var e=[];for(var t in H.Pact.Products)e.push(t),e.push(H.Pact.Products[t]);Z.updateItemsSubdatabase("Pact",e)},collateMaps:function(){var e=function(e,t){for(var a in e.regions){var n=e.regions[a];for(var i in n.maps)!1===M.isZoneValid(i)&&delete n.maps[i]}Z.createFile(U.lineJSON(e),"maps_"+t+I.cJSON)};Z.fetchAPIMultilingual(U.URL_API.MapFloorTyria,function(t){for(var a in t)e(t[a],a)})},collateEvents:function(){var e=function(e,t){var a=[];for(var n in e.events)e.events[n].id=n,a.push(e.events[n]);Z.printAPICache(U.TypeEnum.isAssoc,{aCustomCache:a,aFileName:"events_"+t+I.cJSON})};Z.fetchAPIMultilingual(U.URL_API.EventDetails,function(t){for(var a in t)e(t[a],a)})}},A={TokenCurrent:null,CharIndexCurrent:null,isAccountInitialized:!1,isChartsInitialized:!1,isAuditReady:!1,isCharactersCached:!1,Metadata:{},Currency:{},Equipment:{},Attribute:{},Data:{Account:{},Characters:[],CharacterAssoc:{},CharacterNames:null,Vaults:null,Wallet:null,Titles:null},Possessions:null,Tally:null,URL:{Account:"account",Bank:"account/bank",Materials:"account/materials",Skins:"account/skins",Outfits:"account/outfits",Gliders:"account/gliders",Dyes:"account/dyes",Minis:"account/minis",Carriers:"account/mailcarriers",Champions:"account/pvp/heroes",Finishers:"account/finishers",Nodes:"account/home/nodes",Cats:"account/home/cats",Achievements:"account/achievements",Masteries:"account/masteries",MasteryPoints:"account/mastery/points",Raids:"account/raids",Dungeons:"account/dungeons",Characters:"characters",Shared:"account/inventory",Wallet:"account/wallet",Titles:"account/titles",Recipes:"account/recipes",CharactersSAB:"characters/{0}/sab",Delivery:"commerce/delivery",Transactions:"commerce/transactions",CurrentBuys:"commerce/transactions/current/buys",CurrentSells:"commerce/transactions/current/sells",HistoryBuys:"commerce/transactions/history/buys",HistorySells:"commerce/transactions/history/sells",Stats:"pvp/stats",Games:"pvp/games",Standings:"pvp/standings",TokenInfo:"tokeninfo",GuildLog:"log",GuildMembers:"guild/{0}/members",GuildPermission:"guild/{0}/permission",GuildRanks:"guild/{0}/ranks",GuildStash:"guild/{0}/stash",GuildTeams:"guild/{0}/teams",GuildTreasury:"guild/{0}/treasury",GuildUpgrades:"guild/{0}/upgrades"},Permissions:{},PermissionEnum:{Account:"account",Builds:"builds",Characters:"characters",Guilds:"guilds",Inventories:"inventories",Progression:"progression",PvP:"pvp",TradingPost:"tradingpost",Wallet:"wallet",Unlocks:"unlocks"},DishCurrent:null,getURL:function(e){return"https://api.guildwars2.com/v2/"+e+U.getDivider(e)+"access_token="+A.TokenCurrent},getURLAll:function(e){return A.getURL(e+"?ids=all")},getTransactions:function(e,t){var a=t||{};a.aPermission=A.PermissionEnum.TradingPost,U.fetchPaginated(A.getURL(e),a)},setProgressBar:function(e,t){var a=document.getElementById("accProgress"),n=document.getElementById("accProgressCount");a&&(a.style.width=e/t*T.cPERCENT_100+"%",n.innerHTML=e+" / "+t,e===t&&A.resetProgressBar())},fillProgressBar:function(){A.setProgressBar(1,1)},resetProgressBar:function(e){var t=$("#accProgress"),a=$("#accProgressCount");e||void 0===e?t.css({opacity:1}).animate({opacity:0},800,function(){$(this).css({width:"0px",opacity:1})}):t.css({width:"0px",opacity:1}),a.empty()},initializeAccount:function(e){D.addDictionary(GW2T_ACCOUNT_DICTIONARY),A.Metadata=GW2T_ACCOUNT_METADATA,A.Currency=GW2T_CURRENCY_DATA,A.Equipment=GW2T_EQUIPMENT_DATA,A.Attribute=GW2T_ATTRIBUTE_DATA;var t="string"==typeof e&&void 0!==I.PageEnum.Account[e];Q.initializeFaux();var a=$("#accContent");a.find("section").addClass("accPlatter"),a.find("article").addClass("accDishContainer jsScrollable").each(function(){var e=$(this).attr("data-section");$(this).is(":empty")?$(this).html("<div class='accDishPadding'></div><div id='accDish_"+e+"' class='accDish cntComposition'></div>"):($(this).wrapInner("<div id='accDish_"+e+"' class='accDish cntComposition'></div>"),$(this).prepend("<div class='accDishPadding'></div>")),I.bindScrollbar($(this))}),$("#accContent").show(),U.convertExternalLink($("#accHelp").find(".jsExternal").find("a")),A.generateMenu(t),$("#accToggle").click(function(){$("#accMenu").slideToggle("fast",function(){A.adjustAccountPanel()})}),$("#accExpand").click(function(){$("#opt_bol_showPanel").trigger("click")}),$("#accClose").click(function(){$("#mapAccountButton").trigger("click")}),$("#accDisplayButton").toggle(!O.Options.bol_showPanel).click(function(){$("#opt_bol_showPanel").trigger("click")}),A.initializeTokens(),I.qTip.init($("#panelAccount").find("a, label, button, kbd, img")),D.translateElements();var n=$("#accConsole").onEnterKey(function(){var e=$(this).val(),t=e.charAt(0)===Z.cCommandPrefix?e:Z.cCommandPrefix+e;Z.parseCommand(t,M)});I.bindInputBarText(n,'Enter "help" for commands...'),Q.bindItemSearch("#accSearch",{aCallback:function(e){Q.printItemInfo(e,!0)}}),Q.initializeItemContextMenu(),!1===D.isLanguageDefault&&$("#accDirectory var").each(function(){var e=$(this).text().toLowerCase();$(this).html(D.getWordCapital(e))}),U.convertExternalLink("#accDirectory .linkExternal"),U.convertInternalLink("#accDirectory a"),setTimeout(function(){A.adjustAccountPanel()},1e3),A.isAccountInitialized=!0,H.getUrgent(H.Announcement.UrgentAccount),t&&$("#accMenu_"+e).trigger("click")},generateMenu:function(e){var t=$("#accMenu");$("#accContent").find(".accDishMain").each(function(){var e=$(this).attr("data-section"),a=e.toLowerCase(),n=$("<aside id='accMenu_"+e+"' class='accMenuTab accMenuClick curClick'><span><ins class='accMenuIcon accMenuIconMain mnu mnu_"+a+"' title='<dfn>"+D.getWordCapital(a)+"</dfn>'></ins><var class='accMenuTitle'>"+D.getPhraseOriginal(e)+"</var></span><span class='accMenuSubtab' style='display:none;'></span></aside>");t.append(n),function(e,t){var a=$("#accPlatter"+t);A.createDishMenu(t),e.click(function(){$(".accMenuTab").find(".accMenuIcon").removeClass("accMenuButtonFocused"),$(".accPlatter").hide(),$(this).data("iscurrentaccounttab")&&!1===$(this).hasClass("accMenuTabFocused")?(a.show(),$(this).find(".accMenuCurrent").trigger("click")):($(this).data("iscurrentaccounttab",null),A.DishCurrent=$("#accDish_"+t),$(".accDishMenu").hide(),$("#accDishMenu_"+t).show(),a.find(".accDishContainer").hide(),a.find(".accDishMain").show(),$(this).find(".accMenuIconMain").addClass("accMenuButtonFocused"),a.fadeIn(400),A.adjustAccountPanel(),I.PageCurrent=I.SpecialPageEnum.Account,I.SectionCurrent[I.SpecialPageEnum.Account]=t===I.PageEnum.Account.Manager?"":t,U.updateQueryString(),A.generateDish(t)),$(".accMenuTab").removeClass("accMenuTabFocused").find(".accMenuSubtab").hide(),$(this).addClass("accMenuTabFocused").find(".accMenuSubtab").show(),A.resetProgressBar(!1)});var n=a.find(".accDishContainer");if(n.length){var i=e.find(".accMenuSubtab");i.append("<img src='img/ui/view.png' />"),n.each(function(){if(!1===$(this).hasClass("accDishMain")){var t=$(this).attr("data-section"),n=t.toLowerCase(),r=$("<ins id='accMenu_"+t+"' class='accMenuButton accMenuIcon accMenuClick mnu mnu_"+n+"' title='<dfn>"+D.getWordCapital(n)+"</dfn>'></ins>");i.append(r),A.createDishMenu(t),$(this).hasClass("accCharDependent")&&r.addClass("accCharDependentMenu"),$(this).attr("data-islead")&&$("<span class='accMenuTabDivider'></span>").insertBefore(r),function(n,i){r.click(function(n){$(".accMenuTab").find(".accMenuIcon").removeClass("accMenuButtonFocused"),$(".accPlatter").hide(),$(".accMenuTab").removeClass("accMenuTabFocused").find(".accMenuSubtab").hide(),a.show();var r=$(this).closest(".accMenuTab").data("iscurrentaccounttab",t);r.find(".accMenuCurrent").removeClass("accMenuCurrent"),$(this).addClass("accMenuCurrent"),A.DishCurrent=$("#accDish_"+t),!1===r.hasClass("accMenuTabFocused")&&r.addClass("accMenuTabFocused").find(".accMenuSubtab").show(),$(".accDishMenu").hide(),$("#accDishMenu_"+t).show(),n.stopPropagation(),i.parent().find(".accDishContainer").hide(),i.fadeIn(200),A.adjustAccountPanel(),e.find(".accMenuIcon").removeClass("accMenuButtonFocused"),$(this).addClass("accMenuButtonFocused"),I.PageCurrent=I.SpecialPageEnum.Account,I.SectionCurrent[I.SpecialPageEnum.Account]=t,U.updateQueryString(),A.generateDish(t)})}(0,$(this))}})}}(n,e)}),I.qTip.init(".accMenuIcon"),!0!==e&&($("#accPlatterManager").show(),U.openSectionFromURL({aPrefix:"#accMenu_",aInitialSection:I.PageEnum.Account.Manager}))},resetMenu:function(){$(".accMenuTab").each(function(){$(this).data("iscurrentaccounttab",null).removeClass("accMenuTabFocused").find(".accMenuSubtab").hide(),$(this).find(".accMenuIcon").removeClass("accMenuButtonFocused")}),$("#accMenu_Manager").trigger("click")},adjustAccountPanel:function(){I.BrowserCurrent===I.BrowserEnum.Firefox&&$("#panelAccount").css({position:O.Options.bol_showPanel?"relative":"static",height:O.Options.bol_showPanel?"100%":$(window).height()+"px"});var e=O.Options.bol_alignPanelRight?{left:"0px",right:"auto"}:{left:"auto",right:"0px"};$("#accOverhead").css({width:$("#accContent").width()-8+"px"}).css(e),A.DishCurrent&&(A.DishCurrent.parent().find(".accDishPadding").css({height:A.getOverheadHeight()+"px"}),A.adjustAccountScrollbar())},getOverheadHeight:function(){return $("#accOverhead").height()},adjustAccountScrollbar:function(){I.updateScrollbar(A.DishCurrent.parent())},initializeTokens:function(){var e,t=64,a=localStorage[O.Utilities.APITokens.key];try{a=JSON.parse(a)}catch(e){}void 0===a&&(a=[]).push(A.createToken("Example Key Name","EXAMPLE-API-KEY-PLEASE-REPLACE-WITH-YOUR-OWN-HERE"));var n=!0;if(U.APIKey)for(i=0;i<a.length;i++)e=a[i],U.APIKey===e.key?(e.isUsed=!0,n=!1):delete e.isUsed;else n=!1;U.APIKey&&n&&a.push(A.createToken("URL API Key",U.APIKey,!0));for(var i=0;i<a.length;i++)e=a[i],A.insertTokenRow(e.name,e.key,e.isUsed);X.bindTextlistSwap("#accTokenList","#accTokenList .accTokenButtons",A.saveTokens),A.saveTokens(),A.loadToken(),$("#accManagerPrint").click(function(){var e=localStorage[O.Utilities.APITokens.key];try{e=JSON.parse(e),I.prettyJSON(e)}catch(e){}}),$("#accManagerHide").click(function(){$("#accManager").toggle()}),$("#accTokenNew").attr("title","<dfn>"+D.getWordCapital("add")+"</dfn> "+D.getPhrase("key slot")+"."),$("#accTokenNew").click(function(){O.Utilities.APITokens.value.length<t?(A.insertTokenRow("",""),A.saveTokens(),I.qTip.init($("#accManager").find("button"))):I.write("API tokens limit reached.")}),D.translateElements(),I.qTip.init($("#accManager").find("button"))},insertTokenRow:function(e,t,a){var n=$("<div class='accToken'></div>").appendTo("#accTokenList"),i=$("<img class='accTokenLink curClick' src='img/ui/link.png' title='Get private <dfn>shareable link</dfn>.' />").appendTo(n),r=$("<input class='accTokenKey' type='text' value='"+t+"' maxlength='128' />").appendTo(n),o=$("<input class='accTokenName' type='text' value='"+e+"' maxlength='64' />").appendTo(n),s=$("<div class='accTokenButtons'></div>").appendTo(n),c=$("<button class='accTokenUse' title='<dfn>"+D.getWordCapital("use")+"</dfn> "+D.getPhrase("this key")+".<br />"+D.getPhraseOriginal("Double click to audit")+".'><img src='img/ui/adjust_use.png' /></button>").appendTo(s),l=$("<button class='accTokenDelete' title='<dfn>"+D.getWordCapital("delete")+"</dfn> "+D.getPhrase("this key")+".'><img src='img/ui/adjust_del.png' /></button>").appendTo(s),u=function(){I.updateClipboard(i[0],"http://gw2timer.com#"+U.escapeHTML(U.stripToAlphanumericDash(r.val())))};!0===a&&(A.TokenCurrent=U.stripToAlphanumericDash(t),o.addClass("cssInputActive"),c.addClass("btnActive")),c.click(function(){var e=r.val();e.length>0?($(".accTokenName").removeClass("cssInputActive"),$(".accTokenUse").removeClass("btnActive"),o.addClass("cssInputActive"),c.addClass("btnActive").find("img"),A.TokenCurrent=U.stripToAlphanumericDash(e),A.loadToken(),A.saveTokens()):I.write("Please enter a valid API key.")}).dblclick(function(){U.interpretPage(I.SpecialPageEnum.Audit)}),r.change(function(){c.trigger("click"),u()}),I.bindClipboard(i),u(),l.click(function(){var e=r.val();O.Utilities.APITokens.value.length>1?(e.length>0?confirm("Delete this API token?\nNote: Audit history must be manually deleted at gw2timer.com/audit")&&(n.remove(),A.saveTokens()):(n.remove(),A.saveTokens()),I.qTip.hide()):I.write("Must have at least one API token.")}),$([o,r]).each(function(){$(this).click(function(){$(this).select()}).change(function(){A.saveTokens()})}),$([i,s]).each(function(){$(this).hover(function(){o.addClass("cssInputFocused"),r.addClass("cssInputFocused")},function(){o.removeClass("cssInputFocused"),r.removeClass("cssInputFocused")})})},createToken:function(e,t,a){var n={name:e,key:t};return a&&(n.isUsed=!0),n},saveTokens:function(){var e=[];$(".accToken").each(function(){var t=U.escapeHTML($(this).find(".accTokenName").val()),a=U.stripToAlphanumericDash($(this).find(".accTokenKey").val()),n=A.createToken(t,a,$(this).find(".accTokenUse").hasClass("btnActive"));e.push(n)});var t=O.Utilities.APITokens;t.value=e,localStorage[t.key]=JSON.stringify(t.value)},loadToken:function(){if(null!==A.TokenCurrent){for(var e in A.Permissions)A.Permissions[e]=null;A.Data.CharacterNames=null,A.Data.Vaults=null,A.isAuditReady=!1,$("#accMenu_Characters").data("iscurrentaccounttab",null),$(".accDishMenu").empty(),A.wipeDish("Characters"),$.getJSON(A.getURL(A.URL.TokenInfo),function(e){for(var t in e.permissions){var a=e.permissions[t];A.Permissions[a]=!0}}).fail(function(e,t){A.printError(A.PermissionEnum.Account,t,!1)})}},printError:function(e,t,a){null===A.TokenCurrent?I.write("Please enter an API key first."):("error"===t?I.write("Unable to retrieve response. "+I.cErrorAPI):I.write("Unable to access data for this key from ArenaNet API server."),I.write(A.TokenCurrent)),e&&(I.write("Requested permission: "+e,10),(a||void 0===a)&&$("#accMenu_Manager").trigger("click")),U.nullifyArticle()},checkPermission:function(e){return!!A.Permissions[e]||(A.printError(e),!1)},printAccount:function(e){if(e)I.print("Loading "+e+"..."),$.ajax({dataType:"json",url:A.getURL(e),cache:!1,success:function(e,t,a){I.prettyJSON(e)},error:function(e,t){A.printError(null,t)}});else{I.print("Available account API URL suffixes:");for(var t in A.URL)I.print(A.URL[t])}},getCurrentCharacter:function(){try{return A.Data.Characters[A.CharIndexCurrent]}catch(e){}return null},getCharacterByName:function(e){var t=A.Data.CharacterAssoc[e];return A.Data.Characters[t]},getDishName:function(e){return $(e).closest(".accDishContainer").attr("data-section")},reinitializeDish:function(e,t){if(!t&&!1===e.is(":empty")&&e.data("token")===A.TokenCurrent)return!1;var a=U.getSubstringFromHTMLID(e);return e.empty().data("token",A.TokenCurrent),$("#accDishMenu_"+a).empty(),t?e.removeClass("accDishWipeable"):(e.addClass("accDishWipeable"),I.updateScrollbar(e)),!0},reinitializePanel:function(){$(".accDishWipeable").each(function(){A.reinitializeDish($(this),!0)}),A.resetMenu()},generateDish:function(e){var t="serve"+e;V[t]&&V[t]()},regenerateDish:function(e){A.wipeDish(e),A.generateDish(e)},wipeDish:function(e){$("#accDish_"+e).empty().data("isloaded",!1),$("#accDishMenu_"+e).empty()},createDishMenu:function(e){$("<aside id='accDishMenu_"+e+"' class='accDishMenu'></aside>").appendTo("#accDishMenuContainer")},getDishMenu:function(e){return $("#accDishMenu_"+e)},createCharacterScroller:function(e,t,a){var n=a||{},i=A.getDishMenu(t),r=$("<div class='eqpSelectContainer'></div>").appendTo(i);e.forEach(function(e){var t=$("<span class='eqpSelect curClick' title='"+e.oCharName+" ("+e.level+")' style='border-left: 2px solid "+e.oCharColor+"'><img class='eqpSelectPortrait' src='"+e.oCharPortrait+"' /><img class='eqpSelectProfession' src='img/account/classes/"+e.oCharElite+".png' /></span>").appendTo(r);e.oCharIsLowLevel&&t.addClass("accTrivial"),function(e){t.click(function(){if(n.aClick)n.aClick(e);else{var t=$("#"+n.aElementPrefix+e);t&&t.length&&I.scrollToElement(t,{aOffset:n.aOffset,aSpeed:"fast"})}A.adjustAccountScrollbar()})}(e.oCharIndex)}),I.qTip.init(r.find(".eqpSelect")),A.adjustAccountPanel()},createCharacterBanner:function(e,t,a){var n=a?"id='"+a+t.oCharIndex+"'":"";$("<div "+n+" class='eqpCharSeparator'><img class='eqpCharPortrait' src='"+t.oCharPortrait+"' /><img class='eqpCharProfession' src='img/account/classes/"+t.oCharElite+".png' /><span class='eqpCharName'>"+t.oCharName+"</span></div>").prependTo(e)},embedFrame:function(e,t){var a=$(e);if(!a.find(".accEmbedContainer").length){var n=$("<div class='accEmbedContainer'></div>").appendTo(a);$("<iframe class='accEmbedFrame'></iframe>").appendTo(n)[0].src=t}},assignAccountUpgrades:function(e,t){var a=A.Currency.AuditUpgrades[e];a.purchased=t-a.starting,a.totalgem=a.gem*a.purchased,a.totalowned=a.starting+a.purchased},initializeAccountUpgrades:function(){var e=A.Currency.AuditUpgrades;for(var t in e)e[t].purchased=0,e[t].totalgem=0,e[t].totalowned=e[t].starting},getAccountUpgradesGem:function(){var e=A.Currency.AuditUpgrades,t=0;for(var a in e)t+=e[a].totalgem;return t},initializeGuilds:function(e){var t=A.Data.Account.guilds;void 0===t||null===t||t.length<=0?e():Q.getGuilds(t,function(){e()})},initializeVault:function(e){A.initializeGuilds(function(){U.fetchPattern(A.getURL(A.URL.GuildStash),A.Data.Account.guilds,{aCallback:function(t,a){a?A.Data.Vaults=t:(A.Data.Vaults=null,I.print("Unable to access any guild bank for this account.<br />Requires API key from account of guild leader.")),e(A.Data.Vaults)}})})},iterateInventory:function(e,t){var a,n,i,r,o=[],s=[];for(var c in e)(a=e[c])&&(o.push(a.id),n=a.upgrades,i=a.infusions,r=a.skin,n&&n.length&&n.forEach(function(e){o.push(e)}),i&&i.length&&i.forEach(function(e){o.push(e)}),r&&s.push(r),t&&t(a));return{oItemIDs:o,oSkinIDs:s}},initializePossessions:function(e,t){if(A.Possessions&&!t||A.Possessions&&t&&A.Data.Vaults)e();else{A.Possessions={};var a=function(e,t,a,n){void 0===A.Possessions[e]&&(A.Possessions[e]={oCount:0,oAudit:{}});var i=A.Possessions[e].oAudit,r=function(e){void 0===i[e]&&(i[e]=[0,0]),n||(i[e][0]+=a),i[e][1]+=a};A.Possessions[e].oCount+=a,r(!1===isNaN(t)?"Characters":U.toFirstUpperCase(t)),!1===isNaN(t)&&r(t)},n=function(e,t){e.upgrades&&e.upgrades.forEach(function(e){a(e,t,1,!0)}),e.infusions&&e.infusions.forEach(function(e){a(e,t,1)})},i=function(t,i,r,o){A.Tally={Characters:[0,0],Shared:[0,0],Bank:[0,0],Materials:[0,0],Vault:[0,0]};var s=A.Currency.AuditUpgrades.BagSlot,c=0,l=A.Currency.AuditUpgrades.CraftingLicense,u=0;A.Data.Characters.forEach(function(e){if(e.equipment&&e.equipment.forEach(function(t){a(t.id,e.oCharIndex,1,!0),n(t,e.oCharIndex)}),e.bags&&(c+=e.bags.length-A.Currency.AuditUpgrades.BagSlot.starting,e.bags.forEach(function(t){t&&(A.Tally.Characters[1]+=t.size,a(t.id,e.oCharIndex,1),t.inventory.forEach(function(t){t&&(A.Tally.Characters[0]+=1,a(t.id,e.oCharIndex,t.count,t.binding),n(t,e.oCharIndex))}))})),e.crafting){var t=0;e.crafting.forEach(function(e){e.active&&t++}),t>u+l.starting&&u++}}),A.assignAccountUpgrades("CraftingLicense",u+l.starting),s.purchased=c,s.totalgem=s.gem*c,s.totalowned=A.Data.Characters.length*s.starting+c,A.assignAccountUpgrades("SharedSlot",t.length),A.Tally.Shared[1]=t.length,t.forEach(function(e){e&&(A.Tally.Shared[0]+=1,a(e.id,"Shared",e.count,e.binding))}),A.assignAccountUpgrades("BankTab",~~(i.length/A.Metadata.Bank.NumSlotsPerTab)),A.Tally.Bank[1]=i.length,i.forEach(function(e){e&&(A.Tally.Bank[0]+=1,a(e.id,"Bank",e.count,e.binding),n(e,"Bank"))});var d=0;if(A.Tally.Materials[1]=r.length,r.forEach(function(e){e&&e.count>0&&(A.Tally.Materials[0]+=1,a(e.id,"Materials",e.count),e.count>d&&(d=e.count))}),A.assignAccountUpgrades("StorageExpander",Math.ceil(d/Q.GameLimit.StackSize)),o)for(var p in o)o[p].forEach(function(e){e.inventory.forEach(function(e){e&&(A.Tally.Vault[0]+=1,a(e.id,"Vault",e.count))}),A.Tally.Vault[1]+=e.size});e()};$.getJSON(A.getURL(A.URL.Shared),function(e){$.getJSON(A.getURL(A.URL.Bank),function(a){$.getJSON(A.getURL(A.URL.Materials),function(n){t?A.initializeVault(function(t){i(e,a,n,t)}):i(e,a,n)})})}).fail(function(e,t){A.printError(A.PermissionEnum.Inventories,t)})}},formatPossessionLocations:function(e){var t="",a=e.oAudit;for(var n in a)"Characters"!==n&&(a[n][0]>0||a[n][1]>0)&&(isNaN(n)?t+=D.getWordCapital(n.toLowerCase()):A.Data.Characters[n]&&(t+=A.Data.Characters[n].oCharName),t+=" ("+a[n][1]+"), ");return t=t.substring(0,t.length-2)},getFoundString:function(e){return"<var class='itmColor_reminder'>"+D.getPhrase("found in",U.CaseEnum.Sentence)+": "+A.formatPossessionLocations(e)+"</var>"},iterateRecord:function(e,t){var a;for(var n in e){a=e[n];for(var i=0;i<a.length;i++)t(a[i],n)}},flattenRecord:function(e){var t={};return A.iterateRecord(e,function(e){t[e.i]=e}),t},flattenUnlocks:function(e){var t=[];return e.length&&void 0!==e[0].id?(e.forEach(function(e){e.id&&!1!==e.permanent&&t.push(e.id)}),e=t,t):e},initializeCharts:function(e){U.getScript(U.URL_API.Charts,function(){!1===A.isChartsInitialized&&(Highcharts.setOptions({global:{useUTC:!1}}),A.isChartsInitialized=!0),e()})},getChartsTimeFormat:function(){return O.Options.bol_use24Hour?{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M"}:{second:"%l:%M:%S %p",minute:"%l:%M %p",hour:"%l:%M %p"}},getChartsCurrencyFormat:function(e,t){for(var a=T.formatWeektime(e[0].x,!0)+"<table>",n=0;n<e.length;n++){var i=e[n],r=i.series,o=r.name,s="";if(t&&t[o].currency)switch(t[o].currency){case"gem":s=E.formatGemString(i.y,!0);break;case"karma":s=E.formatKarmaString(i.y,!0)}else s=E.formatCoinStringColored(i.y);a+="<tr><td style='color:"+r.color+"'>"+D.getWordCapital(o.toLowerCase())+"</td><td><b>"+s+"</b></td></tr>"}return a+="</table>"},generateAudit:function(){var e=100,t=$("#audExecute"),a=$("#audExecuteAlternate").hide();I.suspendElement(t);var n,i,r=$("#accAudit").empty(),o=A.Currency.AuditPayments;E.Paylist={};var s,c,l,u,d,p,h,m,g={},f={},C={Ascended:{},Catalog:{},Skins:{},Outfits:{},Gliders:{},Dyes:{},Minis:{},Carriers:{},Champions:{},Finishers:{},Nodes:{},Recipes:{}},v={Skins:{},Outfits:{},Gliders:{},Dyes:{},Minis:{},Carriers:{},Champions:{},Finishers:{},Nodes:{}},b=function(){I.isProgramEmbedded&&U.Args[U.KeyEnum.AutoAudit]&&(window.location.href="about:blank")},S=function(){I.suspendElement(t,!1),a.show(),b()},y=function(e){var t={},a=void 0===e?0:e;for(var n in o)t[n]=a;return t},k=function(){for(var e in A.Currency.AuditCategories)A.Currency.AuditCategories[e]=y(),A.Currency.AuditHistory[e]=null;A.Currency.AuditCategoriesCharacters={}},_=function(e,t,a,n,i){var r=A.Currency.AuditCategories[e];!1===isNaN(e)&&(void 0===A.Currency.AuditCategoriesCharacters[e]&&(A.Currency.AuditCategoriesCharacters[e]=y()),r=A.Currency.AuditCategoriesCharacters[e]);var o=void 0===a?1:a;if(E.isPriceObject(t))!0===n?(r.coin_appraisedbuy+=t.oPriceBuy*o,r.coin_appraisedsell+=t.oPriceSell*o):(r.coin_liquidbuy+=t.oPriceBuyTaxed*o,r.coin_liquidsell+=t.oPriceSellTaxed*o,r.coin_appraisedbuy+=t.oPriceBuy*o,r.coin_appraisedsell+=t.oPriceSell*o);else for(var s in t)void 0!==r[s]&&t[s]>0&&(r[s]+=t[s]*o);if(i){var c=parseInt(i);void 0===f[e]&&(f[e]={});var l=f[e];if(void 0===l[c])if(l[c]=[0,0],E.isPriceObject(t))l[c][1]=N("coin_appraisedsell",t.oPriceSell);else for(var s in t)void 0!==r[s]&&t[s]>0&&(l[c][1]=N(s,t[s]));l[c][0]+=o}},P=function(){var e,t;for(var a in A.Data.Wallet)e=A.Data.Wallet[a],"1"===a?_("Wallet",E.createPricePlain(e),1):A.Currency.AuditWallet[a]&&((t={})[A.Currency.AuditWallet[a].payment]=e,_("Wallet",t,1,!0))},L=function(){var e,t,a,n,i=p.LegendaryInclusion;A.Tally.Legendary={count:0,price:E.createPrice()};for(var r in A.Possessions)if(e=E.Paylist[r]){for(var o in A.Possessions[r].oAudit)t=A.Currency.AuditCategories[o],a=A.Possessions[r].oAudit[o],!1===isNaN(o)&&(void 0===A.Currency.AuditCategoriesCharacters[o]&&(A.Currency.AuditCategoriesCharacters[o]=y()),t=A.Currency.AuditCategoriesCharacters[o]),t&&(E.isPriceObject(e)?a[1]===a[0]?_(o,e,a[1],!1,r):(_(o,e,a[0],!1,r),_(o,e,a[1]-a[0],!0,r)):_(o,e,a[1],!1,r));i[r]&&(n=A.Possessions[r].oCount,A.Tally.Legendary.count+=n,A.Tally.Legendary.price=E.addPrice(A.Tally.Legendary.price,E.recountPrice(e,n)))}},M=function(e,t){var a,n,i="i";if("Recipes"===e){v.Recipes=[],n={},i="b",A.Data.Characters.forEach(function(e){if(e.recipes)for(var t=0;t<e.recipes.length;t++)void 0===n[e.recipes[t]]&&(v.Recipes.push(e.recipes[t]),n[e.recipes[t]]=!0)});var r,o=U.getRecordData("recipes");A.iterateRecord(o,function(t){if(n[t.u]&&1!==n[t.u]&&t.p){n[t.u]=1;for(var i in t.p)(a={})[i]=t.p[i],r="coin"===i?E.createPriceBound(t.p[i]):a,_(e,r,1,!0,t.s)}})}if(v[e]=A.flattenUnlocks(v[e]),A.Tally[e]=[v[e].length,0],void 0===n){if(n=U.getExistAssoc(v[e]),"Skins"===e)for(var s in p.SkinsExclusion)n[s]=!1;if("Gliders"===e){var c=GW2T_GLIDERS_DATA.Combo;for(var s in c)n[c[s].u]=!1}}var l,u={};A.iterateRecord(C[e],function(r){A.Tally[e][1]+=1,(l=r[i])&&(a=E.Paylist[l])&&n[r.u]&&1!==n[r.u]&&void 0===u[l]&&(!1===t&&void 0===A.Possessions[l]||!1!==t)&&(n[r.u]=1,_(e,a,1,!0,l),u[r.i]=!0)})},w=function(){var e;h&&(A.Tally.Buying=[h.length,h.length],h.forEach(function(e){_("Buying",E.createPricePlain(e.price),e.quantity,!1,e.item_id)})),m&&(A.Tally.Selling=[m.length,m.length],m.forEach(function(t){(e=E.Paylist[t.item_id])&&_("Selling",e,t.quantity,!1,t.item_id)}))},x=function(e,t){var a={};for(var n in e)a[n]=e[n]+t[n];return a},N=function(e,t,a){var n=e,i=a||"oPriceSell";if(-1!==n.indexOf("coin"))return t;if("gem"===n)return E.convertGemToCoin(t);var r=o[n].conversion;if(0===r)return 0;if(!1===isNaN(r))return t*r;if(Array.isArray(r)){var s=r[0],c=r[1],l=E.Paylist[c];if(l&&l[i])return Math.floor(t*(l[i]/s))}return 0},W=function(e){return $("<div class='audTitleContainer'><aside class='audTitle'>"+e+"</aside></div>")},R=function(e){var t=$("<div class='audTable'></div>").appendTo(r);return W(e).insertBefore(t),t},H=function(e,t,a){var n=A.Tally[a],i="";n&&(i="<span class='audTableTally'>"+n[0]+" / "+n[1]+" ("+U.convertRatioToPercent(n[0]/n[1])+")</span>");var r=$("<div class='audTableColumn'></div>").appendTo(e),o=$("<div class='audTableCell audTableHeaderHorizontal'>"+t+i+"</div>").appendTo(r);return a&&"Wallet"!==a&&o.click(function(){K(a)}).addClass("audTableHeaderView curZoom").attr("id","audViewHeader_"+a),r},z=function(e,t){var a,n,i,r=$("<div class='audTableHeaderVertical audTableColumn'></div>").appendTo(e);for(var s in o)!t&&o[s].ishidden||(a=o[s],n=A.Currency.AuditWallet[a.id],i=1===a.id?D.getPhraseOriginal(a.header):D.getObjectName(n),r.append("<div class='audTableCell'>"+i+"&nbsp;<ins class='acc_wallet acc_wallet_"+a.id+"'></ins></div>"));r.prepend("<div class='audTableCell audTableHeaderCorner'></div>")},G=function(e){var t,a=y(Number.NEGATIVE_INFINITY);for(var n in e){t=e[n];for(var i in t)t[i]>a[i]&&(a[i]=t[i])}return a},F=function(e,t,a,n,i){var r,s,c,l;for(var u in t)!i&&o[u].ishidden||(r=t[u],s=-1!==u.indexOf("coin")||a?"coin":u,c="",n&&(c="<samp class='audTableCellBar'><s style='background:url(img/background/bargraph.png), linear-gradient(to right, black 0%, "+o[u].color+" 100%);width:"+(n[u]>0?r/n[u]*T.cPERCENT_100:0)+"%'></s></samp>"),l=a?"<span class='cssLeft'>"+(o[u].isappraised?I.Symbol.Approx:I.Symbol.ArrowRight)+"</span>":"",e.append("<div class='audTableCell'>"+l+E.formatPayment(s,r)+c+"</div>"))},j=function(e,t,a,n){F(e,t,a,n,!0)},Z=function(e,t){var a=y();for(var n in t)a[n]=N(n,t[n]);j(e,a,!0)},K=function(e){var t=$("#audView").empty(),a=B.createBank(t),n=B.getTabsContainer(a),i=!1===isNaN(e)?A.Data.Characters[e].oCharPreface:D.getWordCapital(e),r=B.createBankTab(n,{aTitle:i}),o=B.getSlotsContainer(r),s=[];for(var c in f[e])s.push(c);Q.getPricedItems(s,function(){for(var t in f[e])!function(e,t,a){Q.getItem(t,function(n){B.styleBankSlot(e,{aItem:n,aPrice:a[1],aSlotMeta:{count:a[0]}});var i=E.Paylist[t];i&&!1===E.isPriceObject(i)&&B.updateSlotPayment(e,i,a[0],"bnkSlotPriceSell")})}(B.createBankSlot(o),t,f[e][t]);B.tallyBank(a),B.createBankMenu(n,{aWantClear:!0,aReloadElement:$("#audViewHeader_"+e)}),I.scrollToElement("#audViewTitle",{aSpeed:"fast"})})},X=function(e){var t,a=[],n=e.Timestamps;for(var i in e)if("Timestamps"!==i){var r={name:i,data:[],color:A.Currency.AuditColor[i].color};t=e[i];for(var o=0;o<t.length;o++)r.data.push([new Date(n[o]).getTime(),t[o]]);a.push(r)}return a},q=function(){I.clear();var n=R(D.getPhraseOriginal("Audit Categories")),i=R(D.getPhraseOriginal("Sum &amp; Conversion")),s=R(D.getPhraseOriginal("Audit Characters"));z(n);var c,l=A.Currency.AuditCategories,u=G(l);for(var d in l)"Vault"===d&&null===A.Data.Vaults||"Buying"===d&&void 0===h||"Selling"===d&&void 0===m||(c=H(n,D.getWordCapital(d.toLowerCase()),d),F(c,l[d],!1,u));z(i,!0);var p=H(i,D.getPhraseOriginal("Account Sum")),g=H(i,D.getPhraseOriginal("Account Sum")),C=y();for(var d in l)C=x(C,l[d]);j(p,C),Z(g,C);var v=l.Wallet,S=H(i,D.getPhraseOriginal("Wallet")),k=H(i,D.getPhraseOriginal("Wallet"));j(S,v),Z(k,v);var _=y(e),P=H(i,D.getPhraseOriginal("Conversion")),L=H(i,D.getPhraseOriginal("Conversion"));j(P,_),Z(L,_),z(s);var M,w=A.Currency.AuditCategoriesCharacters,K=G(w);for(var d in w)M=H(s,A.Data.Characters[d].oCharIcons,d),F(M,w[d],!1,K);s.addClass("audTableHorizontal"),I.bindScrollbar(s,!0),I.qTip.init(s.find(".chrPreface")),W("View Audit").attr("id","audViewTitle").appendTo(r),$("<div id='audView'></div>").appendTo(r);var q=$("<div id='audUpgrades'></div>").appendTo(r),V=A.getAccountUpgradesGem(),J=B.createBank(q),Y=B.getTabsContainer(J),ee=B.createBankTab(Y,{aTitle:D.getPhraseTitle("Account Upgrades")}),te=B.getSlotsContainer(ee);for(var d in A.Currency.AuditUpgrades)!function(e,t){Q.getItem(t.id,function(a){B.styleBankSlot(e,{aItem:a,aGem:t.gem,aSlotMeta:{count:t.purchased}})})}(B.createBankSlot(te),A.Currency.AuditUpgrades[d]);E.getCoinFromGem(v.gem,function(e){var t=C.coin_appraisedbuy,a=C.coin_appraisedsell,n=C.coin_appraisedbuy,i=C.coin_appraisedsell,s=C.coin_liquidbuy+e,c=C.coin_liquidsell+e,u=C.coin_liquidbuy,d=C.coin_liquidsell;for(var p in o)-1===p.indexOf("coin")&&(t+=N(p,C[p],"oPriceBuy"),a+=N(p,C[p],"oPriceSell"),-1===p.indexOf("gem")&&(n+=N(p,C[p],"oPriceBuy"),i+=N(p,C[p],"oPriceSell"))),o[p].isliquid&&(s+=N(p,v[p],"oPriceBuyTaxed"),c+=N(p,v[p],"oPriceSellTaxed"));var h=C.gem,m=h+V,g=N("gem",V);t+=g,a+=g;var f={};for(var p in l){f[p]=0;for(var S in l[p])"coin_liquidbuy"!==S&&"coin_liquidsell"!==S&&"coin_appraisedbuy"!==S&&(f[p]+=N(S,l[p][S],"oPriceSell"))}var y=$("<div id='audSummaryContainer'></div>").prependTo(r),k=$("<div id='audSummary'></div>").appendTo(y).hide(),_=$("<div id='audHistoryContainer'></div>").appendTo(y).hide(),P=$("<div id='audHistory'></div>").appendTo(_);k.append("<div id='audSummaryName'><var id='audAccountName'>"+U.escapeHTML(A.Data.Account.name)+"</var></div>"),k.append("<div id='audSummaryValues'><div class='audSummarySubtitle'>― "+D.getWordCapital("appraised")+" ―</div><div id='audSummaryAppraised' class='audSummaryCoin curHelp'>"+E.formatCoinString(0,{aWantBig:!0})+"</div><div class='audSummaryMoney'>"+I.Symbol.Approx+" "+E.formatGemToMoney(m+E.convertCoinToGem(i))+"</div><div class='audSummarySubtitle'>― "+D.getWordCapital("liquid")+" ―</div><div id='audSummaryLiquid' class='audSummaryCoin curHelp'>"+E.formatCoinString(0,{aWantBig:!0})+"</div><div class='audSummaryMoney'>"+I.Symbol.Approx+" "+E.formatGemToMoney(v.gem+E.convertCoinToGem(d))+"</div></div>");var L="<dfn>"+D.getPhraseOriginal("Appraised Summary")+":</dfn> <br />"+D.getPhraseOriginal("Appraised Sell")+": "+E.formatCoinStringColored(a)+"<br />"+D.getPhraseOriginal("Appraised Buy")+": "+E.formatCoinStringColored(t)+"<br /><br /><dfn>"+D.getPhraseOriginal("Appraised Summary Exclude Gems")+":</dfn> <br />"+D.getPhraseOriginal("Appraised Sell")+": "+E.formatCoinStringColored(i)+"<br />"+D.getPhraseOriginal("Appraised Buy")+": "+E.formatCoinStringColored(n)+"<br /><br /><dfn>"+D.getWordCapital("Info")+":</dfn> <br />"+D.getPhraseOriginal("Legendary Equipment")+": "+E.formatCoinStringColored(A.Tally.Legendary.price.oPriceSell)+" ("+A.Tally.Legendary.count+" "+D.getWord("legendary")+")<br />"+D.getPhraseOriginal("Ascended Equipment")+": "+E.formatCoinStringColored(A.Tally.Ascended.price.oPriceSell)+" ("+A.Tally.Ascended.armorcount+" "+D.getWord("armor")+", "+A.Tally.Ascended.weaponcount+" "+D.getWord("weapons")+")<br />"+D.getPhraseOriginal("Gem Categories Sum")+": "+E.formatGemToMoney(h)+" "+I.Symbol.ArrowRight+" "+E.formatGemString(h,!0)+" "+I.Symbol.ArrowLeft+" "+E.formatGemToCoin(C.gem)+"<br />"+D.getPhraseOriginal("Gem Account Upgrades")+": "+E.formatGemToMoney(V)+" "+I.Symbol.ArrowRight+" "+E.formatGemString(V,!0)+" "+I.Symbol.ArrowLeft+" "+E.formatCoinStringColored(g)+"<br />",M="<dfn>"+D.getPhraseOriginal("Liquid Summary")+":</dfn> <br />"+D.getPhraseOriginal("Liquid Sell")+": "+E.formatCoinStringColored(c)+"<br />"+D.getPhraseOriginal("Liquid Buy")+": "+E.formatCoinStringColored(s)+"<br /><br /><dfn>"+D.getPhraseOriginal("Liquid Summary Exclude Gems")+":</dfn> <br />"+D.getPhraseOriginal("Liquid Sell")+": "+E.formatCoinStringColored(d)+"<br />"+D.getPhraseOriginal("Liquid Buy")+": "+E.formatCoinStringColored(u)+"<br />",w=$("#audSummaryAppraised").click(function(e){e.which===I.ClickEnum.Left&&I.print(L)}),x=$("#audSummaryLiquid").click(function(e){e.which===I.ClickEnum.Left&&I.print(M)}),W=3e3;k.show("slow",function(){I.animateNumber(a,function(e){w[0].innerHTML=E.formatCoinString(e,{aWantBig:!0})},W,"easeInOutQuart"),I.animateNumber(c,function(e){x[0].innerHTML=E.formatCoinString(e,{aWantBig:!0})},W,"easeInOutQuart"),_.show(),setTimeout(function(){I.qTip.init(w.attr("title",L)),I.qTip.init(x.attr("title",M))},W)});var B=new Date,R=O.loadCompressedObject(O.Utilities.AuditHistory.key)||{},H=A.Data.Account.oAccName;!1===U.isObject(R[H])&&(R[H]={});var z={};for(var p in A.Currency.AuditHistory){var G=R[H][p];z[p]=void 0===G||!1===Array.isArray(G)?[]:G}var F=z.Timestamps.length;for(var p in z){if(z[p].length<F){var j=new Array(F-z[p].length).fill(0);z[p]=z[p].concat(j)}F>=O.Options.int_numAuditReports?z[p]=z[p].slice(1,O.Options.int_numAuditReports):z[p].length>F&&(z[p]=z[p].slice(0,F))}if(z.Timestamps.push(T.formatISO(B)),z.WalletCoin.push(v.coin_liquidsell),z.WalletKarma.push(v.karma),z.WalletGem.push(v.gem),z.TotalGems.push(m),z.TotalAppraisedSellNoGems.push(i),z.TotalLiquidSellNoGems.push(d),O.Options.bol_auditHistoryConverted)for(var p in l)z[p].push(f[p]);else for(var p in l)z[p].push(l[p].coin_appraisedsell);R[H]=z,O.saveCompressedObject(O.Utilities.AuditHistory.key,R),A.initializeCharts(function(){P.highcharts("StockChart",{chart:{width:720,height:445},series:X(z),credits:{enabled:!1},xAxis:{type:"datetime",ordinal:!1,dateTimeLabelFormats:A.getChartsTimeFormat()},yAxis:{startOnTick:!1,endOnTick:!1,labels:{useHTML:!0,formatter:function(){return E.formatCoinStringColored(this.value)}}},tooltip:{useHTML:!0,formatter:function(){return A.getChartsCurrencyFormat(this.points,A.Currency.AuditColor)}}});var e=$("<div id='audHistoryButtons'></div>").appendTo(_);$("<button class='accButton'>"+D.getPhraseOriginal("Print History")+"</button>").appendTo(e).click(function(){I.prettyJSON(z)}),$("<button class='accButton'>"+D.getPhraseOriginal("Print Storage")+"</button>").appendTo(e).click(function(){var e=O.loadCompressedObject(O.Utilities.AuditHistory.key);if(e)try{I.prettyJSON(e)}catch(e){}}),$("<button class='accButton'>"+D.getPhraseOriginal("Trim History")+"</button>").appendTo(e).click(function(){var e=z.Timestamps,t=e.length;if(t>1&&confirm("This will delete some of your history so there is one entry max per day. Continue?")){var a,n={},i={};for(var r in A.Currency.AuditHistory)n[r]=[];for(var o=t-1;o>=0;o--)if((a=e[o].split("T")[0])&&void 0===i[a]){i[a]=!0;for(var r in A.Currency.AuditHistory)n[r].unshift(z[r][o])}z=n,R[H]=z,O.saveCompressedObject(O.Utilities.AuditHistory.key,R)}});var t=[];for(var a in R)t.push({name:a});I.createSearchBar(e,{aIsSelect:!0,aIsInline:!0,aFillerText:D.getPhraseOriginal("Delete Storage"),aDatabase:t,aCallback:function(e){var t=e.name;confirm("Delete account "+t+" from audit storage?")&&(R[t]?(delete R[t],O.saveCompressedObject(O.Utilities.AuditHistory.key,R),I.write(t+" was deleted from the storage.")):I.write(t+" was already deleted or not found in history."))}}),b()})});var ae=$("<div id='audDebug'></div>").appendTo(r);$("<button class='accButton'>Print Possessions</button>").appendTo(ae).click(function(){I.prettyJSON(A.Possessions)}),$("<button class='accButton'>Print Paylist</button>").appendTo(ae).click(function(){I.prettyJSON(E.Paylist)}),$("<button class='accButton'>Print View</button>").appendTo(ae).click(function(){I.prettyJSON(f)}),I.scrollToElement("#accAuditCenter",{aSpeed:"fast"}),I.suspendElement(t,!1),a.show()},V=function(){k(),P(),L(),M("Skins",!1),M("Outfits"),M("Gliders"),M("Dyes"),M("Minis"),M("Carriers"),M("Champions"),M("Finishers"),M("Nodes"),M("Recipes"),w(),q()},J=function(e){var t,a=E.createPrice();return e.forEach(function(e){e&&(t=E.Paylist[e[0]])&&E.isPriceObject(t)&&(a=E.addPrice(a,E.recountPrice(t,e[1])))}),E.createPriceBound(a)},Y=function(){c=U.getRecordHeader("ascended"),s=U.getRecordData("ascended"),u=p.AscendedIngredients,d=p.CompositeIngredients;var e,t={};for(var a in c)e=c[a].type,l="Armor"===e||"Weapon"===e?u[a].concat(u[e]):u[a],t[a]=J(l);A.Tally.Ascended={armorcount:0,weaponcount:0,price:E.createPrice()};var n;A.iterateRecord(s,function(a,i){"Trinket"!==(e=c[i].type)&&(E.Paylist[a.i]=t[i],A.Possessions[a.i]&&(n=A.Possessions[a.i].oCount,"Armor"===e?A.Tally.Ascended.armorcount+=n:"Weapon"===e&&(A.Tally.Ascended.weaponcount+=n),A.Tally.Ascended.price=E.addPrice(A.Tally.Ascended.price,E.recountPrice(t[i],n))))});for(var a in d)E.Paylist[a]=J(d[a])},ee=function(e,t){var a=C[e];A.iterateRecord(a,function(e){if(e.p)for(var a in e.p)(o[a]||e.p.coin)&&(E.Paylist[e.i]=e.p.coin?E.createPriceBound(e.p.coin):e.p);else t&&e.u&&E.Paylist[e.u]&&(E.Paylist[e.i]=E.createPriceBound(E.Paylist[e.u]))})},te=function(){I.print(D.getPhraseOriginal("Loading trading price")+"..."),E.getPrices(U.convertAssocToArray(g),function(e){var t=p.BoundPayments;for(var a in n)E.Paylist[a]=E.processPrice(n[a]);if(e)for(var a in e)E.Paylist[a]=e[a];for(var a in t)if(t[a].coin)E.Paylist[a]=E.createPricePlain(t[a].coin);else for(var i in t[a])E.Paylist[a]={},E.Paylist[a][i]=t[a][i];for(var a in p.JunkValue)E.Paylist[a]=E.createPricePlain(p.JunkValue[a]);ee("Ascended",!0),Y(),ee("Catalog",!0),ee("Skins"),ee("Outfits"),ee("Gliders"),ee("Minis"),ee("Carriers"),ee("Champions"),ee("Finishers"),ee("Nodes"),V()})},ae=function(){I.print(D.getPhraseOriginal("Loading info price")+"..."),$.getJSON(U.URL_DATA.Prices,function(e){n=e.data,i=e.blacklist;for(var t in A.Possessions)void 0===n[t]&&void 0===i[t]&&(g[t]=!0);var a;for(var t in o)a=o[t].conversion,Array.isArray(a)&&!0!==o[t].isbound&&(g[a[1]]=!0);(p=U.getRecordMetadata("ascended")).PriorityTradeable.forEach(function(e){g[e]=!0}),!1!==O.Options.bol_auditTransactions?(I.print(D.getPhraseOriginal("Loading buying transactions")+"..."),A.getTransactions(A.URL.CurrentBuys,{aCallback:function(e){I.print(D.getPhraseOriginal("Loading selling transactions")+"..."),A.getTransactions(A.URL.CurrentSells,{aCallback:function(t){e&&e.length&&(h=e,e.forEach(function(e){g[e.item_id]=!0})),t&&t.length&&(m=t,t.forEach(function(e){g[e.item_id]=!0})),te()},aError:function(){te()}})},aError:function(){te()}})):te()})},ne=function(){var e=0,t=U.getObjectLength(C);for(var a in C)I.print(D.getPhraseOriginal("Loading info "+a.toLowerCase())+"..."),function(a){U.getScript(U.URL_DATA[a],function(){C[a]=U.getRecordData(a),++e===t&&ae()}).fail(function(){I.print("Failed to load "+a+" record file. Auditing aborted."),S()})}(a)},ie=function(){var e=0,t=U.getObjectLength(v);for(var a in v)I.print(D.getPhraseOriginal("Loading account "+a.toLowerCase())+"..."),function(a){$.getJSON(A.getURL(A.URL[a]),function(e){v[a]=e}).done(function(){++e===t&&ne()}).fail(function(){I.print("Failed to retrieve "+a+" account unlocks. Auditing aborted.<br />Please check account permissions."),S()})}(a)};I.clear(),I.print(D.getPhraseOriginal("Loading account bank materials inventory")+"..."),A.initializePossessions(function(){ie()},O.Options.bol_auditVault)}},V={sortCharacters:function(e,t){var a=[];$("."+e).each(function(){a.push({index:U.getSubintegerFromHTMLID($(this).parent()),value:parseInt($(this).attr("data-value"))})}),U.sortObjects(a,{aKeyName:"value",aIsDescending:t});for(var n=0;n<a.length;n++){var i=a[n].index;$("#chrSelection_"+i).appendTo("#chrSelection"),$("#chrUsage_"+i).appendTo("#chrUsage"),$("#chrSeniority_"+i).appendTo("#chrSeniority")}},serveAudit:function(){$("#accAuditContainer").show("fast"),$("#accAuditTop").append("<label><input id='audWantTransactions' type='checkbox' /> "+D.getPhraseOriginal("Include current trading transactions")+".</label><br /><label><input id='audWantVaults' type='checkbox' /> "+D.getPhraseOriginal("Include guilds vault")+".</label><br /><label><input id='audWantAutomatic' type='checkbox' /> "+D.getPhraseOriginal("Automatic daily audit")+".</label><br /><label><input id='audWantConverted' type='checkbox' /> "+D.getPhraseOriginal("Convert currencies in history")+".</label>"),O.mimicInput("#audWantTransactions","bol_auditTransactions"),O.mimicInput("#audWantVaults","bol_auditVault"),O.mimicInput("#audWantAutomatic","bol_auditAccountOnReset"),O.mimicInput("#audWantConverted","bol_auditHistoryConverted"),X.rewrapCheckboxes();var e=$("#accAuditCenter"),t=$("<button id='audExecute'>"+D.getPhraseOriginal("Audit Account")+"</button>").appendTo(e).click(function(){A.generateAudit()});$("<button id='audHelp'>"+D.getWordCapital("help")+"</button>").appendTo(e).click(function(){!1===I.isConsoleShown()&&I.help($("#accHelpAudit").html())});$("<button id='audExecuteAlternate' title='<dfn>Audit</dfn> account.<br />gw2timer.com/audit'> <img src='img/ui/stats.png' /></button>").insertAfter("#chrAccountReload").click(function(){$(this).hide(),t.trigger("click")});I.qTip.init("#audExecuteAlternate"),A.isAuditReady=!0,V.attemptAudit()},attemptAudit:function(){A.isAuditReady&&U.verifyArticle(I.SpecialPageEnum.Audit,function(){$("#audExecute").trigger("click")},!0),U.nullifyArticle()},serveCharacters:function(e){var t=$("#accDish_Characters");if(!1!==A.reinitializeDish(t)){var a=$(".accCharDependentMenu");A.Possessions=null,t.html("<div id='chrSummary'></div><div id='chrStatistics' class='cssStats'><ul id='chrSelection'></ul><ul id='chrUsage' class='chrStats'></ul><ul id='chrSeniority' class='chrStats'></ul><ul id='chrGuilds' class='chrStats'></ul></div><div id='accAuditContainer'><div id='audSeparatorTop' class='accSeparator'></div><div id='accAuditTop' class='accComposition'></div><div id='accAuditCenter'></div><div id='accAudit'></div></div>"),$(".chrWallet").remove(),$(".chrStats").hide(),I.suspendElement(a),t.prepend(I.cThrobber),U.getJSON(A.getURLAll(A.URL.Characters),function(n){A.wipeDish("Hero"),I.removeThrobber(t),A.adjustAccountScrollbar(),A.isCharactersCached=!0;var i=n.length;A.initializeAccountUpgrades(),A.assignAccountUpgrades("CharacterSlot",i),A.Data.CharacterNames=[],A.CharIndexCurrent=null,A.Data.Characters=null,A.Data.Characters=new Array(i),A.Data.CharacterAssoc={};var r=0;n.forEach(function(e){A.Data.CharacterNames.push(e.name),$("#chrSelection").append("<li id='chrSelection_"+r+"' class='chrSelection curClick'></li>"),$("#chrUsage").append("<li id='chrUsage_"+r+"'></li>"),$("#chrSeniority").append("<li id='chrSeniority_"+r+"'></li>"),A.Data.Characters[r]=e,A.Data.Characters[r].oCharIndex=r,A.Data.Characters[r].oCharName=U.escapeHTML(e.name),A.Data.CharacterAssoc[e.name]=r,V.generateCharactersSelection(e),r++}),I.suspendElement(a,!1),V.generateCharactersStatistics(),e&&$("#accMenu_"+e).trigger("click")},A.isCharactersCached).fail(function(e,a){I.removeThrobber(t),A.printError(A.PermissionEnum.Characters,a)})}else V.attemptAudit()},generateCharactersSelection:function(e){var t=e.profession.toLowerCase();if(e.oCharElite=t,e.oCharProfession=t,e.oCharColor=A.Metadata.Profession[t].color,e.oCharIsLowLevel=e.level<Q.GameLimit.LevelMax,e.specializations&&e.specializations.pve)for(var a=e.specializations.pve,n=0;n<a.length;n++)if(a[n]){var i=a[n].id;if(void 0!==A.Metadata.ProfElite[i]){t=A.Metadata.ProfElite[i],e.oCharElite=t;break}}var r="",o="";e.crafting&&e.crafting.length>0&&(e.oCharCraft={},e.crafting.forEach(function(t){var a="<b class='"+(t.rating>=A.Metadata.CraftingRank.Master?"":"accTrivial")+"'><ins class='acc_craft acc_craft_"+t.discipline.toLowerCase()+"'></ins><sup class='chrCraftingRating'>"+t.rating+"</sup></b> ";t.active&&(r+=a,e.oCharCraft[t.discipline]=t.rating),o+=a+" "}));var s=A.Metadata.Race[e.race.toLowerCase()+"_"+e.gender.toLowerCase()]||1,c=A.Metadata.Profession[e.profession.toLowerCase()].weight,l=e.oCharIsLowLevel?"accTrivial":"";e.oCharPortrait="img/account/characters/"+e.race.toLowerCase()+"_"+e.gender.toLowerCase()+I.cPNG,$("#chrSelection_"+e.oCharIndex).append("<img id='chrPortrait_"+e.oCharIndex+"' class='chrPortrait' src='"+e.oCharPortrait+"' /><var id='chrName_"+e.oCharIndex+"' class='chrName' data-value='"+s+"'>"+e.oCharName+"</var><span class='chrCommitment' data-value='"+c+"'><var class='chrProfession "+l+"'><ins class='chrProfessionIcon acc_prof acc_prof_"+t+"'></ins><sup>"+e.level+"</sup></var><var class='chrCrafting'>"+r+"</var></span><img class='chrProceed' src='img/ui/view.png' />").click(function(){var e=U.getSubintegerFromHTMLID($(this));A.CharIndexCurrent===e?(A.CharIndexCurrent=null,$(this).find(".chrProceed").animate({rotation:0},{duration:200,queue:!1}),$(this).removeClass("chrSelected")):(A.CharIndexCurrent=e,$(".chrProceed").animate({rotation:0},{duration:200,queue:!1}),$(this).find(".chrProceed").animate({rotation:T.cCIRCLE_RIGHT_DEGREE},{duration:200,queue:!1}),$(".chrSelection").removeClass("chrSelected"),$(this).addClass("chrSelected"),$("#accMenu_Hero").trigger("click"),A.adjustAccountScrollbar())}),$("#chrPortrait_"+e.oCharIndex).click(function(e){e.stopPropagation();var t=U.getSubintegerFromHTMLID($(this));I.prettyJSON(A.Data.Characters[t])});var u="<img class='chrPrefaceIcon' src='"+e.oCharPortrait+"' /><ins class='acc_prof acc_prof_"+e.oCharElite+" "+l+"'></ins>";e.oCharPreface="<span class='chrPreface'>"+u+e.oCharName+"</span>",e.oCharIcons="<span class='chrPreface' title='"+e.oCharName+"'>"+u+"</span>",I.qTip.init($("#chrSelection_"+e.oCharIndex).find(".chrCommitment").attr("title",o))},generateCharactersStatistics:function(){var e=(new Date).getTime(),t=D.getWord("h"),a=D.getWord("d"),n=D.getWord("y"),i=0,r=0,o=0,s=0,c=0,l=function(e){for(var t,a,n=A.Metadata.WvWRank,i=n.Ranks,r="",o="",s="",c=i.length,l=0;l<c;l++)if(i[l]>e){t=(l-1)%n.RanksPerModifier,a=~~((l-1)/n.RanksPerModifier),r=D.orderModifier(D.getObjectTranslation(n.Titles[t]),D.getObjectTranslation(n.Modifiers[a])),l<c&&(t=l%n.RanksPerModifier,a=~~(l/n.RanksPerModifier),s=D.orderModifier(D.getObjectTranslation(n.Titles[t]),D.getObjectTranslation(n.Modifiers[a])),o=e+" + "+(i[l]-e)+'<img src="img/account/summary/worldabilitypoint.png" /> = '+s);break}return e>=i[c-1]&&(r=D.orderModifier(D.getObjectTranslation(n.Titles[n.Titles.length-1]),D.getObjectTranslation(n.Modifiers[n.Modifiers.length-1]))),"<var id='chrAccountWvWRank' title='"+o+"'>"+r+"</var>"};A.Data.Characters.forEach(function(t){i<t.age&&(i=t.age),r<t.deaths&&(r=t.deaths),t.oCharLifetime=~~((e-new Date(t.created).getTime())/T.cMSECONDS_IN_SECOND),o<t.oCharLifetime&&(o=t.oCharLifetime)}),A.Data.Characters.forEach(function(e){var l="<abbr>"+e.oCharName+"</abbr>";s+=e.age,c+=e.deaths;var u=Math.round(e.age/T.cSECONDS_IN_HOUR),d=e.age/i*T.cPERCENT_100,p=e.deaths/r*T.cPERCENT_100,h="<var class='chrAge' title='"+T.formatTimeLetter(e.age)+"' data-value='"+u+"'>"+u+t+"</var><span class='chrHoverName'>"+l+I.getBar(d,!0)+I.getBar(p)+"</span><var class='chrDeaths' title='"+T.parseRatio(e.deaths/u,2)+"x / 1"+t+"' data-value='"+e.deaths+"'>"+e.deaths+"x</var>";$("#chrUsage_"+e.oCharIndex).append(h);var m=new Date(e.created).toLocaleString(),g=~~(e.oCharLifetime/T.cSECONDS_IN_YEAR),f=~~(e.oCharLifetime/T.cSECONDS_IN_DAY),C=e.oCharLifetime/o*T.cPERCENT_100,v=~~(e.oCharLifetime%T.cSECONDS_IN_YEAR/T.cSECONDS_IN_DAY),b=T.cDAYS_IN_YEAR-v,S=v/T.cDAYS_IN_YEAR*T.cPERCENT_100,y="<var class='chrLifetime' title='"+T.formatTimeLetter(e.oCharLifetime)+"' data-value='"+e.oCharLifetime+"'>"+f+a+" ("+g+n+")</var><span class='chrHoverName'>"+l+I.getBar(C,!0)+I.getBar(S)+"</span><var class='chrBirthday' title='"+T.formatTimeLetter(b*T.cSECONDS_IN_DAY)+"' data-value='"+v+"'>"+b+a+"</var><var class='chrBirthdate'>"+m+"</var>";$("#chrSeniority_"+e.oCharIndex).append(y)}),$(".chrStats li").hover(function(){$("#chrSelection_"+U.getSubstringFromHTMLID($(this))).css({outline:"1px solid red"})},function(){$("#chrSelection_"+U.getSubstringFromHTMLID($(this))).css({outline:"none"})});var u=" <b class='jsSortableHeaderSymbol'>"+I.Symbol.TriDown+"</b>";$("#chrSelection").prepend("<li class='chrHeader'><var class='chrHeaderLeft curClick' data-classifier='chrName'>"+A.Data.Characters.length+" "+D.getWordCapital("characters")+u+"</var><var class='chrHeaderRight curClick' data-classifier='chrCommitment'>"+D.getWordCapital("profession")+u+"</var></li>"),$("#chrUsage").prepend("<li class='chrHeader'><var class='chrHeaderLeft curClick' data-classifier='chrAge'>"+D.getWordCapital("age")+u+"</var><var class='chrHeaderRight curClick' data-classifier='chrDeaths'>"+D.getWordCapital("deaths")+u+"</var></li>"),$("#chrSeniority").prepend("<li class='chrHeader'><var class='chrHeaderLeft curClick' data-classifier='chrLifetime'>"+D.getWordCapital("lifetime")+u+"</var><var class='chrHeaderRight curClick' data-classifier='chrBirthday'>"+D.getWordCapital("birthday")+u+"</var></li>"),$(".chrHeaderLeft, .chrHeaderRight").click(function(){I.toggleSortableHeader($(this)),V.sortCharacters($(this).attr("data-classifier"),$(this).data("isdescending"))}),$.getJSON(A.getURL(A.URL.Account),function(a){A.Data.Account=a,A.Data.Account.oAccName=U.escapeHTML(a.name),A.Data.Account.oAccNick=A.Data.Account.oAccName.split(".")[0];var n=U.convertPrivateAnchor("https://forum-en.guildwars2.com/members/"+a.name.replace(/[\s\.]/g,"-")+"/showposts"),i=Math.round(s/T.cSECONDS_IN_HOUR),r=new Date(a.created),o=~~((e-r.getTime())/T.cMSECONDS_IN_SECOND),u=T.formatTimeLetter(o).trim(),d=T.parseRatio(s/o*T.cHOURS_IN_DAY,2),p=a.commander?"":"accTrivial",h=a.wvw_rank?" "+l(a.wvw_rank):"",m=a.access?"":"accTrivial",g="<span id='chrAccountMisc'><dfn><a id='chrAccountLink' title='"+U.escapeHTML(a.id)+"'"+n+">"+U.escapeHTML(a.name)+"</a></dfn><br />"+r.toLocaleString()+"<br /><img class='"+p+"' src='img/account/summary/commander.png' /><img class='"+m+"' src='img/account/summary/access_hot.png' /> <img src='img/account/summary/fractal.png' />"+(a.fractal_level||"?")+" <img src='img/account/summary/worldabilitypoint.png' />"+(a.wvw_rank||"?")+" <img src='img/account/summary/daily.png' />"+(a.daily_ap||"?")+" <img src='img/account/summary/monthly.png' />"+(a.monthly_ap||"?")+"</span><br />",f="<var id='chrAccountName'>"+A.Data.Account.oAccNick+"</var>"+g+"<var id='chrAccountServer'></var>"+h+"<br /><var id='chrAccountAge' title='"+d+t+" / "+T.cHOURS_IN_DAY+t+"<br />"+T.formatTimeLetter(s)+" / "+u+"'>"+i+t+"</var> / <var id='chrAccountDeaths' title='"+T.parseRatio(c/i,2)+"x / 1"+t+"'>"+c+"x</var> &nbsp; <var id='chrAccountLifetime'>"+u+"</var> &nbsp; <span id='chrAccountTitles'></span> &nbsp; <button id='chrAccountReload' title='<dfn>Reload</dfn> characters data (statistics, equipment, inventory).'><img src='img/ui/refresh.png' /></button>";$("#chrSummary").append(f),I.qTip.init("#chrSummary var, #chrAccountReload"),$("#chrAccountReload").click(function(){A.isCharactersCached=!1,$(".accCharDependent").each(function(){A.wipeDish($(this).attr("data-section"))}),I.qTip.hide(),A.regenerateDish("Characters")}),$.getJSON(U.URL_API.Worlds+a.world,function(e){Array.isArray(e)&&e.length>0&&$("#chrAccountServer").text(e[0].name)}),A.initializeGuilds(function(){var e=a.guilds;A.Data.Characters.forEach(function(e){if(e.guild){var t=Q.getCachedGuild(e.guild);t&&$("#chrName_"+e.oCharIndex).append("<sup class='chrTag'>["+t.tag+"]</sup>")}});var t="<li class='chrHeader'><var class='chrHeaderLeft'>"+D.getWordCapital("guilds")+"</var></li>";$("#chrGuilds").append(t);for(var n in e){var i=Q.getCachedGuild(e[n]);i&&function(e){var t=U.getGuildBannerRaw(e),a=$("<li class='chrGuild'><span class='chrGuildHover'><img class='chrGuildBanner' src='"+t+"' /><img class='chrGuildBanner chrGuildBannerLarge' src='"+t+"' /></span><var class='chrGuildName'>"+e.name+" "+e.oTag+"</var></li>").click(function(){I.prettyJSON(e)});$("#chrGuilds").append(a)}(i)}}),V.initializeWallet(),V.initializeTitles(),$("#chrSummary").show("fast")}),I.qTip.init("#accPlatterCharacters var"),$(".chrStats").show("fast")},initializeWallet:function(){var e=function(e,t){var a=$("<ul id='chrWallet_"+t+"' class='chrStats chrWallet'></ul>").insertBefore("#chrGuilds"),n="";switch(t){case"General":n=D.getModifiedWord("currencies","general",U.CaseEnum.Every);break;case"Dungeon":n=D.getModifiedWord("tokens","dungeon",U.CaseEnum.Every);break;case"Map":n=D.getModifiedWord("tokens","map",U.CaseEnum.Every)}a.append("<li class='chrHeader'><var class='chrHeaderLeft curClick'>"+n+"</var></li>"),I.bindSortableTable(a,{aIsList:!0});for(var i,r,o,s,c,l=0;l<e.length;l++)i=e[l],o=void 0===(o=A.Data.Wallet[i.id])||null===o?0:o,s=i.coefficient,i.value="gem"===s?E.convertGemToCoin(o):void 0===s?o:o*s,i.payment&&(A.Currency.AuditWallet[i.id]=i);for(var u=T.getMinMax(e,"value").oMax,l=0;l<e.length;l++){switch(i=e[l],o=A.Data.Wallet[i.id],o=void 0===o||null===o?0:o,c=o.toLocaleString(),r=i.value,i.id){case 1:c=E.formatCoinStringColored(o);break;case 2:c=E.formatKarmaString(o,!0);break;case 3:c=E.formatLaurelString(o,!0);break;case 4:c=E.formatGemString(o,!0)}var d=r/u*T.cPERCENT_100,p=U.getWikiLinkDefault(D.getObjectDefaultName(i));a.append("<li data-value='"+r+"'><var class='chrWalletAmount'>"+c+"</var><ins class='acc_wallet acc_wallet_"+i.id+"'></ins><var class='chrWalletCurrency'><a class='chrWalletLink'"+U.convertExternalAnchor(p)+">"+D.getObjectName(i)+"</a></var>"+I.getBar(d)+"</li>")}};$.getJSON(A.getURL(A.URL.Wallet),function(t){E.updateExchangeRatios(function(){A.Data.Wallet=null,A.Data.Wallet={};for(i=0;i<t.length;i++){var a=t[i];A.Data.Wallet[a.id]=parseInt(a.value)}var n=A.Currency.Wallet;for(var i in n)e(n[i],i);V.serveAudit()})}).fail(function(){U.nullifyArticle()})},initializeTitles:function(){var e=function(){var e={};A.Data.Characters.forEach(function(t){var a=t.title;if(a){void 0===e[a]&&(e[a]=0),e[a]+=1;var n=Q.getBoxedTitle(a).oData;I.qTip.init($("#chrSelection_"+t.oCharIndex).attr("title","&quot;<dfn>"+n.name+"</dfn>&quot;"))}});var t=[];for(var a in A.Data.Titles){var n=Q.getBoxedTitle(a);if(n){var i=n.oData,r=e[i.id]?"("+e[i.id]+") ":"";t.push({name:r+i.name,wiki:U.getWikiLinkLanguage(i.name)})}}I.createSearchBar("#chrAccountTitles",{aIsSelect:!0,aIsInline:!0,aFillerText:t.length+" "+D.getPhraseOriginal("Titles Unlocked"),aDatabase:t,aCallback:function(e){U.openExternalURL(e.wiki)}})};$.getJSON(A.getURL(A.URL.Titles),function(t){A.Data.Titles=null,A.Data.Titles=U.getExistAssoc(t),Q.getTitles(t,function(){e()})})},requireCharacters:function(e){return!!$("#accDish_Characters").is(":empty")&&(V.serveCharacters(e),$("#accMenu_Characters").trigger("click"),!0)},serveHero:function(){if(!V.requireCharacters("Hero"))if(A.Data.Characters[0].equipment){var e=$("#accDish_Hero"),t=$("#eqpContainer_"+A.CharIndexCurrent),a=$(".eqpContainer"),n=function(){I.removeThrobber(e),A.Data.Characters.forEach(function(e){V.generateHero(e)}),a.show(),A.createCharacterScroller(A.Data.Characters,"Hero",{aElementPrefix:"eqpContainer_",aOffset:-120})};if(null!==A.CharIndexCurrent)V.generateHero(),a.hide(),t.show();else if(!1===A.reinitializeDish(e))a.show();else{e.prepend(I.cThrobber);var i=[],r=[];A.Data.Characters.forEach(function(e){var t=A.iterateInventory(e.equipment);i=i.concat(t.oItemIDs),r=r.concat(t.oSkinIDs)}),Q.getItems(i,function(){Q.getSkins(r,function(){n()})})}}else A.printError(A.PermissionEnum.Builds)},generateHero:function(e){var t=e||A.getCurrentCharacter();if(void 0!==t&&null!==t&&!1!==Array.isArray(t.equipment)&&!$("#eqpContainer_"+t.oCharIndex).length){var a=$("#accDish_Hero"),n=$("<div id='eqpContainer_"+t.oCharIndex+"' class='eqpContainer'></div>").appendTo(a);A.createCharacterBanner(n,t);var i=$("<div class='eqpSubcontainer eqpSubcontainer_"+t.profession+"'></div>").appendTo(n),r=$("<div class='eqpLeft eqpColumn'></div>").appendTo(i),o=$("<div class='eqpRight eqpColumn'></div>").appendTo(i),s=$("<div class='eqpBuild eqpColumn'></div>").appendTo(i),c=A.Equipment,l=c.ColumnLeft,u=c.ColumnRight,d=c.BriefRight,p=c.ToggleableSlots,h=$("<div class='eqpAttrWindow'><aside class='eqpAttrHeader'><span class='eqpAttrTitle'>"+D.getWordCapital("attributes")+"</span></aside><aside class='eqpAttrContent'></aside></div>").appendTo(s),m=new A.Attribute.Base,g=t.equipment.length,f=0,C=function(e){return"<aside class='eqpRow eqp"+e+"'><span class='eqpSlotOuter'><span class='eqpSlot eqpSlot_"+e+"' style='background-image:url(\"img/account/equipment/"+e.toLowerCase()+".png\")'></span></span><span class='eqpBrief eqpBrief_"+e+"'></span></aside>"},v=function(e){return"<aside class='eqpCell eqp"+e+"'><span class='eqpSlot eqpSlot_"+e+"' style='background-image:url(\"img/account/equipment/"+e.toLowerCase()+".png\")'></span></aside>"},b=function(e){var t="",a=e.oData.level<Q.GameLimit.LevelMax?" ("+e.oData.level+")":"";return t="<span class='eqpBriefName "+Q.getRarityClass(e.oData.rarity)+"'>"+e.oData.name+a+"</span><br />",e.oInfusions.forEach(function(e){t+="<span class='"+Q.getRarityClass(e.rarity)+"'><img src='"+e.icon+"' /> "+e.name+"</span><br />"}),e.oUpgrades.forEach(function(e){t+="<span class='"+Q.getRarityClass(e.rarity)+"'><img src='"+e.icon+"' /> "+e.name+"</span><br />"}),t},S=function(){var e=h.find(".eqpAttrContent"),a=Q.calculateAttributes(m,t);for(var n in a)e.append("<span class='eqpAttrBlock eqpAttr_"+n+"' title='<dfn>"+D.getString(n)+"</dfn>'><img src='img/account/attributes/"+n.toLowerCase()+".png' /><var class='eqpAttrSum'>"+a[n]+"</var><var class='eqpAttrBonus'>+"+m[n]+"</var></span>");e.find(".eqpAttr_Power").after("<span class='eqpAttrBlock eqpAttr_Profession'><img src='img/account/attributes/"+t.oCharElite.toLowerCase()+".png' /><var>0%</var></span>"),I.qTip.init(e.find("span"))},T=function(){var e=t.specializations,a=t.skills;if(void 0!==e){var n=$("<div class='spzWindow'><aside class='spzSwitchContainer'><span class='spzSwitchWrapper'><img class='spzBuildIcon' src='img/ui/menu/build.png' /><img src='img/ui/view.png' /><img class='spzSwitch curClick' data-assoc='PVE' src='img/ui/menu/map.png' /><img class='spzSwitch curClick' data-assoc='WVW' src='img/ui/menu/wvw.png' /><img class='spzSwitch curClick' data-assoc='PVP' src='img/ui/menu/pvp.png' /></span></aside><div class='spzContainer'><div class='spzPanel spzPanel_PVE'></div><div class='spzPanel spzPanel_WVW'></div><div class='spzPanel spzPanel_PVP'></div></div><div class='sklContainer'><div class='sklPanel sklPanel_PVE'></div><div class='sklPanel sklPanel_WVW'></div><div class='sklPanel sklPanel_PVP'></div></div></div>").appendTo(s);n.find(".spzSwitch").each(function(){$(this).click(function(){n.find(".spzSwitch").removeClass("spzSwitchFocused"),$(this).addClass("spzSwitchFocused");var t=$(this).attr("data-assoc"),i=t.toLowerCase(),r=n.find(".spzPanel_"+t),o=n.find(".sklPanel_"+t);n.find(".spzPanel").hide(),n.find(".sklPanel").hide(),r.show(),o.show(),V.generateTraits(e[i],r),V.generateSkills(a[i],o)})}),n.find(".spzSwitch:first").trigger("click")}},y=function(){A.setProgressBar(f,g),g===f&&(S(),T())};l.forEach(function(e){r.append(C(e))}),r.find(".eqpWeaponA2").after("<aside class='eqpSwap'><img class='eqpSwapIcon' src='img/account/equipment/swap.png' /></aside>"),r.find(".eqpWeaponA1").after("<span class='eqpSwapOuter eqpSwapA'><img class='eqpSwapIcon' src='img/account/equipment/swapa.png' /></span>"),r.find(".eqpWeaponB1").after("<span class='eqpSwapOuter eqpSwapB'><img class='eqpSwapIcon' src='img/account/equipment/swapb.png' /></span>"),u.forEach(function(e){o.append(v(e))}),o.prepend("<aside class='eqpSepTrinket'></aside>");var k=$("<aside class='eqpBriefRight'></aside>").prependTo(o);d.forEach(function(e){k.append("<span class='eqpBrief eqpBrief_"+e+"' style='display:none;'></span>")}),o.find(".eqpRing2").after("<aside class='eqpSepGathering'><span class='eqpSepInner'></span></aside>"),o.find(".eqpPick").after("<aside class='eqpSepUnderwater'><span class='eqpSepInner'></span></aside>"),o.find(".eqpWeaponAquaticA").after("<aside class='eqpSwapAquatic eqpCell'><img class='eqpSwapIcon' src='img/account/equipment/swap.png' /></aside>"),o.find(".eqpWeaponAquaticA").after("<span class='eqpSwapAquaticOuter eqpSwapAquaticA'><img class='eqpSwapIcon' src='img/account/equipment/swapaquatica.png' /></span>"),o.find(".eqpWeaponAquaticB").after("<span class='eqpSwapAquaticOuter eqpSwapAquaticB'><img class='eqpSwapIcon' src='img/account/equipment/swapaquaticb.png' /></span>"),o.append("<img class='eqpAquaticBackground' src='img/account/equipment/aquatic.png' />");var E=Q.countRuneSets(t),_=[];for(var P in t.equipment)_.push(t.equipment[P].id);if(Q.getItems(_,function(){for(var e in t.equipment)!function(e){Q.getItem(e.id,function(a){var n=$("#eqpContainer_"+t.oCharIndex),r=n.find(".eqpSlot_"+e.slot),o=e.skin?U.URL_IMG.Placeholder:a.icon,s=$("<img class='eqpIcon' src='"+o+"' />").appendTo(r);Q.scanItem(a,{aElement:r,aItemMeta:e,aRuneSets:E,aWantAttr:!0,aCallback:function(t){n.find(".eqpBrief_"+e.slot).append(b(t)).show();var r=null;t.oSkin&&(r=t.oSkin.name,s.attr("src",t.oSkin.icon)),A.Equipment.AttributableSlots[e.slot]&&Q.sumAttributeObject(m,t.oAttr),p[e.slot]&&i.find(".eqpSlot_"+e.slot).prepend("<img class='eqpCheckbox' src='img/ui/checkbox.png' />"),"Gathering"===a.type&&e.charges&&(s.attr("src",t.oData.icon),i.find(".eqpSlot_"+e.slot).prepend("<span class='eqpCharges'>"+e.charges+"</span>")),Q.bindItemSlotBehavior(s,{aItem:t.oData,aSearch:r,aWantClick:!0}),f++,y()}})})}(t.equipment[e])}),0===t.equipment.length&&y(),!1===A.Metadata.Profession[t.oCharProfession].isswappable){var L=[".eqpSwapAquatic",".eqpSwapAquaticB",".eqpWeaponAquaticB"];[".eqpSwap",".eqpSwapB",".eqpWeaponB1",".eqpWeaponB2"].forEach(function(e){i.find(e).css({visibility:"hidden"})}),L.forEach(function(e){i.find(e).hide()}),o.find(".eqpAquaticBackground").addClass("eqpAquaticBackgroundSingle"),o.find(".eqpHelmAquatic").addClass("eqpHelmAquaticSingle")}}},generateTraits:function(e,t){if(void 0!==e&&!1!==t.is(":empty")){var a={},n=function(e,n){var i=$("<aside class='spzLine'><span class='spzLineBackground'></span><span class='spzLineForeground'></span><span class='spzLineContent'><span class='spzSpecSide'><var class='spzSpecSideIcon'></var></span><span class='spzSpecColumn'><var class='spzSpecName'></var></span><span class='spzColumn'><var class='spzMinor spzMinor_10' data-tier='0'><em class='spzCon_01'></em></var></span><span class='spzColumn'><var class='spzMajor_10'><em class='spzCon_10L'></em><em class='spzCon_10R'></em></var><br /><var class='spzMajor_11'><em class='spzCon_11L'></em><em class='spzCon_11R'></em></var><br /><var class='spzMajor_12'><em class='spzCon_12L'></em><em class='spzCon_12R'></em></var><br /></span><span class='spzColumn'><var class='spzMinor spzMinor_20' data-tier='1'></var></var></span><span class='spzColumn'><var class='spzMajor_20'><em class='spzCon_20L'></em><em class='spzCon_20R'></em></var><br /><var class='spzMajor_21'><em class='spzCon_21L'></em><em class='spzCon_21R'></em></var><br /><var class='spzMajor_22'><em class='spzCon_22L'></em><em class='spzCon_22R'></em></var><br /></span><span class='spzColumn'><var class='spzMinor spzMinor_30' data-tier='2'></var></span><span class='spzColumn'><var class='spzMajor_30'><em class='spzCon_30L'></em></var><br /><var class='spzMajor_31'><em class='spzCon_31L'></em></var><br /><var class='spzMajor_32'><em class='spzCon_32L'></em></var><br /></span></span></aside>").appendTo(t);i.find("img").attr("src",U.URL_IMG.Placeholder);var r=function(e){var t=Q.getBoxedTrait(e).oData,r=i.find(".spz"+t.slot+"_"+t.tier+t.order);r.css({backgroundImage:"url("+t.icon+")"});var o="",s="",c=r.attr("data-tier");(a[e]||n[c])&&(r.find("em").show(),o="spzActive","Major"===t.slot&&(s="<span class='spzMajorName'>"+t.name+"</span>")),r.append(s+"<mark class='"+o+"'>"+I.Symbol.Filler+"</mark>"),Q.analyzeTrait(t,{aElement:r})};(function(){var t=Q.getBoxedSpecialization(e).oData;i.css({backgroundImage:"url("+t.background+")"}),i.find(".spzSpecName").text(t.name),t.elite&&i.find(".spzLineBackground").addClass("spzLineBackgroundElite"),t.minor_traits.concat(t.major_traits).forEach(function(e){r(e)})})()},i=[],r=[];e.forEach(function(e){e&&(i.push(e.id),e.traits&&e.traits.forEach(function(e){e&&(r.push(e),a[e]=!0)}))}),Q.getSpecializations(i,function(){for(var t in i){var a=Q.getBoxedSpecialization(i[t]).oData;r=r.concat(a.minor_traits.concat(a.major_traits))}Q.getTraits(r,function(){e.forEach(function(e){e&&n(e.id,e.traits)})})})}},generateSkills:function(e,t){if(void 0!==e&&!1!==t.is(":empty")){var a=$("<div class='sklBar'></div>").appendTo(t),n=function(e,t){if(e){var a=Q.getBoxedSkill(e).oData;t.find(".sklSlotIcon").css({backgroundImage:"url("+a.icon+")"});for(var n=0;n<a.flags.length;n++)if("GroundTargeted"===a.flags[n]){t.append("<span class='sklSlotTarget'></span>");break}Q.analyzeSkill(a,{aElement:t})}else t.find(".sklSlotSelect, .sklSlotForeground").hide()},i=function(e,t){return $("<aside class='sklSlot sklSlot_"+e+"'><span class='sklSlotSelect'></span><span class='sklSlotLocked'></span><span class='sklSlotIcon'></span><span class='sklSlotForeground'></span><span class='sklSlotHotkey'>"+t+"</span></aside>").appendTo(a)},r=i("heal","6");i("utilities0","7"),i("utilities1","8"),i("utilities2","9");var o=i("elite","0"),s=[];for(var c in e){var l=e[c];if(l)if(!1===isNaN(l))s.push(l);else for(var u in l)s.push(l[u])}Q.getSkills(s,function(){n(e.heal,r);for(var t=0;t<e.utilities.length;t++)n(e.utilities[t],a.find(".sklSlot_utilities"+t));n(e.elite,o)})}},serveInventory:function(){if(!V.requireCharacters("Inventory"))if(A.Data.Characters[0].bags){var e=$("#accDish_Inventory");if(!1!==A.reinitializeDish(e)){var t,a,n,i,r,o,s=B.createBank(e),c=B.getTabsContainer(s).append(I.cThrobber),l=0,u=0,d=0,p=0,h=0,m=0,g=function(e,a){var r=[],s=0,c=0;n=B.getSlotsContainer(e.append(I.cThrobber));for(var l=0;l<a.bags.length;l++)if(o=a.bags[l])for(var u=0;u<o.inventory.length;u++)(t=o.inventory[u])&&(r.push(t.id),c++);Q.getPricedItems(r,function(){I.removeThrobber(e);for(var r=0;r<a.bags.length;r++)if(o=a.bags[r])for(var l=0;l<o.inventory.length;l++)i=B.createBankSlot(n),(t=o.inventory[l])?(i.data("count",t.count),function(e,t){Q.getItem(t.id,function(a){B.styleBankSlot(e,{aItem:a,aSlotMeta:t,aCallback:function(){s++,A.setProgressBar(s,c)}})})}(i,t)):B.styleBankSlot(i)})};$.getJSON(A.getURL(A.URL.Shared),function(e){c.empty();var n=B.createBankTab(c,{aTitle:D.getPhraseOriginal("Shared Inventory")});l=0,u=e.length,h=e.length,d=0;for(f=0;f<e.length;f++)i=B.createBankSlot(B.getSlotsContainer(n),"bnkSlotShared"),(t=e[f])&&(i.data("count",t.count),l++,p++,d+=t.count,m+=t.count,function(e,t){Q.getItem(t.id,function(a){B.styleBankSlot(e,{aItem:a,aSlotMeta:t})})}(i,t));B.updateTabTally(n,l,u,d);for(var f=0;f<A.Data.Characters.length;f++){l=0,u=0,d=0,r=A.Data.Characters[f],a=B.createBankTab(c,{aTitle:r.oCharPreface,aIsCollapsed:!0}),B.createInventorySidebar(a,r.bags),function(e,t){e.one("click",function(){g(e,t)})}(a,r);for(var C=0;C<r.bags.length;C++)if(o=r.bags[C]){for(var v=0;v<o.inventory.length;v++)(t=o.inventory[v])&&(l++,p++,t.count&&(d+=t.count,m+=t.count));u+=o.inventory.length,h+=o.inventory.length}B.updateTabTally(a,l,u,d)}B.updateBankTally(s,p,h,m),B.createBankMenu(c)})}}else A.printError(A.PermissionEnum.Inventories)},servePossessions:function(){if(!V.requireCharacters("Possessions"))if(A.Data.Characters[0].bags){var e=$("#accDish_Possessions");if(!1!==A.reinitializeDish(e)){var t,a,n,i=B.createBank(e),r=B.getTabsContainer(i).append(I.cThrobber),o={},s=function(){r.empty();for(var e in Q.ItemEnum)t=B.createBankTab(r,{aTitle:D.getString(e)}),o[e]=B.getSlotsContainer(t);for(var e in A.Possessions)!function(e,t){Q.getItem(e,function(e){(a=o[e.type])&&(n=B.createBankSlot(a),B.styleBankSlot(n,{aItem:e,aSlotMeta:{count:t.oCount},aComment:A.getFoundString(t)}))})}(e,A.Possessions[e]);B.createBankMenu(r),B.tallyBank(i)};A.initializePossessions(function(){Q.getPricedItems(U.convertAssocToArray(A.Possessions),function(){s()})})}}else A.printError(A.PermissionEnum.Inventories)},serveCatalog:function(){B.generateCatalog("Catalog",{aIsCustomCatalog:!0})},serveCleanup:function(){B.generateCatalog("Cleanup",{aIsCollection:!1,aIsLookup:!0,aWantItems:!0,aWantGem:!1,aWantDefaultHelp:!1})},serveAscended:function(){B.generateCatalog("Ascended",{aWantPrices:!1,aWantGem:!1,aWantDefaultHelp:!1})},serveRecipes:function(){var e="Recipes";if(!V.requireCharacters(e))if(A.Data.Characters[0].recipes){var t=$("#accDish_Recipes");if(!1!==A.reinitializeDish(t)){var a=B.createBank(t,{aIsCollection:!0,aWantGem:!1}),n=B.getTabsContainer(a).append(I.cThrobber);U.getScript(U.URL_DATA.Recipes,function(){var t,a,i,r={},o=GW2T_RECIPES_METADATA,s=GW2T_RECIPES_DATA,c={},l={},u={};for(var d in s){t=d.split("_")[0];for(C=0;C<s[d].length;C++)m=s[d][C],u[m.i]=d,void 0===c[m.u]?c[m.u]={oItemID:m.i,oDisciplines:[t]}:c[m.u].oDisciplines.push(t)}var p=[];A.Data.Characters.forEach(function(e){p=U.getUnion(p,e.recipes);for(var n=0;n<e.recipes.length;n++)if(a=e.recipes[n],c[a]){i=c[a].oItemID;for(var r=c[a].oDisciplines,o="",s=0;s<r.length;s++)t=r[s],e.oCharCraft&&e.oCharCraft[t]&&(o+="<ins class='acc_craft acc_craft_"+t.toLowerCase()+"'></ins>");o.length&&(void 0===l[i]&&(l[i]=[]),l[i].push(e.oCharName+o))}});var h=D.getPhrase("crafted by",U.CaseEnum.Sentence)+": ";for(var d in s)for(C=0;C<s[d].length;C++){var m=s[d][C];l[m.i]?m.t="<var class='itmColor_reminder'>"+h+l[m.i].join(", ")+"</var>":delete m.t}var g,f=D.langFullySupported;for(var d in o.Disciplines)for(var C in o.Types)r[g=d+"_"+C]={},r[g]["name_"+f]=o.Disciplines[d][f]+" "+o.Types[C][f];$.getJSON(A.getURL(A.URL.Recipes),function(t){p=U.getUnion(p,t),B.generateUnlockables(n,{aHeaders:r,aRecord:s,aUnlockeds:p,aIsCollapsed:!0,aTabIterator:function(e){var t=e.split("_")[0],a=D.getObjectName(r[e]),i="<ins class='bnkTabIcon acc_craft acc_craft_"+t.toLowerCase()+"'></ins><ins class='bnkTabIcon acc_recipes acc_recipes_"+e.toLowerCase()+"'></ins>";return B.createBankTab(n,{aID:"rcpTab_"+e,aTitle:a,aIcon:i,aIsCollapsed:!0})}});var a=B.getBankSearch(e);Q.bindItemSearch(a,{aSubset:u,aFillerText:null,aCallback:function(e){var t="&quot;<a"+U.convertExternalAnchor(U.getWikiLinkLanguage(e.name))+">"+e.name+"</a>&quot;";if(l[e.id]){var a=l[e.id].join(", ");I.write(t+" was learned and can be crafted by:<br /><br />"+a)}else I.write("None of your characters have learned how to craft "+t);B.scrollToBankTab("#rcpTab_"+u[e.id])}})})})}}else A.printError(A.PermissionEnum.Inventories)},serveSAB:function(){var e="SAB";if(!V.requireCharacters(e)){var t=$("#accDish_SAB");if(!1!==A.reinitializeDish(t)){var a,n,i="sabProgressionBanner_",r=function(e,r){var o=B.createBank(t,{aIsCollection:!0,aWantGem:!1,aWantCoin:!1});A.createCharacterBanner(o,r,i);var s,c,l,u=B.getTabsContainer(o);for(var d in a){s=B.createBankTab(u,{aTitle:D.getObjectName(n[d])}),c=B.getSlotsContainer(s);for(var p in a[d])l=a[d][p],B.createPseudoSlot(c,{aName:l.n,aTooltip:l.t||l.n,aIcon:"img/account/sab/"+l.i+I.cPNG,aIsUnlocked:e[l.u],aLabel:l.l})}B.tallyBank(o),B.createBankDivider(o)},o=function(e){var t={};for(var a in e)for(var n in e[a])t[a+"_"+e[a][n].id]=!0;return t};t.prepend(I.cThrobber),U.getScript(U.URL_DATA.SAB,function(){n=U.getRecordHeader(e),a=U.getRecordData(e),U.fetchPattern(A.getURL(A.URL.CharactersSAB),A.Data.CharacterNames,{aCallback:function(a,n){if(I.removeThrobber(t),n){var s=[];for(var c in a){var l=a[c];if(l.zones&&l.unlocks&&l.songs&&(l.zones.length||l.unlocks.length||l.songs.length)){var u=A.getCharacterByName(c);s.push(u),r(o(a[c]),u)}}s.length>1&&A.createCharacterScroller(s,e,{aElementPrefix:i,aOffset:-120})}else A.printError(A.PermissionEnum.Progression)}})})}}},serveBank:function(){var e=$("#accDish_Bank");if(!1!==A.reinitializeDish(e)){var t,a,n,i,r,o=B.createBank(e),s=B.getTabsContainer(o).append(I.cThrobber),c=0,l=0,u=0,d=function(e){s.empty();for(var d=0;d<e.length;d++)0!==d&&r%A.Metadata.Bank.NumSlotsPerTab!=0||r===e.length||(a=B.createBankTab(s),n=B.getSlotsContainer(a)),r=d+1,i=B.createBankSlot(n),(t=e[d])?(i.data("count",t.count),c+=t.count,function(e,t){Q.getItem(t.id,function(a){B.styleBankSlot(e,{aItem:a,aSlotMeta:t,aCallback:function(){l++,A.setProgressBar(l,u)}})})}(i,t)):B.styleBankSlot(i);B.tallyBank(o),s.append("<div class='bnkTabSeparator'><var class='bnkTabLocked'>"+I.Symbol.Filler+"</var></div>"),B.createBankMenu(s)};$.getJSON(A.getURL(A.URL.Bank),function(e){var t=A.iterateInventory(e,function(){u++});Q.getPricedItems(t.oItemIDs,function(){Q.getSkins(t.oSkinIDs,function(){d(e)})})}).fail(function(t,a){A.printError(A.PermissionEnum.Inventories,a),e.empty()})}},serveVault:function(){var e=$("#accDish_Vault");if(!1!==A.reinitializeDish(e)){var t,a,n,i,r,o,s=B.createBank(e),c=B.getTabsContainer(s).append(I.cThrobber),l=[],u={0:D.getString("GuildStash"),1:D.getString("TreasureTrove"),2:D.getString("DeepCave")},d=function(){var e=[],d=0,p=0,h=0;for(var m in A.Data.Vaults){var g={},f=0;(r=A.Data.Vaults[m]).forEach(function(t){t.inventory.forEach(function(t){t&&(h++,void 0===g[t.id]&&(g[t.id]=!0,f++,e.push(t.id)))})}),r.oGuildID=m,r.oUniqueCount=f,l.push(r)}U.sortObjects(l,{aKeyName:"oUniqueCount",aIsDescending:!0}),Q.getPricedItems(e,function(){c.empty();for(var e in l)if(r=l[e],t=Q.getCachedGuild(r.oGuildID))for(var m=0;m<r.length;m++)o=r[m],a=B.createBankTab(c,{aTitle:t.oTag+" "+u[m]}),n=B.getSlotsContainer(a),o.inventory.forEach(function(e){i=B.createBankSlot(n),e?(i.data("count",e.count),d+=e.count,function(e,t){Q.getItem(t.id,function(a){B.styleBankSlot(e,{aItem:a,aSlotMeta:t,aCallback:function(){p++,A.setProgressBar(p,h)}})})}(i,e)):B.styleBankSlot(i)});B.tallyBank(s),B.createBankMenu(c)})};$.getJSON(A.getURL(A.URL.Account),function(e){A.Data.Account=e,A.initializeVault(function(e){e?d():c.empty()})}).fail(function(e,t){c.empty(),A.printError(A.PermissionEnum.Account,t)})}},serveMaterials:function(){var e="Materials",t=$("#accDish_"+e);if(!1!==A.reinitializeDish(t)){var a=B.createBank(t,{aIsCollection:!1,aWantGem:!1}),n=B.getTabsContainer(a).append(I.cThrobber),i=function(t){var a,i={};for(var r in t)(a=t[r]).count>0&&(i[a.id]={oCount:a.count});B.generateUnlockables(n,{aHeaders:U.getRecordHeader(e),aRecord:U.getRecordData(e),aUnlockeds:i,aWantSearchHighlight:!1,aWantDefaultHelp:!1})};U.getScript(U.URL_DATA.Materials,function(){$.getJSON(A.getURL(A.URL.Materials),function(t){Q.loadItemsSubdatabase(e.toLowerCase(),function(){i(t)})}).fail(function(e,a){A.printError(A.PermissionEnum.Inventories,a),t.empty()})})}},serveWardrobe:function(){var e=$("#accDish_Wardrobe");if(!1!==A.reinitializeDish(e)){var t,a,n,i="Wardrobe",r=D.getWordCapital("gallery"),o=function(e,n){var i=t[n].set||n,o=a[i],s=$("<aside class='bnkTabHover'></aside>").prependTo(e.find(".bnkTabSeparator"));if("string"==typeof o)$("<button class='bnkTabHoverButton'>"+r+"</button>").click(function(e){e.stopPropagation(),U.openExternalURL(o)}).appendTo(s);else{var c=0;for(var l in o)c++,function(e){$("<button class='bnkTabHoverButton'><img src='img/account/characters/"+l.toLowerCase()+".png' /></button>").click(function(t){t.stopPropagation(),U.openExternalURL(e)}).appendTo(s)}(o[l]),c%2==0&&s.append("<br />")}},s=B.createBank(e,{aIsCollection:!0}),c=B.getTabsContainer(s).append(I.cThrobber),l=function(e){a=GW2T_SKINS_GALLERIES,t=GW2T_SKINS_HEADERS,n=GW2T_SKINS_DATA,B.generateUnlockables(c,{aHeaders:t,aRecord:n,aUnlockeds:e,aIsCollapsed:!0,aTabIterator:function(e){var a=D.getObjectName(t[e]),n="<ins class='bnkTabIcon acc_wardrobe acc_wardrobe_"+e.toLowerCase()+"'></ins>",i=B.createBankTab(c,{aID:"wrdTab_"+e,aTitle:a,aIcon:n,aIsCollapsed:!0});return o(i,e),i}});var r={};A.iterateRecord(n,function(e,t){r[e.i]=t}),Q.bindItemSearch(B.getBankSearch(i),{aSubset:r,aFillerText:null,aCallback:function(e){B.scrollToBankTab("#wrdTab_"+r[e.id])}})};U.getScript(U.URL_DATA.Skins,function(){$.getJSON(A.getURL(A.URL.Skins),function(e){l(e)}).fail(function(t,a){A.printError(A.PermissionEnum.Unlocks,a),e.empty()})})}},serveUnlockables:function(e,t){var a=e,n=$("#accDish_"+a);if(!1!==A.reinitializeDish(n)){var i=t||{},r=B.createBank(n,{aIsCollection:!0,aWantGem:i.aWantGem}),o=B.getTabsContainer(r).append(I.cThrobber),s=function(e){B.generateUnlockables(o,{aHeaders:U.getRecordHeader(a),aRecord:U.getRecordData(a),aUnlockeds:e,aWantPrices:!1!==i.aWantPrices,aCallback:i.aCallback})};U.getScript(U.URL_DATA[a],function(){$.getJSON(A.getURL(A.URL[a]),function(e){Q.loadItemsSubdatabase(a.toLowerCase(),function(){s(e)})}).fail(function(e,t){A.printError(i.aPermission||A.PermissionEnum.Unlocks,t),n.empty()})})}},serveOutfits:function(){V.serveUnlockables("Outfits",{aWantPrices:!1})},serveGliders:function(){V.serveUnlockables("Gliders",{aWantPrices:!1})},serveMinis:function(){V.serveUnlockables("Minis")},serveCarriers:function(){V.serveUnlockables("Carriers")},serveChampions:function(){V.serveUnlockables("Champions")},serveFinishers:function(){V.serveUnlockables("Finishers")},serveNodes:function(){V.serveUnlockables("Nodes")},serveCats:function(){V.serveUnlockables("Cats",{aPermission:A.PermissionEnum.Progression,aWantGem:!1,aCallback:function(e){A.embedFrame("#accDish_Cats",G.getCollectibleURL(X.Collectibles.HungryCats,e.aUnlockAssoc))}})},serveRaids:function(){V.serveUnlockables("Raids",{aPermission:A.PermissionEnum.Progression,aWantPrices:!1,aWantGem:!1,aCallback:function(){T.isChecklistCountdownsStarted=!0,$("#accDish_Raids").prepend("<div class='accCountdown jsCountdownToWeekly'></div>")}})},serveDungeons:function(){V.serveUnlockables("Dungeons",{aPermission:A.PermissionEnum.Progression,aWantPrices:!1,aWantGem:!1,aCallback:function(){T.isChecklistCountdownsStarted=!0,$("#accDish_Dungeons").prepend("<div class='accCountdown jsCountdownToDaily'></div>")}})},serveDyes:function(){var e=$("#accDish_Dyes");if(!1!==A.reinitializeDish(e)){var t=B.createBank(e,{aClass:"bnkBankDyes",aIsPseudo:!0}),a=B.getTabsContainer(t).append(I.cThrobber);U.getScript(U.URL_DATA.Dyes,function(){$.getJSON(A.getURL(A.URL.Dyes),function(e){B.generateUnlockables(a,{aHeaders:GW2T_DYES_HEADERS,aRecord:GW2T_DYES_DATA,aUnlockeds:e,aWantDefaultHelp:!1,aWantSearchHighlight:!1,aIsDyes:!0})}).fail(function(t,a){A.printError(A.PermissionEnum.Unlocks,a),e.empty()})})}},serveAchievements:function(){var e=$("#accDish_Achievements");if(!1!==A.reinitializeDish(e)){var t="Achievements",a={},n=[],i=function(i){I.removeThrobber(e);var r,o,s,c,l,u,d,p,h=B.createBank(e,{aIsPseudo:!0}),m=B.getTabsContainer(h),g={},f={},C=function(e){r=B.createBankTab(m,{aID:"achTab_"+e.id,aTitle:e.name,aIcon:"<img class='bnkTabIcon' src='"+e.icon+"' />"});for(var t=0;t<e.achievements.length;t++)c=e.achievements[t],(l=Q.getBoxedAchievement(c))&&(g[c]=!0,u=l.oData,d=a[c],p=Q.processAchievement(u,d),B.updateSlotPrice(r,{aIsTab:!0,aCount:d&&d.done?1:0,aPrice:p.oAPPointCurrent,aPossible:p.oAPPointPossible,aPaymentEnum:"achievement"}),void 0===u.icon&&(u.icon=e.icon),u.oCategoryName=e.name,u.oCategoryID=e.id,u.keywords=u.name.toLowerCase()+" "+e.name.toLowerCase(),n.push(u));!function(t){t.find(".bnkTabSeparator").one("click",function(){for(var n=B.getSlotsContainer(t),i=0;i<e.achievements.length;i++)c=e.achievements[i],(l=Q.getBoxedAchievement(c))&&(u=l.oData,d=a[c],p=Q.processAchievement(u,d),o=B.createPseudoSlot(n,{aID:"achSlot_"+c,aIsUnlocked:!(!d||!d.done),aName:u.name,aLabel:u.name,aIcon:e.icon,aPayment:{achievement:p.oAPPointCurrent},aIsTab:!1,aPossible:p.oAPPointPossible,aCard:Q.analyzeAchievement(u,{aAchievement:p,aWantCard:!0}),aTooltip:Q.analyzeAchievement(u,{aAchievement:p}),aKeywords:e.name+" "+u.name+" "+u.requirement}),p.oAPCountCurrent/p.oAPCountPossible<1&&p.oAPCountPossible>1&&o.append("<var class='bnkSlotCount'>"+p.oAPCountCurrent+"/"+p.oAPCountPossible+"</var>"),function(e,t,a){o.contextmenu(function(n){n.preventDefault(),I.prettyJSON(e),I.prettyJSON(t),I.prettyJSON(a)})}(u,d,p))})}(r)};i.forEach(function(e){f[e.id]=e}),A.Metadata.AchievementCategories.forEach(function(e){if("object"==typeof e)B.createTabDivider(m,{aTitle:D.getObjectTranslation(e)});else if(s=f[e])C(s),delete f[e];else if(-1===e){var t={name:"",icon:"img/ui/unknown.png",achievements:[]};for(var a in Q.Boxes.Achievements)void 0===g[a]&&t.achievements.push(a);C(t)}});for(var v in f)C(f[v]);B.tallyBank(h),B.createBankDivider(h),B.createBankMenu(m,{aIsPseudo:!0,aIsCollapsed:!0,aWantCard:!0,aWantSearchHighlight:!0}),$.getJSON(A.getURL(A.URL.Account),function(e){var t=B.getBankPrice(h),a=e.daily_ap,n=e.monthly_ap;h.find(".bnkPrice").append("<div class='achBankTotal'>"+E.formatAchievement(t[0])+" + "+a.toLocaleString()+"<img class='css24' src='img/account/summary/daily.png' /> + "+n.toLocaleString()+"<img class='css24' src='img/account/summary/monthly.png' /> = <var class='achBankActual'>"+E.formatAchievement(t[0]+a+n)+"</var> / "+E.formatAchievement(t[0]+t[1]+Q.GameLimit.DailyAP)+"</div>")}),Q.bindItemSearch(B.getBankSearch(t),{aDatabase:n,aFillerText:null,aAchievements:a,aCallback:function(e){B.showBankTab($("#achTab_"+e.oCategoryID)),I.scrollToElement($("#achSlot_"+e.id),{aOffset:-A.getOverheadHeight(),aSpeed:"fast"})}})};e.prepend(I.cThrobber),U.getJSON(A.getURL(A.URL.Achievements),function(e){e.forEach(function(e){a[e.id]=e}),U.getJSON(U.getAPI("achievements/categories",!0),function(e){U.getJSON(U.getCacheURL(t),function(a){Q.initializeBoxes(t,a),i(e)})})}).fail(function(){A.printError(A.PermissionEnum.Progression)})}},serveMasteries:function(){var e=$("#accDish_Masteries");if(!1!==A.reinitializeDish(e)){var t={},a=function(a){I.removeThrobber(e);var n,i,r,o,s=B.createBank(e,{aIsPseudo:!0}),c=B.getTabsContainer(s);a.forEach(function(e){n=B.createBankTab(c,{aTitle:e.name}),i=B.getSlotsContainer(n);for(var a=0;a<e.levels.length;a++)o=e.levels[a],r=B.createPseudoSlot(i,{aIsUnlocked:t[e.id+"_"+a],aName:o.name,aIcon:o.icon,aLabel:o.name,aTooltip:Q.analyzeAchievement(o,{aClass:"itmTooltipMastery",aWantIcon:!0}),aCard:Q.analyzeAchievement(o,{aWantCard:!0}),aPayment:{mastery:o.point_cost}})}),B.tallyBank(s),B.createBankDivider(s),B.createBankMenu(c,{aIsPseudo:!0,aWantCard:!0})};e.prepend(I.cThrobber),U.getJSON(U.getAPI("masteries",!0),function(e){U.getJSON(A.getURL(A.URL.Masteries),function(n){n.forEach(function(e){for(var a=0;a<=e.level;a++)t[e.id+"_"+a]=!0}),a(e)}).fail(function(){A.printError(A.PermissionEnum.Progression)})})}},generateExchange:function(){var e=$("#accTrading"),t=100,a=200,n=$("#exgGoldSamples"),i=$("#exgGemSamples"),r=function(e){e.find("tr").each(function(e){$(this).css({opacity:0}).delay(e*(t/2)).animate({opacity:1},t)})},o=function(){setTimeout(function(){e.find(".cssBlur").removeClass("cssBlur")},a)},s=function(){n.empty().html(I.cThrobber),i.empty().html(I.cThrobber),E.updateExchangeRatios(function(){n.empty(),A.Metadata.Exchange.GoldSamples.forEach(function(e){n.prepend("<tr><td>"+e.toLocaleString()+"<img class='exgUnit' src='img/account/trading/gold_small.png' /></td><td>"+E.formatCoinToGem(e*E.Exchange.COPPER_IN_GOLD)+"</td><td>"+E.formatGemToMoney(E.convertCoinToGem(e*E.Exchange.COPPER_IN_GOLD))+"</td></tr>")}),r(n),i.empty(),A.Metadata.Exchange.GemSamples.forEach(function(e){i.prepend("<tr><td>"+e.toLocaleString()+"<img class='exgUnit' src='img/account/trading/gem_small.png' /></td><td>"+E.formatGemToCoin(e)+"</td><td>"+E.formatGemToMoney(e)+"</td></tr>")}),r(i)})};I.loadImg(e),$("#exgGoldTitle").text(D.getPhraseOriginal("Get Coin")),$("#exgGemTitle").text(D.getPhraseOriginal("Get Gem")),s();var c=$("#exgGoldCustom"),l=$("#exgGemCustom"),u=c.find(".exgCustomInput"),d=l.find(".exgCustomInput"),p=c.find(".exgCustomOutput0"),h=c.find(".exgCustomOutput1"),m=l.find(".exgCustomOutput0"),g=l.find(".exgCustomOutput1");u.on("input",$.throttle(Q.cSEARCH_LIMIT,function(){var e=parseInt($(this).val());e>0&&E.updateGemInCoin(function(){p.html(E.formatCoinToGem(e*E.Exchange.COPPER_IN_GOLD)).addClass("cssBlur"),h.html(E.formatGemToMoney(E.convertCoinToGem(e*E.Exchange.COPPER_IN_GOLD))).addClass("cssBlur"),o()})})).trigger("input"),d.on("input",$.throttle(Q.cSEARCH_LIMIT,function(){var e=parseInt($(this).val());e>0&&E.updateGemInCoin(function(){m.html(E.formatGemToCoin(e)).addClass("cssBlur"),g.html(E.formatGemToMoney(e)).addClass("cssBlur"),o()})})).trigger("input");var f=$("#exgItemSearch"),C=$("#exgItemQuantity"),v=$("#exgItemPriceType"),b=function(e){var t;e?(t=e,f.data("price",e)):t=f.data("price");var a=T.parseQuantity(C.val())*t,n=a>E.Exchange.COPPER_IN_GOLD?Math.ceil(a/E.Exchange.COPPER_IN_GOLD):1;u.val(n).trigger("input")};Q.bindItemSearch(f,{aCallback:function(e){E.getPrice(e.id,function(e){var t=v.prop("checked")?e.oPriceSell:e.oPriceBuy;b(t)})}}),C.change(function(){b()}),$("#exgReload").click(function(){u.trigger("input"),d.trigger("input"),s()})},generateRecent:function(){$("#trsRecentTitle").text(D.getPhraseOriginal("Recent"));var e,t,a,n=$("#trsRecentTable"),i=$("#trsRecentReload"),r=20,o=D.getWordCapital("bought"),s=D.getWordCapital("sold"),c=function(){var e=(new Date).getTime();n.empty(),i.removeClass("jsSuspended"),A.adjustAccountScrollbar(),a.forEach(function(t){var a=Q.getCachedItem(t.item_id),i=$("<tr></tr>").appendTo(n),r=new Date(t.purchased).toLocaleString(),c=t.isBought?o:s,l=t.quantity>1?"<var class='trsRecentCount'>"+t.quantity+"</var>":"";i.html("<td><span class='trsRecentItem'><span class='trsRecentSlot'><img class='trsRecentIcon' src='"+a.icon+"' />"+l+"</span><span class='trsRecentName'><var class='trsRecentType'>"+c+"</var>: <var class='"+Q.getRarityClass(a.rarity)+"'>"+a.name+"</var></span></span><span><var class='trsRecentTime' title='"+r+"'>"+T.formatMilliseconds(e-new Date(t.purchased).getTime())+"</var><var class='trsRecentPrice'>"+E.formatCoinStringColored(t.quantity*t.price)+"</var></span></td>");var u=i.find(".trsRecentSlot");I.qTip.init(i.find(".trsRecentTime")),Q.scanItem(a,{aElement:u}),Q.bindItemSlotBehavior(u,{aItem:a,aWantClick:!0})})},l=function(){n.html("<tr><td class='trsRecentError'>"+D.getPhraseOriginal("No transactions")+".</td></tr>"),i.removeClass("jsSuspended")},u=function(){n.empty().html(I.cThrobber),U.getJSON(A.getURL(A.URL.HistoryBuys),function(n){e=n,U.getJSON(A.getURL(A.URL.HistorySells),function(n){t=n;for(var i=0;i<e.length;i++)e[i].isBought=!0;a=e.concat(t),U.sortObjects(a,{aKeyName:"purchased",aIsDescending:!0});var o=[];(a=a.slice(0,r)).forEach(function(e){o.push(e.item_id)}),Q.getItems(o,function(){c()})},!1).fail(function(){l()})},!1).fail(function(){l()})};u(),i.click(function(){u(),$(this).addClass("jsSuspended")})},generateDelivery:function(){$("#trsDeliveryTitle").text(D.getPhraseOriginal("Delivery"));var e,t,a,n=$("#trsDeliveryTable"),i=$("#trsDeliveryTally"),r=$("#trsDeliveryReload"),o=function(){n.empty(),r.removeClass("jsSuspended"),A.adjustAccountScrollbar();for(var o in e){var s=o,c=e[o],l=Q.getCachedItem(s),u=E.getCachedPrice(s),d=$("<tr></tr>").appendTo(n),p=c>1?"<var class='trsRecentCount'>"+c+"</var>":"";d.html("<td><span class='trsRecentItem'><span class='trsRecentSlot'><img class='trsRecentIcon' src='"+l.icon+"' />"+p+"</span><span class='trsRecentName'><var class='"+Q.getRarityClass(l.rarity)+"'>"+l.name+"</var></span></span><span><var class='trsRecentPrice'>"+I.Symbol.Approx+" "+E.formatCoinStringColored(c*u.oPriceSell)+"</var></span></td>");var h=d.find(".trsRecentSlot");Q.scanItem(l,{aElement:h}),Q.bindItemSlotBehavior(h,{aItem:l,aWantClick:!0})}i.html("<span id='trsDeliveryCount'>"+D.getWordCapital("transactions")+": "+t.length+"</span><span id='trsDeliveryCoin'>"+D.getWordCapital("coin")+": "+E.formatCoinStringColored(a)+"</span>")},s=function(){n.html("<tr><td class='trsRecentError'>"+D.getPhraseOriginal("No delivery items")+".</td></tr>"),r.removeClass("jsSuspended")},c=function(){n.empty().html(I.cThrobber),i.empty(),U.getJSON(A.getURL(A.URL.Delivery),function(n){if(t=n.items,(a=n.coins)>0||t.length>0){e={};for(var i in t){var r=t[i].id;void 0===e[r]&&(e[r]=0),e[r]+=t[i].count}Q.getPricedItems(U.convertAssocToArray(e),function(){o()})}else s()},!1).fail(function(){s()})};c(),r.click(function(){c(),$(this).addClass("jsSuspended")})},serveTrading:function(){var e=$("#accDish_Trading");if(e.data("isloaded"))e.data("token")!==A.TokenCurrent&&(e.data("token",A.TokenCurrent),$("#trsRecentReload").trigger("click"),$("#trsDeliveryReload").trigger("click"));else{V.generateExchange(),V.generateRecent(),V.generateDelivery();var t=I.bindInputSelect(e.find("input"));I.qTip.init(t),e.data("isloaded",!0),X.rewrapCheckboxes()}},serveGem:function(){var e=$("#accDish_Gem");if(!1!==A.reinitializeDish(e)){var t="Gem",a=B.createBank(e,{aIsCollection:!0,aWantCoin:!1}),n=B.getTabsContainer(a).append(I.cThrobber),i={},r={},o={},s=function(e,t){var a=t.id;e.find(".bnkSlotSymbol").hasClass("bnkSlotSymbolActive")?(c(e,!1),H.unsubscribeGem(a)):(X.setCheckboxEnumState($("#opt_bol_alertGem"),X.ChecklistEnum.Checked),H.isGemPaused=!1,r[a]?(H.subscribeGemDiscounted(a),I.write(U.escapeHTML(t.name)+D.getPhraseOriginal(" is available - Alarm when item is discount"))):(H.subscribeGemAvailable(a),I.write(U.escapeHTML(t.name)+D.getPhraseOriginal(" is not available - Alarm when item is available"))),c(e,!0)),H.saveGemSubscription()},c=function(e,t,a){if(e){var i=e.find(".bnkSlotSymbol");i.removeClass("bnkSlotSymbolActive"),t?(i.addClass("bnkSlotSymbolActive"),e.data("ismarked",!0)):e.data("ismarked",!1)}else n.find(".bnkSlotSymbol").removeClass("bnkSlotSymbolActive"),n.find(".bnkSlot").data("ismarked",!1);if(a){var r=o[a.id],s=H.Sale.Values[a.id];void 0!==r&&s>=0&&(e.data("ismarked",!0),s<Math.abs(r)||0===s?(e.addClass("bnkSlotDiscount"),e.append("<var class='bnkSlotPriceBuy'>"+E.formatGemString(Math.abs(r),!0)+"</var>")):s&&e.addClass("bnkSlotAvailable"))}},l=function(){var a=U.getRecordData(t);A.iterateRecord(a,function(e){var t=e.i;i[t]=!0,e.u=t;var a=e.p,n=H.Sale.Values[t];if(a)for(var s in a){o[t]=a[s],n>=0&&n<=Math.abs(a[s])&&(a[s]=n,r[t]=!0),a[s]<=0?a[s]=-1*a[s]:r[t]=!0;break}});for(var l in H.GemSubscription)void 0===i[l]&&delete H.GemSubscription[l];B.generateUnlockables(n,{aHeaders:U.getRecordHeader(t),aRecord:a,aUnlockeds:r,aWantGemConvert:!0,aWantDefaultHelp:!1,aWantSearchHighlight:!1,aBind:function(e,t){var a=t.id,n=$("<img class='bnkSlotSymbol curToggle' src='img/ui/menu/alarm.png' />").appendTo(e);c(e,H.isGemSubscribed(a),t),I.isTouchEnabled?e.unbind("click").click(function(){s(e,t)}):n.click(function(a){a.stopPropagation(),s(e,t)})}});var u=$("<div class='cssCenter'></div>").prependTo(e),d=$("#accDishMenu_Gem");$("<button class='accButton'>"+D.getPhraseOriginal("Help")+"</button>").appendTo(u).click(function(){d.find(".bnkButtonHelp").trigger("click")}),$("<button class='accButton curToggle'>"+D.getPhraseOriginal("View Subscription")+"</button>").appendTo(u).click(function(){d.find(".bnkButtonEmpty").trigger("click").trigger("click")}),$("<button class='accButton'>"+D.getPhraseOriginal("Clear Subscription")+"</button>").appendTo(u).click(function(){confirm("Delete all gem store subscriptions?")&&(I.write(D.getPhraseOriginal("Gem alarm and subscription off")),H.initializeGemSubscription(!0),X.setCheckboxEnumState($("#opt_bol_alertGem"),X.ChecklistEnum.Unchecked),c())})};H.updateGemSubscription(function(){Q.loadItemsSubdatabase(t.toLowerCase(),function(){l()})})}},serveMuseum:function(){var e=$("#accDish_Museum");if(!1!==A.reinitializeDish(e)){var t=B.createBank(e,{aIsCollection:!0,aWantGem:!1}),a=B.getTabsContainer(t).append(I.cThrobber);U.getScript(U.URL_DATA.Museum,function(){B.generateUnlockables(a,{aRecord:U.getRecordData("Museum"),aIsCollapsed:!0,aWantSearchHighlight:!1,aWantDefaultHelp:!1}),setTimeout(function(){e.find(".bnkTabSeparator").first().trigger("click")},400)})}},servePact:function(){var e=$("#accDish_Pact");if(!1!==A.reinitializeDish(e)){$("<div id='pctBank'></div><div id='pctStatistics' data-date='2015-2016'><div class='bnkTitle cssCenter'>Statistics</div><br /><table id='pctStatTable'></table></div>").appendTo(e);var t,a,n,i,r="Pact",o=B.createBank($("#pctBank")),s=B.getTabsContainer(o).append(I.cThrobber),c=0,l=0,u=H.Pact.Products,d={},p={},h=0,m=0;U.convertExternalLink("#accDish_Pact a");var g=function(){var e=$("#pctStatTable").append("<tr class='pctTableHeader'><th></th><th>Occurrence</th><th>Recipe</th><th>Price</th><th></th></tr>");for(var t in u)Q.getItem(u[t],function(a){var n=U.escapeHTML(a.name),i=E.Pricelist[t],r=i?i.oPriceSell:0,o=i?E.formatCoinStringColored(i.oPriceSell):E.formatKarmaString(H.Pact.Prices[t]||H.Pact.PriceDefault);e.append("<tr class='pctStatRow cssStats'><td class='pctStatCount' data-value='"+d[t]+"'>"+d[t]+"</td><td data-value='"+d[t]+"'>"+I.getBar(d[t]/h*T.cPERCENT_100,!0)+"</td><td class='pctStatName' data-value='"+n+"' title='"+p[t]+"'><a class='"+Q.getRarityClass(a.rarity)+"'"+U.convertExternalAnchor(U.getTradingItemLink(t,a.name))+"'>"+n+"</a></td><td data-value='"+r+"'>"+I.getBar((i?i.oPriceSell:0)/m*T.cPERCENT_100)+"</td><td class='pctStatPrice' data-value='"+r+"'>"+o+"</td></tr>")});I.qTip.init(".pctStatName"),I.bindSortableTable(e,{aPresortColumn:4})},f=function(){i=GW2T_PACT_DATA;for(var e in i)for(var r=i[e],f={},C=0;C<r.length;C++){var v=r[C];void 0===d[v]&&(d[v]=0,p[v]=""),void 0===f[v]&&(d[v]++,p[v]+=e+"<br />",f[v]=!0),d[v]>h&&(h=d[v])}var b=[];for(var e in u)b.push(e),b.push(u[e]);l=b.length,Q.getPricedItems(b,function(){s.empty(),t=B.createBankTab(s,{aTitle:$("#pctStatistics").attr("data-date")}),a=B.getSlotsContainer(t);for(var e=0;e<b.length;e++){var i=b[e],r=d[i]||1;(n=B.createBankSlot(a)).data("count",1),function(e,t){Q.getItem(t.id,function(a){B.styleBankSlot(e,{aItem:a,aSlotMeta:t,aCallback:function(){c++,A.setProgressBar(c,l)}})})}(n,{id:i,count:-r}),d[i]&&E.getPriceObject(i,function(e){e&&e.oPriceSell>m&&(m=e.oPriceSell)})}B.tallyBank(o),B.createBankMenu(s,{aIsCollection:!0}),g()})};U.getScript(U.URL_DATA.Pact,function(){Q.loadItemsSubdatabase(r.toLowerCase(),function(){f()})})}},serveBuying:function(){B.generateTransactions("Buying",A.URL.CurrentBuys)},serveSelling:function(){B.generateTransactions("Selling",A.URL.CurrentSells)},serveBought:function(){B.generateTransactions("Bought",A.URL.HistoryBuys)},serveSold:function(){B.generateTransactions("Sold",A.URL.HistorySells)}},B={createBank:function(e,t){var a=t||{};a.aIsPseudo&&(a.aIsCollection=!0,a.aWantGem=!1);var n=$("<div "+(a.aID?"id='"+a.aID+"'":"")+" class='bnkContainer'><div class='bnkTop'>"+(a.aTitle?"<aside class='bnkTitle'>"+a.aTitle+"</aside>":"")+"<aside class='bnkBankTally'></aside>"+(!1!==a.aWantCoin?"<aside class='bnkPrice'><var class='bnkPriceTitleA'></var><var class='bnkPriceValueA_Coin'></var> &nbsp; <var class='bnkPriceTitleB'></var><var class='bnkPriceValueB_Coin'></var></aside>":"")+(a.aIsCollection&&!1!==a.aWantGem?"<aside class='bnkGem'><var class='bnkPriceTitleA'></var><var class='bnkPriceValueA_Gem'></var> &nbsp; <var class='bnkPriceTitleB'></var><var class='bnkPriceValueB_Gem'></var></aside>":"")+"</div></div>").appendTo(e);if($("<div class='bnkBank "+(a.aClass||"")+"'></div>").appendTo(n).css({width:(a.aSlotsPerRow||A.Metadata.Bank.NumSlotsHorizontal)*B.getBankSlotWidth()+"px"}),a.aIsCollection){var i=D.getWordCapital("unlocked")+": +",r=D.getWordCapital("locked")+": −";n.data("iscollection",!0),n.find(".bnkPriceTitleA").html(i),n.find(".bnkPriceTitleB").html(r),n.find(".bnkPriceValueA_Coin").html(E.formatCoinStringColored(0)),n.find(".bnkPriceValueB_Coin").html(E.formatCoinStringColored(0)),n.find(".bnkPriceValueA_Gem").html(E.formatGemString(0,!0)),n.find(".bnkPriceValueB_Gem").html(E.formatGemString(0,!0))}return n},getBankContainer:function(e){return e.closest(".bnkContainer")},getTabsContainer:function(e){return e.find(".bnkBank")},createBankDivider:function(e){e.append("<div class='bnkDivider'></div>")},getBankSlotWidth:function(e){return(void 0!==e?e:O.Options.bol_condenseBank)?A.Metadata.Bank.SlotWidthCondensed:A.Metadata.Bank.SlotWidth},createBankTab:function(e,t){var a=t||{},n=$("<div class='bnkTab'></div>"),i=a.aIcon?a.aIcon:"",r=a.aTitle?"<var class='bnkTabText'>"+a.aTitle+"</var>":"",o=$("<div class='bnkTabSeparator curToggle'><aside class='bnkTabHeader'>"+i+r+"<var class='bnkTabPrice bnkTabPrice_Coin'></var><var class='bnkTabPrice bnkTabPrice_Gem'></var><var class='bnkTabToggle'></var><var class='bnkTabTally'></var></aside></div>").appendTo(n),s=o.find(".bnkTabToggle"),c=$("<div class='bnkTabSlots'></div>").appendTo(n);return o.click(function(){B.toggleBankTab(n)}),a.aID&&n.attr("id",a.aID),a.aIsCollapsed&&(I.toggleToggleIcon(s,!1),c.hide()),a.aIsCustomCatalog?B.placeCatalogTab(e,n,a.aWantPrepend):a.aWantPrepend?e.prepend(n):e.append(n),n},getSlotsContainer:function(e){return e.find(".bnkTabSlots")},toggleBankTab:function(e,t,a){var n=e.hasClass("bnkBank")?e.find(".bnkTab"):e,i=B.getSlotsContainer(n),r="boolean"==typeof t?t:!i.is(":visible");r?(a&&B.toggleBankTab(n.closest(".bnkBank"),!1),i.slideDown("fast",function(){A.adjustAccountScrollbar()})):i.slideUp("fast",function(){A.adjustAccountScrollbar()}),I.toggleToggleIcon(n.find(".bnkTabToggle"),r)},showBankTab:function(e){!1===B.getSlotsContainer(e).is(":visible")&&e.find(".bnkTabSeparator").trigger("click")},scrollToBankTab:function(e){var t=$(e);B.showBankTab(t),I.scrollToElement(t,{aOffset:-A.getOverheadHeight(),aSpeed:"fast"}),setTimeout(function(){I.scrollToElement(t,{aOffset:-A.getOverheadHeight()}),B.refreshBankSearch(A.getDishName(t))},2e3)},createTabDivider:function(e,t){var a=t||{},n=a.aTitle?"<var class='bnkTabDividerText'>"+a.aTitle+"</var>":"";$("<div class='bnkTabDivider'><aside class='bnkTabHeader'>"+n+"</aside></div>").appendTo(e)},getTallyString:function(e,t,a){var n=a?" "+a+I.Symbol.Quantity:"",i=e/t,r=1===i?"accSignificant":"accTrivial";return(1===i?"":"<span class='accTrifle'>"+(t-e)+"+</span>")+e+" / "+t+"<span class='"+r+"'> ("+U.convertRatioToPercent(i)+")"+n+"</span>"},updateTabTally:function(e,t,a,n){e.find(".bnkTabTally").html(B.getTallyString(t,a,n))},updateBankTally:function(e,t,a,n){e.find(".bnkBankTally").html(B.getTallyString(t,a,n))},tallyBank:function(e){var t=0,a=0,n=0,i=e.data("iscollection");B.getSlotsContainer(e).each(function(){var e=$(this).parent(),r=0,o=0,s=0,c=e.data("tabcount"),l=e.data("tabfill"),u=e.data("tabcapacity");if(void 0!==l)r+=c,t+=c,o+=l,s=u;else{var d=$(this).find(".bnkSlot");d.each(function(){var e=$(this).data("count");e&&(r+=e,t+=e,o++)}),s=d.length}i&&(r=0),B.updateTabTally(e,o,s,r),a+=o,n+=s}),i&&(t=0),B.updateBankTally(e,a,n,t)},createInventorySidebar:function(e,t){if(void 0!==t){e.addClass("bnkTabInventory");var a=$("<div class='bnkSidebarContainer'></div>").prependTo(e),n=$("<div class='bnkSidebar'></div>").prependTo(a);$("<div class='bnkSidebarBorder'></div>").appendTo(a);var i,r,o=$("<div class='bnkSidebarColumn'></div>").appendTo(n);t.forEach(function(e){if(e){for(var t=0,a=0;a<e.inventory.length;a++)e.inventory[a]&&t++;i=$("<div class='bnkSidebarBagOuter'></div>").appendTo(o),function(t){Q.getItem(e.id,function(e){t.css({backgroundImage:"url("+e.icon+")"}),Q.scanItem(e,{aElement:t}),Q.bindItemSlotBehavior(t,{aItem:e,aWantClick:!0})})}(r=$("<span class='bnkSidebarBag'><var class='bnkSidebarBagCount'>"+t+"/"+e.size+"</var></span>").appendTo(i))}else i=$("<div class='bnkSidebarBagOuter'></div>").appendTo(o),r=$("<span class='bnkSidebarBag'><var class='bnkSidebarBagCount'></var></span>").appendTo(i)})}},createBankSlot:function(e,t){var a=document.createElement("span");return a.innerHTML="<var class='bnkSlotBackground "+(t||"")+"'></var><var class='bnkSlotIcon'></var><var class='bnkSlotForeground'></var>",a.className="bnkSlot",e[0].appendChild(a),$(a)},createPseudoSlot:function(e,t){var a=t||{},n=B.createBankSlot(e),i=0;if(a.aID&&n.attr("id",a.aID),a.aName&&n.click(function(e){e.which===I.ClickEnum.Left&&U.openExternalURL(U.getWikiSearchDefault(a.aName))}),a.aTooltip&&(n.attr("title",a.aTooltip),I.qTip.init(n)),a.aIcon&&n.find(".bnkSlotIcon").css({backgroundImage:"url("+a.aIcon+")"}),a.aIsUnlocked||n.addClass("bnkSlotZero"),a.aIsUnlocked&&(i=a.aCount||1),void 0!==a.aCount&&n.append("<var class='bnkSlotCount'>"+a.aCount+"</var>"),a.aLabel&&n.append("<var class='bnkSlotLabel'>"+a.aLabel+"</var>"),a.aPayment)for(var r in a.aPayment)B.updateSlotPrice(n,{aIsTab:a.aIsTab,aPrice:a.aPayment[r],aPossible:a.aPossible,aCount:i,aPaymentEnum:r});return a.aCard&&n.after("<span class='bnkCard itmTooltip cssTooltip'>"+a.aCard+"</span>"),n.data("keywords",$("<div>"+(a.aKeywords||a.aTooltip||"").toLowerCase()+"</div>").text()),n.data("count",i),n},createBankCard:function(e,t){var a=t||{},n=document.createElement("span");return n.innerHTML=a.aHTML,n.className="bnkCard",e[0].appendChild(n),$(n)},styleBankSlot:function(e,t){var a=t||{};if(t){var n=1,i=1;a.aSlotMeta.count>=0?(n=a.aSlotMeta.count,i=n):a.aSlotMeta.count<0&&(n=-1*a.aSlotMeta.count,i=1);var r=null,o={upgrades:!0,infusions:!0,skin:!0,bound_to:!0};for(var s in a.aSlotMeta)if(o[s]){r=a.aSlotMeta;break}Q.scanItem(a.aItem,{aElement:e,aItemMeta:r,aComment:a.aComment,aCallback:function(t){var o=t.oSkin?t.oSkin.icon:a.aItem.icon;e.find(".bnkSlotIcon").css({backgroundImage:"url("+o+")"}).addClass("bnkSlotRarity_"+a.aItem.rarity);var s=($(t.oHTML).text()+" "+D.getString(a.aItem.rarity)).toLowerCase();e.data("keywords",s),e.data("itemid",a.aItem.id),r&&r.skin&&e.data("skinid",r.skin);var c=a.aWiki||a.aItem.name,l=a.aWiki?U.getWikiSearchDefault(c):U.getWikiSearchLanguage(c);if(e.click(function(e){e.which===I.ClickEnum.Left&&U.openExternalURL(l)}),a.aBind?a.aBind(e,a.aItem):a.aIsCustomCatalog&&B.bindCatalogSlot(e),Q.bindItemSlotBehavior(e,{aItem:a.aItem,aTradeableID:a.aTradeableID,aSearch:c}),a.aLabel&&a.aLabel.length&&e.append("<var class='bnkSlotLabel'>"+a.aLabel+"</var>"),n>1){var u=n%Q.GameLimit.StackSize==0?"bnkSlotCountMax":"";e.append("<var class='bnkSlotCount "+u+"'>"+n+"</var>")}else("Tool"===a.aItem.type||"Gathering"===a.aItem.type)&&a.aSlotMeta&&a.aSlotMeta.charges&&e.append("<var class='bnkSlotCount'>"+a.aSlotMeta.charges+"</var>");if(0===n?(e.addClass("bnkSlotZero"),e.data("count",n)):e.data("count",n),a.aPrice>0)B.updateSlotPrice(e,{aPrice:a.aPrice,aCount:i,aPaymentEnum:E.PaymentEnum.Coin});else if(a.aGem>0)B.updateSlotPrice(e,{aPrice:a.aGem,aCount:i,aPaymentEnum:E.PaymentEnum.Gem,aWantGemConvert:a.aWantGemConvert});else if(t.oIsTradeable||a.aTradeableID){e.addClass("bnkSlotTradeable"),e.data("istradeable",!0);var d=a.aTradeableID||a.aItem.id;E.getPriceObject(d,function(t){B.updateSlotPrice(e,{aPrice:t,aCount:i,aPaymentEnum:E.PaymentEnum.Coin,aTransactionBuy:a.aTransactionBuy,aTransactionSell:a.aTransactionSell}),a.aPriceCallback&&a.aPriceCallback(t)})}a.aCallback&&a.aCallback()}})}else e.data("keywords","*")},updateSlotPrice:function(e,t){var a=t||{},n=E.PaymentEnum[a.aPaymentEnum]?a.aPaymentEnum:E.PaymentEnum.Coin,i=B.getBankContainer(e),r=i.find(".bnkTop"),o=i.data("iscollection"),s=(a.aIsTab?e:e.closest(".bnkTab")).find(".bnkTabPrice_"+n),c=void 0!==a.aPossible?1:a.aCount||1,l="number"==typeof a.aPrice?a.aPaymentEnum?E.createPricePlain(a.aPrice,c):E.createPrice(a.aPrice,c):E.recountPrice(a.aPrice,c),u=o||a.aPaymentEnum?l.oPriceSell:l.oPriceSellTaxed;a.aTransactionBuy?u=(l=E.createPrice(a.aTransactionBuy)).oPriceBuy:a.aTransactionSell&&(u=(l=E.createPrice(a.aTransactionSell)).oPriceSellTaxed);var d=function(e,t,n,i){var r=(e.data("priceleft")||0)+t,o=(e.data("priceright")||0)+n;e.data("priceleft",r).data("priceright",o);var s,c,l;switch(a.aPaymentEnum){case E.PaymentEnum.Coin:c=E.formatCoinStringShort(r),l=E.formatCoinStringShort(o),s=i?"+"+c+" −"+l:l+" <span class='accTrivial'>"+c+"</span>";break;case E.PaymentEnum.Gem:c=E.formatGemString(r,!0),l=E.formatGemString(o,!0),s=i?"+"+c+" −"+l:l;break;default:c=E.formatPayment(a.aPaymentEnum,r),l=E.formatPayment(a.aPaymentEnum,o),s=i?"+"+c+" −"+l:l}e.html(s)};if(!0!==a.aIsTab){switch(a.aPaymentEnum){case E.PaymentEnum.Coin:if(e.append("<var class='bnkSlotPrice'>"+E.formatCoinStringSlot(u)+"</var>"),e.data("istradeable")){var p="number"==typeof a.aPrice?E.createPrice(a.aPrice,1):E.recountPrice(a.aPrice,1);e.append("<var class='bnkSlotPriceBuy'>"+E.formatCoinStringSlot(p.oPriceBuy)+"</var>"),e.append("<var class='bnkSlotPriceSell'>"+E.formatCoinStringSlot(p.oPriceSell)+"</var>")}break;case E.PaymentEnum.Gem:e.append("<var class='bnkSlotPrice'>"+E.formatGemString(u,!0)+"</var>"),a.aCount>1&&e.append("<var class='bnkSlotPriceBuy'>"+E.formatGemString(a.aPrice,!0)+"</var>"),a.aWantGemConvert&&e.append("<var class='bnkSlotPriceSell'>"+E.formatGemToCoin(u)+"</var>");break;default:var h=E.formatPayment(a.aPaymentEnum,u);0===a.aPossible?h="":a.aPossible>0&&u!==a.aPossible&&(h=u+" / "+E.formatPayment(a.aPaymentEnum,a.aPossible)),e.append("<var class='bnkSlotPrice'>"+h+"</var>")}if(a.aPaymentEnum===E.PaymentEnum.Coin)e.data("price",u),e.data("pricebuy",l.oPriceBuy),e.data("pricesell",l.oPriceSell);else if(a.aPaymentEnum===E.PaymentEnum.Gem){var m=u*E.Exchange.COPPER_IN_SILVER;e.data("price",m),e.data("pricebuy",m),e.data("pricesell",m)}}if(!1!==a.aIsTab){e.data("tabcount",(e.data("tabcount")||0)+a.aCount),e.data("tabfill",(e.data("tabfill")||0)+(a.aCount>0?1:0)),e.data("tabcapacity",(e.data("tabcapacity")||0)+1);var g,f;o?(g=l.oPriceBuy,f=l.oPriceSell,void 0!==a.aPossible?(d(s,g=u,f=a.aPossible-u,!0),d(r.find(".bnkPriceValueA_"+n),g,g),d(r.find(".bnkPriceValueB_"+n),f,f)):0!==a.aCount?(d(s,l.oPriceSell,0,!0),d(r.find(".bnkPriceValueA_"+n),g,f)):(d(s,0,l.oPriceSell,!0),d(r.find(".bnkPriceValueB_"+n),g,f))):(a.aTransactionBuy?(g=l.oPriceBuy,f=l.oPriceBuy):a.aTransactionSell?(g=l.oPriceSell,f=l.oPriceSellTaxed):(g=l.oPriceBuyTaxed,f=l.oPriceSellTaxed),0!==a.aCount&&(d(s,g,f),d(r.find(".bnkPriceValueA_"+n),g,f)))}},getBankPrice:function(e){return[e.find(".bnkPriceValueA_Coin").data("priceleft")||0,e.find(".bnkPriceValueB_Coin").data("priceleft")||0]},updateSlotPayment:function(e,t,a,n){for(var i in t){var r=t[i],o="";r<0&&(o="bnkSlotPriceTrivial",r*=-1),e.append("<var class='"+(n||"bnkSlotPrice")+" "+o+"'>"+E.formatPayment(i,r*(a||1))+"</var>");break}},createBankMenu:function(e,t){var a=t||{},n=A.getDishName(e),i=A.getDishMenu(n);a.aWantClear&&i.empty();var r=$("<div class='bnkMenu'></div>").prependTo(i),o=function(e,t){e.toggle(t),a.aWantCard&&e.each(function(){var e=$(this).next();e.length&&e.hasClass("bnkCard")&&(e.toggle(t),t&&e.css({display:""}))})},s=$("<div class='bnkSearch'></div>").prependTo(r),c=$("<input class='bnkSearchInput' type='text' />").appendTo(s);I.bindInputBarText(c),c.on("input",$.throttle(Q.cSEARCH_LIMIT,function(){$(this).removeClass("cssSearchNone");var t,n,i=e.find(".bnkSlot"),r=$(this).val().toLowerCase(),s=[],c="",l=!1;if(r.length>0){if(t=r.charAt(0),n=r.charAt(1),("<"===t||">"===t)&&r.length>1){var u="<"===n||">"===n&&r.length>2,d=u?2:1,p=u?"pricesell":"pricebuy",h=E.parseCoinString(r.substring(d,r.length));i.each(function(){var e=$(this).data(p);e&&(">"===t&&e>=h||"<"===t&&e<=h)?(o($(this),!0),l=!0):o($(this),!1)})}else s=r.split(" "),i.each(function(){var e=!0;if(c=$(this).data("keywords"))if(a.aWantSearchHighlight){for(t=0;t<s.length;t++)if(-1===c.indexOf(s[t])){$(this).removeClass("bnkSlotMatch"),e=!1;break}e&&($(this).addClass("bnkSlotMatch"),l=!0)}else{for(var t=0;t<s.length;t++)if(-1===c.indexOf(s[t])){o($(this),!1),e=!1;break}e&&(o($(this),!0),l=!0)}});!1===l&&$(this).addClass("cssSearchNone",!l)}else i.each(function(){$(this).removeClass("bnkSlotMatch"),o($(this),!0)});A.adjustAccountScrollbar()})).click(function(){$(this).select()});var l=$("<aside class='bnkButtons'></aside>").appendTo(r);$("<div class='bnkButtonReload bnkButton curClick' title='<dfn>Reload</dfn> this bank.<br />Press this if the progress bar has frozen.'></div>").appendTo(l).click(function(){a.aReloadElement?a.aReloadElement.trigger("click"):A.regenerateDish(n)});var u=!0;$("<div class='bnkButtonHelp bnkButton curClick' title='Show this bank&apos;s <dfn>help</dfn> message.'></div>").appendTo(l).click(function(){var e=$("#accHelp"+n),t=e.length?e.html():"";(u||!1===I.isConsoleShown())&&I.help(t+(a.aHelpMessage||"")+$("#accHelpBank").html()),u=!u});var d=0;if($("<div class='bnkButtonEmpty bnkButton curToggle' title='Filter:<br />1st click: non-empty/unlocked <dfn>slots</dfn><br />2nd click: marked or "+Q.GameLimit.StackSize+" stack slots<br />3rd click: empty/locked slots<br />4th click: any slot (reset)'></div>").appendTo(l).click(function(){var t=e.find(".bnkSlot");if(0===d||2===d){var a=0===d;t.each(function(){$(this).data("count")>0?o($(this),a):o($(this),!a)}),$(this).addClass("bnkButtonFocused"),d++}else 1===d?(t.each(function(){$(this).data("count")>=Q.GameLimit.StackSize||$(this).data("ismarked")?o($(this),!0):o($(this),!1)}),d++):(o(t,!0),$(this).removeClass("bnkButtonFocused"),d=0);A.adjustAccountScrollbar()}),!0!==a.aIsPseudo){var p=0;$("<div class='bnkButtonTrade bnkButton curToggle' title='Filter:<br />1st click: <dfn>tradeable</dfn> items<br />2nd click: bound items<br />3rd click: any items (reset).'></div>").appendTo(l).click(function(){var t=e.find(".bnkSlot");0===p||1===p?(t.each(function(){$(this).data("istradeable")?o($(this),0===p):o($(this),1===p),void 0===$(this).data("count")&&o($(this),!1)}),$(this).addClass("bnkButtonFocused"),e.addClass("bnkTradeable"),p++):(o(t,!0),$(this).removeClass("bnkButtonFocused"),e.removeClass("bnkTradeable"),p=0),A.adjustAccountScrollbar()})}if(!0!==a.aIsPseudo&&!0!==a.aIsCollection){var h=0;$("<div class='bnkButtonClean bnkButton curToggle' title='Filter:<br />1st click: <dfn>cleanable</dfn> items<br />2nd click: any items (reset).<br />Example: salvageable items, vendorable items, unopened bags.'></div>").appendTo(l).click(function(){var t=$(this),a=e.find(".bnkSlot");0===h?Q.initializeCleanableFilter(function(){a.each(function(){var e=$(this).data("itemid");e&&void 0===$(this).data("skinid")&&Q.isCleanable(e)&&$(this).addClass("bnkSlotMatchAlternate")}),t.addClass("bnkButtonFocused"),h++}):(a.removeClass("bnkSlotMatchAlternate"),t.removeClass("bnkButtonFocused"),h=0),A.adjustAccountScrollbar()})}if(!0!==a.aIsPseudo){var m=O.Options.bol_showRarity,g=function(t){e.toggleClass("bnkRarity",m),t.toggleClass("bnkButtonFocused")},f=$("<div class='bnkButtonRarity bnkButton curToggle' title='Show <dfn>rarity</dfn> colored boxes.<br />Change permanently at Options page, Account section.'></div>").appendTo(l).click(function(){m=!m,g($(this))});O.Options.bol_showRarity&&g(f)}var C=O.Options.bol_condenseBank,v=function(t){e.toggleClass("bnkCondense",C),t.toggleClass("bnkButtonFocused"),e.css({width:A.Metadata.Bank.NumSlotsHorizontal*B.getBankSlotWidth(C)}),A.adjustAccountScrollbar()},f=$("<div class='bnkButtonCondense bnkButton curToggle' title='Toggle bank <dfn>size</dfn>.<br />Change permanently at Options page, Account section.'></div>").appendTo(l).click(function(){C=!C,v($(this))});if(O.Options.bol_condenseBank&&v(f),a.aWantCard){var b=!1;$("<div class='bnkButtonCard bnkButton curToggle' title='Toggle info <dfn>cards</dfn>.'></div>").appendTo(l).click(function(){b=!b,e.toggleClass("bnkCarded",b),$(this).toggleClass("bnkButtonFocused"),A.adjustAccountScrollbar()}).trigger("click")}var S=!1,T=$("<div class='bnkButtonTab bnkButton curToggle' title='Expand/<dfn>Collapse</dfn> all tabs.'></div>").appendTo(l).click(function(){B.toggleBankTab(e,S),$(this).toggleClass("bnkButtonFocused"),S=!S});a.aIsCollapsed&&T.trigger("click"),$("<div class='bnkButtonWideLess bnkButton curClick' title='<dfn>Decrease</dfn> bank width.'></div>").appendTo(l).click(function(){var t=B.getBankSlotWidth(C),a=4*t,n=e.width();n>a&&(e.css({width:n-t}),A.adjustAccountScrollbar())}),$("<div class='bnkButtonWideMore bnkButton curClick' title='<dfn>Increase</dfn> bank width.'></div>").appendTo(l).click(function(){var t=B.getBankSlotWidth(C),a=$("#accContent").width()-2*t,n=e.width();n<a&&(e.css({width:n+t}),A.adjustAccountScrollbar())}),s.css({width:s.width()-l.width()}),I.qTip.init(l.find(".bnkButton")),A.adjustAccountPanel()},getBankSearch:function(e){return $("#accDishMenu_"+U.toFirstUpperCase(e)).find(".bnkSearch .bnkSearchInput").first()},refreshBankSearch:function(e){B.getBankSearch(e).trigger("input")},fillTab:function(e,t,a){var n,i,r=a||{},o=0,s=U.getObjectLength(t),c=B.getSlotsContainer(e);r.aIsCollapsed&&e.append(I.cThrobber);var l=function(){for(var e=0;e<t.length;e++)n=B.createBankSlot(c),i=t[e],B.fillSlot(n,i.i||i,{aUnlockAssoc:r.aUnlockAssoc,aUnlockObj:i,aComment:i.t,aLabel:i.l,aIsCatalog:r.aIsCatalog,aIsCustomCatalog:r.aIsCustomCatalog,aWantGemConvert:r.aWantGemConvert,aBind:r.aBind,aCallback:function(){o++,A.setProgressBar(o,s)}})};if(r.aIsCollapsed){for(var u=[],d=0;d<t.length;d++)i=t[d],u.push(i.i||i);Q.getPricedItems(u,function(){I.removeThrobber(e),l()})}else l();r.aIsCustomCatalog&&B.bindCatalogTab(e)},fillDyeTab:function(e,t,a,n){var i,r,o=B.getSlotsContainer(e),s=GW2T_DYES_METADATA,c={};for(var l in s.Translations)c[l]=D.getObjectTranslation(s.Translations[l]);for(l=0;l<t.length;l++)i=B.createBankSlot(o),r=t[l],function(e,t,r,o,l,u,d,p,h,m){var g,f=[],C=[];u.forEach(function(e){g=U.convertHexToRGB(e),f.push(g),C.push(U.convertRGBToHSL(g))}),t.rgb=f,t.hsl=C,e.find(".bnkSlotIcon").css({background:u[0]}),e.append("<var class='bnkSlotDyeName'>"+m+"</var>");var v=s.Rarities[n]?s.Rarities[n]:s.Rarities.Default;e.find(".bnkSlotIcon").addClass("bnkSlotRarity_"+v);var b=a[r]?1:0;b&&e.data("count",b),o&&(i.addClass("bnkSlotTradeable"),i.data("istradeable",!0),E.getPriceObject(o,function(t){B.updateSlotPrice(e,{aPrice:t,aCount:b,aPaymentEnum:E.PaymentEnum.Coin}),b&&e.find(".bnkSlotPrice").addClass("accTrivial")}));var S="<div class='bnkDyePreview'><aside class='bnkDyePreviewTitle'><var class='bnkDyePreviewName' style='color:"+u[0]+"'>"+m+"</var> ("+c[d]+" "+c[p]+")</aside><div class='bnkDyePreviewSwatches'><aside class='bnkDyePreviewSwatch' style='background:"+u[0]+"'><var class='bnkDyePreviewMaterial'>"+c.Vibrant+"</var></aside><aside class='bnkDyePreviewSwatch' style='background:"+u[1]+"'><var class='bnkDyePreviewMaterial'>"+c.Leather+"</var></aside><aside class='bnkDyePreviewSwatch' style='background:"+u[2]+"'><var class='bnkDyePreviewMaterial'>"+c.Metal+"</var></aside></div></div>";e.attr("title",S),I.qTip.init(e);var T=(m+" "+c[d]+" "+c[p]).toLowerCase();e.data("keywords",T),e.click(function(e){e.which===I.ClickEnum.Left&&U.openExternalURL(U.getWikiSearchDefault(l))}),Q.bindItemSlotBehavior(e,{aObject:t,aChatlink:h,aTradeableID:o,aSearch:l})}(i,r,r.u,r.i,r.n,r.c,r.h,r.m,r.l,D.getObjectTranslation(r))},fillSlot:function(e,t,a){var n=a||{},i=n.aUnlockAssoc,r=n.aUnlockObj,o="number"==typeof r?t:r.u,s=n.aIsCatalog&&r.u?r.u:null,c=r.n,l=r.p;Q.getItem(t,function(a){n.aIsCustomCatalog&&(e.addClass("bnkSlotCatalog"),o=t,c=a.name);var r,u,d;l&&(r=l.coin,void 0!==(u=l.gem)&&(u<0?u=0:d=u));var p=i[o],h=p?void 0!==p.oCount?p.oCount:1:0,m=n.aComment,g=n.aLabel;p=i[t],n.aIsCatalog&&p&&(h=p.oCount,m=A.getFoundString(p)),B.styleBankSlot(e,{aItem:a,aTradeableID:s,aPrice:r,aGem:d,aSlotMeta:{count:h},aComment:m,aLabel:g,aWiki:c,aIsCustomCatalog:n.aIsCustomCatalog,aWantGemConvert:n.aWantGemConvert,aBind:n.aBind,aCallback:function(){l&&(void 0===r&&void 0===u||0===r||0===u)&&B.updateSlotPayment(e,l,h)}}),n.aCallback&&n.aCallback()})},generateUnlockables:function(e,t){var a=t||{};a.aIsCollapsed&&(a.aWantPrices=!1);var n={};if(a.aIsCatalog)n=A.Possessions;else if(void 0===a.aUnlockeds)a.aUnlockeds=[],A.iterateRecord(a.aRecord,function(e){n[e]=!0});else if(Array.isArray(a.aUnlockeds)){if(a.aUnlockeds.length)if(void 0!==a.aUnlockeds[0].id)for(p=0;p<a.aUnlockeds.length;p++)!1!==a.aUnlockeds[p].permanent&&(n[a.aUnlockeds[p].id]=!0);else for(p=0;p<a.aUnlockeds.length;p++)n[a.aUnlockeds[p]]=!0}else n=a.aUnlockeds;var i,r,o,s,c=B.getBankContainer(e),l={},u={};if(a.aIsCustomCatalog){var d=B.bindCatalog(e,n,a.aHeaders,a.aRecord);l=d.oHeaders,u=d.oRecord}else if(a.aIsLookup){l=a.aHeaders;for(var p in a.aRecord){u[p]=[],r=a.aRecord[p];for(var h=0;h<r.length;h++)n[r[h]]&&u[p].push(r[h])}}else l=a.aHeaders,u=a.aRecord;var m=function(){I.removeThrobber(e);var t=0,d=0,p=0,h=!1;void 0===l&&(l={},h=!0);for(var m in u){h&&(l[m]={name_en:m}),o=l[m],r=u[m],function(e,t,i,r){a.aIsDyes?B.fillDyeTab(e,i,n,r):a.aIsCollapsed||t.iscollapsed?e.find(".bnkTabSeparator").one("click",function(){B.fillTab(e,i,{aUnlockAssoc:n,aIsCatalog:a.aIsCatalog,aIsCollapsed:a.aIsCollapsed,aWantGemConvert:a.aWantGemConvert,aBind:a.aBind})}):B.fillTab(e,i,{aUnlockAssoc:n,aIsCatalog:a.aIsCatalog,aIsCustomCatalog:t.iscustomtab,aWantGemConvert:a.aWantGemConvert,aBind:a.aBind})}(i=a.aTabIterator?a.aTabIterator(m):B.createBankTab(e,{aTitle:D.getObjectName(o),aIsCollapsed:void 0!==a.aIsCollapsed?a.aIsCollapsed:o.iscollapsed,aIsCustomCatalog:o.iscustomtab}),o,r,m);for(var g=0,f=0,C=0;C<r.length;C++)s=(a.aIsCatalog?r[C].i:r[C].u)||r[C],n[s]&&(g++,t++,n[s].oCount&&(f+=n[s].oCount));var v=r.length;d+=v,B.updateTabTally(i,g,v,f),f&&(p+=f)}var b=void 0===a.aWantSearchHighlight||a.aWantSearchHighlight;B.createBankMenu(e,{aIsCollection:!0,aWantSearchHighlight:b,aHelpMessage:$("#accHelpUnlockables").html(),aIsCustomCatalog:a.aIsCustomCatalog}),B.updateBankTally(c,t,d,p),a.aCallback&&a.aCallback({aUnlockAssoc:n})};if(!0===a.aWantItems||!1!==a.aWantPrices){var g=[];A.iterateRecord(u,function(e){!1===isNaN(e)?g.push(e):e.i?g.push(e.i):e.u&&g.push(e.u)}),!0===a.aWantItems&&!1!==a.aWantPrices?Q.getPricedItems(g,function(){m()}):!0===a.aWantItems?Q.getItems(g,function(){m()}):!1!==a.aWantPrices&&E.getPrices(g,function(){m()})}else m()},generateCatalog:function(e,t){var a=$.extend({aIsCatalog:!0,aWantGem:!0,aWantSearchHighlight:!1},t),n=U.toFirstUpperCase(e),i=e.toLowerCase();if(!V.requireCharacters(n))if(A.Data.Characters[0].bags){var r=$("#accDish_"+n);if(!1!==A.reinitializeDish(r)){var o=B.createBank(r,{aIsCollection:void 0===a.aIsCollection||a.aIsCollection,aWantGem:a.aWantGem}),s=B.getTabsContainer(o).append(I.cThrobber),c=function(){a.aHeaders=U.getRecordHeader(e),a.aRecord=U.getRecordData(e),B.generateUnlockables(s,a),Q.bindItemSearch(B.getBankSearch(e),{aFillerText:null,aCallback:function(e){var t="&quot;<a"+U.convertExternalAnchor(U.getWikiLinkLanguage(e.name))+">"+e.name+"</a>&quot;";if(A.Possessions[e.id]){var a=A.formatPossessionLocations(A.Possessions[e.id]);I.print(t+" was found in:<br /><br />"+a)}else I.write("Nowhere in your account has the item "+t)}})};U.getScript(U.URL_DATA[n],function(){Q.loadItemsSubdatabase(i,function(){A.initializePossessions(function(){c()})})})}}else A.printError(A.PermissionEnum.Inventories)},placeCatalogTab:function(e,t,a){var n=e.find(".bnkCatalogTabContainer");n.length||(n=$("<div class='bnkCatalogTabContainer'></div>").prependTo(e)),a?n.prepend(t):n.append(t)},bindCatalogTab:function(e){e.addClass("bnkCatalogTab");var t=$("<kbd class='bnkCatalogTabEdit btnWindow' title='Click to <dfn>edit</dfn> this tab.<br />Click again to stop editing.<br />To edit custom slots, click the slot.'></kbd>").prependTo(e).click(function(){var t=$(this).closest(".bnkBank"),a=$(t.data("currenttab")),n=$(this).closest(".bnkTab").first(),i=t.data("tabeditor"),r=e.find(".bnkTabHeader");if(t.find(".bnkTabHeader").removeClass("bnkCatalogTabHighlight"),n.is(a)&&i.is(":visible"))i.hide(),t.data("currenttab",null),r.removeClass("bnkCatalogTabHighlight");else if(!1===n.is(a)||!1===i.is(":visible")){i.show(),t.data("currenttab",$(this).closest(".bnkTab")),r.addClass("bnkCatalogTabHighlight");var o=e.find(".bnkTabText").text();i.find(".bnkCatalogTabRename").val(o),i.find(".bnkCatalogSlotAdd").select().trigger("focus").trigger("click")}A.adjustAccountPanel()});I.qTip.init(t)},bindCatalogSlot:function(e){e.unbind("click").click(function(){var e=$(this).closest(".bnkBank");e.find(".bnkCatalogSlotHighlight").removeClass("bnkCatalogSlotHighlight");var t=e.data("currentslot"),a=e.data("sloteditor");$(this).is(t)&&a.is(":visible")?(a.hide(),e.data("currentslot",null),$(this).removeClass("bnkCatalogSlotHighlight")):!1!==$(this).is(t)&&!1!==a.is(":visible")||(a.css({left:I.posX,top:I.posY}).show(),e.data("currentslot",$(this)),$(this).addClass("bnkCatalogSlotHighlight")),A.adjustAccountPanel()})},saveCatalog:function(e){var t=[];e.find(".bnkCatalogTab").each(function(){var e,a=[];B.getSlotsContainer($(this)).first().find(".bnkSlotCatalog").each(function(){(e=$(this).data("itemid"))&&a.push(e)}),t.push({name:$(this).find(".bnkTabText").text(),items:a})}),localStorage[O.Utilities.CustomCatalog.key]=JSON.stringify(t)},bindCatalog:function(e,t,a,n){var i,r,o,s,c={},l={},u={},d=[];try{d=JSON.parse(localStorage[O.Utilities.CustomCatalog.key])}catch(e){}for(p=0;p<d.length;p++){o=d[p];for(h=0;h<o.items.length;h++)u[o.items[h]]=!0}for(var p in n)for(h=(r=n[p]).length-1;h>=0;h--)u[r[h].i]&&r.splice(h,1);for(p=0;p<d.length;p++){o=d[p],c[s="Tab_"+p]={name_en:U.escapeHTML(o.name||""),iscustomtab:!0},l[s]=[];for(var h=0;h<o.items.length;h++)(i=o.items[h])&&l[s].push({i:i,n:null})}for(var p in a)c[p]=a[p];for(var p in n)l[p]=n[p];var m=$("<kbd class='bnkCatalogTabAdd btnWindow' title='<dfn>Add a custom bank tab.</dfn><br />To edit a custom tab or add an item to it, click the<img src=\"img/ui/edit.png\" />icon next to one.'></kbd>").appendTo(e).click(function(){if(e.find(".bnkCatalogTab").length<A.Metadata.Bank.CustomTabsLimit){var a=B.createBankTab(e,{aTitle:D.getPhraseTitle("rename tab"),aIsCustomCatalog:!0,aWantPrepend:!0});B.fillTab(a,[],{aUnlockAssoc:t,aIsCatalog:!0,aIsCustomCatalog:!0}),a.find(".bnkCatalogTabEdit").trigger("click")}else I.write("Custom tabs limit reached.")});I.qTip.init(m);var g=A.getDishName(e),f=A.getDishMenu(g),C=$("<div class='bnkCatalogTabEditor'></div>").appendTo(f).hide();e.data("tabeditor",C),$("<div class='bnkCatalogMenuClose bnkButton curClick' title='<dfn>Close</dfn> the tab editor.'></div>").appendTo(C).click(function(){var t=e.data("currenttab");t&&t.find(".bnkTabHeader").removeClass("bnkCatalogTabHighlight"),e.data("currenttab",null),C.hide(),A.adjustAccountPanel()});var v=$("<input class='bnkCatalogSlotAdd bnkSearchInput' type='text' />").appendTo(C);Q.bindItemSearch(v,{aFillerText:D.getPhraseTitle(D.orderModifier("item","new"))+"...",aCallback:function(a){var n=e.data("currenttab");if(n){var i=B.getSlotsContainer(n),r=B.createBankSlot(i);B.fillSlot(r,a.id,{aUnlockAssoc:t,aUnlockObj:a.id,aIsCatalog:!0,aIsCustomCatalog:!0}),B.saveCatalog(e)}}}),$("<input class='bnkCatalogTabRename bnkSearchInput' type='text' />").appendTo(C).change(function(){var t=e.data("currenttab");t&&(t.find(".bnkTabText").text($(this).val()),B.saveCatalog(e))}).click(function(){$(this).select()});var b=$("<aside class='bnkButtons'></aside>").appendTo(C);$("<div class='bnkCatalogTabUp bnkButton curClick' title='Move this tab <dfn>up</dfn>.'></div>").appendTo(b).click(function(){var t=e.data("currenttab");t&&t.prev()&&t.insertBefore(t.prev()),B.saveCatalog(e)}),$("<div class='bnkCatalogTabDown bnkButton curClick' title='Move this tab <dfn>down</dfn>.'></div>").appendTo(b).click(function(){var t=e.data("currenttab");t&&t.next()&&t.insertAfter(t.next()),B.saveCatalog(e)}),$("<div class='bnkCatalogTabDelete bnkButton curClick' title='<dfn>Delete</dfn> this custom bank tab.'></div>").appendTo(b).click(function(){var t=e.data("currenttab"),a=function(){t.remove(),C.hide(),A.adjustAccountPanel(),B.saveCatalog(e)};t&&(t.find(".bnkSlot").length>0?confirm("Delete this custom tab?")&&a():a())});var S=$("<div class='bnkCatalogSlotEditor'></div>").appendTo(f).hide();e.data("sloteditor",S),$("<div class='bnkCatalogMenuClose bnkButton curClick' title='<dfn>Close</dfn> the slot editor.'></div>").appendTo(S).click(function(){var t=e.data("currentslot");t&&t.removeClass("bnkCatalogSlotHighlight"),e.data("currentslot",null),S.hide(),A.adjustAccountPanel()});var T=$("<aside class='bnkButtons'></aside>").appendTo(S);return $("<div class='bnkCatalogSlotLeft bnkButton curClick' title='Move this slot <dfn>left</dfn>.'></div>").appendTo(T).click(function(){var t=e.data("currentslot");t&&t.prev()&&t.insertBefore(t.prev()),B.saveCatalog(e)}),$("<div class='bnkCatalogSlotRight bnkButton curClick' title='Move this slot <dfn>right</dfn>.'></div>").appendTo(T).click(function(){var t=e.data("currentslot");t&&t.next()&&t.insertAfter(t.next()),B.saveCatalog(e)}),$("<div class='bnkCatalogSlotDelete bnkButton curClick' title='<dfn>Delete</dfn> this custom bank slot.'></div>").appendTo(T).click(function(){var t=e.data("currentslot");t&&(t.remove(),S.hide(),A.adjustAccountPanel()),B.saveCatalog(e)}),I.qTip.init(C.find(".bnkButton")),I.qTip.init(S.find(".bnkButton")),{oHeaders:c,oRecord:l}},generateTransactions:function(e,t){var a=U.toFirstUpperCase(e),n=e.toLowerCase(),i=$("#accDish_"+a);if(!1!==A.reinitializeDish(i)){var r,o,s,c,l,u,d,p,h,m=B.createBank(i,{aTitle:D.getWordCapital(n),aClass:"bnkBankTrading",aIsCollection:!1,aWantGem:!1}),g=B.getTabsContainer(m).append(I.cThrobber),f=[],C=0,v=0,b={},S=!1,y=function(e,t){var a,i=0,r=U.getObjectLength(b[t]),o=B.getSlotsContainer(e),s=[];for(var c in b[t])u=b[t][c],(a=B.createBankSlot(o)).data("count",u.oCount),s.push(u),function(e,t){Q.getItem(t.oItemID,function(a){p="buying"===n||"bought"===n?t.oPrice:null,h="selling"===n||"sold"===n?t.oPrice:null,B.styleBankSlot(e,{aItem:a,aComment:"<table class='bnkTransactionsTooltip'>"+t.oStampsTip+"</table>",aTransactionBuy:p,aTransactionSell:h,aSlotMeta:{count:t.oCount},aCallback:function(){S?(i++,A.setProgressBar(i,r)):(C++,A.setProgressBar(C,v))},aPriceCallback:function(a){"buying"===n?a.oPriceBuy===t.oHighest&&e.addClass("bnkSlotMatchAlternate"):"selling"===n&&a.oPriceSell===t.oLowest&&e.addClass("bnkSlotMatchAlternate")},aBind:function(e,t){e.unbind("click").click(function(e){e.which===I.ClickEnum.Left&&E.printListings(t.id)})}})})}(a,u);U.sortObjects(s,{aKeyName:"oLatest"}),e.data("transactions",s);var l=$("<kbd class='bnkTransactionsPrint btnWindow' title='<dfn>Print</dfn> this month of transactions in chronological order.'></kbd>").prependTo(e).click(function(){for(var e=$(this).closest(".bnkTab").first().data("transactions"),t="<div class='bnkTransactionsContainer'>",a=e.length-1;a>=0;a--)Q.getItem(e[a].oItemID,function(n){e[a]&&(t+="<div class='bnkTransactionsBox'>"+Q.getItemPreface(n,e[a].oCount)+"<table class='bnkTransactionsTable'>"+e[a].oStamps+"</table></div>")});t+="</div>",I.print(t,!0),I.bindConsoleInput()});I.qTip.init(l)};A.getTransactions(t,{aCallback:function(e){if(null===e)return g.empty(),void g.append("<span class='bnkError'>"+D.getWordCapital("no")+" "+D.getModifiedWord("transactions","current")+".</span>");for(var t=(new Date).getTime(),a=0;a<e.length;a++)l=e[a],r=l.purchased||l.created,o=r.split("-"),s=o[0]+"-"+o[1],void 0===b[s]&&(b[s]={}),c=l.purchased?T.formatMilliseconds(new Date(l.purchased).getTime()-new Date(l.created).getTime()):T.formatMilliseconds(t-new Date(l.created).getTime()),void 0===b[s][l.item_id]&&(f.push(l.item_id),b[s][l.item_id]={oLatest:l.purchased||l.created,oHighest:Number.NEGATIVE_INFINITY,oLowest:Number.POSITIVE_INFINITY,oItemID:l.item_id,oNumTransactions:0,oCount:0,oPrice:0,oStamps:"",oStampsTip:""},v++),(u=b[s][l.item_id]).oCount+=l.quantity,u.oPrice+=l.price*l.quantity,u.oNumTransactions+=1,d="<tr><td>"+l.quantity+" "+I.Symbol.Quantity+"&nbsp;</td><td>"+E.formatCoinStringColored(l.price)+" =&nbsp;</td><td>"+E.formatCoinStringColored(l.price*l.quantity)+"</td><td>&nbsp;("+c+")</td><td>&nbsp;@ "+new Date(l.purchased||l.created).toLocaleString()+"</td></tr>",u.oStamps+=d,u.oNumTransactions<Q.GameLimit.TooltipLines&&(u.oStampsTip+=d),l.price>u.oHighest&&(u.oHighest=l.price),l.price<u.oLowest&&(u.oLowest=l.price);Q.getPricedItems(f,function(){g.empty(),S=v>Q.GameLimit.FetchAPI;var e,t,a,n,i=0,r=0;for(var o in b){a=0,n=0,s=o.split("-"),t=T.formatLocal(new Date(Date.UTC(s[0],s[1],1,0,0,0)),{year:"numeric",month:"long"}),e=B.createBankTab(g,{aTitle:t,aIsCollapsed:S}),S?function(e,t){e.find(".bnkTabSeparator").one("click",function(){y(e,t)})}(e,o):y(e,o);for(var c in b[o])a++,n+=b[o][c].oCount;i+=a,r+=n,B.updateTabTally(e,a,a,n)}B.updateBankTally(m,i,i,r),B.createBankMenu(g,{aHelpMessage:$("#accHelpTransactions").html()})})}})}}},Q={Boxes:{Items:{},Skins:{},Guilds:{},Achievements:{},Titles:{},Specializations:{},Traits:{},Skills:{}},isBoxedFully:{},RetrievedDatabases:{},SearchDatabase:null,CleanableFilter:null,ItemEnum:{Gathering:"Gathering",Tool:"Tool",Gizmo:"Gizmo",Bag:"Bag",Back:"Back",Armor:"Armor",Weapon:"Weapon",Trinket:"Trinket",UpgradeComponent:"UpgradeComponent",Consumable:"Consumable",Container:"Container",CraftingMaterial:"CraftingMaterial",MiniPet:"MiniPet",Trophy:"Trophy"},ItemRank:{Gathering:"A",Tool:"B",Gizmo:"C",Bag:"D",Back:"E",Armor:"F",Weapon:"G",Trinket:"H",UpgradeComponent:"I",Consumable:"J",Container:"K",CraftingMaterial:"L",MiniPet:"M",Trophy:"N"},RarityEnum:{Junk:"Junk",Basic:"Basic",Fine:"Fine",Masterwork:"Masterwork",Rare:"Rare",Exotic:"Exotic",Ascended:"Ascended",Legendary:"Legendary"},RarityNumber:{Junk:1,Basic:2,Fine:3,Masterwork:4,Rare:5,Exotic:6,Ascended:7,Legendary:8},RarityRank:{Junk:"A",Basic:"B",Fine:"C",Masterwork:"D",Rare:"E",Exotic:"F",Ascended:"G",Legendary:"H"},WeightRank:{Light:"A",Medium:"B",Heavy:"C"},ArmorRank:{HelmAquatic:"A",Helm:"B",Shoulders:"C",Coat:"D",Gloves:"E",Leggings:"F",Boots:"G"},WeaponRank:{Axe:"A",Dagger:"B",Mace:"C",Pistol:"D",Scepter:"E",Sword:"F",Focus:"G",Shield:"H",Torch:"I",Warhorn:"J",Greatsword:"K",Hammer:"L",LongBow:"M",Rifle:"N",ShortBow:"O",Staff:"P",Harpoon:"Q",Speargun:"R",Trident:"S"},TrinketRank:{Amulet:"A",Accessory:"B",Ring:"C"},RunePieces:{Masterwork:2,Rare:4,Exotic:6},GameLimit:{Unknown:8055,DailyAP:15e3,FetchAPI:800,TooltipLines:100,LevelMax:80,StackSize:250,EctoSalvageLevel:68},cSEARCH_LIMIT:200,Context:{Item:null,ItemName:null,ItemID:null,ItemSearch:null},isFauxInitialized:!1,loadItemsSubdatabase:function(e,t){Q.RetrievedDatabases[e]?t():$.getJSON(U.getCacheURL(e),function(t){Q.RetrievedDatabases[e]=!0,Q.initializeBoxes("items",t)}).always(function(){t()})},loadItemsSearch:function(e){Q.SearchDatabase?e():$.getJSON("cache/search_"+D.langPartiallySupported+I.cJSON,function(t){Q.SearchDatabase=t,e()})},setRarityClass:function(e,t){for(var a in Q.RarityEnum)e.removeClass("rarity_"+a);void 0!==Q.RarityEnum[t]&&e.addClass("rarity_"+t)},getRarityClass:function(e){return"rarity_"+e},getItemType:function(e){var t=e.details;if(t){var a=e.type;if({Back:1,Consumable:1,Container:1,CraftingMaterial:1,Gathering:1,Gizmo:1,MiniPet:1,Trophy:1,UpgradeComponent:1}[a])return"<br />"+D.getString(a)+"<br />";if(t.type&&"Default"!==t.type)return D.getString(t.type)+"<br />"}return""},getAttributeString:function(e){var t={CritDamage:"Ferocity",Healing:"HealingPower",ConditionDuration:"Expertise",BoonDuration:"Concentration"};return t[e]?t[e]:e},getAttributeTranslation:function(e){return D.getString(Q.getAttributeString(e))},sumItemAttribute:function(e,t){var a,n,i,r,o,s=t||{},c=A.Attribute["KeyDescription_"+D.langFullySupported],l=function(t){var l=t.length;if(s.aRuneSets&&s.aRuneSets[s.aItem.id]){if(!0===s.aRuneSets[s.aItem.id].issummed)return;l=s.aRuneSets[s.aItem.id].numslotted}for(var u=0;u<l;u++)if(n=t[u],i=U.stripToNumbers(n),r=n.replace(/[\s0-9%,.\-+']/g,"").toLowerCase(),c[r]){if("AgonyResistance"===(o=c[r])&&a.infusion_slots)continue;e[o]+=i}s.aRuneSets&&s.aRuneSets[s.aItem.id]&&(s.aRuneSets[s.aItem.id].issummed=!0)},u=s.aItem;if(u&&u.details&&((a=u.details).infix_upgrade&&a.infix_upgrade.attributes&&a.infix_upgrade.attributes.forEach(function(t){var a=A.Attribute.KeyAttributes[t.attribute];a&&(e[a]+=t.modifier)}),a.bonuses&&l(a.bonuses),void 0!==a.defense&&(e.Armor+=a.defense)),s.aStats){var d=s.aStats.attributes;if(d)for(var p in d)e[Q.getAttributeString(p)]+=d[p]}},sumAttributeObject:function(e,t){for(var a in e)e[a]+=t[a]},calculateAttributes:function(e,t,a){var n={},i=t.level,r=t.oCharProfession,o=A.Attribute.Constants,s=A.Attribute.PrimaryPoints[i-1],c=A.Attribute.PrecisionDivisor[i-1],l=c/A.Attribute.SecondaryDivisorRatio,u=0,d=0,p=A.Metadata.Profession[r].health,h=A.Attribute.HealthGrowth[p],m=0;for(var g in h){if(!((m=parseInt(g))<=i)){u+=(i-d)*h[g];break}u+=(m-d)*h[g],d=m}var f={Power:s+e.Power,Toughness:s+e.Toughness,Armor:s+e.Armor+e.Toughness,Vitality:s+e.Vitality,Health:s/o.VITALITY_IN_HEALTH+u+e.Health+e.Vitality/o.VITALITY_IN_HEALTH,Precision:s+e.Precision,CriticalChance:o.BASE_CRITICALCHANCE+e.CriticalChance+e.Precision/c,Ferocity:e.Ferocity,CriticalDamage:o.BASE_CRITICALDAMAGE+e.CriticalDamage+e.Ferocity/l,ConditionDamage:e.ConditionDamage,HealingPower:e.HealingPower,Expertise:e.Expertise,ConditionDuration:e.ConditionDuration+e.Expertise/l,Concentration:e.Concentration,BoonDuration:e.BoonDuration+e.Concentration/l,AgonyResistance:e.AgonyResistance,MagicFind:e.MagicFind};if(a)return f;for(var g in f)n[g]=A.Attribute.KeyType[g]?U.formatPercentage(f[g],2,1):parseInt(f[g]).toLocaleString();return n},countRuneSets:function(e){var t=e.equipment,a=0;if(t){for(var n={},i=0;i<t.length;i++){if(A.Equipment.ArmorSlots[t[i].slot]&&t[i].upgrades){var r=t[i].upgrades[0];void 0===n[r]&&(n[r]={numslotted:0,issummed:!1}),n[r].numslotted=n[r].numslotted+1,a++}if(a===A.Equipment.NumArmorSlots)break}return n}return null},getRuneBonus:function(e,t){var a="",n=e.details,i=0,r=Q.RunePieces[e.rarity],o=t&&t[e.id]?t[e.id].numslotted:null;"number"==typeof t&&(o=t),o>r&&(o=r);if(n.bonuses){a+=null!==o?"":"<br />",a+="<span class='itmGrayed'>",null!==o&&(a+="<var class='itmBuff'>"+e.name+" ("+o+"/"+r+")</var><br />");for(var s in n.bonuses)a+="<var"+(i<o?" class='itmBuff'":"")+">("+ ++i+"): "+n.bonuses[s]+"</var><br />";a+="</span>"}return a},formatItemDescription:function(e){try{var t="string"==typeof e?e:e.details.infix_upgrade.buff.description;return-1!==t.indexOf("<c=@")&&(t=(t=(t=(t=t.replace(/<c=@abilitytype>/g,"<c class='itmColor_abilitytype'>")).replace(/<c=@flavor>/g,"<c class='itmColor_flavor'>")).replace(/<c=@reminder>/g,"<c class='itmColor_reminder'>")).replace(/<c=@warning>/g,"<c class='itmColor_warning'>")),-1!==t.indexOf("\n")?t.replace(/\n/g,"<br />"):t}catch(e){}return""},isTradeable:function(e){if(void 0===e)return!1;if("number"==typeof e){var t=Q.getBoxedItem(e);if(t)return!1!==t.oIsTradeable}if(e.flags)for(var a,n=0;n<e.flags.length;n++)if("AccountBound"===(a=e.flags[n])||"SoulbindOnAcquire"===a)return!1;return!0},getItem:function(e,t){var a=Q.getBoxedItem(e);return a?(t(a.oData),{fail:function(){}}):$.ajax({dataType:"json",url:U.getAPIItem(e),cache:!0,success:function(e){void 0===Q.Boxes.Items[e.id]&&(Q.Boxes.Items[e.id]={},Q.Boxes.Items[e.id].oData=e),t(e)}})},getPricedItems:function(e,t,a){Q.getItems(e,function(){E.getPrices(e,function(){t()},a)})},createFaux:function(e){var t=U.stripToVariable(D.getObjectDefaultName(e)).toLowerCase();if(void 0===Q.Boxes.Items[t]){var a=$.extend({name:D.getObjectName(e)||"Unnamed Item",description:D.getObjectDesc(e)||"",type:e.type||"Consumable",level:e.level?e.level:0,rarity:e.rarity||"Basic",vendor_value:0,game_types:["Pvp","PvpLobby","Wvw","Dungeon","Pve"],flags:["AccountBound","NoSell","DeleteWarning","AccountBindOnUse"],restrictions:[],id:t,chat_link:"[&AgF3HwAA]",icon:e.icon?e.icon:"img/faux/"+t+I.cPNG,details:{}},e);Q.Boxes.Items[t]={},Q.Boxes.Items[t].oData=a}},initializeFaux:function(){if(!Q.isFauxInitialized)for(var e in H.Faux)Q.createFaux(H.Faux[e])},sortItems:function(e,t){var a=!1,n=function(e){var t=Q.ItemRank[e.type]||"0",a=e.name,n=e.type,i=e.details&&e.details.type?e.details.type:"",r=e.rarity,o=Q.RarityRank[r],s=e.description?e.description.toLowerCase():"",c="?"+i;return"Armor"===n?c=Q.WeightRank[e.details.weight_class]+"_"+Q.ArmorRank[i]:"Weapon"===n?c=Q.WeaponRank[i]:"Trinket"===n?c=Q.TrinketRank[i]:-1!==s.indexOf("decoration")?c="Decoration":-1!==s.indexOf("recipe")&&(c="Recipe"),t+"_"+c+"_"+o+"_"+U.stripToAlphanumeric(a)},i=function(){for(var i,r,o=[],s=[],c=[],l=0;l<e.length;l++)i=e[l],(r=a?Q.Boxes.Items[i]?Q.Boxes.Items[i].oData:null:t[i])&&o.push({oData:r,oType:n(r)});if(U.sortObjects(o,{aKeyName:"oType"}),o.forEach(function(e){s.push(e.oData),c.push(e.oData.id)}),!a)return{oItems:s,oIDs:c};t(s,c)};if("function"!=typeof t)return i();a=!0,Q.getItems(e,function(){i()})},categorizeCleanableItem:function(e,t){var a=e.name.toLowerCase(),n=e.description?e.description.toLowerCase():"";if(t)return e.type===Q.ItemEnum.UpgradeComponent||e.type===Q.ItemEnum.CraftingMaterial?"Combine":(e.type===Q.ItemEnum.Armor||e.type===Q.ItemEnum.Weapon)&&Q.RarityNumber[e.rarity]<Q.RarityNumber.Rare?"Junk":null;if(-1!==n.indexOf("decoration")&&(e.type===Q.ItemEnum.Gizmo||e.type===Q.ItemEnum.Consumable||e.type===Q.ItemEnum.Trophy))return"Decoration";if(-1!==n.indexOf("value as part of a collection"))return"Collection";if(-1!==a.indexOf("recipe"))return"Recipe";if(e.rarity===Q.RarityEnum.Rare&&e.level&&e.level>Q.GameLimit.EctoSalvageLevel&&(e.type===Q.ItemEnum.Weapon||e.type===Q.ItemEnum.Armor||e.type===Q.ItemEnum.Trinket||e.type===Q.ItemEnum.Back)&&-1===e.flags.indexOf("NoSalvage"))return"Rare";if(e.type===Q.ItemEnum.Container)return e.rarity===Q.RarityEnum.Ascended?"ContainerAscended":-1!==a.indexOf("weapon")||-1!==a.indexOf("armor")||-1!==a.indexOf("skin")?"ContainerGear":e.rarity!==Q.RarityEnum.Rare&&e.rarity!==Q.RarityEnum.Exotic||-1===a.indexOf("gear")&&-1===n.indexOf("weapon")&&-1===n.indexOf("armor")&&-1===n.indexOf("gear")&&-1===n.indexOf("skin")?"Container":"ContainerGear";if(e.type===Q.ItemEnum.Trophy){if(-1!==n.indexOf("salvage item"))return"Salvage";if(-1!==n.indexOf("used to")||-1!==n.indexOf("to make"))return"Combine";if(e.rarity===Q.RarityEnum.Junk)return"Junk";if("Legendary"!==e.rarity&&(!1===Q.isTradeable(e)||-1!==n.indexOf("event item")||-1!==n.indexOf("task item")||e.vendor_value>0&&-1===e.flags.indexOf("NoSell")))return"Collection"}return e.type===Q.ItemEnum.Gizmo&&-1!==n.indexOf("combine")&&-1===n.indexOf("tier")?"Combine":e.type===Q.ItemEnum.Consumable?"Food"===e.details.type||"Utility"===e.details.type?"Food":"Transmutation"===e.details.type?"Skin":"Consumable":null},initializeCleanableFilter:function(e){var t="Cleanup";null!==Q.CleanableFilter?e():U.getScript(U.URL_DATA.Cleanup,function(){Q.CleanableFilter={};var a,n=U.getRecordData(t);for(var i in n)if("Food"!==i){a=n[i];for(var r=0;r<a.length;r++)Q.CleanableFilter[a[r]]=!0}e()})},isCleanable:function(e){return Q.CleanableFilter[e]||Q.categorizeCleanableItem(Q.getCachedItem(e),!0)},scanItem:function(e,t){var a=t||{},n=a.aItemMeta||{},i=Q.getBoxedItem(e.id);if(i&&i.oHTML)if(n.upgrades||n.infusions||n.skin||n.slot||n.bound_to||a.aWantAttr||a.aComment)Q.analyzeItem(e,t);else{if(a.aElement){var r=$(a.aElement);r.attr("title",i.oHTML),I.qTip.init(r)}a.aCallback&&a.aCallback(i)}else Q.analyzeItem(e,t)},analyzeItem:function(e,t){var a=t||{},n=[],i=[],r=null,o=null,s=!1,c=!0;a.aItemMeta&&(s=!0),a.aItemMeta=a.aItemMeta||{},a.aWantAttr&&A.isAccountInitialized&&(o=new A.Attribute.Base);var l=e,u=l.type,d="",p=l.details,h=p&&p.infix_upgrade&&p.infix_upgrade.buff?p.infix_upgrade.buff:null,m="Weapon"===u,g=m||"Armor"===u||"Trinket"===u||"Back"===u,f="Back"===u,C="Trinket"===u||f,v=l.rarity===Q.RarityEnum.Ascended||l.rarity===Q.RarityEnum.Legendary,b=!1,S=!0,y=!1,k=!1,_=0,P=0;p&&p.type&&(d=p.type,"Weapon"===u&&(b="Greatsword"===d||"Hammer"===d||"LongBow"===d||"ShortBow"===d||"Rifle"===d||"Staff"===d||"Harpoon"===d||"Speargun"===d||"Trident"===d));var L="",M=void 0!==l.rarity?l.rarity:Q.RarityEnum.Basic;L="<aside class='itmName "+Q.getRarityClass(M)+"'><img class='itmIcon itmIconMain' src='"+l.icon+"' />"+U.escapeHTML(l.name)+"</aside>";var w="";p&&void 0!==p.min_power&&void 0!==p.max_power&&(w+="<span class='itmText'>"+D.getString("WeaponStrength")+":</span> <span class='itmAttr'>"+p.min_power.toLocaleString()+" - "+p.max_power.toLocaleString()+"</span><br />");var O="";p&&p.defense>0&&(O+="<span class='itmText'>"+D.getString("Defense")+":</span> <span class='itmAttr'>"+p.defense.toLocaleString()+"</span><br />");var x="",N="";if(p&&p.infix_upgrade){var W=p.infix_upgrade.attributes;x+="<aside class='itmAttr'>",void 0!==p.infix_upgrade&&(g?(h&&h.description&&-1===h.description.indexOf("\n")&&(x+=U.escapeHTML(h.description)+"<br />"),W.forEach(function(e){x+="+"+parseInt(e.modifier)+" "+Q.getAttributeTranslation(e.attribute)+"<br />"})):h?(x+="<span class='itmBuff'>"+Q.formatItemDescription(l)+"</span>",N="<br />"):p.bonuses&&"Rune"===p.type&&(x+=Q.getRuneBonus(l))),x=N+x,x+="</aside>"}else if(a.aItemMeta.stats){var B=a.aItemMeta.stats.attributes;x+="<aside class='itmAttr'>";for(var R in B)x+="+"+B[R]+" "+Q.getAttributeTranslation(R)+"<br />";x+="</aside>"}else if("Consumable"===u)if(x+=D.getString("DoubleClickToConsume")+"<br />",void 0!==p.duration_ms){var H=p.icon||"img/account/item/nourishment"+("Food"===p.type||"Utility"===p.type?"_"+p.type.toLowerCase():"")+I.cPNG,z=p.name||("Immediate"===p.type?D.getString("Boost"):D.getString("Nourishment")),G=p.duration_ms>0?" ("+T.formatTooltipTimeMS(p.duration_ms,!0)+")":"";x+="<span class='itmConsumableLine'><img class='itmIcon itmConsumableIcon' src='"+H+"' /> <var class='itmGrayed itmConsumableDesc'>"+z+G+": "+Q.formatItemDescription(p.description)+"</var></span>"}else"Booze"===p.type&&(x+=D.getString("ExcessiveAlcohol")+"<br />");o&&Q.sumItemAttribute(o,{aItem:l,aStats:a.aItemMeta.stats});var F="";g&&(F=D.getString(l.rarity)+(f?"":"<br />"));var j="";p&&p.weight_class&&(j=D.getString(p.weight_class)+"<br />");var Z=Q.getItemType(l),K="";l.level>1&&(K+=D.getString("RequiredLevel")+": "+l.level+"<br />");var X="",q="",V=l.description||"";V=Q.formatItemDescription(V),l.description&&(V="<aside>"+V+"</aside>",g?q=V:X=V);var J="";g&&p&&void 0===p.infix_upgrade&&void 0===a.aItemMeta.stats&&(J=D.getString("DoubleClickToSelectStats")+"<br />");var Y="",ee={},te=function(e){Y+=D.getString(e)+"<br />"};l.flags&&(l.flags.forEach(function(e){ee[e]=!0}),ee.Unique&&te("Unique"),s&&a.aItemMeta.binding?(c=!1,"Character"===a.aItemMeta.binding&&a.aItemMeta.bound_to?Y+="<var class='itmColor_warning'>"+D.getString("SoulboundToCharacter")+": "+a.aItemMeta.bound_to+"</var><br />":"Account"===a.aItemMeta.binding&&te("AccountBound")):(ee.SoulbindOnAcquire?(k=!0,c=!1,te("SoulbindOnAcquire")):ee.SoulBindOnUse&&!1===k&&te("SoulBindOnUse"),ee.AccountBound?(y=!0,c=!1,te("AccountBound")):ee.AccountBindOnUse&&!1===y&&te("AccountBindOnUse")),ee.NoSell&&(S=!1));var ae="";a.aSoulbound&&(ae=D.getString("SoulboundToCharacter")+": "+U.escapeHTML(a.aSoulbound));var ne="";a.aComment&&(ne="<aside>"+a.aComment+"</aside>");var ie="",re=0;l.vendor_value>0&&S&&(re=a.aItemMeta.count?a.aItemMeta.count*l.vendor_value:l.vendor_value,ie=E.formatCoinString(re,{aWantColor:!0,aWantSpace:!0}));var oe,se="",ce="",le=[],ue=[],de=[],pe=[];if(g){if((v||!1===(v&&C))&&(se="<br />"),v&&p&&p.infusion_slots)for(R=0;R<p.infusion_slots.length;R++)oe=p.infusion_slots[R],ce="Amulet"===p.type?"Enrichment":"Infusion",ue.push("<img class='itmSlotIcon' src='img/account/item/"+ce.toLowerCase()+".png' /> "+D.getString("Unused"+ce+"Slot")+"<br /><br />"),void 0!==oe.item_id&&void 0===a.aItemMeta.infusions?(le.push(oe.item_id),P++):le.push(null);if(!1===(v&&C)){var he="<img class='itmSlotIcon' src='img/account/item/upgrade.png' /> "+D.getString("UnusedUpgradeSlot")+"<br /><br />";pe.push(he),pe.push(b?he:""),p&&p.suffix_item_id&&void 0===a.aItemMeta.upgrades?(de.push(p.suffix_item_id),P++):(de.push(null),b&&de.push(null))}}if(a.aItemMeta.infusions)for(R=0;R<a.aItemMeta.infusions.length;R++)R<le.length&&(le[R]=a.aItemMeta.infusions[R],le[R]&&P++);if(a.aItemMeta.upgrades)for(R=0;R<a.aItemMeta.upgrades.length;R++)R<de.length&&(de[R]=a.aItemMeta.upgrades[R],de[R]&&P++);var me="";a.aItemMeta.skin&&P++;for(var ge=function(){if(_===P){var e="<div class='itmTooltip'>"+L+w+O+x+X+se+(m?pe.join("")+ue.join(""):ue.join("")+pe.join(""))+me+F+j+Z+K+q+J+Y+ae+ie+ne+"</div>";if(a.aElement){var t=$(a.aElement);t.attr("title",e),I.qTip.init(t)}var u={oData:l,oInfusions:n,oUpgrades:i,oSkin:r,oAttr:o,oHTML:e,oIsTradeable:c};!1===s&&void 0===a.aComment&&(Q.Boxes.Items[l.id]=u),a.aCallback&&a.aCallback(u),_=null}},R=0;R<le.length;R++)null!==le[R]&&function(e,t){Q.getItem(t,function(t){ue[e]="<span class='itmUpgrade'><img class='itmSlotIcon' src='"+t.icon+"' /> "+t.name+"<br />"+t.details.infix_upgrade.buff.description+"</span><br /><br />",a.aCallback&&n.push(t),o&&Q.sumItemAttribute(o,{aItem:t}),_++,ge()}).fail(function(){P--,ge()})}(R,le[R]);for(R=0;R<de.length;R++)null!==de[R]&&function(e,t){Q.getItem(t,function(t){var n="";if("Rune"===t.details.type){var r=0;"HelmAquatic"===p.type?r=a.aRuneSets&&a.aRuneSets[t.id]?1+a.aRuneSets[t.id].numslotted:1:a.aRuneSets&&(r=a.aRuneSets),n=Q.getRuneBonus(t,r),o&&Q.sumItemAttribute(o,{aItem:t,aRuneSets:a.aRuneSets})}else n=t.name+"<br />"+Q.formatItemDescription(t),o&&Q.sumItemAttribute(o,{aItem:t});pe[e]="<aside class='itmUpgrade'><img class='itmSlotIcon' src='"+t.icon+"' /> "+n+"</aside><br />",a.aCallback&&i.push(t),_++,ge()}).fail(function(){P--,ge()})}(R,de[R]);a.aItemMeta.skin&&Q.getSkins(a.aItemMeta.skin,function(){var e=Q.getBoxedSkin(a.aItemMeta.skin);if(e){var t=e.oData;L="<aside class='itmName "+Q.getRarityClass(M)+"'><img class='itmIcon itmIconMain' src='"+t.icon+"' />"+U.escapeHTML(t.name)+"</aside>",me="<aside='itmTransmute'>"+D.getString("Transmuted")+"<br />"+U.escapeHTML(l.name)+"</aside><br /><br />",a.aCallback&&(r=t),_++,ge()}else P--,ge()}),_===P&&ge()},initializeBoxes:function(e,t){var a=U.toFirstUpperCase(e);for(var n in t)void 0===Q.Boxes[a][n]&&(Q.Boxes[a][n]={}),Q.Boxes[a][n].oData=t[n]},getBoxes:function(e,t,a){var n=t,i=[],r=Q.Boxes[e],o=function(){n=U.getUnique(n);for(var t in n)void 0===r[n[t]]&&i.push(n[t]);U.fetchAPI(U.getAPIURL(e),i,{aCallback:function(e){for(var t in e){var n=e[t];r[n.id]={},r[n.id].oData=n}a()}})};if("number"==typeof t){var s=t;r[s]?a():U.getJSON(U.getAPI(e.toLowerCase(),s),function(e){r[s]={},r[s].oData=e,a()}).fail(function(){a()})}else 0===t.length?a():!0===t?Q.isBoxedFully[e]?a():(Q.isBoxedFully[e]=!0,U.getJSON(U.getAPI(e),function(e){n=e,o()})):o()},getItems:function(e,t){Q.getBoxes("Items",e,t)},getSkins:function(e,t){Q.getBoxes("Skins",e,t)},getAchievements:function(e,t){Q.getBoxes("Achievements",e,t)},getTitles:function(e,t){Q.getBoxes("Titles",e,t)},getSpecializations:function(e,t){Q.getBoxes("Specializations",e,t)},getTraits:function(e,t){Q.getBoxes("Traits",e,t)},getSkills:function(e,t){Q.getBoxes("Skills",e,t)},getBoxedItem:function(e){return Q.Boxes.Items[e]},getBoxedSkin:function(e){return Q.Boxes.Skins[e]},getBoxedAchievement:function(e){return Q.Boxes.Achievements[e]},getBoxedTitle:function(e){return Q.Boxes.Titles[e]},getBoxedSpecialization:function(e){return Q.Boxes.Specializations[e]},getBoxedTrait:function(e){return Q.Boxes.Traits[e]},getBoxedSkill:function(e){return Q.Boxes.Skills[e]},getCachedItem:function(e){var t=Q.getBoxedItem(e);return t?t.oData:null},scanData:function(e,t,a){var n=a||{};if(t&&t.oHTML){if(n.aElement){var i=$(n.aElement);i.attr("title",t.oHTML),I.qTip.init(i)}n.aCallback&&n.aCallback(t)}else Q["analyze"+e](t.oData,a)},scanAchievement:function(e,t){Q.scanData("Achievement",Q.getBoxedAchievement(e),t)},scanSpecialization:function(e,t){Q.scanData("Specialization",Q.getBoxedSpecialization(e),t)},scanTrait:function(e,t){Q.scanData("Trait",Q.getBoxedTrait(e),t)},scanSkill:function(e,t){Q.scanData("Skill",Q.getBoxedSkill(e),t)},analyzeAchievement:function(e,t){var a=t||{},n=e,i="",r="<aside class='itmName achName'>"+U.escapeHTML(n.name)+"</aside>",o="",s="",c="",l="",u="",d="",p="";if(a.aWantIcon&&n.icon&&(i="<img class='achIcon' src='"+n.icon+"'/ >"),n.instruction&&(s="<aside class='achInstruction'>"+n.instruction+"</aside>"),n.description&&(o="<aside class='achDescription'>"+n.description+"</aside>"),n.requirement&&(c="<aside class='achRequirement'>"+n.requirement+"</aside>"),a.aWantCard)return r+(n.instruction?s:c.length?c:o);if(e.tiers){var h=a.aAchievement||Q.processAchievement(e),m=D.getWordCapital("tier");l="<aside class='achCount'>"+h.oAPCountCurrent.toLocaleString()+" / "+h.oAPCountPossible.toLocaleString()+" "+D.getWordCapital("completion")+" ("+U.convertRatioToPercent(h.oAPCountCurrent/h.oAPCountPossible)+")</aside>",u="<aside class='achTier'>"+m+" "+h.oAPTierCurrent+" "+D.getWord("of")+" "+h.oAPTierPossible+" "+m+"</aside>",d="<aside class='achPoints'>"+(h.oAPPointPossible>0?h.oAPPointCurrent+" / "+h.oAPPointPossible:"0")+" <img src='img/ui/ap.png' /></aside",p="<var class='achSearchPoints'>"+(h.oAPPointCurrent===h.oAPPointPossible?"":h.oAPPointCurrent+" / ")+E.formatAchievement(h.oAPPointPossible)+"</var>"}var g="<div class='itmTooltip "+(a.aClass||"")+"'><div class='achWrap'>"+i+"<div class='achText'>"+r+c+s+o+l+u+d+"</div></div></div>";if(a.aElement){var f=$(a.aElement);f.attr("title",g),I.qTip.init(f)}var C=Q.getBoxedAchievement(n.id)||{};if(C.oHTML=g,C.oSearchPoints=p,!a.aCallback)return g;a.aCallback(C)},processAchievement:function(e,t){var a=e.tiers,n=0,i=0,r=t&&void 0!==t.current?t.current:0,o=a[a.length-1].count,s=0,c=a.length;return a.forEach(function(e){t&&t.current>=e.count&&(s++,n+=e.points),i+=e.points}),{oAPPointCurrent:n,oAPPointPossible:i,oAPCountCurrent:r,oAPCountPossible:o,oAPTierCurrent:s,oAPTierPossible:c}},bindAchievement:function(e){var t=[],a=[];$(e).each(function(){var e=parseInt($(this).attr("data-ach"));e&&(t.push(e),a.push($(this)))}),Q.getAchievements(t,function(){for(var e=0;e<a.length;e++)Q.scanAchievement(t[e],{aElement:a[e]})})},formatSkillTrait:function(e){var t=function(e){var t=e.text,a=e.type,n=e.value,i=void 0!==e.target?Q.getAttributeTranslation(e.target):"",r=void 0!==e.source?Q.getAttributeTranslation(e.source):"",o="BuffConversion"===a?D.getString("GainBasedPercentage").replace("{0}",r).replace("{1}",i):"",s="<img class='trtFactIcon' src='"+e.icon+"' />",c=e.prefix&&e.prefix.icon?"<img class='trtFactIcon' src='"+e.prefix.icon+"' />":"",l=e.description,u=e.apply_count>1?"<var class='trtStacks'>"+e.apply_count+"</var>":"",d=void 0!==e.duration?e.duration+" "+D.getWord("seconds"):"",p=void 0!==e.duration?" ("+T.formatTooltipTime(e.duration)+")":"",h=e.status,m=e.field_type,g=e.finisher_type,f=e.percent+"%",C=e.hit_count+"x",v=e.distance,b=function(e,t){return"<var class='trtFactIcons'>"+e+"</var><var class='trtFactText'>"+t+"</var>"},S={AttributeAdjust:function(){return b(s,"+"+n+" "+i)},Buff:function(){return b(u+s,h+p+": "+l)},BuffConversion:function(){return b(s,o)},ComboField:function(){return b(s,t+": "+m)},ComboFinisher:function(){return b(s,t+": "+g+" ("+f+")")},Damage:function(){return b(s,t+": "+C)},Distance:function(){return b(s,t+": "+v)},Duration:function(){return b(s,t+": "+d)},Heal:function(){return b(s,t+": "+C)},HealingAdjust:function(){return b(s,t+": "+C)},NoData:function(){return b(s,t)},Number:function(){return b(s,t+": "+n)},Percent:function(){return b(s,t+": "+f)},PrefixedBuff:function(){return b(s+c,h+p+": "+l)},Radius:function(){return b(s,t+": "+v)},Range:function(){return b(s,t+": "+n)},Time:function(){return b(s,t+": "+d)},Unblockable:function(){return b(s,t)}};return S[a]?"<span class='trtFactLine'>"+S[a]()+"</span>":""},a="<span class='trtName'>"+e.name+"</span>",n="<span class='trtDesc'>"+Q.formatItemDescription(e.description)+"</span>",i="",r="",o="";return e.facts&&e.facts.length>0&&(r+="<aside class='trtFacts'>",e.facts.forEach(function(e){"Recharge"===e.type?i="<span class='trtRecharge'>"+e.value+"<img class='trtRechargeIcon' src='"+e.icon+"' /></span>":o+=t(e)}),r=""===o?"":r+o+"</aside>"),i+a+n+r},analyzeSkillTrait:function(e,t,a){var n=a||{},i=Q.formatSkillTrait(t),r=function(e){var t=$("#itemNull").empty(),a=$(e).appendTo(t).height();return t.empty(),a},o="",s=6,c=20;t.skills&&t.skills.forEach(function(e){var t="<div class='qTip'><div class='trtTooltip'>"+Q.formatSkillTrait(e)+"</div></div>";s+=r(t)+c,o+="<div class='trtTooltip trtTooltipExtra' style='margin-top:-"+s+"px'>"+Q.formatSkillTrait(e)+"</div>"});var l="<div class='trtTooltipBorder'>"+I.Symbol.Filler+"</div>"+o+"<div class='trtTooltip'>"+i+"</div>",u=Q.Boxes[e][t.id];if(u&&(u.oHTML=l),n.aElement){var d=$(n.aElement);d.attr("title",l),I.qTip.init(d),d.click(function(){I.prettyJSON(t)})}},analyzeTrait:function(e,t){Q.analyzeSkillTrait("Traits",e,t)},analyzeSkill:function(e,t){Q.analyzeSkillTrait("Skills",e,t)},getGuilds:function(e,t,a){var n=Array.isArray(e)?e:[e],i=void 0===a||a,r=[];if(i){for(var o in n){var s=n[o];void 0===Q.Boxes.Guilds[s]&&r.push(s)}if(0===r.length)return void t()}else r=n;var c=0,l=n.length;for(var o in r)U.getJSON(U.URL_API.Guild+r[o],function(e){e.oTag="["+e.tag+"]",Q.Boxes.Guilds[e.id]=e,++c===l&&t()},i).fail(function(){c--})},getCachedGuild:function(e){var t=Q.Boxes.Guilds[e];return t||null},initializeItemContextMenu:function(){I.styleContextMenu("#itmContext"),$("#itmContext").click(function(){$(this).hide()}),$("#itmContextWiki").click(function(){U.openExternalURL(U.getWikiLinkLanguage(Q.Context.ItemName))}),$("#itmContextYouTube").click(function(){U.openExternalURL(U.getYouTubeLink(Q.Context.ItemSearch))}),$("#itmContextTrading").click(function(){U.openExternalURL(U.getTradingItemLink(Q.Context.ItemID,Q.Context.ItemName))}),$("#itmContextTradingSearch").click(function(){E.printListings(Q.Context.ItemID)}),$("#itmContextInfo").click(function(){Q.Context.Item?Q.Context.Item.name?Q.printItemInfo(Q.Context.Item):I.prettyJSON(Q.Context.Item):I.print("No information available.")}),I.bindClipboard("#itmContextChatlink")},bindItemSlotBehavior:function(e,t){var a=t||{};e.contextmenu(function(e){e.preventDefault();var t;a.aItem?(Q.Context.Item=a.aItem,Q.Context.ItemName=a.aItem.name,Q.Context.ItemID=a.aTradeableID||a.aItem.id,Q.Context.ItemSearch=a.aSearch||a.aItem.name,t=a.aItem.chat_link+" "+Q.Context.ItemSearch):(Q.Context.Item=a.aObject,Q.Context.ItemName=a.aSearch,Q.Context.ItemID=a.aTradeableID,Q.Context.ItemSearch=a.aSearch,t=a.aChatlink||"No chatlink available."),I.updateClipboard("#itmContextChatlink",t),I.showContextMenu("#itmContext")}),a.aWantClick&&e.click(function(e){e.which===I.ClickEnum.Left&&U.openExternalURL(U.getWikiSearchLanguage(a.aItem.name))})},bindItemSearch:function(e,t){var a,n,i,r=t||{},o=$(e).wrap("<span class='itmSearchContainer "+(r.aIsInline?"itmSearchInline":"")+"'></span>"),s=void 0===r.aDatabase,c=D.isLanguageLogographic||!s?1:2,l=4,u=r.aResultsLimit||O.Options.int_numTradingResults,d=$("<div class='itmSearchResultContainer jsHidable'></div>").insertAfter(o).hide(),p=$("<div class='itmSearchResultScroll cntPopup jsScrollable'></div>").appendTo(d),h=$("<div class='itmSearchResultList'></div>").appendTo(p),m="<var class='itmSearchResultNone'>"+D.getPhraseOriginal("Not found")+".</var>",g=[],f=[],C=[];if(null!==r.aFillerText&&I.bindInputBarText(o,r.aIsSelect?I.Symbol.TriDown+" "+r.aFillerText:r.aFillerText),r.aResultsClass&&p.addClass(r.aResultsClass),I.bindScrollbar(p),r.aIsSelect&&(C=r.aDatabase),r.aDatabase)for(var v in r.aDatabase){var b=r.aDatabase[v];g.push([b,b.keywords||b.name.toLowerCase()])}var S=function(){n=!0,f=[]},T=function(e,t){h.empty().removeData("selectedresult"),d.toggle(e),t&&h.html(t),!1===e&&(S(),I.qTip.hide())},y="<br />"+(s?"Right click an item for menu.<br />Type a number to search by item ID.":r.aInfo||""),k=$("<ins class='itmSearchClose btnWindow btnClose' title='<dfn>Close the search results.</dfn>"+y+"'></ins>").appendTo(d).click(function(){r.aCancel&&r.aCancel(),T(!1)});I.qTip.init(k);var _=function(e,t,a,n){t.click(function(){r.aCallback&&(r.aCallback(a),(n||r.aWantClose)&&T(!1)),e.removeData("selectedresult")})},P=function(e,t){if(0!==e.length){if(T(!0),s){i=(new Date).getTime(),h.append(I.cThrobber);for(a=0;a<e.length;a++)h.append("<span class='itmSearchResultLine itmSearchResultLine_"+e[a]+"'></span>");!function(a){Q.getPricedItems(e,function(){if(a===i){I.removeThrobber(h);for(var n=0;n<e.length;n++){var r=e[n],o=Q.getCachedItem(r);if(null!==o){var s=$("<dfn class='itmSearchResultEntry "+Q.getRarityClass(o.rarity)+"' data-id='"+r+"'><img src='"+o.icon+"'>"+U.highlightSubstring(o.name,t)+"</dfn>").appendTo(h.find(".itmSearchResultLine_"+r));_(h,s,o,!0),I.updateScrollbar(p),Q.scanItem(o,{aElement:s}),Q.bindItemSlotBehavior(s,{aItem:o});var c=E.getCachedPrice(r);if(c){var l="<span class='itmSearchResultPrice'>"+E.formatCoinStringSlot(c.oPriceSell)+" <var class='cssFaded'>"+E.formatCoinStringSlot(c.oPriceBuy)+"</var></span>";s.append(l)}}}}},!0)}(i)}else{for(var a=0;a<e.length;a++){var o=$("<span class='itmSearchResultLine'><dfn class='itmSearchResultEntry'><img src='"+(e[a].icon||"img/ui/sixteen/bullet.png")+"' />"+U.highlightSubstring(e[a].name,t)+"</dfn></span>").appendTo(h);_(h,o,e[a]),r.aAchievements&&function(e,t){var a=e.id;Q.analyzeAchievement(e,{aAchievement:Q.processAchievement(e,r.aAchievements[a]),aElement:t,aCallback:function(e){t.append(e.oSearchPoints)}})}(e[a],o.find(".itmSearchResultEntry").first())}I.updateScrollbar(p)}e.length===u&&$("<span class='itmSearchResultNext curClick'>"+D.getWordCapital("next")+" &gt;</span>").prependTo(h).click(function(){!1===n&&(n=!0,A(f[f.length-1])),A(f[f.length-1])}),f.length>1&&$("<span class='itmSearchResultPrev curClick'>&lt; "+D.getWordCapital("previous")+"</span>").prependTo(h).click(function(){!0===n&&(f.pop(),n=!1),f.pop(),A(f[f.length-1]),f.pop()})}else T(!0,m)},A=function(e){var t,n,i,d,p,h=void 0===e?0:e,m=o.val().toLowerCase(),v=[],b=s?a:g;if(!r.aIsSelect||m.length)if(m.length<c)T(!1);else if(U.isInteger(m)&&void 0===r.aDatabase&&m.length>=l)P([parseInt(m)],m);else{for(var S=h;S<b.length;S++){t=b[S],n=m.split(" "),i=t[0],d=t[1],p=!0;for(var y=0;y<n.length;y++)-1!==d.indexOf(n[y])||(p=!1);if(p&&v.push(i),v.length>=u)return void 0===e&&0!==f.length||f.push(S+1),void P(v,m)}void 0===e&&0!==f.length||f.push(h),P(v,m)}else P(C,"")},L=function(e){var t=h.data("selectedresult")||h.find(".itmSearchResultEntry").first().parent();if(t&&t.length){var a=e?t.next():t.prev();a&&a.hasClass("itmSearchResultLine")&&(h.find(".itmSearchSelected").removeClass("itmSearchSelected"),h.data("selectedresult",a),a.addClass("itmSearchSelected"),I.scrollToElement(a,{aContainer:p,aOffset:-p.height()/2}))}};o.one("click",function(){T(!0),h.append(I.cThrobber);var e=function(){if(s)if(r.aSubset){a=[];for(var e=0;e<Q.SearchDatabase.length;e++)r.aSubset[Q.SearchDatabase[e][0]]&&a.push(Q.SearchDatabase[e])}else a=Q.SearchDatabase;T(!1),o.on("input",$.throttle(E.cSEARCH_LIMIT,function(){A()})).click(function(){A(),$(this).select()}).onEscapeKey(function(){T(!1)}),!1!==r.aWantEnter&&o.onEnterKey(function(){var e=h.data("selectedresult")||h.find(".itmSearchResultEntry").first().parent();e&&e.length&&e.find(".itmSearchResultEntry").trigger("click")}).onArrowDownKey(function(){L(!0)}).onArrowUpKey(function(){L(!1)}),o.trigger("input")};s?Q.loadItemsSearch(function(){e()}):e()}).click(function(){S()})},getItemPreface:function(e,t){var a=t>1?t+" ":"",n=U.escapeHTML(e.name);return"<div class='itmPreface'><aside class='itmPrefaceLeft'><a class='itmPrefaceIcon'"+U.convertExternalAnchor(U.getWikiItemDefault(e))+"'><img class='itmPrefaceIconImage' src='"+e.icon+"' /></a> <var class='itmPrefaceName "+Q.getRarityClass(e.rarity)+"'>"+a+n+"</var></aside><aside class='itmPrefaceRight'><input class='cssInputText' type='text' value='"+n+"' /><br /><input class='cssInputText' type='text' value='"+U.escapeHTML(e.chat_link)+"' /><br /><input class='cssInputText' type='text' value='"+e.id+"' /></aside></div>"},printItemInfo:function(e,t){I.print(Q.getItemPreface(e)),I.prettyJSON(e),Q.isTradeable(e)&&t&&E.printListings(e.id,!1),I.bindConsoleInput()}},E={Exchange:{COPPER_IN_SILVER:100,COPPER_IN_GOLD:1e4,SILVER_IN_GOLD:100,CENTS_IN_DOLLAR:100,GEM_PER_DOLLAR:.8,DOLLAR_PER_GEM:1.25,GEM_SAMPLE:100,COIN_SAMPLE:1e6,TAX_LIST:.05,TAX_SOLD:.1,TAX_TOTAL:.15,TAX_INVERSE:.85,GemInCoin:0,CoinInGem:0},cREFRESH_LIMIT:5e3,cSEARCH_LIMIT:750,cEXCHANGE_LIMIT:250,isTradingCalculatorsInitialized:!1,ItemsArray:[],RefreshTimeout:{},ProgressTimeout:{},ProgressWait:0,ProgressTick:0,SwapIndex:-1,CalculatorHistoryArray:new Array(64),CalcHistoryIndex:0,Pricelist:{},Paylist:{},PaymentFormat:{coin:function(e){return E.formatCoinStringShort(e)},gem:function(e){return E.formatGemString(e,!0)},karma:function(e){return E.formatKarmaString(e,!0)},laurel:function(e){return E.formatLaurelString(e,!0)},token:function(e){return e.toLocaleString()+"<ins class='s16 s16_token'></ins>"},mastery:function(e){return e.toLocaleString()+"<ins class='s16 s16_mastery'></ins>"},achievement:function(e){return e.toLocaleString()+"<ins class='s16 s16_achievement'></ins>"},monument:function(e){return e.toLocaleString()+"<ins class='s16 s16_monument'></ins>"},craft:function(){return"<ins class='s16 s16_craft'></ins>"},pvp:function(){return"<ins class='s16 s16_pvp'></ins>"},starting:function(){return"<ins class='s16 s16_starting'></ins>"},spirit:function(e){return e.toLocaleString()+"<ins class='s16 s16_spirit'></ins>"},cob:function(e){return e.toLocaleString()+"<ins class='s16 s16_cob'></ins>"},blticket:function(e){return e.toLocaleString()+"<ins class='s16 s16_blticket'></ins>"},bubble:function(e){return e.toLocaleString()+"<ins class='s16 s16_bubble'></ins>"},badge:function(e){return(0===e?"":e.toLocaleString())+"<ins class='s16 s16_badge'></ins>"},proof:function(e){return e.toLocaleString()+"<ins class='s16 s16_proof'></ins>"},testimony:function(e){return e.toLocaleString()+"<ins class='s16 s16_testimony'></ins>"},commendation:function(e){return e.toLocaleString()+"<ins class='s16 s16_commendation'></ins>"},provisioner:function(e){return e.toLocaleString()+"<ins class='s16 s16_provisioner'></ins>"},contract:function(e){return e.toLocaleString()+"<ins class='s16 s16_contract'></ins>"},mosaic:function(e){return e.toLocaleString()+"<ins class='s16 s16_mosaic'></ins>"},skirmish:function(e){return e.toLocaleString()+"<ins class='s16 s16_skirmish'></ins>"},league:function(e){return e.toLocaleString()+"<ins class='s16 s16_league'></ins>"},glory:function(e){return e.toLocaleString()+"<ins class='s16 s16_glory'></ins>"},dungeon_ac:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_ac'></ins>"},dungeon_arah:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_arah'></ins>"},dungeon_cm:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_cm'></ins>"},dungeon_se:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_se'></ins>"},dungeon_ta:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_ta'></ins>"},dungeon_hotw:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_hotw'></ins>"},dungeon_cof:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_cof'></ins>"},dungeon_coe:function(e){return e.toLocaleString()+"<ins class='s16 s16_dungeon_coe'></ins>"},fotm_relic:function(e){return e.toLocaleString()+"<ins class='s16 s16_fotm_relic'></ins>"},fotm_pristine:function(e){return e.toLocaleString()+"<ins class='s16 s16_fotm_pristine'></ins>"},matrix:function(e){return e.toLocaleString()+"<ins class='s16 s16_matrix'></ins>"},magnetite:function(e){return e.toLocaleString()+"<ins class='s16 s16_magnetite'></ins>"},map_dt:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_dt'></ins>"},map_sw:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_sw'></ins>"},map_vb:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_vb'></ins>"},map_ab:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_ab'></ins>"},map_td:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_td'></ins>"},map_ds:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_ds'></ins>"},magic:function(e){return e.toLocaleString()+"<ins class='s16 s16_magic'></ins>"},map_bs:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_bs'></ins>"},map_eb:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_eb'></ins>"},map_bf:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_bf'></ins>"},map_ld:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_ld'></ins>"},map_dm:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_dm'></ins>"},map_sl:function(e){return e.toLocaleString()+"<ins class='s16 s16_map_sl'></ins>"}},PaymentEnum:{Coin:"Coin",Gem:"Gem"},formatPayment:function(e,t){var a=E.PaymentFormat[e];return a?a(t):"unknown"},formatAchievement:function(e){return E.formatPayment("achievement",e)},getPaymentAmount:function(e){for(var t in e.p)return e.p[t];return 0},parseCoinString:function(e){if(void 0===e||null===e)return 0;var t=e.replace(/[^0-9.-]/gi,"").split("."),a=t.length,n=0,i=0,r=0;return 0===a?0:(1===a&&(i=parseInt(t[0])),a>=2&&(n=parseInt(t[a-1]),i=parseInt(t[a-2])),2===a&&1===t[a-1].length&&(n*=T.cBASE_10),a>=3&&(r=parseInt(t[a-3])),isFinite(n)||(n=0),isFinite(i)||(i=0),isFinite(r)||(r=0),parseInt(n+i*E.Exchange.COPPER_IN_SILVER+r*E.Exchange.COPPER_IN_GOLD))},parseGemString:function(e){return void 0===e||null===e?0:isFinite(parseInt(e))?parseInt(e):0},parseMoneyString:function(e){if(void 0===e||null===e)return 0;var t=e.split("."),a=t.length,n=0,i=0;return 0===a?0:(1===a&&(i=parseInt(t[0])),a>=2&&(n=parseInt(t[a-1]),i=parseInt(t[a-2])),a>=2&&1===t[a-1].length?n*=T.cBASE_10:a>=2&&t[a-1].length>=2&&(n=parseInt(n.toString().substring(0,2))),isFinite(n)||(n=0),isFinite(i)||(i=0),parseInt(n+i*E.Exchange.CENTS_IN_DOLLAR))},formatCoinString:function(e,t){var a=void 0===e||!1===isFinite(e)?0:parseInt(e),n=t||{},i=".",r="",o="",s="",c="",l="",u="",d="",p="",h="";!1!==n.aWantCopy&&(d="<abbr class='cssCopyText'>"+D.getString("CoinGold")+"&nbsp;</abbr>",p="<abbr class='cssCopyText'>"+D.getString("CoinSilver")+"&nbsp;</abbr>",h="<abbr class='cssCopyText'>"+D.getString("CoinCopper")+"&nbsp;</abbr>"),n.aWantColor&&(i="",r="<gold>",o="<silver>",s="<copper>",c="</gold>"+d+"<goldcoin></goldcoin>",l="</silver>"+p+"<silvercoin></silvercoin>",u="</copper>"+h+"<coppercoin></coppercoin>"),n.aWantBig&&(i="",r="<gold>",o="<silver>",s="<copper>",c="</gold>"+d+"<img src='img/ui/coin_gold.png' />",l="</silver>"+p+"<img src='img/ui/coin_silver.png' />",u="</copper>"+h+"<img src='img/ui/coin_copper.png' />"),n.aWantSpace&&(i=" ");var m=Math.abs(~~(a/E.Exchange.COPPER_IN_GOLD)),g=Math.abs(~~(a/E.Exchange.SILVER_IN_GOLD)%E.Exchange.COPPER_IN_SILVER),f=Math.abs(a%E.Exchange.COPPER_IN_SILVER),C=n.aWantColor||n.aWantBig||n.aWantShort?m.toLocaleString():m,v=g,b=f,S=a<0?I.Symbol.Negative:"";return!n.aWantColor&&m>0&&g<T.cBASE_10&&(v="0"+g),!n.aWantColor&&(g>0&&f<T.cBASE_10||f<T.cBASE_10)&&(b="0"+f),n.aWantShort&&((m>0||0===f&&a>0)&&(s="",b="",u=""),0===g&&(o="",v="",l="")),m>0?S+r+C+c+i+o+v+l+i+s+b+u:g>0?S+o+v+l+i+s+b+u:n.aWantColor?s+b+u:S+o+"0"+i+l+s+b+u},formatCoinStringColored:function(e){return E.formatCoinString(e,{aWantColor:!0})},formatCoinStringShort:function(e){return E.formatCoinString(e,{aWantColor:!0,aWantShort:!0})},formatCoinStringSlot:function(e){return E.formatCoinString(e,{aWantColor:!0,aWantShort:!0,aWantCopy:!1})},formatMoneyString:function(e,t){if(void 0===e||!1===isFinite(e))return"0.00";e=parseInt(e);var a=Math.abs(~~(e/E.Exchange.CENTS_IN_DOLLAR)),n=Math.abs(e%E.Exchange.CENTS_IN_DOLLAR),i=e<0?I.Symbol.Negative:"";return n<T.cBASE_10&&(n="0"+n),(t?"<money>":"")+i+"$"+a+"."+n+(t?"</money>":"")},formatCurrencyString:function(e,t,a){if(void 0===t||!1===isFinite(t))return"0";t=parseInt(t);var n=e,i="",r="",o="<"+n+"unit></"+n+"unit>";return a&&(i="<"+n+">",r="</"+n+">"),i+t.toLocaleString()+r+o},formatKarmaString:function(e,t){return E.formatCurrencyString("karma",e,t)},formatLaurelString:function(e,t){return E.formatCurrencyString("laurel",e,t)},formatGemString:function(e,t){return E.formatCurrencyString("gem",e,t)},animateValue:function(e,t,a){a<t?e.css({color:"#ff2200"}).animate({color:"#ffeebb"},5e3):a>t?e.css({color:"#44dd44"}).animate({color:"#ffeebb"},5e3):e.css({"border-radius":32}).animate({"border-radius":4},1e3)},updateCoinInGem:function(e){$.getJSON(U.URL_API.GemPrice+E.Exchange.COIN_SAMPLE,function(t){void 0!==t.quantity&&(E.Exchange.CoinInGem=E.Exchange.COIN_SAMPLE/t.quantity,e())}).fail(function(){e()})},updateGemInCoin:function(e){$.getJSON(U.URL_API.CoinPrice+E.Exchange.GEM_SAMPLE,function(t){void 0!==t.quantity&&(E.Exchange.GemInCoin=E.Exchange.GEM_SAMPLE/t.quantity,e())}).fail(function(){e()})},updateExchangeRatios:function(e){E.updateCoinInGem(function(){E.updateGemInCoin(function(){e()})})},convertGemToCoin:function(e){return Math.round(e*E.Exchange.CoinInGem)},convertCoinToGem:function(e){return Math.round(e*E.Exchange.GemInCoin)},convertGemToMoney:function(e){return Math.round(e*E.Exchange.DOLLAR_PER_GEM)},convertMoneyToGem:function(e){return Math.floor(e*E.Exchange.GEM_PER_DOLLAR)},formatGemToCoin:function(e){return E.formatCoinStringShort(E.convertGemToCoin(e))},formatCoinToGem:function(e){return E.formatGemString(E.convertCoinToGem(e),!0)},formatGemToMoney:function(e){return E.formatMoneyString(E.convertGemToMoney(e),!0)},formatMoneyToGem:function(e){return E.formatGemString(E.convertMoneyToGem(e),!0)},getGemFromCoin:function(e,t){$.getJSON(U.URL_API.GemPrice+e,function(e){if(void 0!==e.quantity){var a=parseInt(e.quantity);t(a)}}).fail(function(){t(0)})},getGemFromCoinInverse:function(e,t){E.updateGemInCoin(function(){0!==E.Exchange.GemInCoin&&t(E.convertCoinToGem(e))})},getCoinFromGem:function(e,t){$.getJSON(U.URL_API.CoinPrice+e,function(e){if(void 0!==e.quantity){var a=parseInt(e.quantity);t(a)}}).fail(function(){t(0)})},getCoinFromGemInverse:function(e,t){E.updateCoinInGem(function(){t(E.convertGemToCoin(e))})},deductTax:function(e){return Math.floor(e-e*E.Exchange.TAX_TOTAL)},processPrice:function(e,t){var a=void 0===t?1:t,n=Array.isArray(e),i=(n?e[0]:e.buys.unit_price)*a,r=(n?e[1]||e[0]:e.sells.unit_price||e.buys.unit_price)*a;return{oPriceBuy:i,oPriceSell:r,oPriceBuyTaxed:E.deductTax(i),oPriceSellTaxed:E.deductTax(r)}},createPrice:function(e,t){var a=void 0===t?1:t,n=void 0===e?0:e*a;return{oPriceBuy:n,oPriceSell:n,oPriceBuyTaxed:E.deductTax(n),oPriceSellTaxed:E.deductTax(n)}},createPricePlain:function(e,t){var a=void 0===t?1:t,n=void 0===e?0:e*a;return{oPriceBuy:n,oPriceSell:n,oPriceBuyTaxed:n,oPriceSellTaxed:n}},createPriceBound:function(e,t){if(E.isPriceObject(e))return{oPriceBuy:e.oPriceBuy,oPriceSell:e.oPriceSell,oPriceBuyTaxed:0,oPriceSellTaxed:0};var a=void 0===t?1:t,n=void 0===e?0:e*a;return{oPriceBuy:n,oPriceSell:n,oPriceBuyTaxed:0,oPriceSellTaxed:0}},addPrice:function(e,t){return{oPriceBuy:e.oPriceBuy+t.oPriceBuy,oPriceSell:e.oPriceSell+t.oPriceSell,oPriceBuyTaxed:e.oPriceBuyTaxed+t.oPriceBuyTaxed,oPriceSellTaxed:e.oPriceSellTaxed+t.oPriceSellTaxed}},recountPrice:function(e,t){return{oPriceBuy:e.oPriceBuy*t,oPriceSell:e.oPriceSell*t,oPriceBuyTaxed:e.oPriceBuyTaxed*t,oPriceSellTaxed:e.oPriceSellTaxed*t}},isPriceObject:function(e){return void 0!==e.oPriceBuy},getPrice:function(e,t,a){var n=void 0!==a&&a;Q.isTradeable(e)&&$.ajax({dataType:"json",url:U.getAPIPrice(e),cache:n,success:function(e){if(E.Pricelist[e.id]=a,t){var a=E.processPrice(e);t(a)}}})},getCachedPrice:function(e){var t=E.Pricelist[e];return t||null},getPrices:function(e,t,a){var n,i=[];if(e&&e.length)for(var r=0;r<e.length;r++)n=e[r],(void 0===Q.Boxes.Items[n]||Q.Boxes.Items[n]&&Q.isTradeable(Q.Boxes.Items[n].oData))&&i.push(n);U.fetchAPI(U.URL_API.ItemPrice,i,{aWantCache:a,aCallback:function(e,a){var n={};e?(e.forEach(function(e){var t=E.processPrice(e);n[e.id]=t,E.Pricelist[e.id]=t}),t(n,a)):t()}})},getPriceObject:function(e,t){E.Pricelist[e]?t(E.Pricelist[e]):E.getPrice(e,function(e){t(e)})},getListings:function(e,t,a){var n=void 0!==a&&a;Q.isTradeable(e)?$.ajax({dataType:"json",url:U.getAPIListings(e),cache:n,success:function(e){t&&t(e)},error:function(){I.removeThrobber(I.getConsole()),I.print("Item is not on the Trading Post.")}}):(I.clear(),I.write("Item is not tradeable."))},formatListings:function(e,t){var a="",n=D.getWordCapital("price"),i=D.getWord("by"),r="",o="",s=0,c=0,l=0,u=0;t.buys.forEach(function(e){r+="<tr><td>"+e.quantity+" "+D.getWordCapital("ordered")+"</td><td>"+E.formatCoinStringColored(e.unit_price)+"</td></tr>",c+=e.quantity,u+=e.listings}),r+="</tbody></table>",t.sells.forEach(function(e){o+="<tr><td>"+e.quantity+" "+D.getWordCapital("available")+"</td><td>"+E.formatCoinStringColored(e.unit_price)+"</td></tr>",s+=e.quantity,l+=e.listings}),o+="</tbody></table>";var d="<span class='trsListingsDemand'>"+D.getWordCapital("demand")+": "+c.toLocaleString()+" "+i+" "+u.toLocaleString()+"</span>",p="<span class='trsListingsSupply'>"+D.getWordCapital("supply")+": "+s.toLocaleString()+" "+i+" "+l.toLocaleString()+"</span>";return a+="<div class='trsListings'>"+("<table class='trsListingsBuys'><thead><tr><th>"+d+"</th><th>"+n+"</th></tr></thead><tbody>")+r+("<table class='trsListingsSells'><thead><tr><th>"+p+"</th><th>"+n+"</th></tr></thead><tbody>")+o+"</div>"},printListings:function(e,t){!1!==t&&I.print(I.cThrobber,!0),Q.getItem(e,function(a){E.getListings(e,function(e){!1!==t&&(I.clear(),I.print(Q.getItemPreface(a))),I.print(E.formatListings(a,e)),I.bindConsoleInput()})})},calculateTrading:function(e){var t=E.parseCoinString(e.find(".trdBuy").val()),a=E.parseCoinString(e.find(".trdSell").val()),n=T.parseQuantity(e.find(".trdQuantity").val()),i=e.find(".trdCost"),r=e.find(".trdTax"),o=e.find(".trdRevenue"),s=e.find(".trdProfit"),c=e.find(".trdBreak"),l=e.find(".trdMargin"),u=(a-a*E.Exchange.TAX_TOTAL-t)*n,d=(a-a*E.Exchange.TAX_SOLD)*n,p=t*n,h=a*E.Exchange.TAX_LIST*n,m=a*E.Exchange.TAX_SOLD*n;i.val(I.Symbol.Negative+E.formatCoinString(Math.round(p))),r.val(I.Symbol.Negative+E.formatCoinString(Math.round(h))+" + −"+E.formatCoinString(Math.round(m))),c.val(E.formatCoinString(Math.round(t/E.Exchange.TAX_INVERSE))),o.val(E.formatCoinString(Math.round(d))),s.val(E.formatCoinString(Math.round(u))),l.val(U.convertRatioToPercent(d/(p+h)-1,2)),$([s,l]).each(function(){var e=Math.round(u);$(this).removeClass("trdZero trdGain trdLoss"),0===e?$(this).addClass("trdZero"):e>0?$(this).addClass("trdGain"):e<0&&$(this).addClass("trdLoss")})},getTradingIDs:function(){var e=[];return X.Textlists.TradingItem.value.forEach(function(t){var a=parseInt(t);isFinite(parseInt(a))&&e.push(a)}),e},updateTradingDetails:function(e){var t=e.find(".trdName").val(),a=e.find(".trdItem").val();!1!==isFinite(parseInt(a))&&0!==t.length&&Q.getItem(a,function(t){var a=e.find(".trdIcon");Q.setRarityClass(e.find(".trdName"),t.rarity),e.attr("data-rarity",t.rarity),e.find(".trdLink").val(t.chat_link||""),a.attr("src",t.icon),a.unbind("click").click(function(){Q.printItemInfo(t)}),Q.scanItem(t,{aElement:a,aCallback:function(t){e.data("istradeable",t.oIsTradeable)}})})},updateTradingPrices:function(e,t){var a=e.find(".trdName").val(),n=e.find(".trdItem").val();if(!1!==isFinite(parseInt(n))&&0!==a.length){var i=0,r=0,o=0,s=0,c=e.find(".trdName"),l=e.find(".trdCurrentBuy"),u=e.find(".trdCurrentSell"),d=e.find(".trdNotifyBuyLow"),p=e.find(".trdNotifyBuyHigh"),h=e.find(".trdNotifySellLow"),m=e.find(".trdNotifySellHigh"),g=E.parseCoinString(d.val()),f=E.parseCoinString(p.val()),C=E.parseCoinString(h.val()),v=E.parseCoinString(m.val()),b=!1!==t,S=e.find(".trdIcon");if(S=S.length&&S.attr("src").length?S.attr("src"):"img/notification/tp.png",!1===e.data("istradeable"))return l.val(""),u.val(""),void(X.getChecklistItem(X.Checklists.TradingOverwrite,U.getSubintegerFromHTMLID(e))===X.ChecklistEnum.Checked&&(e.find(".trdBuy").val("").trigger("input"),e.find(".trdSell").val("").trigger("input")));var T=function(t){if(!t)return l.val(I.Symbol.Ellipsis),void u.val(I.Symbol.Ellipsis);if(i=E.parseCoinString(e.find(".trdCurrentBuy").first().val()),r=E.parseCoinString(e.find(".trdCurrentSell").first().val()),o=t.oPriceBuy,s=t.oPriceSell,l.val(E.formatCoinString(o)),u.val(E.formatCoinString(s)),X.getChecklistItem(X.Checklists.TradingOverwrite,U.getSubintegerFromHTMLID(e))===X.ChecklistEnum.Checked&&(e.find(".trdBuy").val(l.val()).trigger("input"),e.find(".trdSell").val(u.val()).trigger("input")),E.animateValue(l,i,o),E.animateValue(u,r,s),X.isChecked(X.Checklists.TradingNotify,e)){c.removeClass("trdMatched");var n;o<=g&&0!==g&&0!==o?(c.addClass("trdMatched"),d.addClass("trdMatched"),n=D.getPhraseTitle("buy low")+" "+a,D.speak(n),I.notify({aTitle:a,aBody:n,aIcon:S})):d.removeClass("trdMatched"),o>=f&&0!==f&&0!==o?(c.addClass("trdMatched"),p.addClass("trdMatched"),n=D.getPhraseTitle("buy high")+" "+a,D.speak(n),I.notify({aTitle:a,aBody:n,aIcon:S})):p.removeClass("trdMatched"),s<=C&&0!==C&&0!==s?(c.addClass("trdMatched"),h.addClass("trdMatched"),n=D.getPhraseTitle("sell low")+" "+a,D.speak(n),I.notify({aTitle:a,aBody:n,aIcon:S})):h.removeClass("trdMatched"),s>=v&&0!==v&&0!==s?(c.addClass("trdMatched"),m.addClass("trdMatched"),n=D.getPhraseTitle("sell high")+" "+a,D.speak(n),I.notify({aTitle:a,aBody:n,aIcon:S})):m.removeClass("trdMatched")}};b?T(E.getCachedPrice(n)):E.getPrice(n,function(e){T(e)})}},updateAllTradingDetails:function(){Q.getItems(E.getTradingIDs(),function(){$("#trdList .trdEntry").each(function(){E.updateTradingDetails($(this))})})},updateAllTradingPrices:function(){E.getPrices(E.getTradingIDs(),function(){$("#trdList .trdEntry").each(function(){E.updateTradingPrices($(this))})})},clearCalculator:function(e){Q.setRarityClass(e.find(".trdName")),e.find(".trdIcon").attr("src",U.URL_IMG.Placeholder),e.find(".trdItem").val("").trigger("change"),e.find(".trdCurrentBuy").val(""),e.find(".trdCurrentSell").val(""),e.find(".trdLink").val(""),e.find(".trdNotifyBuyLow").val("").trigger("change"),e.find(".trdNotifyBuyHigh").val("").trigger("change"),e.find(".trdNotifySellLow").val("").trigger("change"),e.find(".trdNotifySellHigh").val("").trigger("change"),E.clearMatched(e)},clearMatched:function(e){e.find(".trdName").removeClass("trdMatched"),e.find(".trdNotifyBuyLow").removeClass("trdMatched"),e.find(".trdNotifyBuyHigh").removeClass("trdMatched"),e.find(".trdNotifySellLow").removeClass("trdMatched"),e.find(".trdNotifySellHigh").removeClass("trdMatched")},initializeTrading:function(){var e,t,a,n,i,r="";for(e=0;e<O.Options.int_numTradingCalculators;e++)r="#trdEntry_"+e,$("#trdList").append("<div id='trdEntry_"+e+"' class='trdEntry'><div class='trdAccordion trdAccordionShut'><abbr><img class='trdIcon' src='"+U.URL_IMG.Placeholder+"' /></abbr><div class='trdResultsFocus'><input class='trdName' type='text' /></div><div class='trdButtons'><button class='trdSearch' tabindex='-1'>S</button><button class='trdListings' tabindex='-1'>$</button><br /></div><div class='trdExpand'><abbr>$~O</abbr><input class='trdBuy' type='text' /><abbr>−$~</abbr><input class='trdCost trdOutput' type='text' tabindex='-1' /><br /><abbr>O~$</abbr><input class='trdSell' type='text' /><abbr>$=$</abbr><input class='trdBreak trdOutput' type='text' tabindex='-1' /><br /><abbr>×</abbr><input class='trdQuantity' type='text' /><abbr>−$%</abbr><input class='trdTax trdOutput' type='text' tabindex='-1' /><br /><abbr>+$</abbr><input class='trdProfit trdOutput' type='text' tabindex='-1' /><abbr>=$</abbr><input class='trdRevenue trdOutput' type='text' tabindex='-1' /><br /><abbr>+$%</abbr><input class='trdMargin trdOutput' type='text' tabindex='-1' /><abbr>[]</abbr><input class='trdLink trdOutput' type='text' tabindex='-1' /><input class='trdItem trdOutput' type='text' /><br /><abbr>$~!</abbr><input class='trdNotifyBuyHigh' type='text' /><input class='trdCurrentBuy trdOutput' type='text' tabindex='-1' /><input class='trdNotifyBuyLow' type='text' /><label title='<dfn>"+D.getWordCapital("overwrite")+"</dfn>: Replace your buy and sell prices with the current prices when refreshing.'><input class='trdOverwrite' type='checkbox' tabindex='-1' />"+I.Symbol.Filler+"</label><br /><abbr>!~$</abbr><input class='trdNotifySellHigh' type='text' /><input class='trdCurrentSell trdOutput' type='text' tabindex='-1' /><input class='trdNotifySellLow' type='text' /><label title='<dfn>"+D.getWordCapital("notify")+"</dfn>: Turn on sound notification for this item.'><input class='trdNotify' type='checkbox' tabindex='-1' />"+I.Symbol.Filler+"</label><br /><br /></div></div><div class='trdPreview'><input class='trdCurrentBuy trdOutput' type='text' tabindex='-1' /><input class='trdCurrentSell trdOutput' type='text' tabindex='-1' /><div class='btnSwap'><button class='btnSwapUp' tabindex='-1'></button><button class='btnSwapDown' tabindex='-1'></button></div></div></div>"),I.qTip.init($(r+" .trdOverwrite").parent()),I.qTip.init($(r+" .trdNotify").parent()),X.rewrapCheckboxes(),t=$(r+" .trdName"),a=$(r+" .trdBuy"),n=$(r+" .trdSell"),i=$(r+" .trdQuantity"),I.bindInputSelect(r+" input"),$(r+" .trdListings").click(function(){if(!1===I.isConsoleShown()){var e=$(this).closest(".trdEntry").find(".trdItem").val();E.printListings(e)}}).dblclick(function(){var e=$(this).closest(".trdEntry").find(".trdName").val();U.openExternalURL(U.getWikiLinkLanguage(e))}),$(r+" .trdSearch").click(function(){var e=$(this).closest(".trdEntry").find(".trdItem").val(),t=$(this).closest(".trdEntry").find(".trdName").val();0===e.length?U.openExternalURL(U.getTradingSearchLink(t)):U.openExternalURL(U.getTradingItemLink(e,t))}),$([a,n,i]).each(function(){$(this).on("input",function(){E.calculateTrading($(this).parent())})}),$(r+" .trdCurrentBuy, "+r+" .trdCurrentSell").each(function(){$(this).dblclick(function(){var e=E.parseCoinString($(this).val());0!==e&&($(this).prev().val(E.formatCoinString(e+1)).trigger("change"),$(this).next().val(E.formatCoinString(e-1)).trigger("change"),E.updateTradingPrices($(this).closest(".trdEntry"),!1),D.stopSpeech())})}),$(r+" .btnSwap").hover(function(){$(this).closest(".trdEntry").find(".trdName").addClass("trdHovered"),E.SwapIndex=U.getSubintegerFromHTMLID($(this).closest(".trdEntry"))},function(){$(".trdName").removeClass("trdHovered")}),$(r+" .btnSwapUp, "+r+" .btnSwapDown").each(function(){$(this).click(function(){var e=E.SwapIndex,t=!!$(this).hasClass("btnSwapUp");if((!t||0!==e)&&!t!==$(".trdEntry").length-1){var a=t?e-1:e+1,n=$("#trdEntry_"+e),i=$("#trdEntry_"+a),r=n.find(".trdIcon").attr("src"),o=i.find(".trdIcon").attr("src");n.find(".trdIcon").attr("src",o),i.find(".trdIcon").attr("src",r);var s=[],c=[],l=0,u=0;n.find("input[type='text']").each(function(){s.push($(this).val())}),i.find("input[type='text']").each(function(){c.push($(this).val())}),n.find("input[type='text']").each(function(){$(this).val(c[l]).trigger("change"),l++}),i.find("input[type='text']").each(function(){$(this).val(s[u]).trigger("change"),u++});var d=n.attr("data-rarity"),p=i.attr("data-rarity");n.attr("data-rarity",p),i.attr("data-rarity",d),Q.setRarityClass(n.find(".trdName"),p),Q.setRarityClass(i.find(".trdName"),d),E.clearMatched(n),E.clearMatched(i),n.find(".trdName").removeClass("trdHovered"),i.find(".trdName").addClass("trdHovered"),E.SwapIndex=t?E.SwapIndex-1:E.SwapIndex+1}})}),function(e){Q.bindItemSearch($(t),{aFillerText:null,aWantEnter:!1,aResultsClass:"trdResultsContainer",aCallback:function(t){e.find(".trdItem").val(t.id).trigger("change"),e.find(".trdName").val(t.name).trigger("change"),E.updateTradingDetails(e),E.updateTradingPrices(e,!1)}})}($(r)),$(t).change(function(){var e=$(this).val(),t=$(this).closest(".trdEntry");e.length<1&&E.clearCalculator(t)}).onEnterKey(function(){U.openExternalURL(U.getTradingSearchLink($(this).val()))});r="#trdEntry_0",$(r+" .trdIcon").attr("src","img/ui/question.png"),$(r+" .trdName").val("Kudzu"),$(r+" .trdBuy").val("4500.37.68"),$(r+" .trdSell").val("550037.68"),$(r+" .trdQuantity").val("1"),$(r).css("margin-bottom","6px");var o=function(e,t,a){a=void 0===a?"":": "+a,$(r+" .trd"+e).attr("title","<dfn>"+D.getPhraseTitle(t)+"</dfn>"+a)};o("Name","name"),o("Buy","your buy"),o("Sell","your sell"),o("Quantity","quantity"),o("Cost","cost","Money needed to buy the items."),o("Break","breakpoint","Sell higher than this to make a profit."),o("Tax","tax","Pay 5% fee of sell price to list, and deduct 10% tax of sell price when sold."),o("Profit","profit","Gains after losses from buying and tax."),o("Margin","margin","Revenue over cost and fee."),o("Revenue","revenue","What you will receive at the trader."),o("Link","chatlink","Paste this in game chat to see the item."),o("Item","ID","API item number."),o("NotifyBuyLow","notify if current buy < this buy"),o("NotifyBuyHigh","notify if this buy < current buy"),o("NotifySellLow","notify if current sell < this sell"),o("NotifySellHigh","notify if this sell < current sell"),o("CurrentBuy","current buy","Double click to flank price."),o("CurrentSell","current sell","Double click to flank price."),I.qTip.init($(r+" input")),X.initializeTextlist(X.Textlists.TradingItem,$("#trdList .trdItem"),null,16),X.initializeTextlist(X.Textlists.TradingName,$("#trdList .trdName"),null,64),X.initializeTextlist(X.Textlists.TradingBuy,$("#trdList .trdBuy"),null,16),X.initializeTextlist(X.Textlists.TradingSell,$("#trdList .trdSell"),null,16),X.initializeTextlist(X.Textlists.TradingQuantity,$("#trdList .trdQuantity"),null,16),X.initializeTextlist(X.Textlists.NotifyBuyLow,$("#trdList .trdNotifyBuyLow"),null,16),X.initializeTextlist(X.Textlists.NotifyBuyHigh,$("#trdList .trdNotifyBuyHigh"),null,16),X.initializeTextlist(X.Textlists.NotifySellLow,$("#trdList .trdNotifySellLow"),null,16),X.initializeTextlist(X.Textlists.NotifySellHigh,$("#trdList .trdNotifySellHigh"),null,16),X.initializeCheckboxlist(X.Checklists.TradingOverwrite,$("#trdList .trdOverwrite"),X.ChecklistJob.CheckAll,null,!1),X.initializeCheckboxlist(X.Checklists.TradingNotify,$("#trdList .trdNotify"),X.ChecklistJob.CheckAll,null,!1),$("#trdList .trdSell").trigger("input"),E.updateAllTradingDetails(),$("#trdToggle").click(function(){$("#trdEntry_0 .trdBuy").is(":visible")?($(".trdAccordion").addClass("trdAccordionShut").removeClass("trdAccordionOpen"),$(".trdPreview").removeClass("cssHidden")):($(".trdAccordion").removeClass("trdAccordionShut").addClass("trdAccordionOpen"),$(".trdPreview").addClass("cssHidden"))}),D.verifyNativeTTS(),$("#trdRefresh, #trdRefreshMirror").click($.throttle(E.cREFRESH_LIMIT,function(){E.loopRefresh(!0)})),$("#trdPause").click(function(){E.cancelLoopRefresh()}),$("#trdMute").click(function(){D.stopSpeech()}),$("#trdPrint").click(function(){I.clear();for(var e=X.Textlists.TradingItem.value.length,t="ItemID,Name,Buy,Sell,Quantity,BuyLow,BuyHigh,SellLow,SellHigh<br />",a=0;a<e;a++)t+=U.escapeHTML(X.Textlists.TradingItem.value[a]+","+X.Textlists.TradingName.value[a]+","+X.Textlists.TradingBuy.value[a]+","+X.Textlists.TradingSell.value[a]+","+X.Textlists.TradingQuantity.value[a]+","+X.Textlists.NotifyBuyLow.value[a]+","+X.Textlists.NotifyBuyHigh.value[a]+","+X.Textlists.NotifySellLow.value[a]+","+X.Textlists.NotifySellHigh.value[a])+"<br />";Z.createFile(t.replace(/<br \/>/g,"\r\n"),"tp.csv"),I.print(t)})},updateCoinTo:function(e){var t=0,a=0,n=0,i=0,r=0,o=0,s=0,c=0,l=$("#trdExchange .trdCoinTo"),u=$("#trdExchange .trdCoinToGem"),d=$("#trdExchange .trdCoinToMoney"),p=$("#trdExchange .trdCoinToGemInverse"),h=$("#trdExchange .trdCoinToMoneyInverse"),m=E.parseCoinString(l.val());0===m||""===l.val()?(u.val(""),d.val(""),p.val(""),h.val("")):(E.getGemFromCoin(m,function(r){t=parseInt(u.val()),n=E.parseMoneyString(d.val()),a=r,i=Math.round(a*E.Exchange.DOLLAR_PER_GEM),u.val(a),d.val(E.formatMoneyString(i)),(void 0===e||e)&&(E.animateValue(u,t,a),E.animateValue(d,n,i)),0===a&&(u.val("0"),d.val("0"))}),E.getGemFromCoinInverse(m,function(t){r=parseInt(p.val()),s=E.parseMoneyString(h.val()),o=t,c=Math.round(o*E.Exchange.DOLLAR_PER_GEM),p.val(o),h.val(E.formatMoneyString(c)),(void 0===e||e)&&(E.animateValue(p,r,o),E.animateValue(h,s,c))}))},updateGemTo:function(e){var t=0,a=0,n=0,i=0,r=0,o=0,s=$("#trdExchange .trdGemTo"),c=$("#trdExchange .trdGemToCoin"),l=$("#trdExchange .trdGemToMoney"),u=$("#trdExchange .trdGemToCoinInverse"),d=s.val();0===d||""===s.val()?(c.val(""),l.val(""),u.val("")):(E.getCoinFromGem(d,function(r){t=E.parseCoinString(c.val()),n=E.parseMoneyString(l.val()),a=r,i=parseInt(d*E.Exchange.DOLLAR_PER_GEM),c.val(E.formatCoinString(a)),l.val(E.formatMoneyString(i)),(void 0===e||e)&&(E.animateValue(c,t,a),E.animateValue(l,n,i)),0===a&&(c.val("0"),l.val("0"))}),E.getCoinFromGemInverse(d,function(t){r=E.parseCoinString(u.val()),o=t,u.val(E.formatCoinString(o)),(void 0===e||e)&&E.animateValue(u,r,o)}))},updateMoneyTo:function(e){var t=0,a=0,n=0,i=0,r=$("#trdExchange .trdMoneyTo"),o=$("#trdExchange .trdMoneyToGem"),s=$("#trdExchange .trdMoneyToCoin"),c=E.parseMoneyString(r.val()),l=c*E.Exchange.GEM_PER_DOLLAR;0===c||""===r.val()?(o.val(""),s.val("")):E.getCoinFromGem(l,function(r){t=parseInt(o.val()),n=E.parseCoinString(s.val()),a=l,i=r,o.val(l),s.val(E.formatCoinString(i)),(void 0===e||e)&&(E.animateValue(o,t,a),E.animateValue(s,n,i)),0===i&&(o.val("0"),s.val("0"))})},updateNotifyCoinTo:function(e){var t=0,a=0,n=$("#trdExchange .trdNotifyCoinTo"),i=$("#trdExchange .trdNotifyCoinToGem"),r=$("#trdExchange .trdNotifyCoinToGemHigh"),o=E.parseGemString(r.val()),s=E.parseCoinString(n.val());0===s||""===n.val()?i.val(""):E.getGemFromCoin(s,function(n){if(t=parseInt(i.val()),a=n,i.val(a),(void 0===e||e)&&E.animateValue(i,t,a),0===a)i.val("0");else if(a>=o&&0!==o){r.addClass("trdMatched");var s=D.getPhraseTitle("buy gem high");D.speak(s),I.notify({aTitle:s,aIcon:"img/notification/gem.png"})}else r.removeClass("trdMatched")})},updateNotifyGemTo:function(e){var t=0,a=0,n=$("#trdExchange .trdNotifyGemTo"),i=$("#trdExchange .trdNotifyGemToCoin"),r=$("#trdExchange .trdNotifyGemToCoinHigh"),o=E.parseCoinString(r.val()),s=n.val();0===s||""===n.val()?i.val(""):E.getCoinFromGem(s,function(n){if(t=E.parseCoinString(i.val()),a=n,i.val(E.formatCoinString(a)),(void 0===e||e)&&E.animateValue(i,t,a),0===a)i.val("0");else if(a>=o&&0!==o){r.addClass("trdMatched");var s=D.getPhraseTitle("buy coin high");D.speak(s),I.notify({aTitle:s,aIcon:"img/notification/coin.png"})}else r.removeClass("trdMatched")})},updateAllExchange:function(){E.updateCoinTo(),E.updateGemTo(),E.updateMoneyTo(),E.updateNotifyCoinTo(),E.updateNotifyGemTo()},initializeExchange:function(){var e=$("#trdExchange .trdCoinTo"),t=$("#trdExchange .trdGemTo"),a=$("#trdExchange .trdMoneyTo"),n=$("#trdExchange .trdNotifyCoinTo"),i=$("#trdExchange .trdNotifyGemTo"),r=$("#trdExchange .trdNotifyCoinToGemHigh"),o=$("#trdExchange .trdNotifyGemToCoinHigh");e.val("200.."),t.val("4000"),a.val("50");var s=function(e,t){$("#trdExchange .trd"+e).attr("title","<dfn>"+D.getPhraseTitle(t)+"</dfn>")};s("CoinTo","your coin"),s("GemTo","your gem"),s("MoneyTo","your dollar"),s("CoinToGem","your coin to gem"),s("GemToCoin","your gem to coin"),s("MoneyToGem","your dollar to gem"),s("CoinToMoney","your coin to dollar"),s("GemToMoney","your gem to dollar"),s("MoneyToCoin","your dollar to coin"),s("CoinToGemInverse","gem to your coin"),s("GemToCoinInverse","coin to your gem"),s("CoinToMoneyInverse","dollar to your coin"),s("NotifyCoinTo","your coin"),s("NotifyGemTo","your gem"),s("NotifyCoinToGem","your coin to current gem"),s("NotifyGemToCoin","your gem to current coin"),s("NotifyCoinToGemHigh","notify if current gem > this gem"),s("NotifyGemToCoinHigh","notify if current coin > this coin"),I.qTip.init($("#trdExchange input")),I.bindInputSelect("#trdExchange input"),e.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateCoinTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateCoinTo()})),t.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateGemTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateGemTo()})),a.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateMoneyTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateMoneyTo()})),n.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyCoinTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyCoinTo()})),i.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyGemTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyGemTo()})),X.initializeTextlist(X.Textlists.ExchangeUnit,$([e,t,a,n,i,r,o]),null,16),$(".trdProgress").data("width",$(".trdProgress").width()),E.isTradingCalculatorsInitialized=!0,E.loopRefresh()},cancelLoopRefresh:function(){window.clearTimeout(E.ProgressTimeout),window.clearTimeout(E.RefreshTimeout),$(".trdProgress").width($(".trdProgress").data("width"))},animateProgress:function(){var e=$(".trdProgress");E.ProgressTick<E.ProgressWait&&e.width(e.width()-e.data("width")/E.ProgressWait),E.ProgressTick-=1,E.ProgressTimeout=setTimeout(E.animateProgress,T.cMSECONDS_IN_SECOND)},loopRefresh:function(e){if(E.cancelLoopRefresh(),(!0===e||O.Options.bol_refreshPrices)&&(E.updateAllTradingPrices(),E.updateAllExchange(),O.Options.bol_refreshPrices)){var t=O.Options.int_secTradingRefresh*T.cMSECONDS_IN_SECOND;E.ProgressTick=O.Options.int_secTradingRefresh,E.ProgressWait=O.Options.int_secTradingRefresh,E.animateProgress(),E.RefreshTimeout=setTimeout(E.loopRefresh,t)}},initializeCalculator:function(){$("#trdCalculation .trdCalculator").onEnterKey(function(){E.doCalculation($(this))}).click(function(){$(this).select()}),$("#trdCalculation .trdCalcSubmit").click(function(){E.doCalculation($(this).prev())});for(var e in E.CalculatorHistoryArray)E.CalculatorHistoryArray[e]="";$("#trdCalculation .trdCalculator").onArrowUpKey(function(){if(0===E.CalcHistoryIndex){var e=U.stripToCalculation($(this).val());E.CalculatorHistoryArray[0]!==$(this).val().toString()&&(E.CalculatorHistoryArray.pop(),E.CalculatorHistoryArray.unshift(e))}E.CalcHistoryIndex+1<E.CalculatorHistoryArray.length&&(E.CalcHistoryIndex++,$(this).val(E.CalculatorHistoryArray[E.CalcHistoryIndex]))}),$("#trdCalculation .trdCalculator").onArrowDownKey(function(){E.CalcHistoryIndex-1>=0&&(E.CalcHistoryIndex--,$(this).val(E.CalculatorHistoryArray[E.CalcHistoryIndex]))})},doCalculation:function(pCalculator){var expression=U.stripToCalculation(pCalculator.val()),result="";try{result=eval(expression)}catch(e){}pCalculator.val(parseFloat(result)).select(),result.toString().length>0&&(E.CalculatorHistoryArray.pop(),E.CalculatorHistoryArray.unshift(expression),E.CalcHistoryIndex=0)}},D={Dictionary:{s_TEMPLATE:{de:"",es:"",fr:"",cs:"",it:"",pl:"",pt:"",ru:"",zh:""},s_y:{de:"j",es:"a",fr:"a",cs:"r",it:"a",pl:"r",pt:"a",ru:"г",zh:"年"},s_mo:{de:"mo",es:"me",fr:"mo",cs:"mě",it:"me",pl:"mi",pt:"mê",ru:"ме",zh:"月"},s_w:{de:"w",es:"s",fr:"s",cs:"t",it:"s",pl:"t",pt:"s",ru:"н",zh:"周"},s_d:{de:"t",es:"d",fr:"j",cs:"d",it:"g",pl:"d",pt:"d",ru:"д",zh:"日"},s_h:{de:"h",es:"h",fr:"h",cs:"h",it:"o",pl:"g",pt:"h",ru:"ч",zh:"时"},s_m:{de:"m",es:"m",fr:"m",cs:"m",it:"m",pl:"m",pt:"m",ru:"м",zh:"分"},s_s:{de:"s",es:"s",fr:"s",cs:"s",it:"s",pl:"s",pt:"s",ru:"с",zh:"秒"},s_hour:{de:"stunde",es:"hora",fr:"heure",cs:"hodina",it:"ora",pl:"godzinę",pt:"hora",ru:"час",zh:"时"},s_minute:{de:"minute",es:"minuto",fr:"minute",cs:"minuta",it:"minuto",pl:"minuta",pt:"minuto",ru:"минута",zh:"分"},s_second:{de:"sekunde",es:"segundo",fr:"seconde",cs:"sekunda",it:"secondo",pl:"sekund",pt:"segundo",ru:"секунду",zh:"秒"},s_hours:{de:"stunden",es:"horas",fr:"heures",cs:"hodin",it:"secondi",pl:"godzin",pt:"horas",ru:"часов",zh:"时"},s_minutes:{de:"minuten",es:"minutos",fr:"minutes",cs:"minut",it:"minuti",pl:"minut",pt:"minutos",ru:"минут",zh:"分"},s_seconds:{de:"sekunden",es:"segundos",fr:"secondes",cs:"sekund",it:"ore",pl:"sekund",pt:"segundos",ru:"секунд",zh:"秒"},s_half_an_hour:{de:"eine halbe stunde",es:"media hora",fr:"demi-heure",cs:"půl hodiny",it:"mezz&apos;ora",pl:"pół godziny",pt:"meia hora",ru:"полчаса",zh:"半小时"},s_cooldown:{de:"abkühl",es:"recuperación",fr:"recharge",cs:"dobíjení",it:"raffreddamento",pl:"ochładzania",pt:"resfriamento",ru:"перезарядка",zh:"冷却"},s_remaining:{de:"verbleibend",es:"restante",fr:"restant",cs:"zbývající",it:"rimanente",pl:"pozostały",pt:"restante",ru:"оставшиеся",zh:"剩余"},s_day:{de:"tag",es:"día",fr:"jour",cs:"den",it:"giorno",pl:"dzień",pt:"dia",ru:"день",zh:"白天"},s_night:{de:"nacht",es:"noche",fr:"nuit",cs:"noc",it:"notturne",pl:"nocna",pt:"noturno",ru:"ночь",zh:"夜间"},s_dawn:{de:"tagesanbruch",es:"amanecer",fr:"aube",cs:"svítání",it:"alba",pl:"świt",pt:"alvorecer",ru:"рассвет",zh:"黎明"},s_dusk:{de:"dämmerung",es:"crepúsculo",fr:"crépuscule",cs:"soumrak",it:"crepuscolo",pl:"zmierzch",pt:"crepúsculo",ru:"сумрак",zh:"黄昏"},s_approaching:{de:"nähert",es:"acerca",fr:"approchant",cs:"blíží",it:"avvicina",pl:"zbliża",pt:"aproximava",ru:"приближается",zh:"来临"},s_when:{de:"wann",es:"cuando",fr:"quand",cs:"když",it:"quando",pl:"gdy",pt:"quando",ru:"когда",zh:"什么时候"},s_now:{de:"jetzt",es:"ahora",fr:"présent",cs:"nyní",it:"adesso",pl:"teraz",pt:"agora",ru:"теперь",zh:"现在"},s_directory:{de:"verzeichnis",es:"directorio",fr:"répertoire",cs:"adresář",it:"directory",pl:"katalog",pt:"diretório",ru:"каталог",zh:"目录"},s_dashboard:{de:"dashboard",es:"panel",fr:"tableau de bord",cs:"řídicí panel",it:"dashboard",pl:"pulpit nawigacyjny",pt:"painel",ru:"панель мониторинга",zh:"仪表板"},s_leaderboard:{de:"bestenliste",es:"marcador",fr:"classement",cs:"žebříček",it:"classifica",pl:"liderzy sprzedaży",pt:"placar de líderes",ru:"список лидеров",zh:"排行榜"},s_server:{de:"server",es:"servidor",fr:"serveur",cs:"server",it:"server",pl:"serwer",pt:"servidor",ru:"сервер",zh:"服务器"},s_account:{de:"account",es:"cuenta",fr:"compte",cs:"účet",it:"conto",pl:"konto",pt:"conta",ru:"счёт",zh:"帐户"},s_key:{de:"schlüssel",es:"tecla",fr:"clé",cs:"klávesa",it:"chiave",pl:"klawisz",pt:"chave",ru:"ключ",zh:"索引键"},s_history:{de:"verlauf",es:"historial",fr:"historique",cs:"historie",it:"cronologia",pl:"historii",pt:"histórico",ru:"истории",zh:"历史"},s_info:{de:"info",es:"información",fr:"info",cs:"informace",it:"info",pl:"informacje",pt:"informações",ru:"информация",zh:"资讯"},s_item:{de:"gegenstand",es:"objeto",fr:"objet",cs:"objekt",it:"oggetto",pl:"obiekt",pt:"objeto",ru:" объект",zh:"物品"},s_items:{de:"gegenstände",es:"objetos",fr:"objets",cs:"objektů",it:"oggetti",pl:"obiekty",pt:"objetos",ru:"объекты",zh:"物品"},s_collectible:{de:"sammlerstücke",es:"coleccionable",fr:"collectable",cs:"sběratelský",it:"collezione",pl:"kolekcjonerski",pt:"colecionável",ru:"коллекционирования",zh:"收藏"},s_tier:{de:"rang",es:"rango",fr:"niveau",cs:"pořadí",it:"rango",pl:"ranga",pt:"classe",ru:"ранг",zh:"级"},s_clock:{de:"uhr",es:"reloj",fr:"horloge",cs:"hodiny",it:"orologio",pl:"zegar",pt:"relógio",ru:"часы",zh:"时钟"},s_timers:{de:"zeitgeber",es:"temporizadores",fr:"minuteurs",cs:"časovače",it:"timer",pl:"czasomierzy",pt:"temporizadores",ru:"таймеров",zh:"计时器"},s_timeline:{de:"zeitachse",es:"escala de tiempo",fr:"chronologie",cs:"časová osa",it:"sequenza temporale",pl:"oś czasu",pt:"linha do tempo",ru:"временная шкала",zh:"时间线"},s_countdowns:{de:"countdown",es:"cuenta regresiva",fr:"compte à rebours",cs:"odpočítávání",it:"conto alla rovescia",pl:"odliczanie",pt:"contagem regressiva",ru:"обратный отсчет",zh:"倒计时"},s_announcements:{de:"ankündigungen",es:"anuncios",fr:"annonces",cs:"oznámení",it:"annunci",pl:"ogłoszenia",pt:"anúncios",ru:"объявления",zh:"公告"},s_console:{de:"konsole",es:"consola",fr:"console",cs:"konzola",it:"console",pl:"konsola",pt:"console",ru:"консоль",zh:"控制台"},s_panel:{de:"panel",es:"panel",fr:"panneau",cs:"panel",it:"pannello",pl:"panel",pt:"painel",ru:"панель",zh:"面板"},s_tools:{de:"extras",es:"herramientas",fr:"outils",cs:"nástroje",it:"strumenti",pl:"narzędzia",pt:"ferramentas",ru:"инструменты",zh:"工具"},s_guides:{de:"handbuch",es:"guías",fr:"guides",cs:"vodítka",it:"guide",pl:"prowadnice",pt:"guias",ru:"руководства",zh:"指南"},s_links:{de:"links",es:"vínculos",fr:"liens",cs:"odkazy",it:"collegamenti",pl:"linki",pt:"vínculos",ru:"ссылки",zh:"链接"},s_help:{de:"hilfe",es:"ayuda",fr:"assistance",cs:"pomoci",it:"guida",pl:"pomoc",pt:"ajuda",ru:"помощь",zh:"帮助"},s_options:{de:"optionen",es:"opciónes",fr:"options",cs:"možnosti",it:"opzioni",pl:"opcje",pt:"opções",ru:"параметры",zh:"选项"},s_arrival:{de:"ankunft",es:"llegada",fr:"arrivée",cs:"příjezd",it:"arrivo",pl:"przyjazd",pt:"chegada",ru:"прибытие",zh:"到来"},s_world:{de:"welt",es:"mundo",fr:"monde",cs:"svět",it:"mondo",pl:"świat",pt:"mundo",ru:"босс",zh:"世界"},s_boss:{de:"boss",es:"jefe",fr:"chef",cs:"boss",it:"boss",pl:"szef",pt:"chefe",ru:"босс",zh:"头目"},s_event:{de:"event",es:"evento",fr:"événement",cs:"událost",it:"evento",pl:"wydarzenie",pt:"evento",ru:"событие",zh:"事件"},s_events:{de:"ereignisse",es:"eventos",fr:"événements",cs:"dění",it:"eventi",pl:"wydarzenia",pt:"eventos",ru:"события",zh:"事件"},s_section:{de:"abschnitt",es:"sección",fr:"section",cs:"oddíl",it:"sezione",pl:"sekcja",pt:"seção",ru:"раздел",zh:"节"},s_map:{de:"karte",es:"mapa",fr:"carte",cs:"mapa",it:"mappa",pl:"mapa",pt:"mapa",ru:"ка́рта",zh:"地图"},s_terrain:{de:"terrain",es:"terreno",fr:"terrain",cs:"terén",it:"terreno",pl:"teren",pt:"terreno",ru:"местность",zh:"地形"},s_center:{de:"zentrum",es:"centro",fr:"centre",cs:"střed",it:"centro",pl:"środek",pt:"centro",ru:"центр",zh:"中心"},s_completion:{de:"abschluss",es:"finalización",fr:"progression",cs:"dokončení",it:"completamento",pl:"ukończenie",pt:"progressão",ru:"завершение",zh:"完成"},s_route:{de:"route",es:"ruta",fr:"route",cs:"trasa",it:"percorso",pl:"trasa",pt:"rota",ru:"маршрут",zh:"路线"},s_pins:{de:"stecknadel",es:"chincheta",fr:"repère",cs:"špendlík",it:"segnaposto",pl:"pinezka",pt:"marcador",ru:"маркер",zh:"大头针"},s_path:{de:"pfad",es:"trazado",fr:"tracé",cs:"cesta",it:"tracciato",pl:"ścieżka",pt:"demarcador",ru:"контур",zh:"路径"},s_range:{de:"reichweite",es:"alcance",fr:"portée",cs:"dosah",it:"portata",pl:"zasięg",pt:"alcance",ru:"дальность",zh:"范围"},s_color:{de:"farbe",es:"color",fr:"couleur",cs:"barva",it:"colore",pl:"kolor",pt:"cor",ru:"цвет",zh:"色"},s_opacity:{de:"deckkraft",es:"opacidad",fr:"opacité",cs:"neprůhlednost",it:"opacità",pl:"nieprzezroczystość",pt:"opacidade",ru:"прозрачность",zh:"不透明度"},s_comment:{de:"kommentar",es:"comentario",fr:"commentaire",cs:"komentář",it:"commento",pl:"komentarz",pt:"comentário",ru:"примечание",zh:"注释"},s_compass:{de:"zirkel",es:"compás",fr:"compas",cs:"kružítko",it:"compasso",pl:"cyrkiel",pt:"compasso",ru:"циркуль",zh:"指南针"},s_slot:{de:"steckplatz",es:"ranura",fr:"emplacement",cs:"slot",it:"slot",pl:"gniazdo",pt:"slot",ru:"слот",zh:"插槽"},s_resource:{de:"ressourcen",es:"recursos",fr:"ressources",cs:"zdrojů",it:"risorse",pl:"zasobów",pt:"recursos",ru:"ресурсные",zh:"资源"},s_nodes:{de:"knoten",es:"nodos",fr:"zones",cs:"uzly",it:"nodi",pl:"węzły",pt:"nós",ru:"узлы",zh:"节点"},s_jumping:{de:"sprung",es:"salto",fr:"saut",cs:"skákání",it:"saltando",pl:"skoki",pt:"pulando",ru:"переход",zh:"跳跳"},s_puzzles:{de:"rätsel",es:"prueba",fr:"puzzle",cs:"hlavolam",it:"rompicapo",pl:"zagadki",pt:"desafio",ru:"пазлы",zh:"乐"},s_bookmarks:{de:"zeichen",es:"marcadores",fr:"signets",cs:"záložky",it:"segnalibri",pl:"zakładki",pt:"favoritos",ru:"закладки",zh:"书签"},s_lock:{de:"sperre",es:"bloqueo",fr:"verrou",cs:"zámek",it:"blocco",pl:"zablokuj",pt:"bloqueio",ru:"блокировка",zh:"锁定"},s_checklist:{de:"prüfliste",es:"lista de comprobación",fr:"liste de contrôle",cs:"kontrolní seznam",it:"elenco di controllo",pl:"lista kontrolna",pt:"lista de verificação",ru:"контрольный список",zh:"检查清单"},s_notepad:{de:"notizblock",es:"bloc de notas",fr:"blocnotes",cs:"poznámkový blok",it:"blocco note",pl:"notatnik",pt:"bloco de notas",ru:"блокнот",zh:"记事本"},s_subscription:{de:"abonnement",es:"suscripción",fr:"abonnement",cs:"předplatné",it:"sottoscrizione",pl:"abonament",pt:"assinatura",ru:"подписка",zh:"订阅"},s_alarm:{de:"alarm",es:"alarma",fr:"alarme",cs:"alarmu",it:"allarme",pl:"alarmu",pt:"alarme",ru:"будильника",zh:"闹钟"},s_mode:{de:"modus",es:"modo",fr:"mode",cs:"režim",it:"modalità",pl:"tryb",pt:"modo",ru:"режим",zh:"模式"},s_chatlink:{de:"chatlink",es:"vínculo chat",fr:"lien chat",cs:"chat odkaz",it:"collegamento chat",pl:"czat łącze",pt:"link bate-papo",ru:"чат связь",zh:"连结聊天"},s_stopwatch:{de:"stoppuhr",es:"cronómetro",fr:"chronomètre",cs:"stopky",it:"cronografo",pl:"stoper",pt:"cronômetro",ru:"секундомер",zh:"码表"},s_guild:{de:"gilden",es:"clan",fr:"guilde",cs:"cech",it:"clan",pl:"klan",pt:"clãs",ru:"гильдии",zh:"公会"},s_guilds:{de:"gilden",es:"clanes",fr:"guildes",cs:"cechy",it:"clan",pl:"klany",pt:"clãs",ru:"гильдий",zh:"公会"},s_missions:{de:"missionen",es:"misiónes",fr:"missions",cs:"mise",it:"missioni",pl:"misje",pt:"missões",ru:"миссии",zh:"任务"},s_pact:{de:"pakt",es:"pacto",fr:"pacte",cs:"pakt",it:"patto",pl:"pakt",pt:"pacto",ru:"пакт",zh:"契约团"},s_is:{de:"ist",es:"es",fr:"est",cs:"je",it:"è",pl:"jest",pt:"é",ru:"является",zh:"是"},s_subscribe:{de:"abonnieren",es:"subscribir",fr:"abonner",cs:"předplatit si",it:"sottoscrivere",pl:"abonować",pt:"assinar",ru:"подписаться",zh:"订阅"},s_unsubscribe:{de:"abonnement kündigen",es:"cancelar suscripción",fr:"se désabonner",cs:"přestat odebírat",it:"annulla sottoscrizione",pl:"anulować subskrypcję",pt:"cancelar assinatura",ru:"отменить подписку",zh:"取消订阅"},s_pause:{de:"anhalten",es:"pausar",fr:"suspendre",cs:"pozastavit",it:"sospendere",pl:"wstrzymaj",pt:"pausar",ru:"приостановить",zh:"暂停"},s_resume:{de:"fortsetzen",es:"reanudar",fr:"reprendre",cs:"pokračovat",it:"riprendere",pl:"wznawiać",pt:"retomar",ru:"продолжить",zh:"继续"},s_will_start:{de:"wird starten",es:"se iniciará",fr:"débutera",cs:"začne",it:"inizierà",pl:"rozpocznie się",pt:"começará",ru:"начнется",zh:"开始"},s_click:{de:"klicken",es:"clic",fr:"cliquer",cs:"kliknout",it:"clic",pl:"klikać",pt:"clicar",ru:"щелкнуть",zh:"单击"},s_double:{de:"doppel",es:"doble",fr:"double",cs:"dvojité",it:"doppio",pl:"dwukrotnie",pt:"duplo",ru:"двойной",zh:"双"},s_drag:{de:"ziehen",es:"arrastrar",fr:"glisser",cs:"přetáhnout",it:"trascinare",pl:"przeciągnąć",pt:"arrastar",ru:"перетащить",zh:"拖动"},s_separate:{de:"trennen",es:"separar",fr:"séparer",cs:"oddělit",it:"separare",pl:"oddzielić",pt:"separar",ru:"разделять",zh:"分开"},s_view:{de:"anzeigen",es:"ver",fr:"afficher",cs:"zobrazit",it:"visualizzare",pl:"wyświetlać",pt:"exibir",ru:"представление",zh:"检视"},s_load:{de:"laden",es:"cargar",fr:"charger",cs:"načíst",it:"caricare",pl:"załaduj",pt:"carregar",ru:"загрузить",zh:"载入"},s_save:{de:"speichern",es:"guardar",fr:"enregistrer",cs:"uložit",it:"salvare",pl:"zapisać",pt:"salvar",ru:"сохранить",zh:"储存"},s_import:{de:"importieren",es:"importar",fr:"importer",cs:"importovat",it:"importować",pl:"",pt:"importar",ru:"импортировать",zh:"导入"},s_export:{de:"exportieren",es:"exportar",fr:"exporter",cs:"exportovat",it:"esportare",pl:"eksportować",pt:"exportar",ru:"экспортировать",zh:"导出"},s_select:{de:"markieren",es:"seleccionar",fr:"sélectionner",cs:"vybrat",it:"selezionare",pl:"zaznaczyć",pt:"selecionar",ru:"выделить",zh:"选择"},s_use:{de:"benutzen",es:"usar",fr:"utiliser",cs:"použít",it:"usare",pl:"używać",pt:"usar",ru:"использовать",zh:"用"},s_cancel:{de:"abbrechen",es:"cancelar",fr:"annuler",cs:"zrušit",it:"annullare",pl:"anulować",pt:"cancelar",ru:"отменить",zh:"取消"},s_add:{de:"hinzufügen",es:"añadir",fr:"ajouter",cs:"přidat",it:"aggiungere",pl:"dodać",pt:"adicionar",ru:"добавлять",zh:"加"},s_delete:{de:"löschen",es:"eliminar",fr:"supprimer",cs:"odstranit",it:"eliminare",pl:"usunąć",pt:"excluir",ru:"удалять",zh:"删除"},s_clear:{de:"löschen",es:"borrar",fr:"effacer",cs:"vymazat",it:"cancella",pl:"wyczyść",pt:"limpar",ru:"очистить",zh:"清除"},s_trim:{de:"trimmen",es:"recortar",fr:"découper",cs:"stříhat",it:"tagliare",pl:"odetnij",pt:"cortar",ru:"обрезать",zh:"剪裁"},s_toggle:{de:"umschalten",es:"alternar",fr:"basculer",cs:"přepnout",it:"alterna",pl:"przełączanie",pt:"alternar",ru:"переключить",zh:"切换"},s_condense:{de:"verkleinern",es:"condensar",fr:"condenser",cs:"zúžit",it:"riduci",pl:"zmniejsz",pt:"condensar",ru:"сжать",zh:"紧缩"},s_enable:{de:"aktivieren",es:"habilitar",fr:"activer",cs:"povolit",it:"abilitare",pl:"włączyć",pt:"habilitar",ru:"разрешить",zh:"启用"},s_disable:{de:"deaktivieren",es:"deshabilitar",fr:"désactiver",cs:"zakázat",it:"disabilitare",pl:"wyłączyć",pt:"desabilitar",ru:"отключить",zh:"禁用"},s_expand:{de:"erweiter",es:"expandir",fr:"développer",cs:"rozbalit",it:"espandere",pl:"rozwinąć",pt:"expandir",ru:"развернуть",zh:"展开"},s_collapse:{de:"verkleiner",es:"contraer",fr:"réduire",cs:"sbalit",it:"comprimere",pl:"zwinąć",pt:"recolher",ru:"свернуть",zh:"折叠"},s_show:{de:"anzeigen",es:"mostrar",fr:"afficher",cs:"zobrazit",it:"mostra",pl:"pokaż",pt:"mostrar",ru:"показать",zh:"显示"},s_hide:{de:"ausblenden",es:"ocultar",fr:"masquer",cs:"skrýt",it:"nascondi",pl:"ukryj",pt:"ocultar",ru:"скрыть",zh:"隐藏"},s_draw:{de:"zeichnen",es:"dibujar",fr:"dessiner",cs:"kreslit",it:"disegnare",pl:"rysować",pt:"desenhar",ru:"рисова́ть",zh:"画"},s_undo:{de:"rückgängig",es:"deshacer",fr:"annuler",cs:"zpět",it:"annullare",pl:"cofnąć",pt:"desfazer",ru:"отменить",zh:"复原"},s_optimize:{de:"optimieren",es:"optimizar",fr:"optimiser",cs:"optimalizovat",it:"ottimizzare",pl:"optymalizować",pt:"otimizar",ru:"оптимизировать",zh:"最佳化路线"},s_search:{de:"suchen",es:"buscar",fr:"rechercher",cs:"vyhledat",it:"cerca",pl:"wyszukaj",pt:"pesquisar",ru:"поиск",zh:"搜寻"},s_get:{de:"erhalten",es:"conseguir",fr:"obtenir",cs:"dostat",it:"ottenere",pl:"dostawać",pt:"obter",ru:"достава́ть",zh:"获得"},s_update:{de:"aktualisieren",es:"actualizar",fr:"mettre à jour",cs:"aktualizovat",it:"aggiornare",pl:"aktualizować",pt:"atualizar",ru:"обновить",zh:"更新"},s_convert:{de:"konvertieren",es:"convertir",fr:"convertir",cs:"konvertovat",it:"convertire",pl:"converter",pt:"",ru:"конвертировать",zh:"兑换"},s_print:{de:"ausgeben",es:"imprimir",fr:"imprimer",cs:"tisk",it:"stampa",pl:"drukuj",pt:"imprimir",ru:"печать",zh:"打印"},s_yes:{de:"ja",es:"sí",fr:"oui",cs:"ano",it:"sì",pl:"tak",pt:"sim",ru:"да",zh:"是"},s_no:{de:"kein",es:"no",fr:"pas de",cs:"žádný",it:"non",pl:"żaden",pt:"nada de",ru:"нет",zh:"没有"},s_not:{de:"nicht",es:"no",fr:"ne",cs:"ne",it:"non",pl:"nie",pt:"não",ru:"не",zh:"不"},s_all:{de:"alle",es:"todos",fr:"tous",cs:"všechny",it:"tutti",pl:"wszystkie",pt:"todo",ru:"все",zh:"所有"},s_only:{de:"nur",es:"solamente",fr:"seulement",cs:"pouze",it:"solo",pl:"tylko",pt:"só",ru:"только",zh:"只要"},s_ago:{de:"vor",es:"hace",fr:"il ya",cs:"před",it:"fa",pl:"temu",pt:"há",ru:"назад",zh:"前"},s_also:{de:"auch",es:"también",fr:"aussi",cs:"také",it:"anche",pl:"też",pt:"também",ru:"то́же",zh:"也"},s_checked:{de:"abgehakt",es:"visto",fr:"coché",cs:"odškrtnout",it:"controllato",pl:"zakończony",pt:"marcado",ru:"включен",zh:"勾掉"},s_new:{de:"neu",es:"nuevo",fr:"nouveau",cs:"nový",it:"nuovo",pl:"nowy",pt:"novo",ru:"новый",zh:"新"},s_current:{de:"aktuelle",es:"actual",fr:"actuel",cs:"současný",it:"corrente",pl:"bieżący",pt:"corrente",ru:"текущий",zh:"活期"},s_expired:{de:"abgelaufen",es:"expirado",fr:"expiré",cs:"vypršel",it:"scaduto",pl:"wygasłe",pt:"expirado",ru:"просрочен",zh:"已过期"},s_daily:{de:"täglich",es:"diaria",fr:"quotidien",cs:"denní",it:"giornaliero",pl:"dzienny",pt:"diário",ru:"ежедневно",zh:"每天"},s_dailies:{de:"täglichen",es:"diarios",fr:"quotidiens",cs:"deníky",it:"quotidiani",pl:"dzienniki",pt:"diários",ru:"ежедневных",zh:"每天成就"},s_achievements:{de:"erfolge",es:"logros",fr:"succès",cs:"výsledky",it:"obiettivi",pl:"osiągnięcia",pt:"conquistas",ru:"достижения",zh:"成就"},s_personal:{de:"persönlicher",es:"personal",fr:"personnel",cs:"osobní",it:"personale",pl:"osobisty",pt:"pessoal",ru:"персональный",zh:"私人"},s_previous:{de:"vorhergehend",es:"previo",fr:"préalable",cs:"předchozí",it:"previo",pl:"poprzedni",pt:"prévio",ru:"предыдущий",zh:"以前的"},s_next:{de:"nächste",es:"siguiente",fr:"prochain",cs:"příští",it:"seguente",pl:"następny",pt:"próximo",ru:"следующий",zh:"下一"},s_off:{de:"aus",es:"desactivado",fr:"désactivé",cs:"vypnuto",it:"disattivato",pl:"wyłączany",pt:"desativado",ru:"выключено",zh:"关"},s_offline:{de:"offline",es:"sin conexión",fr:"hors connexion",cs:"offline",it:"offline",pl:"offline",pt:"",ru:"автономный",zh:"离线"},s_predicted:{de:"vorhergesagt",es:"previsto",fr:"prédit",cs:"předpovídal",it:"previsto",pl:"przewiduje",pt:"predito",ru:"предсказанный",zh:"预测"},s_subscribed:{de:"abonniert",es:"suscrito",fr:"souscrit",cs:"odebírané",it:"sottoscritti",pl:"subskrypcji",pt:"assinado",ru:"подписан",zh:"订阅"},s_then:{de:"dann",es:"luego",fr:"puis",cs:"pak",it:"poi",pl:"potem",pt:"então",ru:"затем",zh:"接着"},s_found:{de:"gefunden",es:"encontró",fr:"trouvé",cs:"zjištěno",it:"trovato",pl:"stwierdzono",pt:"encontrado",ru:"найден",zh:"发现了"},s_loading:{de:"laden",es:"cargando",fr:"chargement",cs:"načítání",it:"caricamento",pl:"ładowanie",pt:"carregando",ru:"загрузка",zh:"正在载入"},s_done:{de:"erledigt",es:"hecho",fr:"terminé",cs:"hotovo",it:"fatto",pl:"gotowe",pt:"concluído",ru:"сделанный",zh:"完成了"},s_automatic:{de:"automatisch",es:"automático",fr:"automatique",cs:"automatický",it:"automatico",pl:"automatyczny",pt:"automático",ru:"автоматический",zh:"自动的"},s_custom:{de:"benutzerdefinierte",es:"personalizado",fr:"personnalisée",cs:"vlastní",it:"personalizzata",pl:"niestandardowy",pt:"personalizado",ru:"настраиваемая",zh:"自定义"},s_and:{de:"und",es:"y",fr:"et",cs:"a",it:"e",pl:"i",pt:"e",ru:"и",zh:"和"},s_if:{de:"wenn",es:"si",fr:"si",cs:"jestliže",it:"se",pl:"jeśli",pt:"se",ru:"если",zh:"如果"},s_at:{de:"um",es:"a",fr:"à",cs:"v",it:"a",pl:"o",pt:"a",ru:"в",zh:"在"},s_by:{de:"von",es:"por",fr:"de",cs:"od",it:"da",pl:"przez",pt:"por",ru:"",zh:"由"},s_in:{de:"in",es:"en",fr:"en",cs:"za",it:"in",pl:"w",pt:"em",ru:"в",zh:"在"},s_of:{de:"von",es:"de",fr:"de",cs:"z",it:"di",pl:"z",pt:"de",ru:"из",zh:"的"},s_for:{de:"für",es:"para",fr:"pour",cs:"pro",it:"per",pl:"dla",pt:"para",ru:"для",zh:"为了"},s_to:{de:"zu",es:"a",fr:"contre",cs:"ku",it:"a",pl:"na",pt:"a",ru:"до",zh:"比"},s_Sector:{de:"Sektor",es:"Sector",fr:"Secteur",zh:"扇形"},s_Waypoint:{de:"Wegmarke",es:"Punto de ruta",fr:"Point de passage",zh:"传送点"},s_Point_of_Interest:{de:"Sehenswürdigkeit",es:"Punto de interés",fr:"Site remarquable",zh:"探索点"},s_Vista:{de:"Aussichtspunkt",es:"Vista",fr:"Panorama",zh:"观景点"},s_Mastery_Insight:{de:"Einsicht",es:"Reflexión de dominio",fr:"Source de connaissance de maîtrise",zh:"专精揭秘点"},s_Hero_Challenge:{de:"Heldenherausforderung",es:"Desafío de héroe",fr:"Défi de héros",zh:"英雄挑战"},s_Heart:{de:"Herzchen-Quest",es:"Corazón de prestigio",fr:"Cœur de renommé",zh:"爱心任务"},s_Scheduled_Bosses:{de:"Geplant",es:"Programado",fr:"Planifié",cs:"Plánované",it:"Pianificata",pl:"Zaplanowane",pt:"Agendado",ru:"Запланирован",zh:"世界BOSS订阅"},s_Special_Bosses:{de:"Speziell",es:"Especial",fr:"Spécial",cs:"Speciální",it:"Speciale",pl:"Specjalny",pt:"Especial",ru:"Особый",zh:"特殊BOSS"},s_Dry_Top:{de:"Trockenkuppe",es:"Cima Seca",fr:"Cimesèche",zh:"干涸高地"},s_Legacy_Bosses:{de:"Legacy",es:"Heredado",fr:"Hérité",cs:"Starší",it:"Legacy",pl:"Starsze",pt:"Herdado",ru:"Устаревший",zh:"旧版BOSS"},s_Orr_Temples:{de:"Tempel",es:"Templos",fr:"Temples",cs:"Chrámy",it:"Templi",pl:"Świątynie",pt:"Templos",ru:"Храмы",zh:"神殿"},s_Full_Timetable:{de:"Zeitplan",es:"Horario",fr:"Horaire",cs:"Plán",it:"Programma",pl:"Harmonogram",pt:"Horário",ru:"Расписание",zh:"时间表"},s_promotions:{de:"aktionen",es:"promociones",fr:"promotions",cs:"propagace",it:"promozioni",pl:"promocje",pt:"promoções",ru:"продвижения",zh:"促销"},s_menu:{de:"menü",es:"menú",fr:"menu",cs:"nabídka",it:"menu",pl:"menu",pt:"menu",ru:"меню",zh:"功能表"},s_wvw:{de:"WvW",es:"McM",fr:"McM",cs:"SpS",it:"McM",pl:"SkS",pt:"McM",ru:"МпМ",zh:"世界战场"},s_pve:{de:"SgU",es:"JcE",fr:"JcE",cs:"HpP",it:"GcA",pl:"PvE",pt:"JcA",ru:"ИпО",zh:"玩家对抗环境"},s_pvp:{de:"PvP",es:"JcJ",fr:"JcJ",cs:"HpH",it:"GcG",pl:"PvP",pt:"JcJ",ru:"ИпИ",zh:"玩家对战"},s_display:{de:"anzeige",es:"presentación",fr:"affichage",cs:"zobrazení",it:"visualizzazione",pl:"wyświetlania",pt:"exibição",ru:"отображаемое",zh:"显示"},s_zone:{de:"gebiet",es:"zona",fr:"zone",cs:"zóna",it:"zona",pl:"zona",pt:"zona",ru:"зона",zh:"区"},s_forum:{de:"forum",es:"foro",fr:"forum",cs:"fórum",it:"forum",pl:"forum",pt:"fórum",ru:"форум",zh:"论坛"},s_possessions:{de:"besitzungen",es:"posesiones",fr:"possessions",cs:"bohatství",it:"patrimonio",pl:"dobytek",pt:"posses",ru:"пожитки",zh:"财产"},s_catalog:{de:"katalog",es:"catálogo",fr:"catalogue",cs:"katalog",it:"catalogo",pl:"katalog",pt:"catálogo",ru:"каталог",zh:"目录"},s_audit:{de:"prüfung",es:"auditar",fr:"auditer",cs:"audit",it:"audit",pl:"audyt",pt:"auditar",ru:"аудит",zh:"审计"},s_cleanup:{de:"aufräumen",es:"limpia",fr:"nettoyer",cs:"úklid",it:"ripulire",pl:"oczyszczenie",pt:"limpeza",ru:"уборка",zh:"整理"},s_simple:{de:"einfach",es:"simple",fr:"simple",cs:"prostý",it:"semplice",pl:"prosty",pt:"simples",ru:"простой",zh:"简单"},s_mobile:{de:"mobil",es:"móvil",fr:"mobile",cs:"mobilní",it:"mobile",pl:"mobilna",pt:"móvel",ru:"мобильный",zh:"移动端"},s_tile:{de:"kacheln",es:"mosaico",fr:"mosaïque",cs:"dlaždice",it:"affianca",pl:"sąsiadująco",pt:"ladrilho",ru:"замостить",zh:"堆砌"},s_manager:{de:"manager",es:"administrador",fr:"gestionnaire",cs:"správce",it:"gestione",pl:"menedżer",pt:"gerenciador",ru:"диспетчер",zh:"管理员"},s_bank:{de:"bank",es:"banco",fr:"banque",cs:"banka",it:"banca",pl:"bank",pt:"banco",ru:"банк",zh:"银行"},s_vault:{de:"tresor",es:"arcón",fr:"coffre",cs:"trezor",it:"volta",pl:"kufer",pt:"tesouro",ru:"сундук",zh:"保险箱"},s_materials:{de:"materialien",es:"materiales",fr:"matériaux",cs:"materiály",it:"materiale",pl:"materiały",pt:"materiais",ru:"материалы",zh:"物料"},s_skins:{de:"skins",es:"diseños",fr:"apparences",cs:"vzhledy",it:"apparenze",pl:"karnacje",pt:"desenhos",ru:"конструкции",zh:"皮肤"},s_wardrobe:{de:"garderobenlager",es:"garderobe",fr:"garderobe",cs:"skříň",it:"armadio",pl:"szafa",pt:"roupeiro",ru:"гардероб",zh:"衣柜"},s_outfits:{de:"kleidungssets",es:"atuendos",fr:"tenues",cs:"oblečení",it:"abiti",pl:"strój",pt:"vestuário",ru:"костюмы",zh:"服装"},s_gliders:{de:"gleitschirm",es:"planeador",fr:"deltaplanes",cs:"kluzáky",it:"alianti",pl:"szybowce",pt:"planadores",ru:"планеры",zh:"滑翔翼"},s_dyes:{de:"farben",es:"tintes",fr:"teintures",cs:"barviva",it:"tinturi",pl:"barwniki",pt:"tinturas",ru:"красители",zh:"染料"},s_minis:{de:"miniaturen",es:"miniaturas",fr:"miniatures",cs:"miniatury",it:"miniature",pl:"miniatury",pt:"miniaturas",ru:"миниатюры",zh:"迷你宠物"},s_carriers:{de:"briefboten",es:"carteros",fr:"messagers",cs:"kurýři",it:"corrieri",pl:"kurierzy",pt:"correios",ru:"курьеры",zh:"快递"},s_champions:{de:"champion",es:"campeón",fr:"champion",cs:"mistr",it:"campione",pl:"mistrz",pt:"campeão",ru:"чемпион",zh:"迷雾首领"},s_finishers:{de:"todesstöße",es:"remates",fr:"coups de grâce",cs:"finišer",it:"finitore",pl:"apreter",pt:"arrematador",ru:"финишер",zh:"终结者"},s_cats:{de:"katzen",es:"gatos",fr:"chats",cs:"kočky",it:"gatti",pl:"koty",pt:"gatos",ru:"коты",zh:"猫"},s_characters:{de:"charaktere",es:"personajes",fr:"personnages",cs:"postavy",it:"personaggi",pl:"postacie",pt:"personagens",ru:"персонажей",zh:"人物"},s_hero:{de:"heldin",es:"héroe",fr:"héros",cs:"hrdina",it:"eroe",pl:"bohater",pt:"herói",ru:"геро́й",zh:"主角"},s_equipment:{de:"ausrüstung",es:"equipamiento",fr:"equipement",cs:"vybavení",it:"equipaggiamento",pl:"sprzęt",pt:"equipamento",ru:"обору́дование",zh:"装备"},s_inventory:{de:"inventar",es:"inventario",fr:"inventaire",cs:"inventář",it:"inventario",pl:"inwentarz",pt:"inventário",ru:"инвента́рь",zh:"背包"},s_ascended:{de:"aufgestiegen",es:"ascendido",fr:"élevé",cs:"vystoupal",it:"asceso",pl:"wstąpił",pt:"ascendeu",ru:"вознесся",zh:"升华"},s_recipes:{de:"rezepte",es:"recetas",fr:"recettes",cs:"recepty",it:"ricette",pl:"recepty",pt:"receitas",ru:"рецепты",zh:"配方"},s_crafting:{de:"handwerkskunst",es:"artesanía",fr:"artisanat",cs:"řemeslo",it:"mestiere",pl:"rzemiosło",pt:"ofício",ru:"ремесло",zh:"制作"},s_raids:{de:"schlachtzügen",es:"incursiones",fr:"raids",cs:"nájezd",it:"incursione",pl:"nalot",pt:"incursão",ru:"набег",zh:"大型地下城"},s_dungeons:{de:"verliesen",es:"mazmorras",fr:"donjons",cs:"dungeony",it:"dungeon",pl:"lochy",pt:"masmorras",ru:"подземелья",zh:"地下城"},s_masteries:{de:"beherrschungs",es:"dominios",fr:"maîtrises",cs:"nadvláda",it:"maestria",pl:"dominacji",pt:"mestrias",ru:"господства",zh:"专精"},s_museum:{de:"museum",es:"museo",fr:"musée",cs:"muzeum",it:"museo",pl:"muzeum",pt:"museu",ru:"музей",zh:"博物馆"},s_wishlist:{de:"wunschliste",es:"lista de deseos",fr:"liste d'envies",cs:"seznam přání",it:"lista desideri",pl:"lista życzeń",pt:"lista de desejos",ru:"список желаемого",zh:"愿望清单"},s_trading:{de:"handel",es:"comercio",fr:"commerciale",cs:"obchod",it:"commercio",pl:"handel",pt:"comércio",ru:"продажа",zh:"贸易"},s_tracker:{de:"tracker",es:"rastreador",fr:"suivi",cs:"tracker",it:"tracker",pl:"",pt:"rastreador",ru:"трекер",zh:"跟踪"},s_exchange:{de:"austauschen",es:"intercambiar",fr:"échanger",cs:"spoluužívat",it:"condividere",pl:"dzielić",pt:"compartilhar",ru:"предоставлять",zh:"交换"},s_recent:{de:"aktuell",es:"reciente",fr:"récent",cs:"poslední",it:"recenti",pl:"ostatnie",pt:"recente",ru:"последние",zh:"最近"},s_buying:{de:"kaufen",es:"comprando",fr:"achat en cours",cs:"nákup",it:"comprando",pl:"kupuje",pt:"comprando",ru:"покупаю",zh:"目前买"},s_selling:{de:"verkaufen",es:"vendiendo",fr:"vente en cours",cs:"prodávat",it:"vendendo",pl:"sprzedaje",pt:"vendendo",ru:"продаю",zh:"目前卖"},s_bought:{de:"gekauft",es:"comprado",fr:"achats historique",cs:"koupil",it:"comprato",pl:"kupiłem",pt:"comprei",ru:"купил",zh:"买了"},s_sold:{de:"verkauft",es:"vendido",fr:"ventes historique",cs:"prodal",it:"venduto",pl:"sprzedał",pt:"vendi",ru:"продал",zh:"卖了"},s_this:{de:"dieses",es:"esto",fr:"ce",cs:"toto",it:"questo",pl:"to",pt:"isto",ru:"это",zh:"这"},s_my:{de:"mein",es:"mi",fr:"mon",cs:"můj",it:"mio",pl:"mój",pt:"meu",ru:"мой",zh:"我的"},s_your:{de:"dein",es:"tu",fr:"ton",cs:"tvůj",it:"tuo",pl:"twój",pt:"teu",ru:"твой",zh:"你的"},s_name:{de:"namen",es:"nombre",fr:"nom",cs:"název",it:"nome",pl:"nazwa",pt:"nome",ru:"имя",zh:"名"},s_ordered:{de:"bestellt",es:"pedidos",fr:"demandée",cs:"objednal",it:"ordinato",pl:"zamówiony",pt:"encomendado",ru:"заказал",zh:"订了"},s_available:{de:"verfügbar",es:"disponibles",fr:"disponible",cs:"dostupný",it:"disponibile",pl:"dostępny",pt:"disponível",ru:"досту́пный",zh:"可用"},s_supply:{de:"angebot",es:"oferta",fr:"stock",cs:"nabídka",it:"offerta",pl:"podaż",pt:"suprimento",ru:"предложение",zh:"供应"},s_demand:{de:"nachfrage",es:"demanda",fr:"demande",cs:"poptávka",it:"domanda",pl:"popyt",pt:"demanda",ru:"спрос",zh:"需求"},s_discount:{de:"rabatt",es:"rebaja",fr:"rabais",cs:"sleva",it:"sconto",pl:"rabat",pt:"desconto",ru:"rabat",zh:"折扣"},s_price:{de:"preis",es:"precio",fr:"prix",cs:"cena",it:"prezzo",pl:"cena",pt:"preço",ru:"цена",zh:"价格"},s_buy:{de:"kaufen",es:"comprar",fr:"acheter",cs:"koupit",it:"comprare",pl:"kupić",pt:"comprar",ru:"купить",zh:"买"},s_sell:{de:"verkaufen",es:"vender",fr:"vendre",cs:"prodat",it:"vendere",pl:"sprzedać",pt:"vender",ru:"продать",zh:"卖"},s_outbid:{de:"überbieten",es:"sobrepujar",fr:"surenchérir",cs:"přelicitovat",it:"prezzo più alto",pl:"przelicytować",pt:"ultrapassar",ru:"перекупать",zh:"出价高於"},s_quantity:{de:"anzahl",es:"cantidad",fr:"quantité",cs:"množství",it:"quantità",pl:"ilość",pt:"quantidade",ru:"количество",zh:"量"},s_profit:{de:"gewinn",es:"beneficio",fr:"profit",cs:"zisk",it:"profitto",pl:"zysk",pt:"lucro",ru:"прибыль",zh:"利润"},s_cost:{de:"kosten",es:"costo",fr:"coût",cs:"náklady",it:"costo",pl:"koszt",pt:"custo",ru:"стоимость",zh:"成本"},s_breakpoint:{de:"gewinnschwelle",es:"punto muerto",fr:"seuil de rentabilité",cs:"bod zvratu",it:"punto di pareggio",pl:"próg rentowności",pt:"ponto de equilíbrio",ru:"точка безубыточности",zh:"收支平衡点"},s_tax:{de:"steuer",es:"impuestos",fr:"impôt",cs:"daň",it:"fiscale",pl:"podatek",pt:"fiscal",ru:"налог",zh:"税"},s_revenue:{de:"einnahmen",es:"ingresos",fr:"revenus",cs:"příjmy",it:"entrate",pl:"dochody",pt:"receita",ru:"доходов",zh:"收入"},s_margin:{de:"gewinnspanne",es:"margen",fr:"marge",cs:"marže",it:"margine",pl:"marża",pt:"margem",ru:"валовая",zh:"边际"},s_low:{de:"niedrigen",es:"bajo",fr:"bas",cs:"nízký",it:"bassa",pl:"niski",pt:"baixa",ru:"низкая",zh:"低"},s_high:{de:"hohen",es:"alta",fr:"haut",cs:"vysoký",it:"alta",pl:"wysoki",pt:"alta",ru:"высокая",zh:"高"},s_notify:{de:"benachrichtigen",es:"notificar",fr:"notifier",cs:"oznámit",it:"notifica",pl:"powiadom",pt:"notificar",ru:"уведомить",zh:"通知"},s_overwrite:{de:"überschreiben",es:"sobrescribir",fr:"remplacer",cs:"přepsat",it:"sovrascrivi",pl:"zastąp",pt:"substituir",ru:"перезаписать",zh:"覆写"},s_gem:{de:"edelsteine",es:"gema",fr:"gemme",cs:"klenot",it:"gemma",pl:"klejnot",pt:"gema",ru:"самоцвет",zh:"宝石"},s_coin:{de:"münze",es:"moneda",fr:"monnaie",cs:"mince",it:"moneta",pl:"moneta",pt:"moeda",ru:"монета",zh:"硬币"},s_dollar:{de:"dollar",es:"dólar",fr:"dollar",cs:"dolar",it:"dollaro",pl:"polar",pt:"dólar",ru:"доллар",zh:"元"}},Codex:{s_TEMPLATE:{en:"",de:"",es:"",fr:"",zh:""},s_CoinGold:{en:"g",de:"g",es:"o",fr:"o",cs:"z",it:"o",pl:"z",pt:"o",ru:"з",zh:"金"},s_CoinSilver:{en:"s",de:"s",es:"p",fr:"a",cs:"s",it:"a",pl:"s",pt:"p",ru:"с",zh:"银"},s_CoinCopper:{en:"c",de:"k",es:"c",fr:"c",cs:"m",it:"r",pl:"m",pt:"c",ru:"м",zh:"铜"},s_Back:{en:"Back Item",de:"Rücken-Gegenstand",es:"Objeto para espalda",fr:"Objet de dos",zh:"背包"},s_Bag:{en:"Bag",de:"Tasche",es:"Saco",fr:"Sac",zh:"格包"},s_Boost:{en:"Boost",de:"Verstärker",es:"Potenciador",fr:"Augmentation",zh:"增幅剂"},s_Consumable:{en:"Consumable",de:"Verbrauchsgegenstand",es:"Consumible",fr:"Consommable",zh:"消耗"},s_Container:{en:"Container",de:"Behälter",es:"Contenedor",fr:"Conteneur",zh:"包"},s_CraftingMaterial:{en:"Crafting Material",de:"Handwerksmaterial",es:"Material de artesanía",fr:"Matériau d&apos;artisanat",zh:"制作材料"},s_Gathering:{en:"Gathering Tool",de:"Sammelwerkzeug",es:"Herramienta de recolección",fr:"Outil de récolte",zh:"采集工具"},s_Gizmo:{en:"Gizmo",de:"Dingsbums",es:"Aparato",fr:"Machin",zh:"小发明"},s_MiniPet:{en:"Miniature",de:"Miniatur",es:"Miniatura",fr:"Miniature",zh:"迷你宠物"},s_Nourishment:{en:"Nourishment",de:"Verbrauchsstoff",es:"Consumible",fr:"Produit consommable",zh:"食品"},s_Salvage:{en:"Salvage",de:"Wiederverwertungs",es:"Recicla",fr:"Recyclage",zh:"拆解"},s_Tool:{en:"Salvage Kit",de:"Wiederverwertungskit",es:"Kit de recicla",fr:"Nécessaire de recyclage",zh:"拆解工具包"},s_Trophy:{en:"Trophy",de:"Trophäe",es:"Trofeo",fr:"Trophée",zh:"战利品"},s_UpgradeComponent:{en:"Upgrade Component",de:"Aufwertung",es:"Componente de mejora",fr:"Composant d&apos;amélioration",zh:"升级组件"},s_Junk:{en:"Junk",de:"Schrott",es:"Basura",fr:"Inutile",zh:"垃圾"},s_Basic:{en:"Basic",de:"Einfach",es:"Básico",fr:"Simple",zh:"基本"},s_Fine:{en:"Fine",de:"Edel",es:"Selecto",fr:"Raffiné",zh:"优质"},s_Masterwork:{en:"Masterwork",de:"Meisterwerk",es:"Obra de arte",fr:"Chef-d&apos;œuvre",zh:"精制"},s_Rare:{en:"Rare",de:"Selten",es:"Excepcional",fr:"Rare",zh:"稀有"},s_Exotic:{en:"Exotic",de:"Exotisch",es:"Exótico",fr:"Exotique",zh:"特异"},s_Ascended:{en:"Ascended",de:"Aufgestiegen",es:"Ascendido",fr:"Élevé",zh:"升华"},s_Legendary:{en:"Legendary",de:"Legendär",es:"Legendario",fr:"Légendaire",zh:"传奇"},s_Light:{en:"Light",de:"Leicht",es:"Ligero",fr:"Légèr",zh:"轻甲"},s_Medium:{en:"Medium",de:"Mittel",es:"Medio",fr:"Intermédiaire",zh:"中甲"},s_Heavy:{en:"Heavy",de:"Schwer",es:"Pesado",fr:"Lourd",zh:"重甲"},s_Power:{en:"Power",de:"Kraft",es:"Potencia",fr:"Puissance",zh:"威力"},s_Toughness:{en:"Toughness",de:"Zähigkeit",es:"Dureza",fr:"Robustesse",zh:"坚韧"},s_Armor:{en:"Armor",de:"Rüstung",es:"Armadura",fr:"Armure",zh:"护甲"},s_Vitality:{en:"Vitality",de:"Vitalität",es:"Vitalidad",fr:"Vitalité",zh:"体力"},s_Health:{en:"Health",de:"Lebenspunkte",es:"Salud",fr:"Santé",zh:"生命值"},s_Precision:{en:"Precision",de:"Präzision",es:"Precisión",fr:"Précision",zh:"精准"},s_CriticalChance:{en:"Critical Chance",de:"Kritische Trefferchance",es:"Probabilidad de daño crítico",fr:"Chance de coup critique",zh:"暴击率"},s_Ferocity:{en:"Ferocity",de:"Wildheit",es:"Ferocidad",fr:"Férocité",zh:"暴击效果"},s_CriticalDamage:{en:"Critical Damage",de:"Kritischer Schaden",es:"Daño crítico",fr:"Dégâts critiques",zh:"暴击伤害"},s_ConditionDamage:{en:"Condition Damage",de:"Zustandsschaden",es:"Daño de condición",fr:"Dégâts par altération",zh:"症状伤害"},s_HealingPower:{en:"Healing Power",de:"Heilkraft",es:"Poder de curación",fr:"Guérison",zh:"治疗效果"},s_Expertise:{en:"Expertise",de:"Fachkenntnis",es:"Pericia",fr:"Expertise",zh:"症状效果"},s_ConditionDuration:{en:"Condition Duration",de:"Zustandsdauer",es:"Duración de condición",fr:"Durée d&apos;altération",zh:"症状持续时间"},s_Concentration:{en:"Concentration",de:"Konzentration",es:"Concentración",fr:"Concentration",zh:"增益效果"},s_BoonDuration:{en:"Boon Duration",de:"Segensdauer",es:"Duración de bendición",fr:"Durée d&apos;avantage",zh:"增益持续时间"},s_AgonyResistance:{en:"Agony Resistance",de:"Qual-Widerstand",es:"Resistencia a la agonía",fr:"Résistance à l&apos;agonie",zh:"痛苦抗性"},s_MagicFind:{en:"Magic Find",de:"Magisches Gespür",es:"Hallazgo mágico",fr:"Découverte de magie",zh:"宝物寻获率"},s_Axe:{en:"Axe",de:"Axt",es:"Hacha",fr:"Haches",zh:"斧头"},s_Dagger:{en:"Dagger",de:"Dolch",es:"Daga",fr:"Dague",zh:"匕首"},s_Mace:{en:"Mace",de:"Streitkolben",es:"Maza",fr:"Masse",zh:"钉锤"},s_Pistol:{en:"Pistol",de:"Pistole",es:"Pistola",fr:"Pistolet",zh:"手枪"},s_Scepter:{en:"Scepter",de:"Zepter",es:"Cetro",fr:"Sceptre",zh:"节杖"},s_Sword:{en:"Sword",de:"Schwert",es:"Espada",fr:"Epée",zh:"单手剑"},s_Focus:{en:"Focus",de:"Fokus",es:"Foco",fr:"Focus",zh:"聚能器"},s_Shield:{en:"Shield",de:"Schild",es:"Escudo",fr:"Bouclier",zh:"盾牌"},s_Torch:{en:"Torch",de:"Fackel",es:"Antorcha",fr:"Torche",zh:"火炬"},s_Warhorn:{en:"Warhorn",de:"Kriegshorn",es:"Cuerno de guerra",fr:"Cor de guerre",zh:"号角"},s_Greatsword:{en:"Greatsword",de:"Großschwert",es:"Mandoble",fr:"Espadon",zh:"巨剑"},s_Hammer:{en:"Hammer",de:"Hammer",es:"Martillo",fr:"Marteau",zh:"巨锤"},s_LongBow:{en:"Longbow",de:"Langbogen",es:"Arco largo",fr:"Arc long",zh:"长弓"},s_Rifle:{en:"Rifle",de:"Gewehr",es:"Rifle",fr:"Fusil",zh:"步枪"},s_ShortBow:{en:"Shortbow",de:"Kurzbogen",es:"Arco corto",fr:"Arc court",zh:"短弓"},s_Staff:{en:"Staff",de:"Stab",es:"Báculo",fr:"Bâton",zh:"法杖"},s_Harpoon:{en:"Harpoon",de:"Speer",es:"Lanza",fr:"Lance",zh:"长矛"},s_Speargun:{en:"Speargun",de:"Harpunenschleuder",es:"Cañón de arpón",fr:"Fusil-harpon",zh:"鱼叉枪"},s_Trident:{en:"Trident",de:"Dreizack",es:"Tridente",fr:"Trident",zh:"三叉戟"},s_HelmAquatic:{en:"Head Armor",de:"Kopf-Rüstung",es:"Armadura de cabeza",fr:"Armure : Couvre-chef",zh:"呼吸器"},s_Helm:{en:"Head Armor",de:"Kopf-Rüstung",es:"Armadura de cabeza",fr:"Armure : Couvre-chef",zh:"头部护甲"},s_Shoulders:{en:"Shoulder Armor",de:"Schulter-Rüstung",es:"Armadura de hombros",fr:"Armure : Épaulières",zh:"肩部护甲"},s_Coat:{en:"Chest Armor",de:"Brust-Rüstung",es:"Armadura pectoral",fr:"Armure : Cuirasse",zh:"胸部护甲"},s_Gloves:{en:"Hand Armor",de:"Hand-Rüstung",es:"Armadura de mano",fr:"Armure : Gants",zh:"手部护甲"},s_Leggings:{en:"Leg Armor",de:"Bein-Rüstung",es:"Armadura de pierna",fr:"Armure : Jambières",zh:"腿部护甲"},s_Boots:{en:"Foot Armor",de:"Fuß-Rüstung",es:"Armadura de pie",fr:"Armure : Bottes",zh:"足部护甲"},s_Amulet:{en:"Amulet",de:"Amulett",es:"Amuleto",fr:"Amulette",zh:"项链"},s_Accessory:{en:"Accessory",de:"Accessoire",es:"Accesorio",fr:"Accessoire",zh:"饰品"},s_Ring:{en:"Ring",de:"Ring",es:"Anillo",fr:"Anneau",zh:"戒指"},s_Defense:{en:"Defense",de:"Verteidigung",es:"Defensa",fr:"Défense",zh:"防御"},s_WeaponStrength:{en:"Weapon Strength",de:"Waffenstärke",es:"Fuerza del arma",fr:"Puissance d&apos;arme",zh:"武器威力"},s_Healing:{en:"Healing",de:"Heilung",es:"Curación",fr:"Guérison",zh:"治疗"},s_RequiredLevel:{en:"Required Level",de:"Erforderliche Stufe",es:"Nivel necesario",fr:"Niveau requis",zh:"需要等级"},s_AccountBindOnUse:{en:"Account Bound on Use",de:"Accountgebunden bei Benutzung",es:"Vinculado a cuenta en uso",fr:"Lié au compte dès l&apos;utilisation",zh:"使用后账号绑定"},s_AccountBound:{en:"Account Bound",de:"Accountgebunden",es:"Vinculado a cuenta",fr:"Lié au compte",zh:"账号绑定"},s_SoulBindOnUse:{en:"Soulbound on Use",de:"Seelengebunden bei Benutzung",es:"Ligado en uso",fr:"Lié à l&apos;âme dès l&apos;utilisation",zh:"使用后灵魂绑定"},s_SoulbindOnAcquire:{en:"Soulbound",de:"Seelengebunden",es:"Ligado",fr:"Lié à l&apos;âme",zh:"拾取后灵魂绑定"},s_SoulboundToCharacter:{en:"Soulbound to another character",de:"An einen anderen Charakter seelengebunden",es:"Ligado a otro personaje",fr:"Lié à l&apos;âme d&apos;un autre personnage",zh:"与其他角色灵魂绑定"},s_Unique:{en:"Unique",de:"Einzigartig",es:"Equipamiento único",fr:"Unique",zh:"解除装备"},s_Transmuted:{en:"Transmuted",de:"Transmutiert",es:"Transmutado",fr:"Transmuté",zh:"幻化"},s_UnusedEnrichmentSlot:{en:"Unused Enrichment Slot",de:"Ungenutzter Anreicherungsplatz",es:"Casilla para enriquecimientos sin utilizar",fr:"Emplacement d'enrichissement inutilisé",zh:"未使用的富集灌注槽"},s_UnusedInfusionSlot:{en:"Unused Infusion Slot",de:"Freier Infusionsplatz",es:"Casilla de infusión sin utilizar",fr:"Emplacement d&apos;infusion inutilisé",zh:"未使用的灌注槽"},s_UnusedUpgradeSlot:{en:"Unused Upgrade Slot",de:"Freier Aufwertungsplatz",es:"Casilla para mejoras sin utilizar",fr:"Emplacement d&apos;amélioration inutilisé",zh:"未使用的升级槽"},s_DoubleClickToSelectStats:{en:"Double-click to select stats.",de:"Doppelklicken, um Werte auszuwählen.",es:"Haz doble clic para seleccionar estadísticas.",fr:"Double-cliquez pour sélectionner les statistiques.",zh:"双击选择属性"},s_DoubleClickToConsume:{en:"Double-click to consume.",de:"Zum Benutzen doppelklicken.",es:"Haz doble clic para consumir.",fr:"Double-cliquez pour utiliser.",zh:"双击使用"},s_ExcessiveAlcohol:{en:"Excessive alcohol consumption will result in intoxication.",de:"Übermäßiger Alkoholkonsum führt zu Rauschzuständen.",es:"El consumo excesivo de alcohol provoca embriaguez.",fr:"Consommer trop d&apos;alcool entraîne une ivresse manifeste.",zh:"过量饮酒容易醉"},s_GainBasedPercentage:{en:"Gain {1} Based on a Percentage of {0}",de:"Erhaltener prozentualer Anteil von {0} auf {1}:",es:"Ganas {1} según tu porcentaje de {0}",fr:"Vous bénéficiez d'une augmentation de {1} de {0}%.",zh:"获得等同于你{0}%的{1}"},s_GuildStash:{en:"Guild Stash",de:"Geheimvorrat",es:"Alijo del clan",fr:"Réserve de guilde"},s_TreasureTrove:{en:"Treasure Trove",de:"Schatzgrube",es:"Tesoro oculto",fr:"Trésor"},s_DeepCave:{en:"Deep Cave",de:"Tiefe Höhle",es:"Cueva profunda",fr:"Grotte profonde"}},isLanguageFullySupported:null,isLanguageDefault:null,isLanguageTraditional:null,isLanguageModifierFirst:null,isLanguageLogographic:null,langFullySupported:null,langPartiallySupported:null,initializeLanguage:function(){D.isLanguageFullySupported=!!O.LanguageMeta.isFullySupported[O.Options.enu_Language],D.isLanguageDefault=O.Options.enu_Language===O.OptionEnum.Language.Default,D.isLanguageTraditional=O.Options.enu_Language===O.OptionEnum.Language.ChineseTraditional,D.isLanguageModifierFirst=!!O.LanguageMeta.isModifierFirst[O.Options.enu_Language],D.isLanguageLogographic=!!O.LanguageMeta.isLogographic[O.Options.enu_Language],D.langFullySupported=D.isLanguageFullySupported?O.Options.enu_Language:O.OptionEnum.Language.Default,D.langPartiallySupported=O.Options.enu_Language===O.OptionEnum.Language.ChineseSimplified||O.Options.enu_Language===O.OptionEnum.Language.ChineseTraditional?O.OptionEnum.Language.ChineseSimplified:D.langFullySupported,D.initializeDictionary(),U.initializeAPIURLs()},getString:function(e){var t=D.Codex["s_"+e];if(t){var a=t[O.Options.enu_Language];return a||t[O.OptionEnum.Language.Default]}return e},getDataAttribute:function(e){var t=$(e);if(!1===D.isLanguageDefault){var a=e.attr("data-"+O.Options.enu_Language);if(a)return a;if(D.isLanguageTraditional)return $.s2t(e.attr("data-"+O.OptionEnum.Language.ChineseSimplified))}return t.text()},initializeDictionary:function(){if(D.isLanguageTraditional){var e,t=O.OptionEnum.Language.ChineseSimplified,a=O.OptionEnum.Language.ChineseTraditional;for(var n in D.Dictionary)(e=D.Dictionary[n][t])&&(D.Dictionary[n][a]=$.s2t(e));for(var n in D.Codex)(e=D.Codex[n][t])&&(D.Codex[n][a]=$.s2t(e))}},addDictionary:function(e){for(var t in e)D.Dictionary[t]=e[t];D.initializeDictionary()},getTranslation:function(e){if(D.isLanguageDefault)return e;var t,a=e;-1!==a.indexOf(" ")&&(a=a.replace(/ /g,"_"));var n=D.Dictionary["s_"+a];return n&&(t=n[O.Options.enu_Language])?t:e},getWord:function(e){return D.isLanguageDefault?e:D.Dictionary["s_"+e][O.Options.enu_Language]},getWordCase:function(e,t){return U.toCase(D.getTranslation(e),t)},getWordCapital:function(e){return U.toFirstUpperCase(D.getTranslation(e))},getPhrase:function(e,t){void 0===t&&(t=U.CaseEnum.None);var a=e.split(" ");if(t===U.CaseEnum.Original)for(var n in a)a[n]=D.duplicateCase(a[n],D.getTranslation(a[n].toLowerCase()));else for(var n in a)a[n]=D.getTranslation(a[n]);var i=D.isLanguageLogographic?a.join(""):a.join(" ");return t===U.CaseEnum.None||t===U.CaseEnum.Original?i:U.toCase(i,t)},getPhraseTitle:function(e){return D.getPhrase(e,U.CaseEnum.Every)},getPhraseOriginal:function(e){return!1===D.isLanguageDefault?D.getPhrase(e,U.CaseEnum.Original):e},getModifiedWord:function(e,t,a){return D.getPhrase(D.orderModifier(e,t),a)},orderModifier:function(e,t){return D.isLanguageModifierFirst?t+" "+e:e+" "+t},getModifiedPhrase:function(e,t){var a=e.split(" ");return 1===a.length?D.getWordCase(a[0],t):2===a.length?D.getModifiedWord(a[1],a[0],t):D.getPhrase(e,t)},duplicateCase:function(e,t){var a=e.charAt(0);if(a===a.toLowerCase())return t;if(e.length>2&&t.length>2){var n=e.charAt(1);if(a===a.toUpperCase()&&n===n.toUpperCase())return t.toUpperCase()}return t.charAt(0).toUpperCase()+t.slice(1)},translateElements:function(){!1===D.isLanguageDefault&&($(".jsTranslate").each(function(){$(this).text(D.getPhraseOriginal($(this).text())).removeClass("jsTranslate")}),$(".jsTranslateCompound").each(function(){$(this).text(D.getTranslation($(this).text())).removeClass("jsTranslateCompound")}))},translateAfter:function(){!1===D.isLanguageDefault&&($(".hudSelect, .btnWindow").each(function(){var e=$(this).attr(I.cTooltipAttribute);if(void 0!==e){var t=$("<div>"+e+"</div>"),a=D.getPhraseOriginal(t.find("dfn").text());t.find("dfn").remove(),$(this).attr("title","<dfn>"+a+"</dfn>"+t.html())}I.qTip.init($(this))}),D.translateElements())},isWithin:function(e,t){var a=t[D.langPartiallySupported];return-1!==e.indexOf(a)},getNameKey:function(){return"name_"+D.langFullySupported},getURLKey:function(){return"url_"+D.langFullySupported},getObjectTranslation:function(e){return void 0!==e[O.Options.enu_Language]?e[O.Options.enu_Language]:O.Options.enu_Language===O.OptionEnum.Language.ChineseTraditional&&e[O.OptionEnum.Language.ChineseSimplified]?(e[O.Options.enu_Language]=$.s2t(e[O.OptionEnum.Language.ChineseSimplified]),e[O.Options.enu_Language]):e[O.OptionEnum.Language.Default]},getObjectString:function(e,t){var a=t+O.Options.enu_Language;if(e){if(e[a])return e[a];if(O.Options.enu_Language===O.OptionEnum.Language.ChineseTraditional){var n=e[t+O.OptionEnum.Language.ChineseSimplified];if(n)return e[a]=$.s2t(n),e[a]}return e[t+O.OptionEnum.Language.Default]}return null},getObjectName:function(e){return D.getObjectString(e,"name_")},getObjectNick:function(e){return D.getObjectString(e,"nick_")},getObjectDesc:function(e){return D.getObjectString(e,"desc_")},getObjectDefaultName:function(e){return e["name_"+O.OptionEnum.Language.Default]},getObjectDefaultNick:function(e){return e["nick_"+O.OptionEnum.Language.Default]},getObjectURL:function(e){return e["url_"+D.langFullySupported]},getChainTitle:function(e){return D.isLanguageDefault?e.title:D.getObjectName(e)},getChainAlias:function(e){return D.isLanguageDefault?C.parseChainAlias(e.alias):D.getChainTitle(e)},verifyNativeTTS:function(e){!1===I.isSpeechNativeEnabled&&!1===I.isProgramEmbedded&&I.ModeCurrent===I.ModeEnum.Overlay&&I.BrowserCurrent!==I.BrowserEnum.IE?(I.isSpeechNativeEnabled=!0,U.getScript(U.URL_API.TextToSpeechNative,function(){I.isSpeechNativeLoaded=!0,meSpeak.loadConfig("bin/tts/mespeak_config.json"),meSpeak.loadVoice("bin/tts/voices/"+O.Options.enu_Language+".json"),e&&e()})):e&&e()},speechWait:0,speak:function(e,t){if(!1!==O.Options.bol_alertSpeech){var a=(O.Options.int_setVolume/T.cPERCENT_100).toFixed(2);try{if(I.isSpeechSynthesisEnabled){var n=new SpeechSynthesisUtterance(e);return n.voice=window.speechSynthesis.getVoices().filter(function(e){return e.name===O.LanguageMeta.VoiceCode[O.Options.enu_Language]})[0],n.volume=a,n.rate=.8,void window.speechSynthesis.speak(n)}}catch(e){I.isSpeechSynthesisEnabled=!1}var i=function(e){D.verifyNativeTTS(function(){if(I.isSpeechNativeLoaded)meSpeak.speak(e,{volume:a,speed:150,variant:"f5"});else{var t=document.getElementById("jsTTSAudio");t.src=U.URL_API.TextToSpeech+"&vol="+a+"&t="+e,t.volume=a,t.load(),t.play()}})};if(void 0===t||null===t){var r=D.isLanguageLogographic?4:12;t=1+Math.round(e.length/r)}var o=t*T.cMSECONDS_IN_SECOND;0===D.speechWait?(D.speechWait+=o,i(e),setTimeout(function(){D.speechWait-=o},o)):(D.speechWait+=o,setTimeout(function(){D.speechWait>0&&(i(e),D.speechWait-=o)},D.speechWait-o));var s=30;D.resetSpeechQueue(s)}},isSpeaking:function(){return 0!==D.speechWait},stopSpeech:function(){I.isSpeechSynthesisEnabled?window.speechSynthesis.cancel():I.isSpeechNativeLoaded?meSpeak.stop():document.getElementById("jsTTSAudio").src=""},resetSpeechQueue:function(e){void 0===e&&(e=0),D.speechWait>e*T.cMSECONDS_IN_SECOND&&(D.speechWait=0,D.stopSpeech())},getSpeechWord:function(e,t){return t?D.getModifiedWord(e,t):D.getPhrase(e)},getSpeechInitials:function(e,t){var a=e.charAt(e.length-1);if(a===a.toLowerCase())return e;t&&(e=e.replace(/ /g,"")),e=e.toUpperCase();for(var n="",i="",r=0;r<e.length;r++)n+=" "===(i=e.charAt(r))?i:i+" ";return n},getPluralTime:function(e,t){return e>1&&(t+="s")," "+D.getWord("in")+" "+e+" "+D.getWord(t)},getChainPronunciation:function(e){return D.isLanguageDefault||I.BrowserCurrent!==I.BrowserEnum.Chrome?C.Chains[e.nexus].pronunciation:D.getChainTitle(e)}},C={Chains:GW2T_CHAIN_DATA,ChainAssociation:{},UnscheduledChainsLength:GW2T_CHAIN_ADD_LENGTH,DryTop:{},cIndexSynonym:"nexus",ChainToday:null,ChainTomorrow:null,ChainDummy:{alias:"dummy"},CurrentChainSD:{},NextChainSD1:{},NextChainSD2:{},NextChainSD3:{},NextChainSD4:{},CurrentChainHC:{},NextChainHC1:{},NextChainHC2:{},NextChainHC3:{},NextChainHC4:{},NextChainLS1:{},NextChainLS2:{},NextChainsMS1:[],NextChainsMS2:[],CurrentChains:[],CurrentChainsSD:[],PreviousChains1:[],PreviousChains2:[],NextChains1:[],cEventCharLimit:44,cEventCharLimitLogographic:20,cEventNameWidth:320,TempleChains:[],LegacyChains:[],UnscheduledChains:[],ScheduledChains:[],RegularChains:[],MiscellaneousChains:[],DryTopChains:[],LivingStoryChains:[],ChainSeriesEnum:{Temple:0,Legacy:1,ScheduledCutoff:2,Standard:2,Hardcore:3,Miscellaneous:4,WorldBossCuttoff:4,DryTop:5,LivingStory:6},EventPrimacyEnum:{Optional:0,Normal:1,Primary:2,Boss:3},isUnscheduledChainsLoaded:!1,isDryTopGenerated:!1,isDryTopIconsShown:!1,isTimetableGenerated:!1,isTouringAuto:!0,isTouringManual:!1,getChainByAlias:function(e){return C.Chains[C.ChainAssociation[e.toLowerCase()]]},getChainRegion:function(e){return e&&e.zone?M.getZoneRegion(e.zone):null},viewChainFinale:function(e){I.isMapEnabled&&(M.goToView(e.finalCoord,M.ZoomEnum.Ground,M.Pin.Event),C.isTouringManual=!1)},isChainToday:function(e){return!(!C.ChainToday||e.nexus!==C.ChainToday.nexus)},refreshChainDailyIcon:function(){for(var e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)C.isChainToday(C.CurrentChainsSD[e])?K["WpChain"+e].addClass("clkWaypointDaily"):K["WpChain"+e].removeClass("clkWaypointDaily");$(".chnDaily").hide(),C.ChainToday&&$(".chnDaily_"+C.ChainToday.nexus).show(),C.updateTimetable()},isChainScheduled:function(e){return e.series>=C.ChainSeriesEnum.ScheduledCutoff},isChainWorldBoss:function(e){return e.series<=C.ChainSeriesEnum.WorldBossCuttoff},isChainRegular:function(e){return e.series===C.ChainSeriesEnum.Standard||e.series===C.ChainSeriesEnum.Hardcore||e.series===C.ChainSeriesEnum.Miscellaneous||e.series===C.ChainSeriesEnum.LivingStory},parseChainAlias:function(e){return-1!==e.indexOf("_")?e.split("_")[0]:e},getEventStepNumber:function(e){if(1===e.length)return e;var t,a="";for(t=0;t<e.length;t++){if(!isFinite(e.charAt(t)))return a;a+=e.charAt(t)}return a},getEventWiki:function(e,t){return e.indexOf(".")===e.length-1&&(e=e.slice(0,-1)),t?U.getWikiLinkDefault(e):U.getWikiLinkLanguage(e)},initializeChain:function(e){var t,a,n,i="",r="",o=U.escapeHTML(D.getObjectName(e));e.waypointText=e.waypoint+" "+o,e.iconSrc="img/chain/"+C.parseChainAlias(e.alias).toLowerCase()+I.cPNG;for(t in e.events)e.events[t].step=parseInt(C.getEventStepNumber(e.events[t].num))-1;if(e.isSorted=!1,e.primaryEvents=[],e.scheduleKeys=[],e.waypoint&&(i="<input id='chnWaypoint_"+e.nexus+"' class='chnWaypoint' type='text' value='"+e.waypointText+"' title='In-game waypoint chatcode.' /><a"+U.convertExternalAnchor(U.getWikiSearchDefault(e.title))+"><ins class='s16 s16_wiki' title='Click for Wiki guide.'></ins></a>  ("+e.level+")<a"+U.convertExternalAnchor(U.getYouTubeLink(D.getObjectDefaultName(e)))+"><ins class='s16 s16_youtube' title='Recommended level. Click for YouTube videos.'></ins></a> "),e.reward)for(t in e.reward)i+="coin"===t?E.formatCoinStringShort(e.reward[t]):e.reward[t]+"<ins class='s16 s16_"+t+"' title='"+t+"'></ins> ";i.length&&(r="<div class='chnDetailsExtra'>"+i+"<kbd id='chnDelete_"+e.nexus+"' class='chnDelete' title='Permanently hide this event chain (can undo in <img src=img/ui/menu/alarm.png /> menu above).'></kbd></div>"),$(e.htmllist).append("<div id='chnBar_"+e.nexus+"' class='chnBar'><div class='chnTitle'><img id='chnIcon_"+e.nexus+"' src='"+e.iconSrc+"' /><kbd id='chnCheck_"+e.nexus+"' class='chnCheck'></kbd><h1 id='chnTitle_"+e.nexus+"'>"+o+"</h1><time id='chnTime_"+e.nexus+"' class='chnTimeFutureFar'></time><aside><img class='chnDaily chnDaily_"+e.nexus+"' src='img/ui/daily.png' /></aside></div><div id='chnDetails_"+e.nexus+"' class='chnDetails'><ol id='chnEvents_"+e.nexus+"' class='chnEvents'></ol>"+r+"</div></div>");var s=function(e,t){var a=t,n="&lt;br /&gt;",i=function(e){return"&lt;dfn&gt;"+e+"&lt;/dfn&gt;"},r="";r=e.series===C.ChainSeriesEnum.DryTop?i("Event Number: ")+a.num+n+i("Start Time: ")+a.lim+n+n+"&amp;quot;"+D.getObjectName(a).replace(/["']/g,"")+"&amp;quot;":i("Event Number: ")+a.num+n+i("If Success Go To: ")+a.sGotoNum+n+i("If Failure Go To: ")+a.fGotoNum+n+i("If Success Wait: ")+a.sInterim+n+i("If Failure Wait: ")+a.fInterim+n+i("Time Limit: ")+a.lim+n+i("Avg to Complete: ")+a.avg+n+i("Min to Complete: ")+a.min+n+i("Max to Complete: ")+a.max+n+n+"&amp;quot;"+D.getObjectName(a).replace(/["']/g,"")+"&amp;quot;";var o="",s=C.cEventCharLimit,c=function(){o="chnSubstep",s=C.cEventCharLimit-4},l=C.getEventStepNumber(a.num);if(l.length!==a.num.length){var u=a.num.slice(l.length);-1!==a.num.indexOf(".")?c():2===a.num.length?-1===u.indexOf("A")&&-1===u.indexOf("a")&&c():-1===u.indexOf("A1")&&-1===u.indexOf("a1")&&c()}$("#chnEvents_"+e.nexus).append("<li id='chnEvent_"+e.nexus+"_"+a.num+"' class='chnStep_"+e.nexus+"_"+a.step+" "+o+"'><ins class='evt_"+a.icon+"' title='"+r+"'></ins><span>"+U.truncateString(D.getObjectName(a),s,"..")+"</span></li>")};for(t in e.events)if((n=e.events[t]).primacy===C.EventPrimacyEnum.Primary)e.primaryEvents.push(n);else if(n.primacy===C.EventPrimacyEnum.Boss){e.primaryEvents.push(n),e.primaryEvents[0].minSum=0,e.primaryEvents[0].avgSum=0,e.primaryEvents[0].minavgSum=0;break}for(t=1;t<e.primaryEvents.length;t++){var c=T.parseEventTime(e.primaryEvents[t-1].sInterim[0]);e.primaryEvents[t].minSum=T.parseEventTime(e.primaryEvents[t-1].min)+c+e.primaryEvents[t-1].minSum,e.primaryEvents[t].avgSum=T.parseEventTime(e.primaryEvents[t-1].avg)+c+e.primaryEvents[t-1].avgSum,e.primaryEvents[t].minavgSum=e.primaryEvents[t].minSum+~~(Math.abs(e.primaryEvents[t].avgSum-e.primaryEvents[t].minSum)/2)}if(t--,e.minFinish=e.primaryEvents[t].minSum+T.parseEventTime(e.primaryEvents[t].min),e.avgFinish=e.primaryEvents[t].avgSum+T.parseEventTime(e.primaryEvents[t].avg),e.minavgFinish=e.minFinish+~~(Math.abs(e.avgFinish-e.minFinish)/2),a=0,C.isChainScheduled(e)){for(t in e.events)if(e.events[t].primacy!==C.EventPrimacyEnum.Optional&&(C.getEventStepNumber(e.events[t].num)!==C.getEventStepNumber(e.primaryEvents[a].num)&&a++,s(e,e.events[t])),e.events[t].primacy===C.EventPrimacyEnum.Boss)break}else for(t in e.events)s(e,e.events[t]);I.ModeCurrent!==I.ModeEnum.Tile&&($("#chnTitle_"+e.nexus).click(function(e){e.which===I.ClickEnum.Left&&$(this).parent().next().slideToggle(100,function(){I.updateScrollbar($(this))})}),$("#chnDetails_"+e.nexus).hide()),$("#chnDetails_"+e.nexus+" .chnWaypoint").each(function(){I.bindClipboard($(this),$(this).val())}).click(function(){$(this).select()}),I.qTip.init($("#chnDetails_"+e.nexus+" ins")),I.qTip.init($("#chnDetails_"+e.nexus+" kbd")),X.initializeChainChecklist(e)},initializeScheduledChains:function(){for(var e,t=C.Chains.length,a=0;a<t;a++){switch(e=C.Chains[a],e.nexus=a,C.ChainAssociation[e.alias.toLowerCase()]=e.nexus,e.series){case C.ChainSeriesEnum.Standard:case C.ChainSeriesEnum.Hardcore:e.htmllist="#sectionChains_Scheduled",C.RegularChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.DryTop:e.htmllist="#sectionChains_Drytop",C.DryTopChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.Miscellaneous:e.flags.isSpecial?e.htmllist="#sectionChains_Special":e.htmllist="#sectionChains_Scheduled",C.MiscellaneousChains.push(e),C.RegularChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.LivingStory:if(!H.isStoryEnabled)continue;H.isStoryDashboard?e.htmllist="#dsbStory":e.htmllist="#sectionChains_Scheduled",C.LivingStoryChains.push(e),C.RegularChains.push(e),C.ScheduledChains.push(e)}C.initializeChain(e)}},initializeUnscheduledChains:function(){!1===C.isUnscheduledChainsLoaded&&U.getScript(U.URL_DATA.Unscheduled,function(){if(!C.isUnscheduledChainsLoaded){for(var e=GW2T_CHAIN_UNSCHEDULED,t=C.Chains.length,a=0;a<e.length;a++)C.Chains.push(e[a]);for(var n,i=C.Chains.length,a=t;a<i;a++){switch(n=C.Chains[a],n.nexus=a,n.series){case C.ChainSeriesEnum.Temple:n.htmllist="#sectionChains_Temple",C.TempleChains.push(n),C.UnscheduledChains.push(n);break;case C.ChainSeriesEnum.Legacy:n.htmllist="#sectionChains_Legacy",C.LegacyChains.push(n),C.UnscheduledChains.push(n)}C.initializeChain(n),P.drawChainPaths(n)}C.isUnscheduledChainsLoaded=!0}})},isChainCurrent:function(e){for(var t in C.CurrentChains)if(e.nexus===C.CurrentChains[t].nexus)return!0;return!1},isChainUnchecked:function(e){return X.getChainChecklistState(e)===X.ChecklistEnum.Unchecked},isChainSubscribed:function(e){return X.getChecklistItem(X.Checklists.ChainSubscription,e.nexus)===X.ChecklistEnum.Checked},updateChainsTimeHTML:function(){var e,t,a,n,i,r="<dfn>"+D.getPhraseTitle("click to <br/> subscribe")+"</dfn><br />";for(e in C.ScheduledChains){i=(t=C.ScheduledChains[e]).flags.minuteDelay?t.flags.minuteDelay*T.cSECONDS_IN_MINUTE:0;var o="";if(t.series!==C.ChainSeriesEnum.DryTop){for(var s in t.scheduleKeys)o=o+(0===parseInt(s)?r:" <br /> ")+T.getTimeFormatted({aWantSeconds:!1,aCustomTimeInSeconds:T.convertScheduleKeyToLocalSeconds(t.scheduleKeys[s])+i});$("#chnTime_"+t.nexus).prop("title",o)}if(!1===C.isChainCurrent(t)){var c="",l=t.flags.minuteDelay<0;a=T.getTimeFormatted({aWantLetters:!0,aWantSeconds:!1,aWantNegative:l,aCustomTimeInSeconds:T.getSecondsUntilChainStarts(t)+i}),l&&-1!==a.indexOf(I.Symbol.Negative)&&(c=I.Symbol.StateActive+" "),n=T.getTimeFormatted({aWantLetters:!1,aWantSeconds:!1,aCustomTimeInSeconds:T.convertScheduleKeyToLocalSeconds(t.scheduleKeys[0])+i}),$("#chnTime_"+t.nexus).html(c+a+"<br /><sup>"+n+"</sup>")}}I.qTip.init(".chnTitle time")},updateCurrentChainTimeHTML:function(e){var t,a,n=T.getCurrentTimeframeElapsedTime(),i=e.countdownToFinish-n,r=e.flags.minuteDelay,o=$("#chnTime_"+e.nexus),s=i,c=I.Symbol.StateActive+" ";if(e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated){var l=T.getDryTopMinute(),u=T.getDryTopMinute(1);a=T.getTimeFormatted({aReference:T.ReferenceEnum.UTC,aWant24:!0,aWantHours:!1});var d=l<T.cBASE_10?"0":"";if(o.html(":"+l+" (:"+d+a+")"),C.isDryTopIconsShown){var p="<var style='color:"+T.getCurrentDryTopColor()+"'>",h="<var style='color:"+T.getCurrentDryTopColor(1)+"'>";$("#mapDryTopTimer").html(p+":"+l+" (:"+d+a+") </var>"+h+":"+u+"</var><br />"+p+D.getWord("now")+" →</var> "+h+D.getWord("next")+"</var>")}}else r&&(t=r*T.cSECONDS_IN_MINUTE-n)>0&&(s=t,c=I.Symbol.StateWaiting+" "),i<=0&&(s=T.cSECONDS_IN_TIMEFRAME-n,c=I.Symbol.StateInactive+" "+I.Symbol.Negative),a=T.getTimeFormatted({aWantLetters:!0,aCustomTimeInSeconds:s}),o.html(c+a)},initializeTimetableHTML:function(){if(!1!==C.isTimetableGenerated){$("#sectionChains_Timetable").empty();var e,t,a,n;for(i in T.Schedule){t=T.getScheduleSlotChainsByKey(i);for(e in t){if((a=t[e]).series!==C.ChainSeriesEnum.Standard&&a.series!==C.ChainSeriesEnum.Hardcore&&a.series!==C.ChainSeriesEnum.Miscellaneous||a.flags.isSpecial)break;n=T.getTimeFormatted({aWantSeconds:!1,aCustomTimeInSeconds:T.convertScheduleKeyToLocalSeconds(i)}),$("#sectionChains_Timetable").append("<div class='chnSlot chnSlotTime_"+i+" chnSlot_"+a.nexus+"' data-"+C.cIndexSynonym+"='"+a.nexus+"' data-timeframe='"+i+"'><div class='chnTitle'><img src='"+a.iconSrc+"' /><kbd class='chnCheck'></kbd><h1>"+D.getObjectName(a)+"</h1><time>"+n+"</time><aside><img class='chnDaily chnDaily_"+a.nexus+"' src='img/ui/daily.png' /></aside></div></div>")}}for(var i in C.RegularChains){a=C.RegularChains[i];var r=$(".chnSlot_"+a.nexus),o=r.find(".chnCheck"),s=r.find("time");X.reapplyChainBarState(a.nexus,r,o,s)}$(".chnTitle h1").hover(function(){$(".chnSlot_"+$(this).parent().parent().data(C.cIndexSynonym)).addClass("chnBarHover")},function(){$(".chnSlot").removeClass("chnBarHover")}),$(".chnSlot .chnCheck").click(function(){$("#chnCheck_"+C.Chains[$(this).parent().parent().data(C.cIndexSynonym)].nexus).trigger("click")}),$(".chnSlot time").click(function(){$("#chnTime_"+C.Chains[$(this).parent().parent().data(C.cIndexSynonym)].nexus).trigger("click")}),$(".chnSlotTime_0").addClass("chnBarReset"),C.refreshChainDailyIcon()}},updateTimetable:function(){if(!1!==C.isTimetableGenerated){var e=T.getTimeframeKey(-1),t=T.getTimeframeKey(),a=T.getTimeframeKey(1);$(".chnSlotTime_"+e).removeClass("chnBarCurrent"),$(".chnSlotTime_"+t).addClass("chnBarCurrent"),$(".chnSlotTime_"+e+" .chnTitle h1").removeClass("chnTitleCurrent"),$(".chnSlotTime_"+t+" .chnTitle h1").removeClass("chnTitleFuture").addClass("chnTitleCurrent"),$(".chnSlotTime_"+a+" .chnTitle h1").addClass("chnTitleFuture");var n=T.getCurrentTimeframe();$(".chnSlot").each(function(){if(!(T.convertScheduleKeyToUTCMinutes($(this).data("timeframe"))<n))return!1;$(this).appendTo("#sectionChains_Timetable")}),C.ChainToday&&$("#sectionChains_Timetable .chnDaily_"+C.ChainToday.nexus).each(function(){T.convertScheduleKeyToUTCMinutes($(this).closest(".chnSlot").data("timeframe"))<n&&$(this).hide()})}},sortChainsListHTML:function(){for(var e,t,a=0,n=C.ScheduledChains.length,i=0,r=0;a<n;){e=T.getTimeframeChains(i);for(r in e){if(a>=n)break;!1===(t=e[r]).isSorted&&($("#chnBar_"+t.nexus).appendTo(t.htmllist),t.isSorted=!0,t.scheduleKeyImmediate=T.getTimeframeKey(i),a++)}i++}for(i in C.ScheduledChains){(t=C.ScheduledChains[i]).isSorted=!1;for(r in t.scheduleKeys)if(t.scheduleKeys[r]===t.scheduleKeyImmediate){t.scheduleKeys=t.scheduleKeys.slice(r,t.scheduleKeys.length).concat(t.scheduleKeys.slice(0,r));break}}C.updateChainsTimeHTML();var o={};for(i in C.CurrentChains)o[(t=C.CurrentChains[i]).nexus]=t.nexus,$("#chnBar_"+t.nexus).addClass("chnBarCurrent"),C.isChainUnchecked(t)&&O.Options.bol_expandWB&&I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+t.nexus).show("fast",function(){I.updateScrollbar()}),$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleFuture chnTitleFutureFar").addClass("chnTitleCurrent"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeFuture chnTimeFutureFar").addClass("chnTimeCurrent");for(i in C.PreviousChains1)o[(t=C.PreviousChains1[i]).nexus]!==t.nexus&&($("#chnBar_"+t.nexus).removeClass("chnBarCurrent").addClass("chnBarPrevious"),O.Options.bol_collapseChains&&I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+t.nexus).hide(),$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleCurrent").addClass("chnTitleFutureFar"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeCurrent").addClass("chnTimeFutureFar"));for(i in C.PreviousChains2)o[(t=C.PreviousChains2[i]).nexus]!==t.nexus&&$("#chnBar_"+t.nexus).removeClass("chnBarPrevious");for(i in C.NextChains1)o[(t=C.NextChains1[i]).nexus]!==t.nexus&&($("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleFutureFar").addClass("chnTitleFuture"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeFutureFar").addClass("chnTimeFuture"))},queueEventsHighlight:function(e){var t,a,n=e,i=T.getCurrentTimeframeElapsedTime(),r=!1;if(i>0){for(t in n.primaryEvents)if((a=C.getSumBasedOnOptions(n,t))>=i&&t>0){C.highlightEvents(n,parseInt(t-1)),r=!0;break}!1===r&&((a=C.getSumBasedOnOptions(n,-1))>=i?C.highlightEvents(n,t):C.highlightEvents(n,-1))}for(t in n.primaryEvents)(a=C.getSumBasedOnOptions(n,t))>=i&&(a-=i,setTimeout(function(e,t){return function(){C.highlightEvents(e,t)}}(n,parseInt(t)),a*T.cMSECONDS_IN_SECOND));(a=C.getSumBasedOnOptions(n,-1))>=i&&(a-=i,setTimeout(function(e){return function(){C.highlightEvents(e,-1)}}(n),a*T.cMSECONDS_IN_SECOND))},highlightEvents:function(e,t){var a,n,i=500,r=C.cEventNameWidth,o=e.primaryEvents.length-1,s=C.isChainRegular(e);if(e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated&&(P.LayerArray.DryTopActive=null,P.LayerArray.DryTopActive=[],C.isDryTopIconsShown))for(a in e.events)n=e.events[a],M.toggleLayer(n.eventicon,!1),M.toggleLayer(n.eventring,!1);if(t>-1){for(e.CurrentPrimaryEvent=e.primaryEvents[t],a=0;a<t;a++)$(".chnStep_"+e.nexus+"_"+a).removeClass("chnEventCurrent");if($(".chnStep_"+e.nexus+"_"+(t-1)).css({opacity:1}).animate({opacity:.5},i,function(){e.series===C.ChainSeriesEnum.DryTop&&$(this).hide()}),$(".chnStep_"+e.nexus+"_"+t).each(function(){$(this).removeClass("chnEventFuture").addClass("chnEventCurrent").show().css({width:0,opacity:.5}).animate({width:r,opacity:1},i).css({width:"auto"}),e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated&&(n=e.events[$(this).attr("data-eventindex")],I.isMapEnabled&&(P.LayerArray.DryTopActive.push(n.eventicon),P.LayerArray.DryTopActive.push(n.eventring),C.isDryTopIconsShown&&M.toggleLayerArray(P.LayerArray.DryTopActive,!0),P.rebindMarkerTooltips()))}),t<e.primaryEvents.length)for(a=t+1;a<e.primaryEvents.length;a++)$(".chnStep_"+e.nexus+"_"+a).show().removeClass("chnEventCurrent").addClass("chnEventFuture");if(P.wantTourPrediction()&&M.isMapAJAXDone&&C.isChainUnchecked(e)&&s&&!e.flags.isSpecial&&C.isTouringAuto&&!1===C.isTouringManual&&(C.isTouringAuto=!1,$("#chnEvent_"+e.nexus+"_"+e.CurrentPrimaryEvent.num).trigger("click"),setTimeout(function(){C.isTouringAuto=!0},1e3)),t===o&&O.Options.bol_alertArrival&&s&&(O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&C.isChainUnchecked(e)&&!e.flags.isSpecial||O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&C.isChainSubscribed(e)&&C.isChainUnchecked(e))){var c=D.getPhraseOriginal("Arrival predicted");D.speak(D.getChainPronunciation(e)+" "+c),I.notify({aTitle:D.getObjectName(e),aBody:c,aIcon:e.iconSrc})}}else{if(e.CurrentPrimaryEvent=e.primaryEvents[o],$("#chnEvents_"+e.nexus+" li").show().removeClass("chnEventCurrent"),$(".chnStep_"+e.nexus+"_"+o).css({opacity:1}).animate({opacity:.5},i),O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&O.Options.bol_alertAtEnd&&I.isProgramLoaded&&e.nexus===C.CurrentChainSD.nexus&&s){var l=", "+D.getSpeechWord("checked"),u="",d="",p=U.objToBool(C.NextChainSD1),h=U.objToBool(C.NextChainHC1),m=D.getSpeechWord("next "+D.orderModifier("boss","world")+" is")+" ",g="";C.NextChainSD1&&!C.isChainUnchecked(C.NextChainSD1)&&(u=l),C.NextChainHC1&&!C.isChainUnchecked(C.NextChainHC1)&&(d=l),!1===O.Options.bol_alertChecked&&(u.length>0&&(p=!1),d.length>0&&(h=!1)),p&&h?(D.speak(m+D.getChainPronunciation(C.NextChainSD1)+u,5),D.speak(D.getSpeechWord("also")+", "+D.getChainPronunciation(C.NextChainHC1)+d,3)):p?D.speak(m+D.getChainPronunciation(C.NextChainSD1)+u,5):h&&D.speak(m+D.getChainPronunciation(C.NextChainHC1)+d,5),(p||h)&&(g=T.getTimeTillChainFormatted(C.NextChainSD1,"speech"),D.speak(g,3)),p&&I.notify({aTitle:D.getObjectName(C.NextChainSD1),aBody:g,aIcon:C.NextChainSD1.iconSrc}),h&&I.notify({aTitle:D.getObjectName(C.NextChainHC1),aBody:g,aIcon:C.NextChainHC1.iconSrc})}O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&O.Options.bol_alertUnsubscribe&&I.isProgramLoaded&&C.isChainWorldBoss(e)&&C.isChainSubscribed(e)&&$("#chnTime_"+e.nexus).trigger("click")}},getSumBasedOnOptions:function(e,t){if(C.isChainToday(e))return t>-1?e.primaryEvents[t].minSum:(e.countdownToFinish=e.minFinish,e.minFinish);var a=T.getTimeSinceMidnight(T.ReferenceEnum.Local,T.UnitEnum.Hours);if(t>-1){switch(O.Options.int_setPredictor){case O.IntEnum.Predictor.Auto:if(a>=12&&a<18)return e.primaryEvents[t].minSum;if(a>=18)return e.primaryEvents[t].minavgSum;if(a>=0&&a<6)return e.primaryEvents[t].avgSum;if(a>=6&&a<12)return e.primaryEvents[t].minavgSum;break;case O.IntEnum.Predictor.Min:return e.primaryEvents[t].minSum;case O.IntEnum.Predictor.MinAvg:return e.primaryEvents[t].minavgSum;case O.IntEnum.Predictor.Avg:return e.primaryEvents[t].avgSum}return e.primaryEvents[t].minavgSum}switch(O.Options.int_setPredictor){case O.IntEnum.Predictor.Auto:if(a>=12&&a<18)return e.countdownToFinish=e.minFinish,e.minFinish;if(a>=18)return e.countdownToFinish=e.minavgFinish,e.minavgFinish;if(a>=0&&a<6)return e.countdownToFinish=e.avgFinish,e.avgFinish;if(a>=6&&a<12)return e.countdownToFinish=e.minavgFinish,e.minavgFinish;break;case O.IntEnum.Predictor.Min:return e.countdownToFinish=e.minFinish,e.minFinish;case O.IntEnum.Predictor.MinAvg:return e.countdownToFinish=e.minavgFinish,e.minavgFinish;case O.IntEnum.Predictor.Avg:return e.countdownToFinish=e.avgFinish,e.avgFinish}return e.countdownToFinish=e.minavgFinish,e.minavgFinish}},M={MapEnum:"map",OptionSuffix:"",Continent:GW2T_CONTINENT_DATA.map,Zones:GW2T_ZONE_DATA,ZoneAssociation:GW2T_ZONE_ASSOCIATION,Subzones:{},Regions:GW2T_REGION_DATA,Submaps:GW2T_SUBMAP_DATA,Compasses:GW2T_COMPASS_DATA,cInitialZone:"lion",Map:{},FloorCurrent:{},ZoneCurrent:{},numPins:0,numPinsSlots:32,numCompassesSlots:32,cICON_SIZE_STANDARD:32,cRING_SIZE_MAX:256,isMapInitialized:!1,isTouchEnabled:!1,isMouseOnHUD:!1,isMenuOnHUD:!1,isUserDragging:!1,isZoneLocked:!1,isFloorShown:!0,isMapAJAXDone:!1,isAPIRetrieved_MAPFLOOR:!1,isItineraryRetrieved:!1,isMappingIconsGenerated:!1,isEventIconsGenerated:!1,ContextLatLng:null,cMAP_MOUSEMOVE_RATE:100,cInertiaThreshold:100,cZoomFactor:2,ZoomEnum:{Adaptive:-2,Same:-1,Min:0,Overview:3,Default:3,Space:3,Sky:5,Bird:6,Ground:7,Max:7},cZIndexRaise:999999,cZIndexBury:-999999,GPSPreviousZoneID:"",GPSPreviousCoord:[],GPSPreviousAngleCharacter:0,GPSPreviousAngleCamera:0,GPSisInstance:!1,Layer:{Overview:new L.layerGroup,Pin:new L.layerGroup,PersonalPin:new L.layerGroup,PersonalPath:new L.layerGroup,CompassIcon:new L.layerGroup,CompassCircle:new L.layerGroup},Pin:{Program:{},Event:{},Over:{},Character:{},Camera:{}},MappingEnum:{Sector:0,Waypoint:1,Landmark:2,Vista:3,Challenge:4,Heart:5,EventIcon:6,EventCircle:7,EventLabel:8},APIPOIEnum:{Sector:"sectors",Waypoint:"waypoint",Landmark:"landmark",Vista:"vista",Challenge:"skill_challenges",Heart:"tasks"},initializeMap:function(){var e=this,t="#"+this.MapEnum,a=O.Options["int_setInitialZoom"+P.MapSwitchSuffix];this.Map=L.map(this.MapEnum+"Pane",{minZoom:this.ZoomEnum.Min,maxZoom:this.ZoomEnum.Max,inertiaThreshold:this.cInertiaThreshold,doubleClickZoom:!1,touchZoom:!1,zoomControl:!1,attributionControl:!1,crs:L.CRS.Simple}).setView(this.Continent.CenterInitial,a),this.initializeTouch();var n;for(var i in this.Zones)(n=this.Zones[i]).center=this.computeZoneCenter(n),n.nick=i,n.Layers={Path:new L.layerGroup,Waypoint:new L.layerGroup,Landmark:new L.layerGroup,Vista:new L.layerGroup,Mastery:new L.layerGroup,Challenge:new L.layerGroup,Heart:new L.layerGroup,Sector:new L.layerGroup,HeartArea:new L.layerGroup,SectorArea:new L.layerGroup,EventIcon:new L.layerGroup,EventCircle:new L.layerGroup,EventArea:new L.layerGroup,EventLabel:new L.layerGroup},e.MapEnum===P.MapEnum.Tyria&&P.LayerArray.ChainPath.push(n.Layers.Path);switch(this.ZoneCurrent=this.Zones[this.cInitialZone],this.MapEnum){case P.MapEnum.Tyria:this.createStandardPins(),P.populateMap(M),P.drawZoneBorders(),P.drawZoneGateways(),C.ScheduledChains.forEach(P.drawChainPaths),H.getUrgent(H.Announcement.UrgentPVE);break;case P.MapEnum.Mists:this.createStandardPins(),P.populateMap(W),H.getUrgent(H.Announcement.UrgentWVW)}this.bindMapClicks(),$(t+"CoordinatesCopy").onEnterKey(function(){var t=$(this).val();Z.interpretCommand(t,e,e.ZoomEnum.Ground,e.Pin.Program)}),$(t+"GPSButton").click(function(){P.updateCharacter(1)}).dblclick(function(){e.Map.getZoom()!==e.ZoomEnum.Ground?e.Map.setZoom(e.ZoomEnum.Ground):e.Map.setZoom(e.ZoomEnum.Default)}),$(t+"ZoneButton").one("mouseenter",e.bindZoneList(e)).dblclick(function(){e.goToDefault()}).contextmenu(function(t){t.preventDefault(),e.Map.setZoom(e.Map.getZoom()-1)}),this.isMapInitialized=!0},createStandardPins:function(){if(I.isMapEnabled){var e=this;this.Pin.Program=this.createPin("img/map/pin_blue.png"),this.Pin.Event=this.createPin("img/map/pin_green.png"),this.Pin.Over=this.createPin("img/map/pin_over.png",[128,128]),this.Pin.Character=this.createPin("img/map/pin_character.png",[40,40]),this.Pin.Camera=this.createPin("img/map/pin_camera.png",[256,256],{clickable:!1}),this.Layer.Pin.eachLayer(function(t){e.bindMarkerCoordBehavior(t,"click"),e.bindMarkerZoomBehavior(t,"contextmenu"),t.on("dblclick",function(){e.movePin(this)})}),this.Pin.Character.on("dblclick",function(){e.movePin(this),e.movePin(e.Pin.Camera)}),this.toggleLayer(this.Layer.Pin,!1)}},initializeTouch:function(){var e=this;if(!(O.Options.bol_ignoreTouch||e.isTouchEnabled&&I.isTouchEnabled)&&("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)){e.isTouchEnabled=!0,I.isTouchEnabled=!0,e.Map.touchZoom&&e.Map.touchZoom.disable(),e.Map.tap&&e.Map.tap.disable();var t="#"+e.MapEnum,a=$("<div class='tchMenu'></div>").prependTo(t+"Pane");I.preventMapPropagation(a),$("<kbd class='tchTogglePanel tchButton'></kbd>").appendTo(a).click(function(){$("#opt_bol_showPanel").trigger("click")}),$("<kbd class='tchZoomIn tchButton'></kbd>").appendTo(a).click(function(){e.Map.zoomIn()}),$("<kbd class='tchZoomOut tchButton'></kbd>").appendTo(a).click(function(){e.Map.zoomOut()}),a.css({top:"calc(50% - "+a.height()+"px)"})}},bindMapClicks:function(){var e=this,t="#"+e.MapEnum,a=$(t+"Peripheral"),n=a.find(".hudSelect"),i=a.find(".hudItem"),r="hudPeripheralActive",o="hudItemActive";switch(n.click(function(){i.removeClass(o),e.isMenuOnHUD?a.removeClass(r):(a.addClass(r),$(this).parent().addClass(o)),e.isMenuOnHUD=!e.isMenuOnHUD}).mouseenter(function(){e.isMenuOnHUD&&(i.removeClass(o),$(this).parent().addClass(o))}),a.mouseleave(function(){a.removeClass(r),e.isMenuOnHUD&&(i.removeClass(o),e.isMenuOnHUD=!1)}),I.preventMapPropagation(t+"CoordinatesBar"),this.toggleCoordinatesBar(),$(t+"CoordinatesToggle").click(function(){$("#opt_bol_showCoordinatesBar").trigger("click")}),this.Map.on("click",function(t){if(!e.isMouseOnHUD&&!e.isTouchEnabled){var a=e.convertLCtoGC(t.latlng);e.outputCoordinatesCopy(P.formatCoord(a))}}),this.Map.on("dblclick",function(t){e.isMouseOnHUD||(e.saveBackupPins(),e.createPersonalPin(t.latlng,!0))}),this.Map.on("contextmenu",function(a){e.ContextLatLng=a.latlng,I.showContextMenu(t+"Context")}),$(t+"Context").click(function(){$(this).hide()}),$(t+"ContextCenter").click(function(){e.goToDefault()}),$(t+"ContextToggleHUD").click(function(){$("#opt_bol_showHUD"+e.OptionSuffix).trigger("click")}),$(t+"ContextCompass").one("mouseenter",function(){U.getScript(U.URL_DATA.Resource,function(){e.initializeCompassPlacer(e)})}),$(t+"ContextPins").one("mouseenter",function(){e.initializePinsPlacer(e)}),$(t+"ContextToggleFloor").click(function(){e.toggleFloor()}),$(t+"ContextToggleLock").click(function(){e.toggleZoneLock()}),$(t+"ContextToggleCompletion").click(function(){$("#opt_bol_showWorldCompletion"+e.OptionSuffix).trigger("click")}),e.MapEnum){case P.MapEnum.Tyria:$(t+"ContextDrawCompletion").click(function(){P.drawCompletionRoute()}),$(t+"ContextDrawResource").click(function(){G.drawResourceRoute()});break;case P.MapEnum.Mists:}},toggleCoordinatesBar:function(){var e=O.Options.bol_showCoordinatesBar;$(".mapCoordinatesBar input").toggle(e),I.ModeCurrent===I.ModeEnum.Overlay&&$(".mapTime").toggle(e)},outputCoordinatesCopy:function(e){var t="#"+this.MapEnum;$(t+"CoordinatesCopy").val(e).select()},outputCoordinatesName:function(e){var t="#"+this.MapEnum;$(t+"CoordinatesName").val(e)},bindMapVisualChanges:function(){var e=this,t="#"+e.MapEnum;$(t+"HUDPane").hover(function(){e.isMouseOnHUD=!0},function(){e.isMouseOnHUD=!1}),$(t+"Context").hover(function(){e.isMouseOnHUD=!0},function(){e.isMouseOnHUD=!1}),this.Map.on("dragstart",function(){e.isUserDragging=!0,C.isTouringManual=!0}),this.Map.on("dragend",function(){e.isUserDragging=!1}),this.Map.on("mousemove",$.throttle(e.cMAP_MOUSEMOVE_RATE,function(t){e.isMouseOnHUD||e.isUserDragging||e.showCurrentZone(e.convertLCtoGC(t.latlng))})),this.Map.on("zoomend",function(t){e.adjustZoomMapping(),e.MapEnum===P.MapEnum.Tyria&&P.adjustZoomDryTop()})},changeFloor:function(e){this.Map.removeLayer(this.FloorCurrent),void 0!==e&&!0!==e||(e=O.Options["int_setFloor"+this.OptionSuffix]),!1!==e&&(this.FloorCurrent=L.tileLayer("https://tiles.guildwars2.com/"+this.Continent.id+"/"+e+"/{z}/{x}/{y}.jpg",{continuousWorld:!0}),this.FloorCurrent.addTo(this.Map))},toggleFloor:function(e){var t=this,a="#"+t.MapEnum,n=$(a+"Pane");t.isFloorShown=void 0===e?!t.isFloorShown:e,n.toggleClass("mapPaneOff",!t.isFloorShown),t.isFloorShown?t.changeFloor():I.ModeCurrent===I.ModeEnum.Overlay&&t.changeFloor(!1)},toggleZoneLock:function(){this.isZoneLocked=!this.isZoneLocked,this.isZoneLocked?I.write("Map locked to zone: "+D.getObjectName(this.ZoneCurrent)):I.write("Map zoning unlocked.")},refreshMap:function(){this.isMapInitialized&&(this.Map.invalidateSize(),this.refreshView())},isZoneValid:function(e){return void 0!==this.ZoneAssociation[e]},isSubzoneValid:function(e){return void 0!==this.Subzones[e]&&void 0!==this.Subzones[e].map_rect},getZoneFromID:function(e){var t=this.ZoneAssociation[e];return t?this.Zones[t]:null},getZoneFromString:function(e){var t=e.toLowerCase();for(var a in this.Zones)if(-1!==t.indexOf(a))return this.Zones[a];return null},getZoneName:function(e){var t;if("string"==typeof e&&this.Zones[e])t=this.Zones[e];else{if("object"!=typeof e)return"nozonename";t=e}return D.getObjectName(t)},getZoneNick:function(e){return this.ZoneAssociation[e.id]},getZoneRegion:function(e){var t=this.Zones[e.toLowerCase()];return t?t.region:null},isWithinZone:function(e,t){var a=e.continent_rect;return t[0]>=a[0][0]&&t[1]>=a[0][1]&&t[0]<=a[1][0]&&t[1]<=a[1][1]},getZoneFromCoord:function(e){for(var t in this.Zones)if(this.isWithinZone(this.Zones[t],e))return this.Zones[t];return null},showCurrentZone:function(e){var t=this,a=t.MapEnum;if(document.getElementById(a+"CoordinatesMouse").value=e[0]+", "+e[1],!(e[0]>=this.ZoneCurrent.continent_rect[0][0]&&e[1]>=this.ZoneCurrent.continent_rect[0][1]&&e[0]<=this.ZoneCurrent.continent_rect[1][0]&&e[1]<=this.ZoneCurrent.continent_rect[1][1]||!0===this.isZoneLocked)){var n,i="",r=this.getZoneFromCoord(e);if(null!==r){n=this.Zones[this.ZoneCurrent.nick];for(var o in n.Layers)this.Map.removeLayer(n.Layers[o]);switch(this.ZoneCurrent=r,i=this.getZoneName(this.ZoneCurrent),document.getElementById(a+"CoordinatesName").value=i,t.MapEnum){case P.MapEnum.Tyria:P.isChainPathsAllowed()&&this.ZoneCurrent.Layers.Path.addTo(this.Map),O.Options.bol_displayWaypoints&&this.ZoneCurrent.Layers.Waypoint.addTo(this.Map),O.Options.bol_displayPOIs&&this.ZoneCurrent.Layers.Landmark.addTo(this.Map),O.Options.bol_displayVistas&&this.ZoneCurrent.Layers.Vista.addTo(this.Map),O.Options.bol_displayMasteries&&this.ZoneCurrent.Layers.Mastery.addTo(this.Map),O.Options.bol_displayChallenges&&this.ZoneCurrent.Layers.Challenge.addTo(this.Map),O.Options.bol_displayHearts&&this.ZoneCurrent.Layers.Heart.addTo(this.Map),O.Options.bol_displaySectors&&this.ZoneCurrent.Layers.Sector.addTo(this.Map),O.Options.bol_displayHeartsArea&&this.ZoneCurrent.Layers.HeartArea.addTo(this.Map),O.Options.bol_displaySectorsArea&&this.ZoneCurrent.Layers.SectorArea.addTo(this.Map),O.Options.bol_displayEvents&&(this.ZoneCurrent.Layers.EventIcon.addTo(this.Map),this.ZoneCurrent.Layers.EventCircle.addTo(this.Map),this.ZoneCurrent.Layers.EventArea.addTo(this.Map),this.ZoneCurrent.Layers.EventLabel.addTo(this.Map));break;case P.MapEnum.Mists:O.Options.bol_displayWaypointsWvW&&this.ZoneCurrent.Layers.Waypoint.addTo(this.Map),O.Options.bol_displayPOIsWvW&&this.ZoneCurrent.Layers.Landmark.addTo(this.Map),O.Options.bol_displayVistasWvW&&this.ZoneCurrent.Layers.Vista.addTo(this.Map),O.Options.bol_displayChallengesWvW&&this.ZoneCurrent.Layers.Challenge.addTo(this.Map),O.Options.bol_displaySectorsWvW&&this.ZoneCurrent.Layers.Sector.addTo(this.Map),O.Options.bol_displaySectorsAreaWvW&&this.ZoneCurrent.Layers.SectorArea.addTo(this.Map)}P.rebindMarkerTooltips(),this.adjustZoomMapping()}}},refreshCurrentZone:function(){var e=this.ZoneCurrent.center;switch(this.MapEnum){case P.MapEnum.Tyria:this.showCurrentZone(this.getZoneCenter("verdant")),this.showCurrentZone(this.getZoneCenter("auric"));break;case P.MapEnum.Mists:this.showCurrentZone(this.getZoneCenter("edge")),this.showCurrentZone(this.getZoneCenter("eternal"))}this.showCurrentZone(e)},computeZoneCenter:function(e){var t=e.continent_rect;return[t[0][0]+~~((t[1][0]-t[0][0])/2),t[0][1]+~~((t[1][1]-t[0][1])/2)]},getZoneCenter:function(e){return this.Zones[e]?this.Zones[e].center:[0,0]},getEventCenter:function(e){var t=this.getZoneFromID(e.map_id),a=e.location.center;return this.convertEventCoord(a,t)},scaleDimension:function(e,t){return t=t||this.Map.getZoom(),parseInt(e/Math.pow(this.cZoomFactor,this.ZoomEnum.Max-t))},invertZoomLevel:function(e){return this.ZoomEnum.Max-e},adjustZoomMapping:function(){var e,t,a,n=this,i=this.Map.getZoom(),r=this.invertZoomLevel(i),o={waypoint:[40,32,26,20,16,12,0,0],landmark:[32,24,16,12,0,0,0,0],eventicon:[32,24,16,12,0,0,0,0],eventlabelfont:[14,0,0,0,0,0,0,0],sectorfont:[28,20,16,0,0,0,0,0],sectoropacity:[.9,.6,.3,0,0,0,0,0],objicon:[38,38,38,38,32,24,16,0],objtimerfont:[18,17,16,15,14,13,12,0],objinfofont:[14,13,12,11,10,9,0,0],objumbrella:[96,96,96,96,64,32,24,0],spawnfont:[28,24,20,16,12,8,0,0],spawnopacity:[.9,.9,.8,.7,.6,.5,0,0],wallweight:[10,8,6,4,2,0,0,0]},s=function(e){return o[e][r]},c=s("waypoint"),l=s("landmark"),u=s("eventicon"),d=s("eventlabelfont"),p=s("sectorfont"),h=s("sectoropacity"),m=s("objicon"),g=s("objtimerfont"),f=s("objinfofont"),C=s("objumbrella"),v=s("spawnfont"),b=s("spawnopacity"),S=s("wallweight");switch(this.MapEnum){case P.MapEnum.Tyria:O.Options.bol_displayEvents&&(this.ZoneCurrent.Layers.EventIcon.eachLayer(function(e){n.resizeMarkerIcon(e,u),e._icon&&(e._icon.style.zIndex=M.cZIndexRaise)}),this.ZoneCurrent.Layers.EventCircle.eachLayer(function(e){e.setRadius(n.getZoomedDistance(e.options.trueradius))}),this.ZoneCurrent.Layers.EventLabel.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=d+"px",e._icon.style.zIndex=n.cZIndexBury+1,e._icon.style.display="table")})),t=O.Options.bol_showZoneOverview,e=O.Options.bol_showWorldCompletion,a=O.Options.bol_displaySectors;break;case P.MapEnum.Mists:$(".objIcon").css({width:m,height:m}),$(".objProgressBar").css({width:m}),$(".objTimer").css({fontSize:g}),$(".objInfo").css({fontSize:f}),$(".objUmbrella").css({width:C,height:C}),t=O.Options.bol_showZoneOverviewWvW,e=O.Options.bol_showWorldCompletionWvW,a=O.Options.bol_displaySectorsWvW,this.Layer.SpawnLabel.eachLayer(function(e){e._icon.style.fontSize=v+"px",e._icon.style.opacity=b,e._icon.style.zIndex=n.cZIndexBury+1,e._icon.style.display="table"}),this.Layer.Secondaries.eachLayer(function(e){n.resizeMarkerIcon(e,l)}),this.Layer.Destructible.eachLayer(function(e){e.setStyle({weight:S})})}this.Layer.CompassCircle.eachLayer(function(e){e.setRadius(n.getZoomedDistance(e.options.trueradius))}),e&&t&&i===this.ZoomEnum.Overview?(this.toggleLayer(this.Layer.Overview,!0),this.Layer.Overview.eachLayer(function(e){e._icon.style.display="table"})):this.toggleLayer(this.Layer.Overview,!1),this.ZoneCurrent.Layers.Waypoint.eachLayer(function(e){n.resizeMarkerIcon(e,c)}),this.ZoneCurrent.Layers.Landmark.eachLayer(function(e){n.resizeMarkerIcon(e,l),e._icon&&(e._icon.style.opacity=i<n.ZoomEnum.Max?.6:.8)}),this.ZoneCurrent.Layers.Vista.eachLayer(function(e){n.resizeMarkerIcon(e,l)}),this.ZoneCurrent.Layers.Mastery.eachLayer(function(e){n.resizeMarkerIcon(e,l)}),this.ZoneCurrent.Layers.Challenge.eachLayer(function(e){n.resizeMarkerIcon(e,l)}),this.ZoneCurrent.Layers.Heart.eachLayer(function(e){n.resizeMarkerIcon(e,l)}),this.ZoneCurrent.Layers.Sector.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=p+"px",e._icon.style.opacity=h,e._icon.style.zIndex=n.cZIndexBury+1,a&&(e._icon.style.display="table"))}),P.updateCharacter(-1)},getZoomedDistance:function(e){return e/Math.pow(2,this.ZoomEnum.Max-this.Map.getZoom())},createStandardIcon:function(e){return L.icon({iconUrl:e,iconSize:[32,32],iconAnchor:[16,16]})},createPin:function(e,t,a){void 0===t&&(t=[32,32]);var n={icon:L.icon({iconUrl:e,iconSize:t,iconAnchor:[t[0]/2,t[1]/2]}),draggable:!0};if(void 0!==a)for(var i in a)n[i]=a[i];var r=L.marker(this.convertGCtoLC([0,0]),n);return this.Layer.Pin.addLayer(r),r},initializeContextSlots:function(e,t,a,n,i){for(var r,o=a,s="#"+o.MapEnum,c=D.getWordCapital("load"),l=D.getWordCapital("save"),u=D.getWordCapital("slot"),d=$(s+"ContextLoad"+e),p=$(s+"ContextSave"+e),h=0;h<t;h++)r=" "+u+": <input class='cssInputText mapContextSlot' type='text' value='#"+(h+1)+"' /></li>",d.append("<li data-index='"+h+"' class='mapContextLine'>"+c+r),p.append("<li data-index='"+h+"' class='mapContextLine'>"+l+r);X.initializeTextlist(X.Textlists["Slot"+e+o.OptionSuffix],d.find(".mapContextSlot"),null,64),X.initializeTextlist(X.Textlists["Slot"+e+o.OptionSuffix],p.find(".mapContextSlot"),null,64),$([d,p]).each(function(){$(this).find(".mapContextSlot").click(function(e){e.stopPropagation(),$(this).select()})}),$(s+"ContextSave"+e+" li").click(function(){n($(this).attr("data-index"))}).find(".mapContextSlot").onEnterKey(function(){$(this).parent().trigger("click")}),$(s+"ContextLoad"+e+" li").click(function(){i($(this).attr("data-index"))}).find(".mapContextSlot").onEnterKey(function(){$(this).parent().trigger("click")}),I.createFilterBar($("<div class='mapContextSearch'></div>").prependTo(d),d.find(".mapContextSlot"),".mapContextLine"),I.createFilterBar($("<div class='mapContextSearch'></div>").prependTo(p),p.find(".mapContextSlot"),".mapContextLine"),I.bindScrollbar(d),I.bindScrollbar(p)},initializePinStorage:function(e){var t=e,a=function(e){var a=O.Utilities["StoredPins"+t.OptionSuffix];a.value=new Array(e);var n=a.key;try{a.value=JSON.parse(localStorage[n])}catch(e){}},n=function(e){var a=O.Utilities["StoredPins"+t.OptionSuffix],n=t.getPersonalCoords();n.length>0?(a.value[e]=n,localStorage[a.key]=JSON.stringify(a.value),I.write(n.length+" pins saved.")):t.isPersonalPinsLaid(!0)},i=function(e){var a=O.Utilities["StoredPins"+t.OptionSuffix];t.redrawPersonalPath(a.value[e])},r=t.numPinsSlots;a(r),t.initializeContextSlots("Pins",r,t,n,i)},saveBackupPins:function(){var e=O.Utilities["BackupPins"+this.OptionSuffix];localStorage[e.key]=JSON.stringify(this.getPersonalCoords())},loadBackupPins:function(){var e=O.Utilities["BackupPins"+this.OptionSuffix];try{e.value=JSON.parse(localStorage[e.key])}catch(e){}this.redrawPersonalPath(e.value,null)},printPinHelp:function(){var e="<h2>Path Pins Interactions</h2><ul><li><b>Create a pin:</b> double click an empty area on the map (multiple pins creates a path).</li><li><b>Insert a pin between a path:</b> double click a part of the path.</li><li><b>Delete a pin:</b> double click that pin.</li><li><b>Delete all pins:</b> choose Clear from the Path context menu.</li><li><b>Move a pin:</b> hold click and drag that pin.</li><li><b>Move a pin to center:</b> right click that pin.</li><li><b>Zoom to a pin:</b> right click that pin when not in max zoom.</li></ul><br /><h2>Path Pins Features</h2><ul><li><b>Check off a pin:</b> single click that pin.</li><li><b>Get coordinates of a pin:</b> single click that pin.</li><li><b>Get coordinates of a path:</b> single click on the path.</li><li><b>Generate a path:</b> paste the path coordinates into the coordinates bar and press Enter.</li><li><b>Optimize a path:</b> middle click that pin, it will become the starting pin.</li><li><b>Save/Load pins:</b> the save slots can be named, which can be filtered by the search bar.</li></ul>";I.help(e)},printCompassHelp:function(){var e="<h2>Compass Pins Interactions</h2><ul><li><b>Create a pin:</b> select an icon from the context menu gallery.</li><li><b>Create a custom pin:</b> checkmark the checkbox by the custom input boxes then enter your own range, color, and comment.</li><li><b>Delete a pin:</b> double click that pin.</li><li><b>Delete all pins:</b> choose Clear from the Compass context menu.</li><li><b>Move a pin:</b> hold click and drag that pin.</li><li><b>Move a pin to center:</b> right click that pin.</li><li><b>Zoom to a pin:</b> right click that pin when not in max zoom.</li></ul><br /><h2>Compass Pins Features</h2><ul><li><b>Get coordinates of a pin:</b> single click that pin.</li><li><b>Draw a path connecting all compasses of a type:</b> middle click that pin.</li><li><b>Export pins for sharing:</b> use the compass export function and copy and output text.</li><li><b>Import pins from text:</b> use the compass import function, then paste the compass data text into the adjacent input box.</li><li><b>Import pins from file:</b> use the Choose File button and select a .json or .xml file.</li><li><b>Save/Load pins:</b> the save slots can be named, which can be filtered by the search bar.</li></ul>";I.help(e)},createPersonalPin:function(e,t){var a=this,n=this.numPins,i=this.convertLCtoGC(e),r=this.coordPreviousPin?this.convertDirectionAngle(this.coordPreviousPin,i):0;this.coordPreviousPin=i;var o=0===this.numPins?"img/map/pin_red.png":"img/map/pin_directed.png",s=L.marker(e,{icon:L.icon({iconUrl:o,iconSize:[32,32],iconAnchor:[16,16]}),draggable:!0,opacity:.9,rotationAngle:r});this.toggleLayer(s,!0),this.Layer.PersonalPin.addLayer(s),this.numPins++,t&&this.drawPersonalPath(),this.bindMarkerCoordBehavior(s,"click"),s.on("mousedown",function(e){switch(e.originalEvent.which){case I.ClickEnum.Left:void 0===this.options.isMarked||!1===this.options.isMarked?(this.options.isMarked=!0,this.setOpacity(.3)):(this.options.isMarked=!1,this.setOpacity(1));break;case I.ClickEnum.Middle:a.optimizePersonalPath(n)}}),s.on("dblclick",function(){a.removePersonalPin(this)}),s.on("contextmenu",function(e){a.Map.getZoom()===a.ZoomEnum.Max?(a.GPSPreviousCoord.length>0?a.movePin(this,a.GPSPreviousCoord):a.movePin(this,a.Map.getCenter()),a.drawPersonalPath()):a.Map.setView(e.latlng,a.ZoomEnum.Max)}),s.on("dragend",function(){a.drawPersonalPath()})},removePersonalPin:function(e){this.toggleLayer(e,!1),this.Layer.PersonalPin.removeLayer(e),this.drawPersonalPath(),this.numPins--},insertPersonalPin:function(e,t){var a=[],n=0;this.Layer.PersonalPin.eachLayer(function(i){a.push(i.getLatLng()),n===e&&a.push(t),n++}),this.clearPersonalPins();for(n in a)this.createPersonalPin(a[n]);this.drawPersonalPath()},clearPersonalPins:function(){var e=this;this.Layer.PersonalPin.eachLayer(function(t){e.toggleLayer(t,!1)}),this.Layer.PersonalPin.clearLayers(),this.drawPersonalPath(),this.numPins=0,this.coordPreviousPin=null},drawPersonalPath:function(){var e,t=this,a=[],n=[],i=0;this.Layer.PersonalPin.eachLayer(function(e){a.push(e.getLatLng()),n.push(P.getLayerId(e)),i++});var r=P.getUserPathColor(),o=P.getUserPathOpacity();if(i>1){this.Layer.PersonalPath.clearLayers();for(var s=0;s<i-1;s++)(e=L.polyline([a[s],a[s+1]],{color:r,opacity:o,precede:s})).on("click",function(){t.outputCoordinatesCopy(t.getPersonalString()),t.outputPinsDistance()}),e.on("dblclick",function(e){t.saveBackupPins(),t.insertPersonalPin(this.options.precede,e.latlng)}),this.Layer.PersonalPath.addLayer(e);this.toggleLayer(this.Layer.PersonalPath,!0),t.outputPinsDistance()}else this.toggleLayer(this.Layer.PersonalPath,!1),this.Layer.PersonalPath.clearLayers()},parsePersonalPath:function(e){var t=this.parseCoordinatesMulti(e);return null!==t&&(this.redrawPersonalPath(t),!0)},redrawPersonalPath:function(e,t){var a=void 0!==e?e:this.getPersonalCoords();if(void 0!==a&&null!==a&&a.length>0){this.clearPersonalPins();for(var n in a)this.createPersonalPin(this.convertGCtoLC(a[n]));this.drawPersonalPath(),null!==t&&(void 0===t?this.goToArguments(a[0]):this.goToArguments(t))}else I.write(D.getPhraseOriginal("Path not available for this")+".")},outputPinsDistance:function(){for(var e=0,t=this.Layer.PersonalPin.getLayers(),a=t.length-1,n=0;n<a;n++)e+=P.getDistanceBetweenCoords(this.convertLCtoGC(t[n].getLatLng()),this.convertLCtoGC(t[n+1].getLatLng()));var i=~~(e*T.cPOINTS_TO_UNITS),r=T.formatTimeLetter(Math.ceil(i/T.cUNITS_PER_SECOND),!0);this.outputCoordinatesName(i+" "+D.getWord("range")+" ("+r+")")},isPersonalPinsLaid:function(e){return 0!==this.numPins||(e&&I.write("No path pins to work with. Double click on the map to lay pins."),!1)},optimizePersonalPath:function(e){this.redrawPersonalPath(P.getGreedyPath(this.getPersonalCoords(),e))},drawRandom:function(e){var t=parseInt(e);if(!(0===t||t>1e3||this.numPins>1e3||void 0===t)){for(var a,n,i=0;i<t;i++)a=T.getRandomIntRange(0,this.Continent.Dimensions[0]),n=T.getRandomIntRange(0,this.Continent.Dimensions[1]),this.createPersonalPin(this.convertGCtoLC([a,n]));this.drawPersonalPath()}},getPersonalCoords:function(){var e=this,t=[];return this.Layer.PersonalPin.eachLayer(function(a){t.push(e.convertLCtoGC(a.getLatLng()))}),t},getPersonalString:function(){return JSON.stringify(this.getPersonalCoords())},getClosestLocation:function(e,t){var a,n=this,i=Number.POSITIVE_INFINITY,r=null;return t.eachLayer(function(t){(a=P.getDistanceBetweenCoords(e,n.convertLCtoGC(t.getLatLng())))<i&&(i=a,r=t)}),r},initializePinsPlacer:function(e){var t=e,a="#"+t.MapEnum;$(a+"ContextClearPins").click(function(){t.clearPersonalPins()}),t.initializePinStorage(t),$(a+"ContextOptimizePins").click(function(){t.isPersonalPinsLaid(!0)&&t.optimizePersonalPath()}),$(a+"ContextChatlinkPins").click(function(){t.isPersonalPinsLaid(!0)&&P.printClosestWaypoints()});var n=$(a+"ContextURLPins");n.length&&(I.bindClipboard(n),n.mouseenter(function(){if(t.isPersonalPinsLaid()){var e=P.MapSwitchWebsite===P.MapEnum.Mists?"wvw/":"";I.updateClipboard($(this),I.cSiteURL+e+t.getPersonalString())}}));var i=$(a+"ContextURLCoord");i.length&&(I.bindClipboard(i),i.mouseenter(function(){if(t.ContextLatLng){var e=P.MapSwitchWebsite===P.MapEnum.Mists?"wvw/":"";I.updateClipboard($(this),I.cSiteURL+e+t.convertLCtoGC(t.ContextLatLng))}})),$(a+"ContextZoneInfo").click(function(){if(t.ZoneCurrent)for(var e in t.ZoneCurrent){var a=t.ZoneCurrent[e];I.print(e+": "+(Array.isArray(a)?JSON.stringify(a):a))}else I.write("Invalid zone.")}),$(a+"ContextHelpPins").click(function(){t.printPinHelp()}),$(a+"ContextUndoPins").click(function(){t.loadBackupPins()})},initializeCompassPlacer:function(e){var t=e,a="#"+t.MapEnum,n=8,i=4,r=1e6,o=32,s=256,c=65536,l=$(a+"ContextCompass"),u=$(a+"ContextCompassList");I.preventMapPropagation(u);var d=0,p=0,h=null,m=null,g=$(a+"ContextAddCompass");g.click(function(){m?(t.saveBackupCompasses(),t.createCompass(m,t.ContextLatLng)):I.write("Please select a compass pin first.")});var f=$("<input type='checkbox' />"),C=$("<label title='"+D.getPhraseOriginal("Enable custom range and comment")+".'></label>").append(f),v=$("<input type='number' value='1200' min='0' max='"+r+"' step='100' style='width:48px' title='"+D.getWordCapital("range")+"' />"),b=$("<input type='text' value='#ffffff' maxlength='"+o+"' style='width:48px' class='cssInputText' title='"+D.getWordCapital("color")+"' />"),S=$("<input type='text' value='"+D.getWordCapital("comment")+"...' maxlength='"+s+"' style='width:"+(I.ModeCurrent===I.ModeEnum.Overlay?64:128)+"px; margin-left:4px;' class='cssInputText' title='"+D.getWordCapital("comment")+"' />");if(t.MapEnum===P.MapEnum.Tyria){var T=GW2T_RESOURCE_DATA;for(var y in T){var k=y.toLowerCase();t.Compasses["node_"+k]={nodetype:T[y].type,icon:"img/node/"+k+I.cPNG}}}for(var y in t.Compasses){var E=t.Compasses[y];if(E.id=y,!1!==E.isPlaceable){d++,E.icon=E.icon||"img/compass/"+E.id+I.cPNG;var _=$("<img src='"+E.icon+"' />"),A=void 0!==E.tooltip?E.tooltip:E.range?D.getWordCapital("range")+" "+E.range:"";if(A.length&&_.attr("title",A),E.nodetype){h!==E.nodetype&&(h=E.nodetype,p=0),p++;var L=$("#mapContextNodeList_"+E.nodetype);L.append(_),p%i==0&&L.append("<br />")}else u.append(_),d%n==0&&u.append("<br />");!function(e){_.click(function(){var a=f.is(":checked")?$.extend({},e,{range:parseInt(v.val()),color:U.stripToColorString(b.val()),comment:U.escapeHTML(S.val())}):e;m=a,t.saveBackupCompasses(),t.createCompass(a,t.ContextLatLng)})}(E)}}$("<span id='"+t.MapEnum+"CompassCustom' style='display:block;' class='mapCompassCustom'></span>").prependTo(u).append([C,v,b,S]).find("input").onEnterKey(function(){g.trigger("click")}),$(a+"ContextClearCompasses").click(function(){t.clearCompasses()});var M=$(a+"ContextImportCompasses");M.click(function(){var e=$(a+"CompassImportText").val();t.parseCompasses(e)});var w=$("<input type='file' style='width:128px' />").insertBefore(M);Z.bindFileInput(w,function(e,a){t.parseCompasses(e,a)}),$("<input id='"+t.MapEnum+"CompassImportText' type='text' value='' maxlength='"+c+"' style='width:96px; margin-left:4px;' class='cssInputText' title='<dfn>Export</dfn> to get the textual copy of laid compasses.<br />Paste that text in this box and <dfn>Import</dfn> to reconstruct the compasses.' />").onEnterKey(function(){M.trigger("click")}).appendTo(M),$(a+"ContextExportCompasses").click(function(){if(t.isCompassesLaid()){var e=JSON.stringify(t.serializeCompasses());I.print("Saveable File:"),Z.createFile(e,"gw2t_compasses.json"),I.print("<br />Copyable Text:"),I.paste(e)}}),$("#wvwContextDrawCompasses").click(function(){W.redrawDefaultCompasses()}),$(a+"ContextHelpCompasses").click(function(){t.printCompassHelp()}),$(a+"ContextUndoCompasses").click(function(){t.loadBackupCompasses()}),l.find("input").click(function(e){e.stopPropagation(),$(this).select()}).trigger("mouseenter"),C.click(function(e){e.stopPropagation()}),I.qTip.init(l.find("label, input, img")),X.rewrapCheckboxes(),t.initializeCompassStorage()},initializeCompassStorage:function(){var e=this,t=function(t){var a=O.Utilities["StoredCompasses"+e.OptionSuffix];a.value=new Array(t),a.value=O.loadCompressedObject(a.key)||new Array(t)},a=function(t){var a=O.Utilities["StoredCompasses"+e.OptionSuffix],n=e.serializeCompasses();n.length>0?(a.value[t]=n,O.saveCompressedObject(a.key,a.value),I.write(n.length+" compasses saved.")):e.isCompassesLaid()},n=function(t){var a=O.Utilities["StoredCompasses"+e.OptionSuffix];e.redrawCompasses(a.value[t])},i=e.numCompassesSlots;t(i),e.initializeContextSlots("Compasses",i,e,a,n)},saveBackupCompasses:function(){var e=O.Utilities["BackupCompasses"+this.OptionSuffix];localStorage[e.key]=JSON.stringify(this.serializeCompasses())},loadBackupCompasses:function(){var e=O.Utilities["BackupCompasses"+this.OptionSuffix];try{e.value=JSON.parse(localStorage[e.key])}catch(e){}this.redrawCompasses(e.value)},serializeCompasses:function(){var e=this,t=[];return e.Layer.CompassCircle.eachLayer(function(a){var n=a.options,i={id:n.compassid,coord:e.convertLCtoGC(a.getLatLng())};n.color&&(i.color=n.color.toLowerCase()),n.compassrange&&(i.range=parseInt(n.compassrange)),n.compasscomment&&(i.comment=n.compasscomment),t.push(i)}),U.sortObjects(t,{aKeyName:"id"}),t},pathCompasses:function(e){var t=this,a=e.options.compassid,n=[];t.Layer.CompassCircle.eachLayer(function(e){e.options.compassid===a&&n.push(t.convertLCtoGC(e.getLatLng()))}),t.redrawPersonalPath(n)},redrawCompasses:function(e,t){if(void 0!==e&&null!==e&&e.length>0){this.clearCompasses();var a=0,n=[];for(var i in e){var r=e[i],o=void 0!==t?[r.coord[0]+t[0],r.coord[1]+t[1]]:r.coord,s=null;this.Compasses[r.id]?s=$.extend({},this.Compasses[r.id],r):r.coord&&o&&(s={id:"custom",icon:"img/compass/custom.png",range:r.range,color:r.color,comment:r.comment}),null!==s?(a++,n.push(o),this.createCompass(s,this.convertGCtoLC(o))):I.write("Failed parsing a compass: "+r.id)}a>0&&(this.goToView(U.getRandomElement(n)),I.write(a+" compasses reconstructed."))}else I.write(D.getPhraseOriginal("Compass not available for this."))},parseCompasses:function(e,t){var a=this,n=function(){var t,n,i,r,o,s={},c=0,l=["squad_arrow","squad_circle","squad_heart","squad_rectangle","squad_spiral","squad_star","squad_triangle","squad_x"],u=$($.parseXML(e)),d={},p=[],h=[];u.find("POI").each(function(){t=$(this),n=t.attr("type"),void 0===s[n]&&(s[n]={id:l[c]},c=c<l.length-1?c+1:0),i=t.attr("MapID"),(r=a.getZoneFromID(i))?(o=a.convertGPSCoord([t.attr("xpos"),t.attr("ypos"),t.attr("zpos")],r),p.push(o),h.push({id:s[n].id,coord:o})):void 0===d[i]&&(d[i]=!0,I.print("Unrecognized zone ID: "+i))}),a.redrawCompasses(h),a.redrawPersonalPath(p);for(var m="",g=u.find("MarkerCategory").first();g.length;)m+=(g.attr("DisplayName")||g.attr("name"))+" ",g=g.find("MarkerCategory").first();I.print(m.length?"&quot;"+U.escapeHTML(m.trim())+"&quot;":"Untitled Markers")},i=function(e){var n,i,r=10,o=[],s=[],c=e.Nodes,l=e.DetachedNodes,u=t.name.split(".")[0],d=a.getZoneFromID(u);d?(c.forEach(function(e){o.push(a.convertGPSCoord([e.X,e.Y,e.Z],d)),(i=e.Comment)&&l.push(e)}),l.forEach(function(e){(n=a.convertGPSCoord([e.X,e.Y,e.Z],d))[1]=n[1]+r,s.push({id:"comment",coord:n,comment:e.Comment})}),a.redrawCompasses(s),a.redrawPersonalPath(o)):I.print("Unrecognized zone ID: "+u)};if(-1!==e.indexOf("<OverlayData>"))try{n(e)}catch(e){I.write("Invalid marker file for importing Compasses.")}else{var r=JSON.parse(e);Array.isArray(r)?this.redrawCompasses(r):r.Nodes&&t&&i(r)}},redrawDefaultCompasses:function(){var e=W.Metadata.PlacementAssociation[W.ZoneCurrent.nick],t=W.Placement[e],a=W.Metadata.Offsets[W.ZoneCurrent.nick];if(void 0!==a&&t){var n=t.Company;W.redrawCompasses(n,a)}},isCompassesLaid:function(){return 0!==this.Layer.CompassIcon.getLayers().length||(I.write("No compass pins to work with. Lay compasses from the map's &quot;Compass&quot; context menu."),!1)},createCompass:function(e,t){var a=this,n=e.range*T.cUNITS_TO_POINTS,i=this.getZoomedDistance(n),r=L.circleMarker(t,{clickable:!1,compassid:e.id,compassrange:e.range,compasscomment:e.comment,trueradius:n,radius:i,color:e.color,weight:2,opacity:e.opacity||.8,fillOpacity:e.fillOpacity||.1});this.Layer.CompassCircle.addLayer(r),this.toggleLayer(r);var o=e.range?24:32,s=e.range?24:32,c=L.marker(t,{circle:r,icon:L.icon({className:"mapCompass",iconUrl:e.icon,iconSize:[o,s],iconAnchor:[o/2,s/2]}),title:e.comment,draggable:!0,opacity:.9});a.bindMarkerCoordBehavior(c,"click"),c.on("drag",function(){this.options.circle.setLatLng(this.getLatLng())}),c.on("dblclick",function(){a.removeCompass(this),I.qTip.hide()}),c.on("contextmenu",function(){a.Map.getZoom()!==a.ZoomEnum.Ground?a.Map.setView(this.getLatLng(),a.ZoomEnum.Ground):(a.GPSPreviousCoord.length>0?a.movePin(this,a.GPSPreviousCoord):a.movePin(this,a.Map.getCenter()),this.options.circle.setLatLng(this.getLatLng()))}),c.on("mousedown",function(e){e.originalEvent.which===I.ClickEnum.Middle&&a.pathCompasses(this.options.circle)}),this.Layer.CompassIcon.addLayer(c),this.toggleLayer(c),e.comment&&I.qTip.init(".mapCompass")},removeCompass:function(e){this.toggleLayer(e.options.circle,!1),this.Layer.CompassCircle.removeLayer(e.options.circle),this.toggleLayer(e,!1),this.Layer.CompassIcon.removeLayer(e)},clearCompasses:function(){var e=this;this.Layer.CompassIcon.eachLayer(function(t){e.removeCompass(t)}),this.Layer.CompassCircle.clearLayers(),this.Layer.CompassIcon.clearLayers()},resizeMarkerIcon:function(e,t){void 0===t&&(t=this.cICON_SIZE_STANDARD),e.setIcon(new L.icon({iconUrl:e.options.icon.options.iconUrl,iconSize:[t,t],iconAnchor:[t/2,t/2]}))},toggleLayer:function(e,t){e&&(void 0===t&&(t=!this.Map.hasLayer(e)),t?e.addTo(this.Map):this.Map.removeLayer(e))},toggleLayerArray:function(e,t){for(var a in e)this.toggleLayer(e[a],t)},toggleSubmap:function(e,t){var a=this.Submaps[e];void 0===a.ImageOverlay?(a.ImageOverlay=this.createSubmap(a),this.toggleSubmap(e,t)):(void 0===t&&(t=!this.Map.hasLayer(a.ImageOverlay)),t?a.ImageOverlay.addTo(this.Map).bringToBack():this.Map.removeLayer(a.ImageOverlay))},toggleSubmapArray:function(e,t){for(var a in e)this.toggleSubmap(e[a],t)},createSubmap:function(e,t){var a=L.imageOverlay(e.img,this.convertGCtoLCMulti(e.bounds));return t&&a.addTo(this.Map).bringToBack(),a},movePin:function(e,t){void 0===t?this.toggleLayer(e,!1):(this.toggleLayer(e,!0),Array.isArray(t)?e.setLatLng(this.convertGCtoLC(t)):e.setLatLng(t),e._icon.style.zIndex=this.cZIndexRaise)},goToView:function(e,t,a){void 0!==a&&this.movePin(a,e),void 0===t?t=this.ZoomEnum.Ground:t===this.ZoomEnum.Same?t=this.Map.getZoom():t===this.ZoomEnum.Adaptive?t=this.getAdaptiveZoom():"object"==typeof t&&void 0!==t.offset&&(t=this.getAdaptiveZoom(t.offset)),this.Map.setView(this.convertGCtoLC(e),t),this.showCurrentZone(e)},refreshView:function(e){var t=e?this.convertGCtoLC(e):this.Map.getCenter();this.Map.setView(M.Continent.CenterInitial,this.Map.getZoom()),this.Map.setView(t,this.Map.getZoom())},goToZone:function(e,t){var a=this.getZoneCenter(e);this.showCurrentZone(a),this.goToView(a,t)},getAdaptiveZoom:function(e){void 0===e&&(e=0);var t=$(window).width();return(t>=I.ScreenWidth.Huge?this.ZoomEnum.Default+1:t>=I.ScreenWidth.Large?this.ZoomEnum.Default:t>=I.ScreenWidth.Medium?this.ZoomEnum.Default-1:this.ZoomEnum.Default-2)+e},goToDefault:function(e){void 0===e&&(e=this.getAdaptiveZoom()),this.Map.setView(this.convertGCtoLC(this.Continent.Center),e)},goToArguments:function(e,t,a){var n,i,r=[];if(e)if(2===(r=this.parseCoordinates(e)).length)isFinite(r[0])&&isFinite(r[1])&&this.goToView(r,t,a);else if(r.length>=3){if(isFinite(r[0])&&isFinite(r[1])&&isFinite(r[2])){var o=this.invertZoomLevel(r[2]);this.goToView([r[0],r[1]],o,a)}}else if("default"===(i=e.toLowerCase()))this.goToDefault();else for(n in this.Zones)if(-1!==i.indexOf(n)){this.goToView(this.getZoneCenter(n),this.ZoomEnum.Sky);break}},executeURLCommands:function(){var e,t=U.Args[U.KeyEnum.Go],a=U.Args[U.KeyEnum.Draw],n=function(){void 0===U.Args[U.KeyEnum.Page]&&$("#plateMenu_Map").trigger("click")};try{e=JSON.parse(t)}catch(e){}if(e&&Array.isArray(e)&&e.length&&Array.isArray(e[0])?(this.parsePersonalPath(t),U.Args[U.KeyEnum.Go]=null,n()):t&&(this.goToArguments(t,this.ZoomEnum.Ground,this.Pin.Program),U.Args[U.KeyEnum.Go]=null,n()),a){var i=this.getZoneFromString(a);i?P.drawCompletionRoute(i):this.parsePersonalPath(a),U.Args[U.KeyEnum.Draw]=null,n()}I.ModeCurrent===I.ModeEnum.Overlay&&!1===I.isProgramEmbedded&&P.tickGPS()},convertGCtoLC:function(e){return this.Map.unproject(e,this.Map.getMaxZoom())},convertGCtoLCMulti:function(e,t){var a,n=[];for(a=t=t||0;a<e.length;a++)n.push(this.convertGCtoLC(e[a]));return n},convertGCtoLCDual:function(e){return[this.convertGCtoLC(e[0]),this.convertGCtoLC(e[1])]},convertLCtoGC:function(e){var t=this.Map.project(e,this.ZoomEnum.Max);return[Math.round(t.x),Math.round(t.y)]},convertLCtoGCMulti:function(e){for(var t=[],a=0;a<e.length;a++)t.push(this.convertLCtoGC(e[a]));return t},convertEventCoord:function(e,t){var a=t.continent_rect_actual||t.continent_rect,n=t.map_rect;return[~~(a[0][0]+(a[1][0]-a[0][0])*(e[0]-n[0][0])/(n[1][0]-n[0][0])),~~(a[0][1]+(a[1][1]-a[0][1])*(1-(e[1]-n[0][1])/(n[1][1]-n[0][1])))]},convertEventCoordMulti:function(e,t){for(var a=[],n=0;n<e.length;n++)a.push(this.convertEventCoord(e[n],t));return a},convertGPSCoord:function(e,t){var a=new Array(3);return a[0]=e[0]*T.cMETERS_TO_UNITS,a[1]=e[2]*T.cMETERS_TO_UNITS,a[2]=e[1]*T.cMETERS_TO_UNITS,this.convertEventCoord(a,t)},convertGPSAngle:function(e){return Math.atan2(e[2],e[0])*T.cRADIAN_TO_DEGREE},convertDirectionAngle:function(e,t){return Math.atan2(t[1]-e[1],t[0]-e[0])*T.cRADIAN_TO_DEGREE},parseCoordinates:function(e){return e.toString().replace(/[^\d,-.]/g,"").split(",")},parseCoordinatesMulti:function(e){var t,a=13,n=e.replace(/\s/g,""),i=[],r=[];if(n.length>=a&&"["===n.charAt(0)&&"["===n.charAt(1)&&"]"===n.charAt(n.length-1)&&"]"===n.charAt(n.length-2)){i=(n=n.substring(2,n.length-2)).split("],[");for(var o in i)2===(t=i[o].split(",")).length&&(t[0]=Math.round(t[0]),t[1]=Math.round(t[1]),r.push(t));return r}return null},convertLatLngs:function(e){if(Array.isArray(e)){var t=this.convertLCtoGCMulti(e);P.printCoordinates(t)}},getElementCoordinates:function(e){var t=e.attr("data-coord");return this.Zones[t]?this.getZoneCenter(t):this.parseCoordinates(t)},bindMapLinks:function(e,t){if(!1!==I.isMapEnabled){var a=this;$(e+" dfn").each(function(){$(this).text("["+$(this).text()+"]"),a.bindMapLinkBehavior($(this),t,a.Pin.Program)})}},bindMapLinkBehavior:function(e,t,a){if(!1!==I.isMapEnabled&&void 0!==e&&null!==e){var n=this;e.click(function(){var e=$(this).attr("data-coord");Z.interpretCommand(e,n,t,a),C.isTouringManual=!1}),e.dblclick(function(){var e=n.getElementCoordinates($(this));e.length>1&&(n.Map.getZoom()===n.ZoomEnum.Max?n.goToView(e,n.ZoomEnum.Default,a):n.Map.zoomIn())}),e.contextmenu(function(e){e.preventDefault();var t=n.convertGCtoLC(n.getElementCoordinates($(this)));if(n.Map.getZoom()===n.ZoomEnum.Max){var a=n.Map.getCenter();~~a.lat==~~t.lat&&~~a.lng==~~t.lng?n.Map.setZoom(n.ZoomEnum.Default):n.Map.setView(t,n.Map.getZoom())}else n.Map.setView(t,n.ZoomEnum.Max)}),e.mouseover(function(){var e=n.getElementCoordinates($(this));e.length>1&&n.movePin(n.Pin.Over,e)}),e.mouseout(function(){n.movePin(n.Pin.Over)})}},bindOverviewBehavior:function(e,t){var a=this;e.on(t,function(t){a.goToZone(e.options.mappingzone,a.ZoomEnum.Sky)})},bindMarkerZoomBehavior:function(e,t,a){if(!I.isTouchEnabled){var n=this;void 0===a&&(a=n.ZoomEnum.Default),e.on(t,function(e){if(n.Map.getZoom()===n.ZoomEnum.Max){var t=n.Map.getCenter();~~t.lat==~~e.latlng.lat&&~~t.lng==~~e.latlng.lng?n.Map.setZoom(a):n.Map.setView(e.latlng,n.Map.getZoom())}else n.Map.setView(e.latlng,n.ZoomEnum.Max)})}},bindMarkerCoordBehavior:function(e,t){if(!I.isTouchEnabled){var a=this;e.on(t,function(){var e=a.convertLCtoGC(this.getLatLng());a.outputCoordinatesCopy(P.formatCoord(e))})}},bindMarkerWikiBehavior:function(e,t,a){I.isTouchEnabled||e.on(t,function(e){U.openExternalURL(C.getEventWiki(this.options.wiki,a))})},bindZoneList:function(e){var t=e,a="#"+t.MapEnum;$(a+"ZoneList li").each(function(){var e=$(this).attr("data-zone");$(this).text(t.getZoneName(e)),$(this).attr("data-coord",t.getZoneCenter(e).toString()),t.bindMapLinkBehavior($(this),{offset:1})}),$(a+"ZoneList h2").each(function(){var e=$(this).attr("data-region");$(this).text(D.getObjectName(t.Regions[e]))})}},P={MapSwitchObject:M,MapSwitchSuffix:"",MapSwitchWebsite:"map",MapSwitchGPS:null,MapEnum:{Tyria:"map",Mists:"wvw"},TempSubmap:{submap:{},img:"http://i.imgur.com/cTSJUvZ.jpg",bounds:[[20736,6656],[23808,8192]]},Layer:{ZoneBorder:new L.layerGroup,ZoneGateway:new L.layerGroup,ZonePowerup:new L.layerGroup,ZoneLaunchpad:new L.layerGroup,DryTopNicks:new L.layerGroup,Chest:new L.layerGroup},NodeArray:{JP:[]},LayerArray:{ChainPath:[],Resource:[],JP:[],Guild_Bounty:[],Guild_Trek:[],Guild_Challenge:[],Guild_Rush:[],Guild_Puzzle:[],DryTopIcons:[],DryTopRings:[],DryTopActive:[]},LocationsDatabase:[],Events:{},DryTopTimer:{},Resources:{},JPs:{},Chests:{},Collectibles:{},Guild:{},GPSTimeout:{},isGPSPrinting:!1,initializeMap:function(){I.isMapEnabled&&M.initializeMap()},rebindMarkerTooltips:function(){I.qTip.init(".leaflet-marker-icon")},addMapLocation:function(e,t,a,n){var i={name:t,icon:a,coord:e,keywords:(t+" "+n).toLowerCase()};P.LocationsDatabase.push(i)},populateMap:function(e){if(!1!==I.isMapEnabled){var t,a=e,n=O.Options["bol_showWorldCompletion"+a.OptionSuffix];switch(a.MapEnum){case P.MapEnum.Tyria:t=U.getLangURL(U.URL_API.MapFloorTyria);break;case P.MapEnum.Mists:if(t=U.getLangURL(U.URL_API.MapFloorMists),!1===n)return}var i=function(e){switch(e&&(a.isAPIRetrieved_MAPFLOOR=!0),a.MapEnum===P.MapEnum.Tyria&&!1===O.Options.bol_displayEvents&&P.donePopulation(),a.MapEnum){case P.MapEnum.Tyria:!0===O.Options.bol_displayEvents?P.populateEvents():P.finishPopulation();break;case P.MapEnum.Mists:W.finishPopulation()}},r=function(e){var t,i,r,o,s,c,l,u,d,p,h,m,g,f=D.getTranslation("Sector"),C=D.getTranslation("Point of Interest"),v=D.getTranslation("Vista"),b=D.getTranslation("Mastery Insight"),S=D.getTranslation("Hero Challenge"),T=D.getTranslation("Heart");for(r in e.regions){o=e.regions[r];for(s in o.maps)if((u=a.getZoneFromID(s))&&!u.ispopulated){u.ispopulated=!0,c=o.maps[s];var y,k=D.getObjectName(u),E=0,_=0,A=0,w=0,O=0,x=0;for(i=c.points_of_interest.length,t=0;t<i;t++){switch((l=c.points_of_interest[t]).type){case a.APIPOIEnum.Waypoint:_++,p=U.URL_IMG.Waypoint,m="mapWp",g=l.name,P.addMapLocation(l.coord,l.name,p,k);break;case a.APIPOIEnum.Landmark:if(!1===n)continue;A++,p=U.URL_IMG.Landmark,m="mapPoi",g=l.name,P.addMapLocation(l.coord,l.name,p,k+" "+C);break;case a.APIPOIEnum.Vista:if(!1===n)continue;w++,p=U.URL_IMG.Vista,m="mapPoi",g=y=l.name?l.name+" "+v:v,P.addMapLocation(l.coord,k+" "+y+" "+l.poi_id,p,k+" "+v);break;default:continue}switch(d=L.marker(a.convertGCtoLC(l.coord),{title:"<span class='"+m+"'>"+g+"</span>",markername:l.name,icon:L.icon({iconUrl:p,iconSize:[16,16],iconAnchor:[8,8]}),id:l.poi_id}),l.type){case a.APIPOIEnum.Waypoint:d.on("mouseout",function(){try{this._icon.src=U.URL_IMG.Waypoint}catch(e){}}),d.on("mouseover",function(){this._icon.src=U.URL_IMG.WaypointOver}),u.Layers.Waypoint.addLayer(d);break;case a.APIPOIEnum.Landmark:d.on("mouseout",function(){try{this._icon.src=U.URL_IMG.Landmark}catch(e){}}),d.on("mouseover",function(){this._icon.src=U.URL_IMG.LandmarkOver}),u.Layers.Landmark.addLayer(d);break;case a.APIPOIEnum.Vista:u.Layers.Vista.addLayer(d)}!1===I.isTouchEnabled&&(l.type===a.APIPOIEnum.Waypoint||l.type===a.APIPOIEnum.Landmark?(d.on("click",function(){a.outputCoordinatesCopy(U.getChatlinkFromPoiID(this.options.id)),a.outputCoordinatesName(this.options.markername)}),d.on("dblclick",function(){D.isLanguageDefault?U.openExternalURL(U.getWikiLinkLanguage(this.options.markername)):U.openExternalURL(U.getWikiLinkCode(this.options.id,this.options.markername))}),a.bindMarkerZoomBehavior(d,"contextmenu",a.ZoomEnum.Sky)):(a.bindMarkerZoomBehavior(d,"click",a.ZoomEnum.Sky),a.bindMarkerZoomBehavior(d,"contextmenu",a.ZoomEnum.Sky)))}if(n){if(c.training_points)for(O=i=c.training_points.length,p=U.URL_IMG.Mastery,t=0;t<i;t++)l=c.training_points[t],d=L.marker(a.convertGCtoLC(l.coord),{title:"<span class='mapPoi'>"+b+"</span>",icon:L.icon({iconUrl:p,iconSize:[16,16],iconAnchor:[8,8]})}),a.bindMarkerZoomBehavior(d,"click",a.ZoomEnum.Sky),a.bindMarkerZoomBehavior(d,"contextmenu",a.ZoomEnum.Sky),u.Layers.Mastery.addLayer(d),P.addMapLocation(l.coord,k+" "+b+" "+l.id,p,k+" "+b);if(c.skill_challenges)for(x=i=c.skill_challenges.length,p=U.URL_IMG.Challenge,t=0;t<i;t++)l=c.skill_challenges[t],d=L.marker(a.convertGCtoLC(l.coord),{title:"<span class='mapPoi'>"+S+"</span>",icon:L.icon({iconUrl:p,iconSize:[16,16],iconAnchor:[8,8]})}),a.bindMarkerZoomBehavior(d,"click",a.ZoomEnum.Sky),a.bindMarkerZoomBehavior(d,"contextmenu",a.ZoomEnum.Sky),u.Layers.Challenge.addLayer(d),P.addMapLocation(l.coord,k+" "+S+" "+l.idx,p,k+" "+S);if(c.tasks)for(E=i=c.tasks.length,p=U.URL_IMG.Heart,t=0;t<i;t++)l=c.tasks[t],d=L.marker(a.convertGCtoLC(l.coord),{title:"<span class='mapPoi'>"+l.objective+" ("+l.level+")</span>",wiki:l.objective,icon:L.icon({iconUrl:p,iconSize:[16,16],iconAnchor:[8,8]})}),M.bindMarkerWikiBehavior(d,"click"),M.bindMarkerZoomBehavior(d,"contextmenu",a.ZoomEnum.Sky),u.Layers.Heart.addLayer(d),P.addMapLocation(l.coord,l.objective,p,k+" "+T),h=L.polygon(a.convertGCtoLCMulti(l.bounds),{clickable:!1,color:"#ffc321",weight:2,opacity:.8,fillOpacity:.1}),u.Layers.HeartArea.addLayer(h),function(e){d.on("mouseover",function(){e.setStyle({color:"lime"})}).on("mouseout",function(){e.setStyle({color:"#ffc321"})})}(h);if(c.sectors)for(i=c.sectors.length,p=U.URL_IMG.Sector,t=0;t<i;t++)l=c.sectors[t],d=L.marker(a.convertGCtoLC(l.coord),{clickable:!1,icon:L.divIcon({className:"mapSec",html:"<span class='mapSecIn'>"+l.name+"</span>",iconSize:[512,64],iconAnchor:[256,32]})}),u.Layers.Sector.addLayer(d),P.addMapLocation(l.coord,l.name,p,k+" "+f),h=L.polyline(a.convertGCtoLCMulti(l.bounds),{clickable:!1,color:"white",weight:2,opacity:.8}),u.Layers.SectorArea.addLayer(h);a.isMappingIconsGenerated=!0}n&&(d=L.marker(a.convertGCtoLC(u.center),{mappingzone:u.nick,riseOnHover:!0,icon:L.divIcon({className:"mapOverview",html:"<span class='mapOverviewIn'><var class='mapOverviewName'>"+D.getObjectName(u)+"</var>"+(c.min_level>0?"<var class='mapOverviewLevel'>"+(80===c.min_level?c.max_level:c.min_level+" - "+c.max_level)+"</var>":"")+(E>0?"<img src='img/map/heart.png' />"+E+" ":"")+(_>0?"<img src='img/map/waypoint.png' />"+_+" ":"")+(A>0?"<img src='img/map/landmark.png' />"+A+" ":"")+(x>0?"<img src='img/map/challenge.png' />"+x+" ":"")+(w>0?"<img src='img/map/vista.png' />"+w:"")+(O>0?"<img src='img/map/mastery.png' />"+O+" ":"")+"</span>",iconSize:[256,64],iconAnchor:[128,32]})}),a.bindOverviewBehavior(d,"click"),a.bindOverviewBehavior(d,"contextmenu"),a.Layer.Overview.addLayer(d),a.toggleLayer(a.Layer.Overview,!0))}}};$.getJSON(t,function(e){r(e),i(!0)}).fail(function(){I.isAPIEnabled=!1,a.MapEnum===P.MapEnum.Tyria?(I.ModeCurrent===I.ModeEnum.Website&&I.urge("ArenaNet API server is unreachable. <a"+U.convertExternalAnchor(U.URL_API.Support+"?source=map")+">Check status</a>.<br />Map will use backup cache and features will be limited.<br />"),$.getJSON(U.URL_DATA.Maps,function(e){r(e),i(!0)})):i(!1)})}},populateEvents:function(){var e=function(e){for(var t=["scarlet","molten all","overdue emi","aetherblade","queen's cha","mordrem inv","offshoot","vigil eng","haunted","stabilize the rift","guild","subdue","bounty","hero cha"],a=0;a<t.length;a++)if(-1!==e.indexOf(t[a]))return!0;return!1},t=function(e){return-1!==e.indexOf("free")?"release":-1!==e.indexOf("rescue")?"release":-1!==e.indexOf("capture")?"flag":-1!==e.indexOf("retake")?"flag":-1!==e.indexOf("reclaim")?"flag":-1!==e.indexOf("liberate")?"flag":-1!==e.indexOf("protect")?"shield":-1!==e.indexOf("defend")?"shield":-1!==e.indexOf("escort")?"shield":-1!==e.indexOf("kill")?"boss":-1!==e.indexOf("slay")?"boss":-1!==e.indexOf("defeat")?"boss":-1!==e.indexOf("collect")?"collect":-1!==e.indexOf("help")?"star":-1!==e.indexOf("destroy")?"cog":-1!==e.indexOf("gather")?"collect":-1!==e.indexOf("bring")?"collect":-1!==e.indexOf("recover")?"collect":-1!==e.indexOf("return")?"collect":-1!==e.indexOf("retrieve")?"collect":-1!==e.indexOf("salvage")?"collect":-1!==e.indexOf("treasure")?"fist":"swords"},a={release:"img/event/release.png",flag:"https://render.guildwars2.com/file/A4F01E7A5E90382F0ACFA71348E4241900529EB5/102321.png",shield:"https://render.guildwars2.com/file/4D52C9605D6F19D3B6FB00D39E95EC45C3FCB62C/102387.png",boss:"https://render.guildwars2.com/file/9C97043218F4EF1205B6FB5503CFCCA038D607E1/102392.png",collect:"https://render.guildwars2.com/file/7695C3055956ACCC4D7F273F59B2120B0CB123B0/102330.png",star:"https://render.guildwars2.com/file/F6B0F9F82D1D3A000D1827E3EA59A7D734141004/102388.png",cog:"https://render.guildwars2.com/file/92BC536037C0AA531E9019D7AB3A23C71805FB99/102393.png",fist:"https://render.guildwars2.com/file/9005555700262173FB6506A12204776AAEC6A40F/102391.png",swords:"https://render.guildwars2.com/file/98EB189CADF825549B187C57B551CE1AA29CA694/102320.png"},n=function(e){var t;for(t in e.events)P.Events[t]={},P.Events[t].name=e.events[t].name},i=function(i){$.getJSON(U.URL_API.EventDetails,function(r){var o,s,c,l,u,d,p,h,m,g,f,C,v,b,S,y=D.getPhraseOriginal("Drag to separate")+". "+D.getPhraseOriginal("Double click for wiki")+".";n(i||r);for(o in r.events)c=(s=r.events[o]).name.toLowerCase(),l=void 0!==P.Events[o]?P.Events[o].name:s.name,b=M.getZoneFromID(s.map_id),S=D.getObjectName(b),b&&!e(c)&&50!==s.map_id&&(m=M.getEventCenter(s),g=M.convertGCtoLC(m),s.location.points?(f=M.convertEventCoordMulti(s.location.points,b),p=L.polygon(M.convertGCtoLCMulti(f),{clickable:!1,color:"#ff8844",weight:2,opacity:.8,fillOpacity:.1}),b.Layers.EventArea.addLayer(p)):(v=(s.location.radius||1)*T.cUNITS_TO_POINTS,C=M.getZoomedDistance(v),p=L.circleMarker(g,{trueradius:v,radius:C,clickable:!1,color:"#ff8844",weight:2,opacity:.8,fillOpacity:.1}),b.Layers.EventCircle.addLayer(p)),d=L.marker(g,{clickable:!1,icon:L.divIcon({className:"mapSec",html:"<span class='mapSecIn'>"+l+"</span>",iconSize:[128,128],iconAnchor:[64,64]})}),b.Layers.EventLabel.addLayer(d),h=s.icon?U.getAPIImage(s.icon.signature+"/"+s.icon.file_id):a[t(c)],u=L.marker(g,{title:"<span class='mapPoi'><dfn>"+l+"</dfn> ("+s.level+")<br /><cite>"+y+"</cite></span>",wiki:s.name,coord:m,eventid:o,icon:L.icon({iconUrl:h,iconSize:[48,48],iconAnchor:[24,24]}),draggable:!0}),function(e,t){u.on("mouseover",function(){t.setStyle({color:"red"})}).on("mouseout",function(){t.setStyle({color:"#ff8844"})}).on("drag",function(){e.setLatLng(this.getLatLng())})}(d,p),M.bindMarkerCoordBehavior(u,"click",!0),M.bindMarkerWikiBehavior(u,"dblclick",!0),M.bindMarkerZoomBehavior(u,"contextmenu"),b.Layers.EventIcon.addLayer(u),P.addMapLocation(m,s.name,h,S+" "+s.name));M.isEventIconsGenerated=!0}).done(function(){P.donePopulation()}).always(function(){P.finishPopulation()})};D.isLanguageDefault?i():$.getJSON(U.getLangURL(U.URL_API.EventDetails),function(e){i(e)}).fail(function(){P.finishPopulation()})},donePopulation:function(){M.refreshCurrentZone()},finishPopulation:function(){M.isMapAJAXDone=!0,M.bindMapVisualChanges(),M.adjustZoomMapping(),P.adjustZoomDryTop(),P.initializeMapSearch(),"wvw"!==I.PageInitial&&M.executeURLCommands()},initializeMapSearch:function(){$("#mapZoneButton").one("mouseenter",function(){I.preventMapPropagation("#mapSearch"),Q.bindItemSearch("#mapSearch",{aDatabase:P.LocationsDatabase,aResultsClass:"mapSearchResults",aResultsLimit:200,aCallback:function(e){M.goToView(e.coord,M.ZoomEnum.Same,M.Pin.Program)}})})},wantTourPrediction:function(){return!(!I.isMapEnabled||!O.Options.bol_tourPrediction||I.ModeCurrent===I.ModeEnum.Overlay||I.PageCurrent!==I.PlateEnum.Chains&&I.PageCurrent!==I.PlateEnum.Directory||!1!==C.isDryTopIconsShown||U.Args[U.KeyEnum.Go])},createNodeArray:function(e){for(var t=new Array(e),a=0;a<e;a++)t[a]={oMarker:null,oPath:null};return t},toggleNode:function(e,t,a){e[t]&&(M.toggleLayer(e[t].oMarker,a),M.toggleLayer(e[t].oPath,a))},toggleNodeArray:function(e,t){for(var a=0;a<e.length;a++)M.toggleLayer(e[a].oMarker,t),M.toggleLayer(e[a].oPath,t)},getLayerId:function(e){return e._leaflet_id},getLayerGroup:function(e){return e._layers},sortCoordinates:function(e,t){var a;for(var n in e)(a=e[n])[0]=Math.round(a[0]),a[1]=Math.round(a[1]);if(e.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}),!t)return e;for(var n in e)this.printNumberedCoordinates(e[n],n)},roundCoordinates:function(e,t){var a;for(var n in e)(a=e[n])[0]=Math.round(a[0]),a[1]=Math.round(a[1]);this.printCoordinates(e,t)},printNeedles:function(e){for(var t in e)this.printNumberedCoordinates(e[t].c,t)},printNodes:function(e,t){for(var a=0;a<e.length;a++){var n=t?"n: "+(a+1)+", ":"";I.print("{"+n+"c: ["+e[a][0]+", "+e[a][1]+"]},")}},printNumberedCoordinates:function(e,t){I.print("{n: "+(parseInt(t)+1)+", c: ["+e[0]+", "+e[1]+"]},")},formatCoord:function(e){return"["+e[0]+", "+e[1]+"]"},compileCoordinates:function(e,t){for(var a,n="",i=t?" ":"",r=0;r<e.length;r++)a=r<e.length-1?t&&(r+1)%2==0?"]],<br />":t&&r%2==0?"], ":"],":"]",n+=null===e[r]?"null,":"["+(t&&r%2==0?"[":"")+e[r][0]+","+i+e[r][1]+a;return(t?"[<br />":"[")+n+(t?"]<br />]":"]")},printCoordinates:function(e,t){I.print(this.compileCoordinates(e,t))},printClosestWaypoints:function(){var e,t,a,n,i=12,r=500,o="",s=[""],c=[0,0],l=0;if(M.Layer.PersonalPin.eachLayer(function(i){t=M.convertLCtoGC(i.getLatLng()),null!==(a=M.getZoneFromCoord(t))&&(n=M.getClosestLocation(t,a.Layers.Waypoint),e="",null!==n&&(e=U.getChatlinkFromPoiID(n.options.id),l=P.getDistanceBetweenCoords(t,c),s[s.length-1]!==e&&l>r&&s.push(e),c=t))}),s.shift(),s.length>0){for(var u=Math.ceil(s.length/i),d=0,o="<div id='jsWaypointLinks'>Copy the codes below and<br />paste them in game chat to <br />follow the route:<br />",p=0;p<u;p++){o+="<input type='text'  class='cssInputText' value='";for(var h=i*p;h<i*(p+1)&&!(d>=s.length);h++)o+=" "+(h+1)+"-&gt;"+s[h],d++;o+="' /> Message "+(p+1)+"<br />"}o+="</div>",I.print(o,!0),I.bindInputSelect("#jsWaypointLinks .cssInputText"),I.bindConsoleInput()}else I.write("Pins must first be placed and be inside zones in order to create chatlinks.");return d},getDistanceBetweenCoords:function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},getUnitsBetweenCoords:function(e,t){return~~(P.getDistanceBetweenCoords(e,t)*T.cPOINTS_TO_UNITS)},getGreedyPath:function(e,t){var a=e;if(void 0!==t){var n=a[0];a[0]=a[t],a[t]=n}for(var i=a[0],r=0,o=a.length,s=0;s<o;s++){for(var c=Number.POSITIVE_INFINITY,l=s;l<o;l++){var u=P.getDistanceBetweenCoords(i,a[l]);u<=c&&(r=l,c=u)}i=a[r],a[r]=a[s],a[s]=i}return a},getUserPathColor:function(){return U.stripToColorString(O.Options.str_colorPersonalPath)},getUserPathOpacity:function(){return O.Options.int_opacityPersonalPath/100},refreshPersonalPath:function(){M.isMapInitialized&&M.drawPersonalPath(),W.isMapInitialized&&W.drawPersonalPath()},drawDirectedPath:function(e,t,a){void 0===t&&(t=!0);var n=M.convertGCtoLCMulti(e),i=new L.layerGroup,r=8,o=t?0:r-1;a=a||"lime";for(var s=0;s<n.length-1;s++)i.addLayer(L.polyline([n[s],n[s+1]],{color:a,weight:2*(o+2)})),o=t?o+1:o-1,t&&o>=r?o=0:!t&&o<0&&(o=r-1);return i},drawSpots:function(e,t){var a,n=M.convertGCtoLCMulti(e),i=new L.layerGroup,r={radius:10,color:"lime",weight:4};if(void 0!==t)for(var o in t)r[o]=t[o];for(var o in n)a=L.circleMarker(n[o],r),M.bindMarkerZoomBehavior(a,"click"),i.addLayer(a);return i},drawCompletionRoute:function(e){if(M.isItineraryRetrieved){var t=e?e.path:M.ZoneCurrent.path;M.redrawPersonalPath(t)}else U.getScript(U.URL_DATA.Itinerary,function(){for(var t in GW2T_COMPLETION_DATA)M.Zones[t].path=GW2T_COMPLETION_DATA[t].path;M.isItineraryRetrieved=!0,P.drawCompletionRoute(e)})},printZoneEvents:function(){if(M.isEventIconsGenerated){var e=[];M.ZoneCurrent.Layers.EventIcon.eachLayer(function(t){t.oSortableCoord=t.options.coord[0],e.push(t)}),U.sortObjects(e,{aKeyName:"oSortableCoord"});var t=I.getConsole();e.forEach(function(e){var a=e.options;$("<div class='mapEventListEntry'><input type='text' class='cssInputText' value='"+a.eventid+"' /> <input type='text' class='cssInputText' value='["+a.coord+"]' /> <a"+U.convertExternalAnchor(C.getEventWiki(a.wiki))+">[W]</a> <dfn class='cssGameTitle' data-coord='"+a.coord+"'>"+a.wiki+"</dfn></div>").appendTo(t).data("keywords",a.wiki.toLowerCase())}),I.print(""),M.bindMapLinks("#itemConsole"),I.bindConsoleInput();var a=$("<div class='cntSearchContainer'></div>").prependTo(t);I.createFilterBar(a,".mapEventListEntry")}else I.write("Event icons have not been generated.")},drawZoneBorders:function(){if(O.Options.bol_showZoneBorders&&0===P.Layer.ZoneBorder.getLayers().length)for(var e in M.Zones){var t=M.Zones[e];P.Layer.ZoneBorder.addLayer(L.rectangle(M.convertGCtoLCMulti(t.continent_rect),{fill:!1,color:M.Regions[t.region].color,weight:2,clickable:!1}))}M.toggleLayer(P.Layer.ZoneBorder,O.Options.bol_showZoneBorders)},drawZoneGateways:function(){if(O.Options.bol_showZoneGateways&&0===P.Layer.ZoneGateway.getLayers().length){var e,t,a=GW2T_GATEWAY_CONNECTION,n=a.launchpads,i=function(e,t,a,n){var i,r=e;Array.isArray(e[0])&&(r=e[0],i=e[1]);var o={icon:L.icon({iconUrl:t,iconSize:[32,32],iconAnchor:[16,16]}),opacity:a||.6,title:n};i&&(o.rotationAngle=M.convertDirectionAngle(r,i)+T.cCIRCLE_RIGHT_DEGREE);var s=L.marker(M.convertGCtoLC(r),o);return M.bindMarkerZoomBehavior(s,"click"),M.bindMarkerZoomBehavior(s,"contextmenu"),s},r=function(a,n,r){for(var o in a){for(var s in a[o])e=i(a[o][s],"img/map/gateway_"+n+I.cPNG),P.Layer.ZoneGateway.addLayer(e);r&&(t=L.polyline(M.convertGCtoLCDual(a[o]),{color:r,opacity:.2}),P.Layer.ZoneGateway.addLayer(t))}},o=function(t,a){for(var n in t)e=L.marker(M.convertGCtoLC(t[n].c),{icon:L.icon({iconUrl:"img/map/"+a+I.cPNG,iconSize:[32,32],iconAnchor:[16,16]})}),M.bindMarkerZoomBehavior(e,"click"),M.bindMarkerZoomBehavior(e,"contextmenu"),P.Layer.ZonePowerup.addLayer(e),P.Layer.ZoneGateway.addLayer(e)};r(a.interborders,"interborders"),r(a.interzones,"interzones","purple"),r(a.intrazones,"intrazones","white"),o(a.powerups,"powerup"),n.forEach(function(a){var n=a.i?"<div class='mapLoc'><img src='"+a.i+"' /></div>":null;e=i(a.c,"img/map/launchpad.png",1,n),P.Layer.ZoneLaunchpad.addLayer(e),P.Layer.ZoneGateway.addLayer(e),t=L.polyline(M.convertGCtoLCDual(a.c),{color:"gold",opacity:.2}),P.Layer.ZoneGateway.addLayer(t)}),P.rebindMarkerTooltips()}M.toggleLayer(P.Layer.ZoneGateway,O.Options.bol_showZoneGateways),M.adjustZoomMapping()},drawChainPaths:function(e){if(!1!==I.isMapEnabled){var t,a,n,i,r,o;if(e.series!==C.ChainSeriesEnum.DryTop)for(t=0;t<e.primaryEvents.length;t++){switch(n=e.primaryEvents[t],t){case 0:i="red";break;case 1:i="orange";break;case 2:i="yellow";break;case 3:i="lime";break;case 4:i="cyan";break;case 5:i="blue";break;case 6:i="violet";break;case 7:i="purple";break;default:i="white"}if(n.path[0][0]<0)for(var s=1;s<n.path.length;s++)o=L.circleMarker(M.convertGCtoLC(n.path[s]),{clickable:!1,radius:8,color:"red",weight:2,opacity:.8,fillOpacity:.1}),M.Zones[e.zone].Layers.Path.addLayer(o);else r=M.convertGCtoLCMulti(n.path,1),o=L.polyline(r,{color:i}),M.Zones[e.zone].Layers.Path.addLayer(o)}var c=e.primaryEvents;e.finalCoord=c[c.length-1].path[0];var l;for(t in e.events)-1!==(l=(a=e.events[t]).num).indexOf(".")&&(l=l.replace(".","\\.")),$("#chnEvent_"+e.nexus+"_"+l).each(function(){var e=a.path[0],n=e;e[0]<0&&(n=[Math.abs(e[0]),Math.abs(e[1])]),$(this).attr("data-coord",n[0]+","+n[1]),$(this).attr("data-eventindex",t),I.ModeCurrent!==I.ModeEnum.Mobile&&M.bindMapLinkBehavior($(this),M.ZoomEnum.Ground,M.Pin.Event)})}},isChainPathsAllowed:function(){return O.Options.bol_showChainPaths&&I.PageCurrent!==I.PlateEnum.Map&&I.ModeCurrent!==I.ModeEnum.Overlay},generateDryTop:function(){U.getScript(U.URL_DATA.DryTop,function(){C.DryTop=GW2T_DRYTOP_EVENTS;var e,t,a,n;if(I.isMapEnabled){for(i in C.DryTop)a=C.DryTop[i],n=L.marker(M.convertGCtoLC(a.coord),{clickable:!1,icon:L.divIcon({className:"mapNick",html:"<span class='mapNickIn'>"+D.getObjectName(a)+"<br /><var class='mapDryTopTimestamp' style='color:"+a.color+"'>"+a.time+"</var></span>",iconSize:[512,64],iconAnchor:[256,32]})}),P.Layer.DryTopNicks.addLayer(n);M.toggleLayer(P.Layer.DryTopNicks,!0),P.DryTopTimer=L.marker(M.convertGCtoLC(M.getZoneCenter("dry")),{clickable:!1,icon:L.divIcon({className:"mapNick",html:"<div class='mapNickIn' id='mapDryTopInfo'><span id='mapDryTopTimer'></span><br /><input id='mapDryTopClip0' type='text' /> <input id='mapDryTopClip1' type='text' /></div>",iconSize:[512,64],iconAnchor:[256,32]})}),M.toggleLayer(P.DryTopTimer,!0);for(i in C.DryTopChains){t=C.DryTopChains[i];for(e in t.events)(a=t.events[e]).eventring=L.marker(M.convertGCtoLC(a.path[0]),{zIndexOffset:M.cZIndexBury,clickable:!1,icon:L.icon({iconUrl:"img/event/ring/"+a.ring+I.cPNG,iconSize:[32,32],iconAnchor:[16,16]})}),a.eventicon=L.marker(M.convertGCtoLC(a.path[0]),{title:"<span class='mapEvent'><dfn>"+D.getObjectName(a)+"</dfn></span>",wiki:D.getObjectName(a),icon:L.icon({iconUrl:"img/event/"+a.icon+I.cPNG,iconSize:[16,16],iconAnchor:[8,8]})}),M.bindMarkerWikiBehavior(a.eventicon,"click"),M.bindMarkerZoomBehavior(a.eventicon,"contextmenu"),$("#chnEvent_"+t.nexus+"_"+a.num).hasClass("chnEventCurrent")&&(P.LayerArray.DryTopActive.push(a.eventicon),P.LayerArray.DryTopActive.push(a.eventring),M.toggleLayer(a.eventring,!0),M.toggleLayer(a.eventicon,!0)),P.LayerArray.DryTopRings.push(a.eventring),P.LayerArray.DryTopIcons.push(a.eventicon)}P.rebindMarkerTooltips()}I.loadImg($("#sectionChains_Drytop"));for(var i=0;i<2;i++)I.bindClipboard("#chnDryTopWaypoint"+i),I.bindClipboard("#mapDryTopClip"+i);C.isDryTopGenerated=!0,T.initializeDryTopStrings(),P.toggleDryTopIcons(!0)})},toggleDryTopIcons:function(e){C.isDryTopGenerated&&I.isMapEnabled&&(C.isDryTopIconsShown=e,M.toggleLayer(P.Layer.DryTopNicks,e),M.toggleLayer(P.DryTopTimer,e),e?(M.toggleLayerArray(P.LayerArray.DryTopActive,e),P.adjustZoomDryTop(),I.qTip.init($("#mapDryTopClip0, #mapDryTopClip1").click(function(){$(this).select()}).hover(function(){M.isMouseOnHUD=!0},function(){M.isMouseOnHUD=!1}))):(M.toggleLayerArray(P.LayerArray.DryTopIcons,e),M.toggleLayerArray(P.LayerArray.DryTopRings,e))),K.updateDryTopClipboard()},adjustZoomDryTop:function(){if(C.isDryTopIconsShown){var e,t,a,n,i,r;switch(M.Map.getZoom()){case 7:a=32,i=20,r=.9;break;case 6:a=28,i=16,r=.8;break;case 5:a=24,i=12,r=.8;break;case 4:a=20,i=0,r=0;break;case 3:a=16,i=0,r=0;break;default:a=0,i=0,r=0}n=M.scaleDimension(M.cRING_SIZE_MAX);for(e in P.LayerArray.DryTopIcons)t=P.LayerArray.DryTopIcons[e],M.resizeMarkerIcon(t,a),t=P.LayerArray.DryTopRings[e],M.resizeMarkerIcon(t,n);P.Layer.DryTopNicks.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=i+"px",e._icon.style.opacity=r,e._icon.style.zIndex=M.cZIndexBury+1,e._icon.style.display="table")}),P.DryTopTimer._icon.style.fontSize=Math.ceil(1.5*i)+"px",P.DryTopTimer._icon.style.opacity=r,P.DryTopTimer._icon.style.zIndex=M.cZIndexRaise+1,P.DryTopTimer._icon.style.display="table"}},loadSubzone:function(e,t){var a=t,n=a.Subzones;void 0===n[e]&&(n[e]={},$.getJSON(U.getAPIMap(e),function(t){n[e]={map_rect:t.map_rect,continent_rect:t.continent_rect,floors:t.floors,center:a.computeZoneCenter(t)};var i="name_"+D.langPartiallySupported;n[e][i]=t.name}).fail(function(){I.warn("zone ID: "+e)}))},switchMapCheck:function(){if(void 0!==GPSIdentityJSON&&null!==GPSIdentityJSON){var e=P.MapSwitchGPS,t=GPSIdentityJSON.map_id,a="#"+P.MapSwitchWebsite;void 0!==M.ZoneAssociation[t]?P.MapSwitchGPS=P.MapEnum.Tyria:void 0!==W.ZoneAssociation[t]&&(P.MapSwitchGPS=P.MapEnum.Mists),P.MapSwitchGPS!==e&&P.MapSwitchGPS!==P.MapSwitchWebsite&&$(a+"SwitchButton").trigger("click")}},updateCharacter:function(e){var t,a=O.Options["int_setFollow"+P.MapSwitchSuffix],n=O.Options["bol_displayCharacter"+P.MapSwitchSuffix];switch(P.MapSwitchWebsite){case P.MapEnum.Tyria:t=M;break;case P.MapEnum.Mists:if(t=W,!1===W.isWvWLoaded)return}if(void 0!==GPSPositionArray&&null!==GPSPositionArray&&3===GPSPositionArray.length&&!t.isUserDragging&&void 0!==GPSIdentityJSON&&null!==GPSIdentityJSON&&P.MapSwitchGPS===P.MapSwitchWebsite){var i,r=GPSIdentityJSON.map_id;if(t.isZoneValid(r))i=t.getZoneFromID(r),t.GPSisInstance&&(t.GPSisInstance=!1,t.isFloorShown&&t.changeFloor());else{if(!t.isSubzoneValid(r))return P.loadSubzone(r,t),t.movePin(t.Pin.Character),void t.movePin(t.Pin.Camera);i=t.Subzones[r],t.GPSisInstance=!0}var o=t.convertGPSCoord(GPSPositionArray,i),s=!1,c=!1;if(t.GPSPreviousCoord[0]===o[0]&&t.GPSPreviousCoord[1]===o[1]||(s=!0,t.GPSPreviousCoord=o,document.getElementById(P.MapSwitchWebsite+"CoordinatesMouse").value=o[0]+", "+o[1]),t.GPSPreviousZoneID!==r&&(c=!0,t.GPSPreviousZoneID=r,t.GPSisInstance&&t.isFloorShown&&t.changeFloor(i.floors[0])),(a===O.IntEnum.Follow.Character&&s||e>=0)&&(t.Map.setView(t.convertGCtoLC(o),t.Map.getZoom()),t.showCurrentZone(o),e=-1),a===O.IntEnum.Follow.Zone&&c&&t.ZoneAssociation[r]&&(t.refreshView(i.center),t.showCurrentZone(i.center),e=-1),n){var l=-t.convertGPSAngle(GPSDirectionArray),u=-t.convertGPSAngle(GPSCameraArray);(t.GPSPreviousAngleCharacter!==l||t.GPSPreviousAngleCamera!==u||e<=0)&&(P.isGPSPrinting&&(I.clear(),I.print("Coord: "+P.formatCoord(o)+"<br />Position: "+U.formatJSON(GPSPositionArray)+"<br />Direction: "+U.formatJSON(GPSDirectionArray)+"<br />Perspective: "+U.formatJSON(GPSPerspectiveArray)+"<br />Camera: "+U.formatJSON(GPSCameraArray)),I.prettyJSON(GPSIdentityJSON),J.isProjectionInitialized&&J.Camera.lookAt(new THREE.Vector3(GPSCameraArray[0],GPSCameraArray[1],GPSCameraArray[2]))),t.movePin(t.Pin.Character,o),t.movePin(t.Pin.Camera,o),t.Pin.Camera._icon.style.zIndex=t.cZIndexBury,t.Pin.Camera._icon.style.pointerEvents="none",t.Pin.Character.setRotationAngle(l),t.Pin.Camera.setRotationAngle(u),t.GPSPreviousAngleCharacter=l,t.GPSPreviousAngleCamera=u)}}},tickGPS:function(){(O.Options["int_setFollow"+P.MapSwitchSuffix]||O.Options["bol_displayCharacter"+P.MapSwitchSuffix])&&(P.updateCharacter(),window.clearTimeout(P.GPSTimeout),P.GPSTimeout=setTimeout(function(){P.tickGPS()},O.Options.int_msecGPSRefresh))}},G={generateAndInitializeDailies:function(){var e=$("#dlyCalendar"),t=new Date;$("#dlyHeader, #dlyCalendar, #dlyActivity").empty(),I.removeThrobber("#dlyContainer"),$("#dlyHeader").html(T.formatWeektime(t)),T.isChecklistCountdownsStarted=!0,G.fillDailyCalendar(e,t)},fillDailyCalendar:function(e,t,a){var n=$(e),i=function(){n.find(".dlyBox:first").addClass("dlyCurrent").next().addClass("dlyNext"),n.find(".dlyZoom").each(function(){M.bindMapLinkBehavior($(this),M.ZoomEnum.Sky,M.Pin.Program)}),I.bindPseudoCheckbox(n.find("ins")),I.qTip.init(n.find("ins")),I.removeThrobber(n.parent()),Q.bindAchievement(".dly")};G.createDailyBookmarks(n),n.after(I.cThrobber),T.getDaily().done(function(){G.insertDailyDay(n,T.DailyToday,t,a),T.getDaily({aWantGetTomorrow:!0}).done(function(){G.insertDailyDay(n,T.DailyTomorrow,T.addDaysToDate(t,1),a),i(n)})}).fail(function(){I.warn("daily achievements"),I.removeThrobber(n.parent())})},createDailyBookmarks:function(e){!1!==I.isMapEnabled&&I.createSearchBar(e,{aIsSelect:!0,aBarClass:"dlyBookmarks",aDatabase:T.Daily.Bookmark,aFillerText:D.getModifiedWord("bookmarks","map",U.CaseEnum.Every),aCallback:function(e){M.redrawPersonalPath(e.path)},aCancel:function(){M.clearPersonalPins()}})},insertDailyDay:function(e,t,a,n){var i,r,o,s,c,l,u=$(e),d=t.pve,p=t.pvp,h=t.wvw,m=t.fractals,g="",f="",v=function(e){if(i=e.split(" "),r=i[0],o=i[1].toLowerCase(),s=i.length>2?i[2].toLowerCase():"",c=i.length>3?i[3].toLowerCase():"",l=i.length>4?i[4].toLowerCase():"","misc"===o)return"<ins class='dly dly_pve_"+s+" dlyZoom curZoom' data-ach='"+r+"' data-coord='"+c+"'></ins>";if("jp"===o||"adventure"===o)return"<ins class='dlyRegion dly_region_"+c+"'><ins class='dly dly_pve_"+o+" dlyZoom curZoom' data-ach='"+r+"' data-coord='"+l+"'></ins></ins>";if("vista"===o||"miner"===o||"lumberer"===o||"forager"===o)return"<ins class='dlyRegion dly_region_"+s+"'><ins class='dly dly_pve_"+o+" dlyZoom curZoom' data-ach='"+r+"' data-coord='"+c+"'></ins></ins>";if("dungeon"===o)return"<ins class='dlyRegion dly_region_"+c+"'><ins class='dly dly_pve_dungeon_"+s+" dlyZoom curZoom' data-ach='"+r+"' data-coord='"+l+"'></ins></ins>";if("boss"===o){var t=C.getChainByAlias(s);return"<ins class='dlyRegion dly_region_"+C.getChainRegion(t)+"'><ins class='dly dly_pve_boss dlyZoom curZoom' data-ach='"+r+"' data-coord='"+t.finalCoord+"'></ins></ins>"}return"event"===o?"<ins class='dlyRegion dly_region_"+M.getZoneRegion(s)+"'><ins class='dly dly_pve_event dlyZoom curZoom' data-ach='"+r+"' data-coord='"+s+"'></ins></ins>":""},b=function(e){if(i=e.split(" "),r=i[0],o=i[1].toLowerCase(),2===i.length)return"<ins class='dly dly_pvp_"+o+"' data-ach='"+r+"'></ins>";var t=i[2].toLowerCase();return"<ins class='dly dly_pvp_profession_"+o+"_0' data-ach='"+r+"'><ins class='dly dly_pvp_profession_"+t+"_1'></ins></ins>"},S=function(e){return i=e.split(" "),r=i[0],"<ins class='dly dly_wvw_"+(o=i[1].toLowerCase())+"' data-ach='"+r+"'></ins>"},y="",k="",E="";switch(d.forEach(function(e){y+=v(e)}),p.forEach(function(e){k+=b(e)}),h.forEach(function(e){E+=S(e)}),a.getUTCDay()){case T.DayEnum.Sunday:g="dlySunday";break;case T.DayEnum.Saturday:g="dlySaturday"}var _=n||void 0===n?"":"dlyBoxDashboard",P=T.Daily.Activity,A=P.Schedule[a.getUTCDay()],L=D.getObjectName(P.Activities[A]);f="<em class='dlyActivityIconContainer dlyMonthday' title='"+L+"'><img class='dlyActivityIcon' src='img/daily/activities/"+A+I.cPNG+"' /></em>";var w=$("<div class='dlyBox "+_+"'><aside class='dlyMonthdayBackground dlyMonthday'></aside>"+f+"<a class='dlyMonthdayNumber dlyMonthday "+g+"'"+U.convertExternalAnchor(U.getWikiLinkLanguage(L))+"title='"+L+"'>"+a.getUTCDate()+"</a><span class='dlyMode'><ins class='dly dly_daily_pve'></ins>"+y+"</span><span class='dlyMode'><ins class='dly dly_daily_pvp'></ins>"+k+"</span><span class='dlyMode'><ins class='dly dly_daily_wvw'></ins>"+E+"</span></div>").appendTo(u);I.qTip.init(".dlyMonthdayNumber");var O=T.Daily.Fractal,x=function(e,t,a,n,i){w.append("<span class='dlyMode dlyModeFractal'><ins class='dly dly_daily_fractal"+(e?"scale":"island")+"'></ins><ins class='dly chl_fractal chl_"+t[0].toLowerCase()+"' title='"+t[0]+"' "+(a?"data-ach='"+a[0]+"'":"")+"></ins><ins class='dly chl_fractal chl_"+t[1].toLowerCase()+"' title='"+t[1]+"' "+(a?"data-ach='"+a[1]+"'":"")+"></ins><ins class='dly chl_fractal chl_"+t[2].toLowerCase()+"' title='"+t[2]+"' "+(a?"data-ach='"+a[2]+"'":"")+"></ins><a class='dlyFractalScales' title='<dfn>"+i+"</dfn>'"+U.convertExternalAnchor(D.getObjectURL(O))+">"+n+"</a></span>"),I.qTip.init(w.find("ins")),I.qTip.init(".dlyFractalScales")},N=function(e){for(var t=O.Scale.length-1;t>0;t--)if(O.Scale[t]===e)return t+1;return 1},W=function(e){return O.Scale[e-1]},B=[m[0],m[1],m[m.length-1]],R=parseInt(T.DailyAssociation[B[0]]),H=parseInt(T.DailyAssociation[B[1]]),z=parseInt(T.DailyAssociation[B[2]]);R&&H&&z&&x(!0,[W(R),W(H),W(z)],B,R+" "+H+" "+z,O.Scale[R-1]+" | "+O.Scale[H-1]+" | "+O.Scale[z-1]);var G=[m[5],m[9],m[13]],F=T.DailyAssociation[G[0]],j=T.DailyAssociation[G[1]],Z=T.DailyAssociation[G[2]];F&&j&&Z&&x(!1,[F,j,Z],G,N(F)+" "+N(j)+" "+N(Z),F+" | "+j+" | "+Z),Q.bindAchievement(".chl_fractal")},generateAndInitializeResources:function(){var e,t=[],a=.3,n=P.getUserPathColor(),i=P.getUserPathOpacity(),r=I.bindInputSelect("#nod_int_coinWaypointAverage"),o=I.bindInputSelect("#nod_int_secNodeVisitAverage"),s=function(e){return X.getChecklistItem(X.Checklists["Resource"+e.options.grade],e.options.index)},c=function(e,t){X.setChecklistItem(X.Checklists["Resource"+e.options.grade],e.options.index,t)},l=function(){for(var e in P.LayerArray.Resource)P.LayerArray.Resource[e].eachLayer(function(e){e instanceof L.Marker&&s(e)===X.ChecklistEnum.Checked&&e.setOpacity(a)})},u=function(e){M.bindMarkerZoomBehavior(e,"contextmenu"),M.bindMarkerCoordBehavior(e,"click"),e.on("mousedown",function(t){switch(t.originalEvent.which){case I.ClickEnum.Left:s(e)===X.ChecklistEnum.Checked?(c(e,X.ChecklistEnum.Unchecked),this.setOpacity(1)):(c(e,X.ChecklistEnum.Checked),this.setOpacity(a));break;case I.ClickEnum.Middle:M.createPersonalPin(this.getLatLng(),!0)}})},d=function(){E.getPrices(t,function(e){for(var t in P.Resources){var a=P.Resources[t],n=a.item;if(n&&e[n]){var i=e[n];$("#nodPrice_"+t).html(E.formatCoinStringColored(i.oPriceSell)),P.Resources[t].price=i.oPriceSellTaxed}else $("#nodPrice_"+t).html(D.getObjectName(a))}},!1)},p=function(t,a){return e.Yield[t.type][a]},h=function(e){var t,a,r,o,s,c,d=0,h=e,m="Rich"===e?[32,32]:[24,24],g="Rich"===e?[16,16]:[12,12];for(t in P.Resources){r=P.Resources[t],void 0===P.Resources[t].price&&(P.Resources[t].price=0);var f=t.toLowerCase(),C=r[h];if(void 0!==C&&C.length>0){o=new L.layerGroup;for(a in C)s=L.marker(M.convertGCtoLC(C[a].c),{grade:h,name:t,quantity:p(r,h),index:d,coord:C[a].c,icon:L.divIcon({className:"nod"+h,html:"<img src='img/node/"+f+I.cPNG+"' />",iconSize:m,iconAnchor:g}),isNode:!0}),u(s),o.addLayer(s),void 0!==C[a].p&&(c=L.polyline(M.convertGCtoLCMulti(C[a].p),{color:n,dashArray:"5,10",opacity:i}),o.addLayer(c)),d++;M.toggleLayer(o),P.Layer["Resource_"+h+"_"+t]=o,P.LayerArray.Resource.push(o)}}X.initializeChecklist(X.Checklists["Resource"+h],d),l()},m=function(e,t){if(t){for(var a in P.Resources)$("#nod_"+a).prop("checked",!1).trigger("change");e.prop("checked",!0)}var n=U.getSubstringFromHTMLID(e),i=e.prop("checked"),r=$("#nodShowRegular").prop("checked"),o=$("#nodShowHotspot").prop("checked");M.toggleLayer(P.Layer["Resource_Rich_"+n],i),M.toggleLayer(P.Layer["Resource_Permanent_"+n],i),M.toggleLayer(P.Layer["Resource_Regular_"+n],i&&r),M.toggleLayer(P.Layer["Resource_Hotspot_"+n],i&&o)},g=function(e){var t,a,n=0,i=[],c=Number.POSITIVE_INFINITY,l=r.val(),u=o.val(),d=0,p=0,h=0;M.Map.eachLayer(function(r){if(r instanceof L.Marker&&r.options.isNode&&s(r)===X.ChecklistEnum.Unchecked){if(e&&!1===M.isWithinZone(M.ZoneCurrent,r.options.coord))return;h+=P.Resources[r.options.name].price*r.options.quantity,i.push(r.options.coord),(t=i[n][0])<c&&(c=t,a=n),n++}});var m=i.length;if(m>0){M.redrawPersonalPath(P.getGreedyPath(i,a)),d=P.printClosestWaypoints()*l,p=m*u;var g="Gather Profit: <span class='cssRight'>"+E.formatCoinStringColored(h)+"</span><br />Waypoint Cost: <span class='cssRight'>"+E.formatCoinStringColored(d)+"</span><br /></br >Net Profit: <span class='cssRight'>"+E.formatCoinStringColored(h-d)+"</span><br /><br />Nodes to Visit: <span class='cssRight'>"+m+"</span><br />Estimated Time: <span class='cssRight'>"+T.getTimeFormatted({aCustomTimeInSeconds:p,aWantLetters:!0})+"</span>";I.print(g)}};U.getScript(U.URL_DATA.Resource,function(){var a,n;P.Resources=GW2T_RESOURCE_DATA,e=GW2T_RESOURCE_METADATA,h("Rich"),h("Permanent");for(a in P.Resources)n=P.Resources[a],$("#nodResource_"+n.type).append("<label><input id='nod_"+a+"' type='checkbox' checked='checked' /> <img src='img/node/"+a.toLowerCase()+I.cPNG+"' /> <abbr>"+D.getObjectName(n)+"</abbr><var id='nodPrice_"+a+"'></var></label>"),n.item&&t.push(n.item);for(a in P.Resources)!function(e){e.change(function(){m(e)}),X.getCheckboxLabel(e).dblclick(function(){m(e,!0)})}($("#nod_"+a));$("#mapToggle_Resource").data("checked",!0).click(function(){var e=I.toggleButtonState($(this));for(a in P.Resources)$("#nod_"+a).prop("checked",e).trigger("change")}),$("#nodRoute").click(function(){M.isPersonalPinsLaid()?M.clearPersonalPins():g()}).contextmenu(function(e){e.preventDefault(),g(M.ZoneCurrent)}),$("#nodToggle_ResourceOre").click(function(){$("#nodResource_Ore input").trigger("click")}),$("#nodToggle_ResourcePlant").click(function(){$("#nodResource_Plant input").trigger("click")}),$("#nodToggle_ResourceWood").click(function(){$("#nodResource_Wood input").trigger("click")}),$("#nodShowRegular").one("click",function(){h("Regular")}),$("#nodShowHotspot").one("click",function(){h("Hotspot")}),$("#nodShowRegular").change(function(){var e=$(this).prop("checked");for(var t in P.Resources){var a=$("#nod_"+t).prop("checked");M.toggleLayer(P.Layer["Resource_Regular_"+t],a&&e)}}).trigger("change"),$("#nodShowHotspot").change(function(){var e=$(this).prop("checked");for(var t in P.Resources){var a=$("#nod_"+t).prop("checked");M.toggleLayer(P.Layer["Resource_Hotspot_"+t],a&&e)}}).trigger("change"),$("#nodUncheck").click(function(){for(var e in P.LayerArray.Resource)P.LayerArray.Resource[e].eachLayer(function(e){e instanceof L.Marker&&e.setOpacity(1)});X.clearChecklist(X.Checklists.ResourceRich),X.clearChecklist(X.Checklists.ResourcePermanent),X.clearChecklist(X.Checklists.ResourceRegular),X.clearChecklist(X.Checklists.ResourceHotspot)}),X.rewrapCheckboxes(),$("#nodRefresh").click(function(){d(),I.write("Prices refreshed.")}),d(),G.createDailyBookmarks("#nodBookmarks"),U.verifyArticle("All",function(){$("#nodShowRegular, #nodShowHotspot").trigger("click")}),U.verifyArticle("Regular",function(){$("#nodShowRegular").trigger("click")}),U.verifyArticle("Hotspot",function(){$("#nodShowHotspot").trigger("click")})})},drawResourceRoute:function(){!1===$("#nodMenu").is(":visible")&&(I.write("Please view the <a data-page='Resource'>Resource Nodes</a> section first."),I.bindConsoleLink()),$("#nodRoute").trigger("contextmenu")},generateAndInitializeJPs:function(){var e,t=function(t,a){var n=t.oMarker,i=n.options.difficulty,r=a?"jpzDifficulty0":"jpzDifficulty"+i;n.setIcon(new L.icon({className:r,iconUrl:"img/map/"+e[i].name+I.cPNG,iconSize:[32,32],iconAnchor:[16,16]}))};U.getScript(U.URL_DATA.JP,function(){e=GW2T_JP_DATA.Type,P.JPs=GW2T_JP_DATA.JP,X.Checklists.JP.length=U.getObjectLength(P.JPs),P.NodeArray.JP=P.createNodeArray(X.Checklists.JP.length);var a,n,i,r,o,s,c=P.getUserPathColor(),l=P.getUserPathOpacity();$(".jpzHeader").each(function(){$(this).text(D.getObjectName(e[$(this).attr("data-difficulty")]))});for(var u in P.JPs)a=P.JPs[u],o=D.getObjectName(a),i=L.marker(M.convertGCtoLC(a.coord),{id:a.id,difficulty:a.difficulty,title:"<div class='mapLoc'><dfn>"+D.getObjectName(e[a.difficulty])+":</dfn> "+o+"<img src='"+a.img+"' /></div>"}),P.NodeArray.JP[a.id].oMarker=i,t(P.NodeArray.JP[a.id]),a.path&&(r=L.polyline(M.convertGCtoLCMulti(a.path),{color:c,dashArray:"5,10",opacity:l}),P.NodeArray.JP[a.id].oPath=r),s=(o+" "+M.getZoneName(a.zone)).toLowerCase(),$("<aside class='jpzItem'><dt id='jpz_"+a.id+"' data-coord='"+a.coord+"'>"+o+"</dt><label><input type='checkbox' id='jpzCheck_"+a.id+"' /></label>&nbsp;<cite><a href='"+U.getYouTubeLink(o)+"'>[Y]</a> <a href='"+U.getWikiLinkObject(a)+"'>[W]</a></cite><dd>"+a.description+"</dd></aside>").data("keywords",s).appendTo("#jpzList_"+a.difficulty),(n=$("#jpz_"+a.id)).attr("title","<div class='mapLoc'><img src='"+a.img+"' /></div>"),M.bindMapLinkBehavior(n,M.ZoomEnum.Same);P.toggleNodeArray(P.NodeArray.JP,!0),M.bindMapLinks(".jpzList"),U.convertExternalLink(".jpzList a"),I.createFilterBar("#jpzSearch",".jpzItem"),I.qTip.init(".jpzList dt"),X.rewrapCheckboxes(),$("#jpzToggleJP").change(function(){var e=$(this).prop("checked");if(P.toggleNodeArray(P.NodeArray.JP,e),e)for(var a=0;a<P.NodeArray.JP.length;a++){var n=P.NodeArray.JP[a];(e=X.getChecklistItem(X.Checklists.JP,a))===X.ChecklistEnum.Unchecked?t(n):t(n,!0)}}),$("#mapToggle_JP").data("checked",!0).click(function(){var e=I.toggleButtonState($(this));$("#jpzToggleJP").prop("checked",e).trigger("change"),$("#jpzToggleChest").prop("checked")&&$("#jpzToggleChest").prop("checked",e).trigger("change")}),P.rebindMarkerTooltips(),X.initializeChecklist(X.Checklists.JP,X.Checklists.JP.length);for(var d=function(){var e=X.countChecklist(X.Checklists.JP,X.ChecklistEnum.Checked),t=X.Checklists.JP.length;$("#jpzCounter").text(e+"/"+t)},u=0;u<X.Checklists.JP.length;u++)$("#jpzCheck_"+u).each(function(){var e=X.getChecklistItem(X.Checklists.JP,u,U.TypeEnum.isBoolean);$(this).prop("checked",e),!1===e?X.getCheckboxLabel($(this)).prev().removeClass("jpzListNameChecked"):(X.getCheckboxLabel($(this)).prev().addClass("jpzListNameChecked"),t(P.NodeArray.JP[u],!0))}).change(function(){var e=X.getCheckboxEnumState($(this)),a=U.getSubintegerFromHTMLID($(this));e===X.ChecklistEnum.Unchecked?(X.getCheckboxLabel($(this)).prev().removeClass("jpzListNameChecked"),t(P.NodeArray.JP[a])):(X.getCheckboxLabel($(this)).prev().addClass("jpzListNameChecked"),t(P.NodeArray.JP[a],!0)),X.setChecklistItem(X.Checklists.JP,a,e),d()}).parent().hover(function(){$(this).prev().css({"text-decoration":"underline"}).trigger("mouseenter")},function(){$(this).prev().css({"text-decoration":"none"}).trigger("mouseleave")}),function(e){var t=P.NodeArray.JP[e].oMarker;t.on("click",function(){$("#jpzCheck_"+e).trigger("click"),I.scrollToElement("#jpz_"+this.options.id,{aContainer:"#plateMap"})}),M.bindMarkerZoomBehavior(t,"contextmenu")}(u);$("#jpzUncheckJP").click(function(){for(u=0;u<X.Checklists.JP.length;u++)$("#jpzCheck_"+u).prop("checked",!1).parent().prev().removeClass("jpzListNameChecked"),t(P.NodeArray.JP[u]);X.clearChecklist(X.Checklists.JP),d()}),d(),G.generateAndInitializeChests()})},generateAndInitializeChests:function(){P.Chests=GW2T_JP_DATA.Chest;var e=P.Chests.Basic.length+P.Chests.Splendid.length;X.initializeChecklist(X.Checklists.Chest,e);var t,a,n=0,i=.3,r=function(e){return X.getChecklistItem(X.Checklists.Chest,e.options.index)},o=function(e,t){X.setChecklistItem(X.Checklists.Chest,e.options.index,t)},s=function(){P.Layer.Chest.eachLayer(function(e){r(e)===X.ChecklistEnum.Checked?e.setOpacity(i):e.setOpacity(1)})},c=function(e,t,a){var n=null;e.t&&(n=e.t);var s=L.marker(M.convertGCtoLC(e.c),{index:a,icon:L.divIcon({className:"mapChest"+t,html:"<img src='img/map/chest.png' />",iconSize:[32,32],iconAnchor:[16,16]}),title:n});s.on("click",function(){r(this)===X.ChecklistEnum.Checked?(o(this,X.ChecklistEnum.Unchecked),this.setOpacity(1)):(o(this,X.ChecklistEnum.Checked),this.setOpacity(i))}),M.bindMarkerZoomBehavior(s,"contextmenu"),P.Layer.Chest.addLayer(s)};for(t in P.Chests)for(a in P.Chests[t])c(P.Chests[t][a],t,n),n++;$("#jpzToggleChest").change(function(){M.toggleLayer(P.Layer.Chest,$(this).prop("checked")),s()}),$("#jpzUncheckChest").click(function(){X.clearChecklist(X.Checklists.Chest),s()})},generateCollectiblesUI:function(){U.getScript(U.URL_DATA.Collectible,function(){P.Collectibles=GW2T_COLLECTIBLE_DATA;var e,t,a,n,i=GW2T_COLLECTIBLE_METADATA,r={};for(o in P.Collectibles)r[(e=P.Collectibles[o]).category]=!0,t=D.getObjectName(e),a=D.getObjectDefaultName(e),n=I.cSiteLink+"<dfn>"+X.Collectibles[o].urlkey+"</dfn>",$("<div class='cltBox cltBox_"+e.category+"'><label style='color:"+e.color+"'><img id='cltPins_"+o+"' class='cltIcon' src='img/collectible/"+o.toLowerCase()+".png' /><input id='ned_"+o+"' type='checkbox' /> "+t+"</label><span class='cltLinks' title='"+n+"' ><cite><a href='"+U.getYouTubeLink(a)+"'>[Y]</a>&nbsp;<a href='"+e.wiki+"'>[W]</a>&nbsp;<a href='"+e.credit+"'>[C]</a>&nbsp;&nbsp;-&nbsp;&nbsp;</cite><a id='nedUncheck_"+o+"'>Reset</a></span></div>").appendTo("#cltList").data("keywords",t.toLowerCase()),$("#ned_"+o).one("click",function(){var e=U.getSubstringFromHTMLID($(this));G.generateCollectibles(e),M.goToArguments(P.Collectibles[e].view)}),U.verifyArticle(X.Collectibles[o].urlkey,function(){var e=$("#ned_"+o).trigger("click");setTimeout(function(){I.scrollToElement(e,{aOffset:-64,aSpeed:"fast"})},2e3)});U.convertExternalLink("#cltList cite a"),I.qTip.init(".cltLinks"),I.createFilterBar("#cltSearch",".cltBox"),X.rewrapCheckboxes();for(var o in i.Categories)!function(e){var t=i.Categories[e];$("<button class='cltFilterButton btnTab curToggle' title='Filter: <dfn>"+e+"</dfn>'><img src='"+t+"' /></button>").appendTo("#cltFilter").click(function(){$(this).hasClass("btnActive")?($(".cltFilterButton").removeClass("btnActive"),$(".cltBox").show()):($(".cltFilterButton").removeClass("btnActive"),$(this).addClass("btnActive"),$(".cltBox").hide(),$(".cltBox_"+e).show())})}(o);I.qTip.init(".cltFilterButton"),$("#mapToggle_Collectible").data("checked",!1).data("hideonly",!0).click(function(){for(o in P.Collectibles)$("#ned_"+o).prop("checked")&&$("#ned_"+o).trigger("click")}),I.scrollToElement("#headerMap_Collectible",{aContainer:"#plateMap"})})},generateCollectibles:function(e){var t,a,n,i,r,o,s,c,l,u,d,p,h=U.Args[X.Collectibles[e].urlkey],m=P.Collectibles[e],g=D.getObjectName(m),f="img/collectible/"+e.toLowerCase()+"/";if(m.needles[0].u)for(s={},c={},t=0;t<m.needles.length;t++)s[(r=m.needles[t]).u]=t+1,c[t]=r.u;var C=function(e,t){if(m.iconsize){var a=m.ringsize||16;e.setIcon(new L.divIcon({className:"mapNeedle"+t,html:"<span class='mapNeedleIcon' style='color:"+m.color+";background-image: url("+e.options.needleLabel+");background-size: "+m.iconsize+"px'></span>",iconSize:[a,a],iconAnchor:[a/2,a/2]}))}else e.setIcon(new L.divIcon({className:"mapNeedle"+t+" mapNeedleExtreme"+e.options.needleExtreme,html:"<span style='color:"+m.color+"'>"+e.options.needleLabel+"</span>",iconSize:[16,16],iconAnchor:[8,8]}));t===X.ChecklistEnum.Found?e.setOpacity(.2):e.setOpacity(1)},v=function(t,a){var n=L.marker(M.convertGCtoLC(t),a);C(n,l),n.on("click",function(e){var t=X.trackChecklistItem(X.Collectibles[this.options.needleType],this.options.needleIndex),a=this;m.iscushion?P.LayerArray[this.options.needleType].forEach(function(e){e.options.needleIndex===a.options.needleIndex&&C(e,t)}):C(this,t);var n=X.getCheckedIndexes(X.Collectibles[this.options.needleType],c);n.length?U.updateAddressBar("?"+this.options.needleKey+"="+n):U.updateQueryString()}),M.bindMarkerCoordBehavior(n,"click"),M.bindMarkerZoomBehavior(n,"contextmenu"),P.LayerArray[e].push(n)};for(X.Collectibles[e].length=P.Collectibles[e].needles.length,X.initializeChecklist(X.Collectibles[e],X.Collectibles[e].length,h,null,s),P.LayerArray[e]=[],P.Layer[e]=new L.layerGroup,t=0;t<m.needles.length;t++)if(n=t+1,r=m.needles[t],l=X.getChecklistItem(X.Collectibles[e],t),r.u&&void 0===r.l&&(r.l=r.u.toString()),p="<div class='mapLoc'><dfn>"+g+":</dfn> "+(r.l?r.l+" (#"+n+")":"#"+n)+(m.iscushion?"<br />"+D.getObjectName(r):""),r.s&&(p+="<img src='"+r.s+"' />"),r.t&&(p+="<div class='mapTip'>"+r.t+"</div>"),p+="</div>",i=0===t||t===m.needles.length-1?0:void 0===r.e?"":r.e,o={needleExtreme:i,needleIndex:t,needleType:e,needleKey:X.Collectibles[e].urlkey,needleLabel:m.iconsize?f+r.i+I.cPNG:void 0===r.l?n:r.l,title:p},m.iscushion)for(a=0;a<r.c.length;a++)v(r.c[a],o);else if(v(r.c,o),t<m.needles.length-1&&!1!==m.wantpath&&(d=2===r.e?"5,15":"1",u=L.polyline(M.convertGCtoLCDual([r.c,m.needles[t+1].c]),{color:"lime",dashArray:d,opacity:.5}),P.Layer[e].addLayer(u)),r.p)for(a=0;a<r.p.length-1;a++)u=L.polyline(M.convertGCtoLCDual([r.p[a],r.p[a+1]]),{color:"magenta",dashArray:"5,15",opacity:.5}),P.Layer[e].addLayer(u);M.toggleLayerArray(P.LayerArray[e],!0),M.toggleLayer(P.Layer[e],!0),$("#ned_"+e).change(function(){var t=$(this).prop("checked"),a=U.getSubstringFromHTMLID($(this));M.toggleLayerArray(P.LayerArray[a],t),M.toggleLayer(P.Layer[a],t),t?(M.goToArguments(P.Collectibles[a].view),P.rebindMarkerTooltips(),X.getCheckboxLabel($(this)).addClass("cltCheckedLabel")):X.getCheckboxLabel($(this)).removeClass("cltCheckedLabel"),"RangerPets"===e&&G.generatePetsList(m.needles,t)}),$("#nedUncheck_"+e).click(function(){var e=U.getSubstringFromHTMLID($(this)),t=P.LayerArray[e];for(var a in t)C(t[a],X.ChecklistEnum.Unfound);X.clearChecklist(X.Collectibles[e]),U.updateQueryString()}),$("#cltPins_"+e).click(function(){if(M.isPersonalPinsLaid())M.clearPersonalPins();else{var e=[],t=m.needles[0].c;if(!1===isNaN(t[0])){for(var a in m.needles)e.push(m.needles[a].c);M.redrawPersonalPath(e)}}})},getCollectibleURL:function(e,t){var a=U.convertAssocToArray(t).join(",");return a=a.length?a:"null",I.cSiteURL+"?"+e.urlkey+"="+a+"&bol_showPanel=false"},generatePetsList:function(e,t){var a="RangerPets",n=$("#cltSublist"+a),i=n.find(".cltSublistContainer");if(n.toggle(t),$(".cltPetIcon").removeClass("cltPetIconFocused"),!1!==i.is(":empty")){for(var r,o,s,c,l,u,d,p,h,m=D.getWord("s"),g=0;g<e.length;g++){r=e[g],c=D.getObjectName(r),l=U.getWikiLinkDefault("Juvenile "+D.getObjectDefaultName(r));var f="<div class='cltPetBox'><span class='cltPetIcon curToggle' title='"+c+"' style='background-image:url("+(h="img/collectible/rangerpets/"+r.i+I.cPNG)+")'><var class='cltPetIconBackground'>"+I.Symbol.Filler+"</var></span><aside class='cltPetFacts'>";for(var C in r.a)o=r.a[C],Array.isArray(o)?(p="("+o[1]+m+")",d=o[0]>1?"<var class='cltPetStack'>"+o[0]+"</var>"+p:p):d=o,f+="<span class='cltPetFact'><img class='cltPetFactIcon' src='img/fact/"+C+I.cPNG+"' /><var class='cltPetFactText'>"+d+"</var></span>";f+="</aside></div>",s=$(f).appendTo(i).data("keywords",c.toLowerCase()),function(e,t){s.find(".cltPetIcon").click(function(){var t=$(this).hasClass("cltPetIconFocused");if($(".cltPetIcon").removeClass("cltPetIconFocused"),t)M.toggleLayerArray(P.LayerArray[a],!0);else{for(var n=0;n<P.LayerArray[a].length;n++)(u=P.LayerArray[a][n]).options.needleIndex===e?M.toggleLayer(u,!0):M.toggleLayer(u,!1);$(this).addClass("cltPetIconFocused")}}).dblclick(function(){U.openExternalURL(t)})}(g,l)}I.qTip.init(i.find(".cltPetIcon"));var v=$("<div class='cntSearchContainer'></div>").insertBefore(i);I.createFilterBar(v,$(".cltPetBox")),setTimeout(function(){I.scrollToElement(n,{aContainer:"#plateMap"})},200)}else I.scrollToElement(n,{aContainer:"#plateMap"})},generateGuildUI:function(){var e=function(e,t,a){var n=D.getObjectName(P.Guild[e]),i=D.getObjectDefaultName(t),r=D.getObjectName(t),o=t.limit?" - "+t.limit:"",s="gld"+e+"_"+a;return $("<div class='gld"+e+"'><img class='cssWaypoint' "+I.cClipboardAttribute+"='"+t.wp+" "+n+": "+r+"' src='"+U.URL_IMG.Placeholder+"' /> <dfn id='"+s+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+r+o+"</dfn> <a href='"+U.getYouTubeLink(i)+"'>[Y]</a> <a href='"+U.getWikiLinkLanguage(r)+"'>[W]</a></div>").appendTo("#gldBook_"+e).data("keywords",r.toLowerCase()),$("#"+s)},t=function(e){var t="#gldBook_"+e;U.convertExternalLink(t+" a"),I.qTip.init(t+" dfn"),$(t+" .cssWaypoint").each(function(){I.bindClipboard($(this))});var a=$("<div class='cntSearchContainer'><div>").prependTo(t);I.createFilterBar(a,".gld"+e)},a=function(e){M.toggleLayerArray(P.LayerArray["Guild_"+e],!1),$("#gldBook_"+e+" dfn").each(function(){I.toggleHighlight($(this),!1)}),void 0!==P.Guild[e].usedSubmaps&&M.toggleSubmapArray(P.Guild[e].usedSubmaps,!1)};U.getScript(U.URL_DATA.Guild,function(){P.Guild=GW2T_GUILD_DATA;var n;for(n in P.Guild){var i=P.Guild[n],r=D.getObjectName(i);$("#gldButtons").append("<div class='gldButtonContainer'><button class='gldButton curToggle btnTab' id='gldButton_"+n+"' style='background-size:cover; background-image:url(img/guild/"+n.toLowerCase()+I.cPNG+")' title='<dfn>"+r+"</dfn><br />"+I.cSiteLink+"<dfn>guild/"+n.toLowerCase()+"</dfn>'></button><a class='gldLink cssButton' href='"+U.getYouTubeLink(r)+"'>Y</a>&nbsp;<a class='gldLink cssButton' href='"+D.getObjectURL(i)+"'>W</a></div>"),$("#gldBooks").append("<div class='gldBook' id='gldBook_"+n+"'></div>")}$(".gldBook").hide(),I.qTip.init("#gldButtons button"),U.convertExternalLink("#gldButtons a"),$(".gldButton").click(function(){$(".gldButton").removeClass("btnActive");var e=U.getSubstringFromHTMLID($(this)),t=!0;$("#gldBook_"+e).is(":visible")&&(a(e),t=!1),$(".gldBook").hide(),t&&($(this).addClass("btnActive"),$("#gldBook_"+e).show()),I.updateScrollbar()}),$("#mapToggle_Guild").data("hideonly",!0).click(function(){$(".gldButton").removeClass("btnActive").each(function(){a(U.getSubstringFromHTMLID($(this))),$(".gldBook").hide(),I.updateScrollbar()}),M.movePin(M.Pin.Program)}),$("#gldButton_Bounty").one("click",function(){U.sortObjects(P.Guild.Bounty.data);for(var a in P.Guild.Bounty.data){var n=P.Guild.Bounty.data[a],i=e("Bounty",n,a),r=new L.layerGroup;if(void 0!==n.paths)for(var o in n.paths)r.addLayer(P.drawDirectedPath(n.paths[o]));void 0!==n.spawn&&r.addLayer(P.drawSpots(n.spawn)),P.LayerArray.Guild_Bounty.push(r),i.attr("title","<div class='mapLoc'><img src='"+n.img+"' /></div>").click(function(){I.toggleHighlight($(this)),M.toggleLayer(P.LayerArray.Guild_Bounty[U.getSubintegerFromHTMLID($(this))])}),M.bindMapLinkBehavior(i,M.invertZoomLevel(n.coord[2]))}t("Bounty")}),$("#gldButton_Trek").one("click",function(){U.sortObjects(P.Guild.Trek.data);for(var a in P.Guild.Trek.data){var n=P.Guild.Trek.data[a],i=e("Trek",n,a),r=new L.layerGroup;r.addLayer(L.polyline(M.convertGCtoLCMulti(n.path),{color:"gold"})),P.LayerArray.Guild_Trek.push(r),i.attr("title","<div class='mapLoc'><img src='"+n.img+"' /></div>").click(function(){I.toggleHighlight($(this)),M.toggleLayer(P.LayerArray.Guild_Trek[U.getSubintegerFromHTMLID($(this))])}),M.bindMapLinkBehavior(i,M.ZoomEnum.Ground,M.Pin.Program)}t("Trek")}),$("#gldButton_Challenge").one("click",function(){P.Guild.Challenge.usedSubmaps=[],U.sortObjects(P.Guild.Challenge.data);for(var a in P.Guild.Challenge.data){var n=P.Guild.Challenge.data[a],i=e("Challenge",n,a);void 0!==n.submap&&(M.toggleSubmap(n.submap,!1),P.Guild.Challenge.usedSubmaps.push(n.submap));var r=new L.layerGroup;r.addLayer(L.polyline(M.convertGCtoLCMulti(n.path),{color:"gold"})),r.addLayer(P.drawSpots(n.spawn,{color:"gold"})),P.LayerArray.Guild_Challenge.push(r),i.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Challenge.data[e].submap,a=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,a),M.toggleLayer(P.LayerArray.Guild_Challenge[e])}),M.bindMapLinkBehavior(i,M.ZoomEnum.Ground,M.Pin.Program)}t("Challenge")}),$("#gldButton_Rush").one("click",function(){P.Guild.Rush.usedSubmaps=[],U.sortObjects(P.Guild.Rush.data);for(var a in P.Guild.Rush.data){var n=P.Guild.Rush.data[a],i=e("Rush",n,a);void 0!==n.submap&&(M.toggleSubmap(n.submap,!1),P.Guild.Rush.usedSubmaps.push(n.submap));var r=new L.layerGroup;r.addLayer(L.polyline(M.convertGCtoLCMulti(n.path),{color:"gold"})),r.addLayer(L.polyline(M.convertGCtoLCMulti(n.track),{color:"lime",dashArray:"5,10"})),r.addLayer(L.marker(M.convertGCtoLC(n.finish),{icon:M.createStandardIcon("img/map/chest.png")})),void 0!==n.traps0&&r.addLayer(P.drawSpots(n.traps0,{radius:5,color:"red",weight:1,opacity:1})),void 0!==n.traps1&&r.addLayer(P.drawSpots(n.traps1,{radius:10,color:"red",weight:1,opacity:1})),r.addLayer(P.drawSpots(n.flags,{radius:2,color:"gold",weight:2,opacity:1})),P.LayerArray.Guild_Rush.push(r),i.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Rush.data[e].submap,a=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,a),M.toggleLayer(P.LayerArray.Guild_Rush[e])}),M.bindMapLinkBehavior(i,M.ZoomEnum.Ground,M.Pin.Program)}t("Rush")}),$("#gldButton_Puzzle").one("click",function(){P.Guild.Puzzle.usedSubmaps=[],U.sortObjects(P.Guild.Puzzle.data);for(var a in P.Guild.Puzzle.data){var n=P.Guild.Puzzle.data[a],i=e("Puzzle",n,a);void 0!==n.submap&&(M.toggleSubmap(n.submap,!1),P.Guild.Puzzle.usedSubmaps.push(n.submap));var r=new L.layerGroup;r.addLayer(P.drawSpots(n.interactions,{color:"gold"})),r.addLayer(L.marker(M.convertGCtoLC(n.finish),{icon:M.createStandardIcon("img/map/chest.png")})),P.LayerArray.Guild_Puzzle.push(r),i.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Puzzle.data[e].submap,a=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,a),M.toggleLayer(P.LayerArray.Guild_Puzzle[e])}),M.bindMapLinkBehavior(i,M.ZoomEnum.Ground,M.Pin.Program)}t("Puzzle")});for(n in P.Guild)U.verifyArticle(n,function(){$("#gldButton_"+n).trigger("click")})})}},W={MapEnum:"wvw",OptionSuffix:"WvW",Continent:GW2T_CONTINENT_DATA.wvw,ZoneAssociation:GW2T_LAND_ASSOCIATION,Subzones:{},cInitialZone:"eternal",Floors:[],isMappingIconsGenerated:!1,ZoomEnum:{Adaptive:-2,Same:-1,Min:0,Overview:2,Default:3,Space:2,Sky:4,Bird:5,Ground:6,Max:6},Layer:{Overview:new L.layerGroup,Pin:new L.layerGroup,PersonalPin:new L.layerGroup,PersonalPath:new L.layerGroup,CompassIcon:new L.layerGroup,CompassCircle:new L.layerGroup,Destructible:new L.layerGroup,Secondaries:new L.layerGroup,Objective:new L.layerGroup,SpawnLabel:new L.layerGroup},LayerArray:{},Pin:{Program:{},Event:{},Over:{},Character:{},Camera:{}},LocaleThreshold:{Range:99,AmericasPrefix:"1",Americas:1e3,Europe:2e3,EuropePrefix:"2",France:2100,Germany:2200,Spain:2300},LocaleEnum:{Americas:"Americas",Europe:"Europe"},LeaderboardURL:{Americas:"https://leaderboards.guildwars2.com/en/na/wvw",Europe:"https://leaderboards.guildwars2.com/en/eu/wvw"},LocaleCurrent:null,Rotation:null,LandPrefix:{},isWvWPrepped:!1,isWvWLoaded:!1,isWvWPaused:!1,Metadata:{},Servers:{},Matches:null,MatchupCurrent:null,Guilds:{},Objectives:{},ObjectiveTimeout:{},ObjectiveTimestampIgnore:null,Compasses:{},Placement:{},MapType:{},LandEnum:{},ObjectiveEnum:{},OwnerEnum:{},MatchupIDCurrent:null,isObjectiveTickEnabled:!1,isObjectiveTimerTickEnabled:!1,isAPIFailed:!1,isFallbackEnabled:!1,numFailedAPICalls:0,cOWNERS_PER_TIER:3,cLEADERBOARD_SERVERS_CHAR_LIMIT:32,cTOTAL_PPT_POSSIBLE:0,cSECONDS_IMMUNITY:300,cMSECONDS_IMMUNITY:3e5,MatchStartTimeMS:null,MatchFinishTimeMS:null,MatchFinishTimeISO:null,secTillWvWReset:null,numSiegeSupply:0,initializeBorderlands:function(){W.Rotation=W.Metadata.Rotation;for(var e in W.Rotation){var t=W.Rotation[e];W.Zones[t]=GW2T_LAND_ADD[t],W.LandPrefix[e]=W.Zones[t].id+"-"}$(".wvwZoneListBorderlands").each(function(){var e=W.Rotation[$(this).attr("data-zone")];$(this).attr("data-zone",e)})},initializeWvW:function(e){var t=new Date;$.extend(W,$.extend({},M,W)),W.Regions=GW2T_REALM_DATA,W.Zones=GW2T_LAND_DATA,W.Servers=GW2T_SERVER_DATA,W.Compasses=GW2T_WEAPON_DATA,W.Metadata=GW2T_WVW_METADATA,W.Placement=GW2T_PLACEMENT_DATA,W.MapType=W.Metadata.MapType,W.LandEnum=W.Metadata.LandEnum,W.ObjectiveEnum=W.Metadata.ObjectiveEnum,W.OwnerEnum=W.Metadata.OwnerEnum,W.initializeBorderlands(),W.computeObjectivesValue(),W.initializeObjectives(),W.initializeMap(),W.populateWvW(),W.initializeLeaderboard(),W.initializeLog(),W.reinitializeServerChange(),W.generateServerList(),I.styleContextMenu("#wvwContext"),U.convertExternalLink("#wvwHelpLinks a"),$("#wvwToolsButton").one("mouseenter",W.initializeSupplyCalculator),$("#wvwHUDContainer").toggle(O.Options.bol_showHUDWvW),W.isWvWLoaded=!0,e===I.SpecialPageEnum.Leaderboard?$("#lboRegion").trigger("click"):U.openSectionFromURL({aButton:"#lboRegion",aSection:"Leaderboard"});var a=H.getAnnouncement(H.Announcement.NewsWVW,t);a&&W.addLogEntry(a)},initializeObjectives:function(){var e=GW2T_OBJECTIVE_DATA;for(var t in W.Rotation){var a=e[W.Rotation[t]];for(var n in a)W.Objectives[n]=a[n]}},populateWvW:function(){var e,t,a;for(var n in W.Objectives)a=(e=W.Objectives[n]).type===W.ObjectiveEnum.Ruins||e.type===W.ObjectiveEnum.Bloodlust?"objSubobjective":"",t=L.marker(W.convertGCtoLC(e.coord),{clickable:!0,riseOnHover:!0,icon:L.divIcon({className:"",html:"<div id='obj_"+e.id+"' class='objContainer "+a+"'><span class='objUmbrellaContainer'><span class='objUmbrellaOuter'><span id='objUmbrella_"+e.id+"' class='objUmbrella'></span></span></span><time id='objTimer_"+e.id+"' class='objTimer'></time><span class='objProgressContainer'><span id='objProgressBar_"+e.id+"' class='objProgressBar'><var id='objProgress_"+e.id+"' class='objProgress'></var></span></span><span class='objIconContainer'><img id='objIcon_"+e.id+"' class='objIcon' src='"+U.URL_IMG.Placeholder+"'/></span><span class='objInfo'><cite id='objClaim_"+e.id+"' class='objClaim'></cite> <cite id='objAge_"+e.id+"' class='objAge'></cite></span></div>",iconSize:[38,38],iconAnchor:[19,19]})}),function(e){t.on("click",function(){e.data&&I.prettyJSON(e.data)})}(e),W.bindMarkerZoomBehavior(t,"contextmenu"),e.Marker=t,W.Layer.Objective.addLayer(t);W.toggleLayer(W.Layer.Objective,!0);var i=W.Metadata.SpawnLabels;for(var n in W.Rotation){var r=i[W.Rotation[n]];for(var o in r){var s=r[o];t=L.marker(W.convertGCtoLC(s),{icon:L.divIcon({className:"mapSec",html:"<span class='mapSecIn wvwSpawnContainer wvwColor"+o+"' id='wvwSpawn_"+n+"_"+o+"' data-owner='"+o+"'><var class='wvwSpawnLabel'></var></span>",iconSize:[128,64],iconAnchor:[64,32]})}),function(e,a){t.on("click",function(){$("#wvwZoneLink"+("Center"===e?"Center":a)).trigger("click")}),t.on("dblclick",function(){$("#wvwZoneLink"+("Center"===e?"Center":a)).trigger("dblclick")}),t.on("contextmenu",function(){W.goToDefault()})}(n,o),W.Layer.SpawnLabel.addLayer(t)}}W.toggleLayer(W.Layer.SpawnLabel,!0),W.toggleObjectiveLabels(),I.isProjectionEnabled?W.toggleFloor(!1):W.toggleFloor(!0),!1===O.Options.bol_showWorldCompletionWvW&&W.finishPopulation()},finishPopulation:function(){W.toggleSecondaries(),W.toggleWalls(),W.bindMapVisualChanges(),W.adjustZoomMapping(),W.executeURLCommands()},toggleSecondaries:function(e){if(O.Options.bol_showSecondaries&&0===W.Layer.Secondaries.getLayers().length){var t=function(e,t,a){if(void 0!==e)for(var n in e){var i=W.Metadata.Offsets[a],r=e[n],o=L.marker(W.convertGCtoLC([r[0]+i[0],r[1]+i[1]]),{clickable:!1,icon:L.icon({iconUrl:"img/wvw/secondaries/"+t+I.cPNG,iconSize:[32,32],iconAnchor:[16,16]}),opacity:.9});W.Layer.Secondaries.addLayer(o)}};for(var a in W.Rotation){var n=W.Rotation[a],i=W.Metadata.PlacementAssociation[n],r=W.Placement[i];t(r.ShrineEarth,"shrine_earth",n),t(r.ShrineFire,"shrine_fire",n),t(r.ShrineAir,"shrine_air",n),t(r.Sentry,"sentry",n),t(r.Depot,"depot",n)}e&&W.adjustZoomMapping()}W.toggleLayer(W.Layer.Secondaries,O.Options.bol_showSecondaries)},toggleWalls:function(e){var t="coral",a="orange",n="yellow";if(O.Options.bol_showDestructibles&&0===W.Layer.Destructible.getLayers().length){var i=function(e,t,a){var n=W.Metadata.Offsets[a];for(var i in e){var r=e[i],o=[r[0][0]+n[0],r[0][1]+n[1]],s=[r[1][0]+n[0],r[1][1]+n[1]],c=L.polyline(W.convertGCtoLCDual([o,s]),{clickable:!1,color:t,opacity:.8,weight:10,lineCap:"butt"});W.Layer.Destructible.addLayer(c)}};for(var r in W.Rotation){var o=W.Rotation[r],s=W.Metadata.PlacementAssociation[o],c=W.Placement[s];i(c.Barricade,t,o),i(c.Wall,a,o),i(c.Gate,n,o)}e&&W.adjustZoomMapping()}W.toggleLayer(W.Layer.Destructible,O.Options.bol_showDestructibles)},toggleObjectiveLabels:function(){$(".objInfo, .wvwSpawnContainer").toggle(O.Options.bol_showObjectiveLabels)},getWorldRelink:function(e){var t=e,a=new Date(e),n=a.getUTCMonth(),i=a.getUTCFullYear();n%2==0&&(n=n%T.cMONTHS_IN_YEAR+1,a.setUTCMonth(n));for(var r=T.getDaysInMonth(a);r>0;r--)if(new Date(i,n,r).getDay()===t.getUTCDay()){a.setUTCDate(r);break}if(a<t){var o=n+1;return a.setUTCMonth(o),o>=T.cMONTHS_IN_YEAR&&(a.setUTCFullYear(i+1),a.setUTCMonth(o%T.cMONTHS_IN_YEAR)),W.getWorldRelink(a)}return a},getName:function(e){return D.getObjectName(W.Metadata[e])},getNick:function(e){return D.getObjectNick(W.Metadata[e])},formatMatchup:function(e){var t,a,n,i,r,o=2,s=0,c=W.Metadata.Teams.length,l=W.Metadata.Teams,u=new Array(c),d=new Array(c),p=new Array(c),h=new Array(c),m=new Array(c),g=new Array(c),f=new Array(c),C={};if(C.id=s,e.wvw_match_id){s=e.wvw_match_id;for(b=0;b<c;b++)n=e[(t=l[b])+"_world_id"],u[b]=new Array,u[b].push(W.Servers[n]);C.worlds=W.convertWorlds(e)}else{s=e.id;for(var v=e.all_worlds,b=0;b<c;b++){i=v[t=l[b]],r=e.worlds[t],u[b]=new Array,u[b].push(W.Servers[r]);for(y=0;y<i.length;y++)i[y]!==r&&u[b].push(W.Servers[i[y]])}C.worlds=e.worlds}var S=function(e){return U.escapeHTML(D.getObjectName(W.Servers[C.worlds[e]]))},T=W.getName("Borderlands");C.RedHome=D.orderModifier(T,S("red")),C.BlueHome=D.orderModifier(T,S("blue")),C.GreenHome=D.orderModifier(T,S("green")),C.Center=W.getName("Center");for(b=0;b<c;b++){t=l[b],a=U.toFirstUpperCase(t),p[b]=new Array,h[b]=new Array,m[b]=new Array,g[b]=new Array,f[b]=D.getObjectName(W.Metadata[a]);for(var y=0;y<u[b].length;y++){var I=u[b][y];I.owner=a;var k=U.escapeHTML(D.getObjectName(I)),E="";0===y&&(d[b]=I,u[b].length>1&&(E="+")),0===E.length&&u[b].length>=o||u[b].length>o?(p[b]+=D.getObjectNick(I)+E,m[b]+="<a href='?page=WvW&enu_Server="+I.id+"' title='"+k+"'>"+D.getObjectNick(I)+E+"</a>"):(p[b]+=k+E,m[b]+="<a href='?page=WvW&enu_Server="+I.id+"'>"+k+E+"</a>"),h[b]+=k+E,g[b]+=D.getObjectNick(I)+E,u[b].length>1&&y<u[b].length-1&&(p[b]+=" &amp; ",h[b]+="<br />",m[b]+=" &amp; ",g[b]+=" "),I.id===O.Options.enu_Server&&(C.oOwnerCurrent=a)}}for(b=0;b<c;b++)t=l[b],C[t]={oServers:u[b],oHost:d[b],oNameStr:p[b],oNameLinesStr:h[b],oNameLinksStr:m[b],oNickStr:g[b],oColor:f[b]};return C},getTeamFromOwner:function(e){return W.MatchupCurrent[e.toLowerCase()]},getBorderlandsString:function(e,t){var a,n,i=t||{},r="string"==typeof e?W.Servers[W.MatchupCurrent.worlds[e]]:e,o=e.map_type;if(void 0!==o){var s=W.MapType[o];if("center"===s)return W.getNick("Center");r=W.Servers[W.MatchupCurrent.worlds[s]]}return a=i.aWantServerNick?D.getObjectNick(r):D.getObjectName(r),n=i.aWantBorderlandsNick?W.getNick("Borderlands"):W.getName("Borderlands"),i.aWantPronoun&&r.owner===W.MatchupCurrent.oOwnerCurrent?W.getName("Our")+" "+n:D.orderModifier(n,a)},getObjectiveNick:function(e,t){return void 0!==e.direction?(t?W.getName(e.direction):W.getNick(e.direction))+" "+W.getName(e.type):void 0!==e.alias?W.getName(e.alias):D.getObjectNick(e)},getObjectiveImage:function(e,t){var a=t||e.owner;return e.type===W.ObjectiveEnum.Ruins?"img/wvw/ruins/"+(e.direction+"_"+a).toLowerCase()+I.cPNG:e.type===W.ObjectiveEnum.Bloodlust?"img/wvw/ruins/"+(e.alias+"_"+a).toLowerCase()+I.cPNG:"img/wvw/objectives/"+(e.type+"_"+a).toLowerCase()+I.cPNG},computeObjectivesValue:function(){var e,t,a=W.Metadata.ObjectiveType;for(var n in a)e=a[n].Value.Each,a[n].Value.Borderlands=a[n].Quantity.Borderlands*e,a[n].Value.Battlegrounds=a[n].Quantity.Battlegrounds*e,a[n].Value.All=(a[n].Value.Borderlands+a[n].Value.Battlegrounds)*W.cOWNERS_PER_TIER,t=a[n].Quantity.isUnique?e:0,W.cTOTAL_PPT_POSSIBLE+=a[n].Value.All+t},getObjectiveTypeValue:function(e){return W.Metadata.ObjectiveType[e].Value.Each},getMatchupTier:function(e){var t=W.isFallbackEnabled?"match_id":"id";return parseInt(e[t].split("-")[1])},generateServerList:function(){var e=[];for(var t in W.Servers)e.push(W.Servers[t]);U.sortObjects(e);var a=$("#wvwServerListContainer"),n=[];e.forEach(function(e){n.push({name:D.getObjectName(e)+(e.suffix?" "+e.suffix:""),icon:"img/ui/flags/"+(e.suffix?U.stripToAlphanumeric(e.suffix).toLowerCase():"na")+I.cPNG,id:e.id})}),I.createSearchBar(a,{aBarID:"wvwServerListBar",aResultsClass:"wvwServerListResults",aIsSelect:!0,aWantClose:!0,aDatabase:n,aFillerText:D.getPhraseOriginal("Select Server"),aCallback:function(e){O.Options.enu_Server=e.id,localStorage.enu_Server=O.Options.enu_Server,U.updateQueryString("enu_Server="+e.id),W.reinitializeServerChange()}}),I.preventMapPropagation(a)},initializeLeaderboard:function(){$("#lboToggle").click(function(){$("#opt_bol_showLeaderboard").trigger("click")}),$("#lboCondense").click(function(){$("#opt_bol_condenseLeaderboard").trigger("click")}),$("#lboRegion").click(function(){W.toggleRegionLeaderboard()}),$("#lboStats").click(function(){W.generateStats()}),$("#lboOpaque").click(function(){$("#opt_bol_opaqueLeaderboard").trigger("click")}),$("#lboCountdown").click(function(){U.openExternalURL(W.LeaderboardURL[W.LocaleCurrent])}),W.toggleLeaderboard(),W.opaqueLeaderboard(),W.toggleLeaderboardWidth(),I.bindScrollbar("#lboOther")},toggleRegionLeaderboard:function(){var e=$("#lboOther");if(!1!==e.is(":empty")&&null!==W.LocaleCurrent){var t=W.Metadata.MatchIDs[W.LocaleCurrent];for(var a in t){var n=t[a],i=W.isFallbackEnabled?U.URL_API.MatchFallback+n:U.URL_API.Matches+n,r="lboOther_"+n;n!==W.MatchupIDCurrent&&(e.append("<div id='"+r+"'></div>"),function(e,t){$.getJSON(i,function(a){var n=W.isFallbackEnabled?W.formatMatchup(W.Matches[t]):W.formatMatchup(a);W.insertScoreboard(a,n,$("#"+e)),W.readjustLeaderboard(),I.updateScrollbar("#lboOther")})}(r,n))}}else e.animate({height:0},"fast",function(){e.empty().css({height:"auto"})})},insertScoreboard:function(e,t,a){var n,i,r,o,s,c,l,u,d=function(e){return W.isFallbackEnabled?{red:e[0],blue:e[1],green:e[2]}:e},p=function(){return{red:0,blue:0,green:0}},h=t||W.MatchupCurrent,m=W.Metadata.Owners.length,g=W.getMatchupTier(e),f=d(e.scores),C=e.victory_points||p(),v={},b=!0;for(var S in W.Metadata.Owners){v[_=W.Metadata.Owners[S]]={},v[_].Total=0,v[_][W.LandEnum.RedHome]=0,v[_][W.LandEnum.BlueHome]=0,v[_][W.LandEnum.GreenHome]=0,v[_][W.LandEnum.Center]=0;for(var y in W.Metadata.Owners)v[_][W.LandEnum.Center+W.Metadata.Owners[y]]=0}for(var S in e.maps){n=e.maps[S],o=W.LandPrefix[n.type];for(var y in n.objectives)r=n.objectives[y],s=W.isFallbackEnabled?o+r.id:r.id,void 0!==(i=W.Objectives[s])&&(_=r.owner,c=i.map_type,l=W.getObjectiveTypeValue(i.type),u=i.nativeowner,_!==W.OwnerEnum.Neutral&&(v[_].Total+=l,v[_][c]+=l,c===W.LandEnum.Center&&(v[_][W.LandEnum.Center+u]+=l)))}var k;void 0===a?((k=$("#lboCurrent")).empty(),(I.ModeCurrent===I.ModeEnum.Overlay||I.isProgramEmbedded)&&(b=!1)):k=a;for(var E="<section>",S=0;S<m;S++){var _=W.Metadata.Owners[S],P=_.toLowerCase(),A=(g-1)*W.cOWNERS_PER_TIER+(S+1),L=b?"<aside class='lboRank'>"+A+".</aside><aside class='lboName'>&nbsp;"+h[P].oNameLinksStr+"</aside>":"",M=f[P],w=T.getMinMax(f).oMax,x=f[P]/w*T.cPERCENT_100,N=C[P],B=T.getMinMax(C).oMax,R=C[P]/B*T.cPERCENT_100,H=v[_].Total,z=H/W.cTOTAL_PPT_POSSIBLE*T.cPERCENT_100,G="";if(void 0!==e.kills&&!1===W.isFallbackEnabled){var F,j,Z=void 0!==e.kills?e.kills[P]:"",K=void 0!==e.deaths?e.deaths[P]:"",X=T.parseRatio(Z/K,2),q="",Q=T.parseRatio(T.clampCeil(Z/K,2)/2)*T.cPERCENT_100;e.maps.forEach(function(e){F=e.kills[P],j=e.deaths[P],q+="<dfn>"+F+" : "+j+" ("+T.parseRatio(F/j,2)+")</dfn> on "+h[e.type]+"<br />"}),G="<aside class='lboKD' title='<dfn>Kills to Deaths ratio: "+X+"</dfn><br />"+q+"'><var class='lboKills'>"+Z.toLocaleString()+"</var><samp><s style='width:"+Q+"%'><mark></mark></s></samp><var class='lboDeaths'>"+K.toLocaleString()+"</var></aside>"}for(var V=[],J=[],Y=[],ee=[],y=0;y<m;y++){var te=W.Metadata.Owners[y],ae=te.toLowerCase();if(te!==_){var ne=v[_][te+"Home"]+v[_][W.LandEnum.Center+te];V.push(ne),J.push(M-f[ae]),Y.push(N-C[ae]);var ie=W.Servers[h.worlds[ae]];ee.push(U.escapeHTML(D.getObjectName(ie)))}}var re,oe,se=V[0]+V[1],ce="";se>0?(re=Math.round(V[0]/se*T.cPERCENT_100),oe=Math.round(V[1]/se*T.cPERCENT_100)):(re=0,oe=0,ce="lboFocusZero");var le,ue;for(var y in e.maps){var de=d((n=e.maps[y]).scores);switch(n.type){case W.Metadata.Opposites[_][0]+"Home":le=de[P];break;case W.Metadata.Opposites[_][1]+"Home":ue=de[P]}}var pe,he,me=le+ue,ge="";me>0?(pe=Math.round(le/me*T.cPERCENT_100),he=Math.round(ue/me*T.cPERCENT_100)):(pe=0,he=0,ge="lboFocusZero"),E+="<article class='lboServer lboServer"+_+"'>"+L+(W.isFallbackEnabled?"<aside class='lboScoreLegacy' title='<dfn>"+J[0]+" points</dfn> away from "+ee[0]+"<br /><dfn>"+J[1]+" points</dfn> away from "+ee[1]+"'><var>"+M.toLocaleString()+"</var><samp><s style='width:"+x+"%'></s></samp></aside><aside class='lboPPTLegacy' title='<dfn>Points-Per-Tick (PPT)</dfn>'><samp><s style='width:"+z+"%'></s></samp><var>+"+H+"</var></aside>":"<aside class='lboVictory' title='<dfn>"+Y[0]+" points</dfn> away from "+ee[0]+"<br /><dfn>"+Y[1]+" points</dfn> away from "+ee[1]+"'><var><img class='lboVictoryIcon' src='img/wvw/victorypoint.png' />"+N.toLocaleString()+"</var><samp><s style='width:"+R+"%'></s></samp></aside><aside class='lboPPT' title='<dfn>Points-Per-Tick (PPT)</dfn>'><samp><s style='width:"+z+"%'></s></samp><var>+"+H+"</var></aside>")+"<aside class='lboLand' title='<dfn>PPT per borderlands</dfn>'><var class='lboPPTGreen'>+"+v[_][W.LandEnum.GreenHome]+"</var><var class='lboPPTBlue'>+"+v[_][W.LandEnum.BlueHome]+"</var><var class='lboPPTRed'>+"+v[_][W.LandEnum.RedHome]+"</var><var class='lboPPTCenter'>+"+v[_][W.LandEnum.Center]+"</var></aside>"+G+"<aside class='lboFocus lboFocus"+_+"' title='<dfn>Server Focus (PPT Now)</dfn><br /><dfn>"+V[0]+" PPT</dfn> earnable from "+ee[0]+" native objectives<br /><dfn>"+V[1]+" PPT</dfn> earnable from "+ee[1]+" native objectives'><var class='lboFocusA'>"+re+"%</var><samp class='"+ce+"'><s style='width:"+re+"%'><mark></mark></s></samp><var class='lboFocusB'>"+oe+"%</var></aside><aside class='lboFocus lboFocus"+_+"' title='<dfn>Server Focus (Points Matchup)</dfn><br /><dfn>"+le+" points</dfn> earned from "+ee[0]+" Borderlands<br /><dfn>"+ue+" points</dfn> earned from "+ee[1]+" Borderlands'><var class='lboFocusA'>"+pe+"%</var><samp class='"+ge+"'><s style='width:"+pe+"%'><mark></mark></s></samp><var class='lboFocusB'>"+he+"%</var></aside></article>"}E+="</section>",k.append(E),I.qTip.init(k.find("aside, a")),O.Options.bol_condenseLeaderboard&&W.toggleLeaderboardWidth()},toggleLeaderboard:function(){O.Options.bol_showLeaderboard?(W.updateObjectives(),$("#lboCurrent, #lboOther").show("fast",function(){$("#lboContainer").css({padding:(I.ModeCurrent===I.ModeEnum.Overlay?0:8)+"px"})}),$(".lboExtra").show()):($("#lboCurrent, #lboOther").hide("fast",function(){$("#lboContainer").css({padding:0})}),$(".lboExtra").hide())},opaqueLeaderboard:function(){I.toggleHUDOpacity("#lboContainer","lbo",O.Options.bol_opaqueLeaderboard)},toggleLeaderboardWidth:function(e){var t=!O.Options.bol_condenseLeaderboard,a=$(".lboRank, .lboLand, .lboFocus");e?t?a.show("fast"):a.hide("fast"):a.toggle(t)},readjustLeaderboard:function(){$("#lboOther").css({maxHeight:$(window).height()-2*$("#lboCurrent").height()})},generateStats:function(){I.isConsoleShown()||(I.print(I.cThrobber,!0),E.updateCoinInGem(function(){$.getJSON(U.getAPI("worlds",!0),function(e){e.forEach(function(e){e.sortablePopulation=W.Metadata.PopulationPercent[e.population]}),U.sortObjects(e,{aKeyName:"sortablePopulation",aIsDescending:!0});var t="<table id='wvwStats' class='cssStats'>";t+="<thead><tr><th>Server</th><th>ID</th><th>Population</th><th>Transfer</th><th>Conversion</th></tr></thead><tbody>",e.forEach(function(e){if(e.id.toString().charAt(0)===W.LocaleThreshold[W.LocaleCurrent+"Prefix"]){var a=U.escapeHTML(D.getObjectName(W.Servers[e.id])),n=W.Metadata.PopulationTransfer[e.population];t+="<tr><td><a class='wvwStatsLink wvwPopulation_"+U.escapeHTML(e.population)+"' href='?page=WvW&enu_Server="+e.id+"'>"+a+"</a></td><td>"+e.id+"</td><td>"+I.getBar(W.Metadata.PopulationPercent[e.population])+"</td><td>"+E.formatGemString(n,!0)+"</td><td>"+E.formatGemToCoin(n)+"</td></tr>"}}),t+="</tbody></table>",I.print(t,!0)})}))},initializeLog:function(){$("#wvwLogContainer").show(),$("#logWindow").data("oldHeight",$("#logWindow").height()),$("#logToggle").click(function(){$("#opt_bol_showLog").trigger("click")}),$("#logExpand").click(function(){$("#opt_bol_maximizeLog").trigger("click")}),$("#logOpaque").click(function(){$("#opt_bol_opaqueLog").trigger("click")}),W.toggleLog(!0),W.opaqueLog(),W.toggleLogHeight(),I.bindScrollbar("#logWindow"),I.loadImg($("#wvwLog")),O.mimicInput("#wvwZoomInput","int_setInitialZoomWvW");for(var e in W.MapType)!function(e){$("#opt_bol_log"+e).change(function(){O.Options["bol_log"+e]?$(".logEntry"+e).show("fast",function(){I.updateScrollbar("#logWindow")}):$(".logEntry"+e).hide("fast",function(){I.updateScrollbar("#logWindow")})}).parent().dblclick(function(){$("#logFilters input:checkbox").each(function(){X.setCheckboxEnumState($(this),X.ChecklistEnum.Unchecked)}),X.setCheckboxEnumState($("#opt_bol_log"+e),X.ChecklistEnum.Checked)})}(e);var t=W.getName("Borderlands");X.relabelCheckbox("#opt_bol_narrateRedHome",D.orderModifier(t,W.getName("Red"))),X.relabelCheckbox("#opt_bol_narrateBlueHome",D.orderModifier(t,W.getName("Blue"))),X.relabelCheckbox("#opt_bol_narrateGreenHome",D.orderModifier(t,W.getName("Green"))),X.relabelCheckbox("#opt_bol_narrateCenter",W.getName("Center")),X.relabelCheckbox("#opt_bol_narrateRuins",W.getName("Ruins")),X.relabelCheckbox("#opt_bol_narrateCamp",W.getName("Camp")),X.relabelCheckbox("#opt_bol_narrateTower",W.getName("Tower")),X.relabelCheckbox("#opt_bol_narrateKeep",W.getName("Keep")),X.relabelCheckbox("#opt_bol_narrateCastle",W.getName("Castle")),X.relabelCheckbox("#opt_bol_narrateClaimed",W.getName("Claimed")),I.preventMapPropagation(O.mimicInput("#logNarrateVolume","int_setVolume")),O.Enact.bol_logNarrate(),$("#logTime").click(function(){$("#opt_bol_use24Hour").trigger("click"),$("#logWindow li time").each(function(){var e=T.getTimeFormatted({aCustomTimeInDate:new Date($(this).attr("data-time"))});$(this).html(e)})}),$("#wvwPause").click(function(){W.isWvWPaused=!W.isWvWPaused,W.isWvWPaused?(W.addLogEntry("WvW updating paused."),D.stopSpeech()):(W.addLogEntry("WvW updating resumed."),W.updateObjectives())})},toggleLog:function(e){I.toggleElement("#wvwLog, .logExtra",O.Options.bol_showLog,"fast",e)},opaqueLog:function(){I.toggleHUDOpacity("#wvwLog","log",O.Options.bol_opaqueLog)},toggleLogHeight:function(){var e=$("#logWindow"),t=$(window).height(),a=e.data("oldHeight"),n=t-(I.ModeCurrent===I.ModeEnum.Overlay?164:210);O.Options.bol_maximizeLog?e.show().animate({height:n},200,function(){I.updateScrollbar(e),O.Options.bol_maximizeLog=!0}):e.show().animate({height:a},200,function(){I.updateScrollbar(e),O.Options.bol_maximizeLog=!1})},readjustLog:function(){$("#wvwLog").height()>$(window).height()&&$("#logExpand").trigger("click").trigger("click")},addLogEntry:function(e,t,a,n){e=e||"",t=t||"";var i="";void 0===a?(i=T.getTimeFormatted(),a=(new Date).toISOString()):i=T.getTimeFormatted({aCustomTimeInDate:new Date(a)});var r=$("<li class='logEntry "+t+"'><time data-time='"+a+"'>"+i+"</time><span>"+e+"</span></li>").prependTo("#logWindow");if(this.bindMapLinkBehavior(r.find("dfn")),!1===n)r.hide();else{var o=r.width();r.css({width:0}).animate({width:o},400,function(){$(this).removeAttr("style")})}var s=$(".logEntry");s.length>O.Options.int_numLogEntries&&s.last().remove(),I.updateScrollbar("#logWindow")},addLogEntryObjective:function(e,t){var a,n="<img src='"+W.getObjectiveImage(e,e.prevowner)+"' />",i="<img src='"+W.getObjectiveImage(e,e.owner)+"' />",r=W.getObjectiveNick(e,!1);t?(n=i,i="<cite>"+e.oTag+"</cite>",a=e.claimed_at):a=e.last_flipped;var o=n+" ⇒ "+i+" <dfn data-coord='"+e.coord+"'>"+r+"</dfn>",s=e.map_type,c="logEntry"+s;t||(e.prevownerhtml=o);var l=!0;(s===W.LandEnum.RedHome&&!1===O.Options.bol_logRedHome||s===W.LandEnum.BlueHome&&!1===O.Options.bol_logGreenHome||s===W.LandEnum.GreenHome&&!1===O.Options.bol_logBlueHome||s===W.LandEnum.Center&&!1===O.Options.bol_logCenter)&&(l=!1),W.addLogEntry(o,c,a,l),O.Options.bol_logNarrate&&W.narrateLog(e,t)},narrateLog:function(e,t){var a=e.map_type,n=e.type;if(!(t&&!1===O.Options.bol_narrateClaimed||a===W.LandEnum.RedHome&&!1===O.Options.bol_narrateRedHome||a===W.LandEnum.BlueHome&&!1===O.Options.bol_narrateBlueHome||a===W.LandEnum.GreenHome&&!1===O.Options.bol_narrateGreenHome||a===W.LandEnum.Center&&!1===O.Options.bol_narrateCenter||n===W.ObjectiveEnum.Bloodlust&&!1===O.Options.bol_narrateRuins||n===W.ObjectiveEnum.Ruins&&!1===O.Options.bol_narrateRuins||n===W.ObjectiveEnum.Camp&&!1===O.Options.bol_narrateCamp||n===W.ObjectiveEnum.Tower&&!1===O.Options.bol_narrateTower||n===W.ObjectiveEnum.Keep&&!1===O.Options.bol_narrateKeep||n===W.ObjectiveEnum.Castle&&!1===O.Options.bol_narrateCastle)){var i,r=W.getObjectiveNick(e,!0);i=t?D.getSpeechInitials(e.oTagInitial):e.owner===W.MatchupCurrent.oOwnerCurrent?W.getName("Us"):D.getSpeechInitials(D.getObjectNick(W.getTeamFromOwner(e.owner).oHost));var o,s=($("#logNarrateLand input:checked").length>1?W.getBorderlandsString(e,{aWantPronoun:!0})+". ":"")+r,c=(o=t?W.getName("Claimed"):e.owner===e.nativeowner?W.getName("Retaken"):W.getName("Captured"))+" "+i;D.speak(s),D.speak(c)}},initializeSupplyCalculator:function(){var e=function(e,t){var a=e.html();if(a=""===a?0:parseInt(a),!(t<0&&0===a)){var n=t<0?-1:1;W.numSiegeSupply+=t,$("#splNeed").html(W.numSiegeSupply);var i=a+n;0===i?(e.removeClass("splAdded"),i=""):e.addClass("splAdded"),e.html(i)}};I.preventMapPropagation("#wvwSupply");for(var t in W.Metadata.BlueprintGrade)for(var a in W.Metadata.BlueprintType){var n=W.Metadata.BlueprintGrade[t],i=$("<ins class='spl spl_"+n.toLowerCase()+"_"+a+"'></ins>"),r=W.Metadata.BlueprintType[a][t];$("#splBlueprints"+n).append(i),function(t){i.click(function(){e($(this),t),$("#splHave").trigger("input")}),i.contextmenu(function(){return e($(this),-1*t),$("#splHave").trigger("input"),!1})}(r)}$("#splReset").click(function(){$("#splBlueprints ins").html("").removeClass("splAdded"),$("#splNeed").html("0"),W.numSiegeSupply=0,$("#splHave").trigger("input")}),$("#splHave").click(function(){$(this).select()}).on("input",function(){var e=T.parseQuantity($(this).val(),0)-W.numSiegeSupply,t=$("#splRemain").html(e);I.colorizeValue(t,e)})},updateParticipants:function(){null!==W.MatchupCurrent&&(X.relabelCheckbox("#opt_bol_logRedHome",W.MatchupCurrent.red.oNameStr),X.relabelCheckbox("#opt_bol_logBlueHome",W.MatchupCurrent.blue.oNameStr),X.relabelCheckbox("#opt_bol_logGreenHome",W.MatchupCurrent.green.oNameStr),X.relabelCheckbox("#opt_bol_logCenter",W.getName("Center")),$("#wvwZoneLinkRed").html(W.MatchupCurrent.red.oNameStr),$("#wvwZoneLinkBlue").html(W.MatchupCurrent.blue.oNameStr),$("#wvwZoneLinkGreen").html(W.MatchupCurrent.green.oNameStr),W.addLogEntry($("#wvwHelpLinks").html()+"<br /><br /><br />"),W.addLogEntry(W.MatchupCurrent.green.oNickStr+" : "+W.MatchupCurrent.blue.oNickStr+" : "+W.MatchupCurrent.red.oNickStr),$(".wvwSpawnContainer").each(function(){var e=$(this).attr("data-owner").toLowerCase(),t=W.MatchupCurrent[e].oNameLinesStr;$(this).find(".wvwSpawnLabel").html(t)}))},reinitializeServerChange:function(e){for(var t in W.Objectives){var a=W.Objectives[t];a.isImmune=!1,a.owner=null,a.last_flipped=null,a.last_flipped_msec=null,a.claimed_by="none",a.claimed_at=null,a.prevownerhtml=null}W.LocaleCurrent=O.Options.enu_Server>=W.LocaleThreshold.Europe?W.LocaleEnum.Europe:W.LocaleEnum.Americas,W.MatchupIDCurrent=null,W.MatchStartTimeMS=null,W.MatchFinishTimeMS=null,W.MatchFinishTimeISO=null,W.MatchupCurrent=null,$(".objUmbrellaContainer").hide(),$(".objTimer").empty(),$(".objProgressBar").hide(),$("#lboCurrent").empty().append(I.cThrobber),$("#lboOther").empty(),!1!==e&&$("#logWindow").empty(),W.toggleObjectiveTick(!1),W.toggleObjectiveTick(!0)},updateObjectives:function(){if(!W.isWvWPaused){var e,t={},a=0,n=null,i=3,r=18,o=(new Date).getTime(),s=function(){W.numFailedAPICalls=0,W.isAPIFailed=!1,W.isFallbackEnabled=!1,I.write("WvW data connection reestablished at "+T.getTimeFormatted())};W.isFallbackEnabled&&W.updateObjectivesFallback(),U.getJSON(U.URL_API.Match+O.Options.enu_Server,function(i){if(W.isFallbackEnabled)return s(),void W.reinitializeServerChange(!1);var c,l,u,d=0,p=16,h=!1;if(W.MatchFinishTimeISO!==i.end_time){var m=W.getWorldRelink(new Date(i.end_time)),g=m.getTime()-o;W.MatchFinishTimeISO=i.end_time,W.MatchStartTimeMS=new Date(i.start_time).getTime(),W.MatchFinishTimeMS=new Date(i.end_time).getTime(),W.secTillWvWReset=~~((W.MatchFinishTimeMS-o)/T.cMSECONDS_IN_SECOND),W.MatchupIDCurrent=i.id,W.MatchupCurrent=W.formatMatchup(i),W.updateParticipants(),W.addLogEntry("Next server relink: "+T.formatLocal(m,{year:"numeric",month:"numeric",day:"numeric"})+" ("+T.formatMilliseconds(g)+")")}O.Options.bol_showLeaderboard&&W.insertScoreboard(i);for(var f in i.maps){c=i.maps[f];for(var C in c.objectives)e=c.objectives[C].last_flipped,void 0===t[e]&&(t[e]=0),t[e]+=1,t[e]>a&&(a=t[e])>r&&(n=e)}for(var f in i.maps){c=i.maps[f];for(var C in c.objectives)if(u=c.objectives[C],void 0!==(l=W.Objectives[u.id])&&(l.last_flipped!==u.last_flipped&&(null!==l.last_flipped&&d++,l.last_flipped=u.last_flipped,l.last_flipped_msec=new Date(u.last_flipped).getTime(),l.prevowner=l.owner,l.owner=u.owner,l.data=u,W.updateObjectiveIcon(l),W.updateObjectiveAge(l),W.updateObjectiveTooltip(l),o-l.last_flipped_msec<W.cMSECONDS_IMMUNITY&&l.owner!==W.OwnerEnum.Neutral&&l.type!==W.ObjectiveEnum.Ruins&&(null===n||null!==n&&n!==l.last_flipped)&&(W.Objectives[l.id].isImmune=!0,$("#objProgressBar_"+l.id).show().find("var").css({width:"0%"}).animate({width:"100%"},800))),l.claimed_by!==u.claimed_by&&(l.prevclaimed_by=l.claimed_by,l.claimed_by=u.claimed_by,l.claimed_at=u.claimed_at,W.updateObjectiveClaim(l)),d>p)){h=!0;break}if(d>p){h=!0;break}var v=c.bonuses&&c.bonuses.length?c.bonuses[0].owner:W.OwnerEnum.Neutral,b=W.Rotation[c.type];(l=W.Objectives[b+"_bloodlust"])&&l.owner!==v&&(l.last_flipped=o,l.last_flipped_msec=o,l.prevowner=l.owner,l.owner=v,l.claimed_by=null,W.updateObjectiveIcon(l),W.updateObjectiveTooltip(l))}h&&(D.stopSpeech(),W.reinitializeServerChange(!1),W.addLogEntry("Restarted due to API error."),I.write("Too many objectives updated. ArenaNet API server may be having problems.")),W.isAPIFailed&&s()},!1).fail(function(){if(!1===W.isFallbackEnabled)if(W.numFailedAPICalls++,W.numFailedAPICalls>i)W.isFallbackEnabled=!0,W.updateObjectives(),I.print("<br />Too many failed API retrievals. Switched to backup API server.<br />If problem persists, please consult <a"+U.convertExternalAnchor(U.URL_API.Support+"?source=wvw")+">ArenaNet API forum</a> for status updates.");else if(!1===W.isAPIFailed){W.isAPIFailed=!0;var e=null!==W.secTillWvWReset&&W.secTillWvWReset<10*T.cSECONDS_IN_MINUTE?"WvW reset is happening soon.":"The map will refresh automatically when ArenaNet servers are back online.";I.print("Unable to retrieve WvW data during "+T.getTimeFormatted()+". Please wait...<br />"+e)}})}},convertWorlds:function(e){return{red:e.red_world_id,blue:e.blue_world_id,green:e.green_world_id}},updateObjectivesFallback:function(){var e=new Date,t=e.toISOString(),a=e.getTime();null===W.MatchupIDCurrent||null===W.Matches?U.getJSON(U.URL_API.MatchesFallback,function(e){if(!1!==W.isFallbackEnabled){W.Matches={};for(var t in e.wvw_matches){var n=e.wvw_matches[t],i=parseInt(O.Options.enu_Server);W.Matches[n.wvw_match_id]=n,n.red_world_id!==i&&n.blue_world_id!==i&&n.green_world_id!==i||(W.MatchupIDCurrent=n.wvw_match_id,W.MatchStartTimeMS=new Date(e.start_time).getTime(),W.MatchFinishTimeMS=new Date(e.end_time).getTime(),W.secTillWvWReset=~~((W.MatchFinishTimeMS-a)/T.cMSECONDS_IN_SECOND),W.MatchupCurrent=W.formatMatchup(W.Matches[W.MatchupIDCurrent]),W.updateParticipants(),W.updateObjectivesFallback())}}},!1):U.getJSON(U.URL_API.MatchFallback+W.MatchupIDCurrent,function(e){if(!1!==W.isFallbackEnabled){var n,i,r,o,s=new Date(a-W.cMSECONDS_IMMUNITY),c=new Date(a-O.Options.int_secWvWRefresh*T.cMSECONDS_IN_SECOND);for(var l in e.maps){n=e.maps[l],o=W.LandPrefix[n.type];for(var u in n.objectives)if(r=n.objectives[u],void 0!==(i=W.Objectives[o+r.id])){var d=null===i.owner?s:c;i.owner!==r.owner&&(i.last_flipped=d.toISOString(),i.last_flipped_msec=d.getTime(),i.prevowner=i.owner,i.owner=r.owner,W.updateObjectiveIcon(i),W.updateObjectiveAge(i),W.updateObjectiveTooltip(i),a-i.last_flipped_msec<W.cMSECONDS_IMMUNITY&&i.owner!==W.OwnerEnum.Neutral&&(W.Objectives[i.id].isImmune=!0,$("#objProgressBar_"+i.id).show().find("var").css({width:"0%"}).animate({width:"100%"},800))),i.claimed_by!==r.owner_guild&&(i.prevclaimed_by=i.claimed_by,i.claimed_by=r.owner_guild,i.claimed_at=t,W.updateObjectiveClaim(i))}}O.Options.bol_showLeaderboard&&W.insertScoreboard(e)}},!1)},updateObjectiveIcon:function(e){var t=2e3,a=$("#objUmbrella_"+e.id),n=$("#objIcon_"+e.id),i=n.css("width");if(null!==e.prevowner&&e.owner!==W.OwnerEnum.Neutral){var r=W.Metadata[e.prevowner].color,o=W.Metadata[e.owner].color;a.parent().parent().show(),a.css({borderColor:r,boxShadow:"0px 0px 10px "+r}),I.bloatElement(a,1e3,100),function(a,r,o){n.css({width:i}).animate({width:0},t,function(){r.css({borderColor:o,boxShadow:"0px 0px 10px "+o}),$(this).attr("src",W.getObjectiveImage(e)).animate({width:i},t,function(){r.parent().parent().hide(),W.adjustZoomMapping()})})}(e.owner,a,o),W.addLogEntryObjective(e)}else n.attr("src",W.getObjectiveImage(e))},updateObjectiveTimers:function(){var e,t,a,n,i=(new Date).getTime(),r=3e4;for(var o in W.Objectives)(e=W.Objectives[o]).isImmune&&(t=i-e.last_flipped_msec,n=(a=W.cMSECONDS_IMMUNITY-t)/W.cMSECONDS_IMMUNITY*T.cPERCENT_100,a>0&&t+r>0?(document.getElementById("objTimer_"+e.id).innerHTML=T.formatTimeColon(a),document.getElementById("objProgress_"+e.id).style.width=n+"%"):t+r<=0?!1===T.isTimeOutOfSync&&(W.addLogEntry("Negative time detected. Your computer's time may be <a"+U.convertExternalAnchor("https://www.google.com/search?q=synchronize+time")+">out of sync!</a>"),T.isTimeOutOfSync=!0):($("#objTimer_"+e.id).html(""),$("#objProgressBar_"+e.id).css({opacity:1}).animate({opacity:0},2e3,function(){$(this).css({opacity:1}).hide()}),$("#objIcon_"+e.id).css({opacity:0}).animate({opacity:1},2e3),e.isImmune=!1,W.updateObjectiveAge(e)))},updateObjectiveAge:function(e){if(e.last_flipped_msec){var t=(new Date).getTime()-e.last_flipped_msec;$("#objAge_"+e.id).html(T.getShorthandTime(t))}},updateAllObjectiveAge:function(){for(var e in W.Objectives)W.updateObjectiveAge(W.Objectives[e])},updateObjectiveClaim:function(e){var t=e.claimed_by,a=function(){var a=Q.getCachedGuild(t);e.oGuildName=a.name,e.oTagInitial=a.tag,e.oTag=a.oTag,W.updateObjectiveTooltip(e);var n=$("#objClaim_"+e.id);n.css("color");n.html(a.oTag),"none"!==e.prevclaimed_by&&(I.blinkElement(n,2e3,200),W.addLogEntryObjective(e,!0))};null===t||void 0===t?(e.oGuildName=null,e.oTag=null,W.updateObjectiveTooltip(e),$("#objClaim_"+e.id).empty()):Q.getGuilds(t,function(){a()})},updateObjectiveTooltip:function(e){var t=e,a=$("#objIcon_"+t.id),n="";t.claimed_by&&(n="<aside><dfn>Claim:</dfn> "+new Date(t.claimed_at).toLocaleString()+"</aside><aside><dfn>Guild:</dfn> "+U.escapeHTML(t.oGuildName+" "+t.oTag)+"</aside><aside class='cssCenter'><img class='objTooltipBanner' src='"+U.getGuildBannerURL(t.oGuildName)+"' /></aside>");var i="<div class='objTooltip'><aside><dfn class='objTooltipName'>"+D.getObjectName(t)+"</dfn></aside><aside class='cntDivider objTooltipDivider'></aside><aside><dfn>Owner:</dfn> "+new Date(t.last_flipped).toLocaleString()+"</aside>"+(e.prevownerhtml?"<aside class='cssCenter'>"+e.prevownerhtml+"</aside>":"")+n+"</div>";I.qTip.init(a.attr("title",i))},toggleObjectiveTick:function(e){e?(W.isObjectiveTickEnabled=e,W.tickObjectives(),W.isObjectiveTimerTickEnabled=e):(window.clearTimeout(W.ObjectiveTimeout),W.isObjectiveTickEnabled=e,W.isObjectiveTimerTickEnabled=e)},tickObjectives:function(){W.isObjectiveTickEnabled&&(W.updateObjectives(),window.clearTimeout(W.ObjectiveTimeout),W.ObjectiveTimeout=setTimeout(function(){W.tickObjectives()},O.Options.int_secWvWRefresh*T.cMSECONDS_IN_SECOND))}},J={Renderer:{},Scene:{},Camera:{},isProjectionInitialized:!1,initializeProjection:function(){J.Scene=new THREE.Scene,J.Camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),J.Renderer=new THREE.WebGLRenderer({alpha:!0}),J.Renderer.setClearColor(16777215,0),J.Renderer.setSize(window.innerWidth,window.innerHeight),document.getElementById("itemProjector").appendChild(J.Renderer.domElement);var e=new THREE.BoxGeometry(1,1,1),t=new THREE.MeshBasicMaterial({color:65280}),a=new THREE.Mesh(e,t);J.Camera.position.z=5;var e=new THREE.CircleGeometry(1,32),t=new THREE.MeshBasicMaterial({color:16776960}),n=new THREE.Mesh(e,t);J.Scene.add(n);var i=function(){requestAnimationFrame(i),a.rotation.x+=.1,a.rotation.y+=.1,J.Renderer.render(J.Scene,J.Camera)};i(),J.isProjectionInitialized=!0}},T={Daily:GW2T_DAILY_DATA,DailyAssociation:GW2T_DAILY_ASSOCIATION,DailyToday:null,DailyTomorrow:null,ResetToday:null,ResetTomorrow:null,Schedule:{},DryTopSets:{},DryTopCodes:{},DST_IN_EFFECT:0,SECONDS_TILL_DAILY:0,SECONDS_TILL_WEEKLY:0,TIMESTAMP_UNIX_SECONDS:0,cUTC_OFFSET_USER:0,cUTC_OFFSET_SERVER:-8,cUTC_OFFSET_HAWAII:-10,cUTC_OFFSET_EASTERN:-4,cMSECONDS_IN_SECOND:1e3,cMSECONDS_IN_MINUTE:6e4,cMSECONDS_IN_DAY:864e5,cSECONDS_IN_MINUTE:60,cSECONDS_IN_HOUR:3600,cSECONDS_IN_DAY:86400,cSECONDS_IN_WEEK:604800,cSECONDS_IN_MONTH:2592e3,cSECONDS_IN_YEAR:31536e3,cMINUTES_IN_HOUR:60,cMINUTES_IN_2_HOURS:120,cMINUTES_IN_DAY:1440,cHOURS_IN_MERIDIEM:12,cHOURS_IN_DAY:24,cDAYS_IN_WEEK:7,cDAYS_IN_BIWEEK:14,cDAYS_IN_MONTH:30,cDAYS_IN_YEAR:365,cMONTHS_IN_YEAR:12,cSECONDS_IN_TIMEFRAME:900,cMINUTES_IN_TIMEFRAME:15,cMINUTES_IN_MINIFRAME:5,cNUM_TIMEFRAMES_IN_HOUR:4,cSECS_MARK_0:0,cSECS_MARK_1:900,cSECS_MARK_2:1800,cSECS_MARK_3:2700,cSECS_MARK_4:3599,cBASE_10:10,cBASE_16:16,cPERCENT_100:100,cCIRCLE_RIGHT_DEGREE:90,cCIRCLE_HALF_DEGREE:180,cCIRCLE_FULL_DEGREE:360,cRADIAN_TO_DEGREE:180/Math.PI,cUNITS_TO_POINTS:1/24,cPOINTS_TO_UNITS:24,cUNITS_TO_METERS:.0254,cMETERS_TO_UNITS:1/.0254,cUNITS_PER_SECOND:386,cWEEKLY_RESET_SECONDS:113400,cDAYTIME_DAY_MINUTES:80,cDAYTIME_NIGHT_MINUTES:40,cDAYTIME_DAY_START:25,cDAYTIME_NIGHT_START:45,cDAYTIME_TRANSITION_MINUTES:5,ReferenceEnum:{UTC:0,Local:1,Server:2},UnitEnum:{Milliseconds:0,Seconds:1,Minutes:2,Hours:3},DayEnum:{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},isTimeOutOfSync:!1,secondsTillResetWeekly:-1,isChecklistCountdownsStarted:!1,getCurrentDryTopEvents:function(e){return T.DryTopCodes[T.getDryTopMinute(e)].chat+I.siteTagCurrent},getCurrentDryTopColor:function(e){return T.DryTopCodes[T.getDryTopMinute(e)].color},getDryTopMinute:function(e){e=e||0;var t=~~((new Date).getUTCMinutes()/T.cMINUTES_IN_MINIFRAME)*T.cMINUTES_IN_MINIFRAME+e*T.cMINUTES_IN_MINIFRAME;return(t=T.wrapInteger(t,T.cMINUTES_IN_HOUR))<T.cBASE_10&&(t="0"+t),t},initializeDryTopStrings:function(){var e=function(e){var t=T.DryTopSets[e],a="";for(var n in t)a+=D.getObjectName(t[n])+"@"+t[n].wp+" ";return a.trim()};T.DryTopSets=GW2T_DRYTOP_SETS,T.DryTopCodes=GW2T_DRYTOP_CODES;for(var t in T.DryTopCodes)T.DryTopCodes[t].chat+=e(T.DryTopCodes[t].set);K.updateDryTopClipboard(),$("#itemDryTopClip").show()},initializeScheduleSlot:function(e){void 0===T.Schedule[e]&&(T.Schedule[e]={SchedTime:e,SchedChains:[]})},insertChainToSchedule:function(e){var t=0,a=e.timing;if(Array.isArray(a))for(var n in a)t=T.parseChainTime(a[n]),T.initializeScheduleSlot(t),T.Schedule[t].SchedChains.push(e);else for(t=a.hourInitial*T.cMINUTES_IN_HOUR+a.minuteOffset;t<T.cMINUTES_IN_DAY;t+=a.hourMultiplier*T.cMINUTES_IN_HOUR)T.initializeScheduleSlot(t),T.Schedule[t].SchedChains.push(e)},initializeSchedule:function(){var e,t,a,n;H.Story.isEnabled&&T.isTimely(H.Story,new Date)&&(H.isStoryEnabled=!0,(I.isProgramEmbedded||I.ModeCurrent!==I.ModeEnum.Website||!1===O.Options.bol_showHUD||!1===O.Options.bol_showDashboard)&&(H.isStoryDashboard=!1)),D.isLanguageLogographic&&(C.cEventCharLimit=C.cEventCharLimitLogographic),X.initializeChecklist(X.Checklists.Chain,C.Chains.length+C.UnscheduledChainsLength),X.initializeChecklist(X.Checklists.ChainSubscription,C.Chains.length+C.UnscheduledChainsLength),C.initializeScheduledChains(),I.initializeChainsUI(),$("#sectionChains_Scheduled .chnBar h1, #sectionChains_Drytop .chnBar h1, #dsbStory .chnBar h1").addClass("chnTitleFutureFar");for(e in C.ScheduledChains)T.insertChainToSchedule(C.ScheduledChains[e]);for(e in T.Schedule){n=T.Schedule[e];for(t in C.ScheduledChains)for(a in n.SchedChains)if(C.ScheduledChains[t].nexus===n.SchedChains[a].nexus){C.ScheduledChains[t].scheduleKeys.push(e);break}}C.CurrentChainSD=T.getStandardChain()},getScheduleSlotTime:function(e){return T.Schedule[e].SchedTime},getScheduleSlotChainsByKey:function(e){return T.Schedule[e].SchedChains},getCurrentTimeframe:function(){var e=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Minutes);return e-e%T.cMINUTES_IN_TIMEFRAME},getTimeframe:function(e){e=e||0;var t=T.getCurrentTimeframe()+e*T.cMINUTES_IN_TIMEFRAME;return T.wrapInteger(t,T.cMINUTES_IN_DAY)},getTimeframeChains:function(e){return T.Schedule[T.getTimeframe(e)].SchedChains},getTimeframeChainBySeries:function(e,t){var a=T.getTimeframeChains(e);for(var n in a)if(a[n].series===t)return a[n];return null},getTimeframeChainsBySeries:function(e,t){var a=T.getTimeframeChains(e),n=[];for(var i in a)a[i].series===t&&n.push(a[i]);return n},getStandardChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.Standard)},getHardcoreChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.Hardcore)},getLivingStoryChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.LivingStory)},getMiscellaneousChains:function(e){return T.getTimeframeChainsBySeries(e,C.ChainSeriesEnum.Miscellaneous)},getTimeframeKey:function(e){return T.getTimeframe(e).toString()},convertScheduleKeyToLocalSeconds:function(e){var t=T.getScheduleSlotTime(e)*T.cSECONDS_IN_MINUTE-(new Date).getTimezoneOffset()*T.cSECONDS_IN_MINUTE;return T.wrapInteger(t,T.cSECONDS_IN_DAY)},convertScheduleKeyToUTCMinutes:function(e){return parseInt(e)},getCurrentTimeframeElapsedTime:function(e){var t=new Date,a=t.getUTCMinutes(),n=t.getUTCSeconds();return e===T.UnitEnum.Minutes?a%T.cMINUTES_IN_TIMEFRAME:a%T.cMINUTES_IN_TIMEFRAME*T.cSECONDS_IN_MINUTE+n},getSecondsUntilChainStarts:function(e){var t=T.convertScheduleKeyToLocalSeconds(e.scheduleKeys[0]),a=T.getTimeSinceMidnight(T.ReferenceEnum.Local,T.UnitEnum.Seconds),n=T.cSECONDS_IN_TIMEFRAME*T.cNUM_TIMEFRAMES_IN_HOUR;return t>=T.cSECONDS_IN_DAY-n&&a<=n?T.cSECONDS_IN_DAY-t+a:a>=T.cSECONDS_IN_DAY-n&&t<=n?T.cSECONDS_IN_DAY-a+t:t-a},getTimeTillChainFormatted:function(e,t){var a=T.getSecondsUntilChainStarts(e),n=~~(a/T.cSECONDS_IN_MINUTE)%T.cSECONDS_IN_MINUTE,i=~~(a/T.cSECONDS_IN_HOUR),r=D.getTranslation("m"),o=D.getTranslation("h");return"speech"===t&&(r=" "+D.getSpeechWord("minute"),o=" "+D.getSpeechWord("hour"),Math.abs(n)>1&&(r=" "+D.getSpeechWord("minutes")),Math.abs(i)>1&&(o=" "+D.getSpeechWord("hours")),0===i&&30===Math.abs(n)&&(n=D.getTranslation("half an hour"),r="",o="")),o+=" ",n+=r,Math.abs(a)>=T.cSECONDS_IN_HOUR?i+=o:i="",a<0?" "+i+n+" "+D.getTranslation("ago"):" "+D.getTranslation("in")+" "+i+n},getRandomIntRange:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getMinMax:function(e,t){var a,n=!(void 0===t),i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=null,s=null;for(var c in e)(a=n?e[c][t]:e[c])<i&&(i=a,o=c),a>r&&(r=a,s=c);return{oMin:i,oMax:r,oMinKey:o,oMaxKey:s}},wrapInteger:function(e,t,a){var n=e;return a&&e/t==0?e:((n%=t)<0&&(n=t+n),n)},clampInteger:function(e,t,a){return e<t?t:e>a?a:e},clampFloor:function(e,t){return T.clampInteger(e,t,Number.POSITIVE_INFINITY)},clampCeil:function(e,t){return T.clampInteger(e,Number.NEGATIVE_INFINITY,t)},stepFunction:function(e,t,a,n,i){var r=~~(e/t)*i+a;return r>n?n:r},parseQuantity:function(e,t){void 0===t&&(t=1);var a=parseInt(e);return isFinite(a)||(a=t),a},parseRatio:function(e,t){return 0===e||isNaN(e)?0:1===e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY?1:void 0!==t?e.toFixed(t):e},parseEventTime:function(e){var t=[];return-1!==e.indexOf("~")?(t=e.split("~"),T.parseEventTime(t[0])+~~(T.parseEventTime(t[1])/2)):"*"===e?0:-1===e.indexOf(":")?parseInt(e,T.cBASE_10):2===(t=e.split(":")).length?parseInt(t[0],T.cBASE_10)*T.cSECONDS_IN_MINUTE+parseInt(t[1],T.cBASE_10):3===t.length?parseInt(t[0])*T.cSECONDS_IN_HOUR+parseInt(t[1],T.cBASE_10)*T.cSECONDS_IN_MINUTE+parseInt(t[2],T.cBASE_10):NaN},parseChainTime:function(e){var t=e.split(":");return parseInt(t[0],T.cBASE_10)*T.cMINUTES_IN_HOUR+parseInt(t[1],T.cBASE_10)},checkDST:function(){Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var e=new Date;T.DST_IN_EFFECT=e.dst()&&O.Options.bol_detectDST?1:0},getTimeFormatted:function(e){var t,a,n,i=$.extend({aReference:T.ReferenceEnum.Local,aWant24:O.Options.bol_use24Hour,aWantSeconds:!0,aWantHours:!0,aWantLetters:!1},e),r="",o=void 0===i.aCustomTimeInDate?new Date:i.aCustomTimeInDate;if(void 0===i.aCustomTimeInSeconds)switch(i.aReference){case T.ReferenceEnum.Local:t=o.getSeconds(),a=o.getMinutes(),n=o.getHours();break;case T.ReferenceEnum.Server:t=o.getSeconds(),a=o.getMinutes(),n=o.getUTCHours()+T.cUTC_OFFSET_SERVER+T.DST_IN_EFFECT,n=T.wrapInteger(n,T.cHOURS_IN_DAY);break;case T.ReferenceEnum.UTC:t=o.getUTCSeconds(),a=o.getUTCMinutes(),n=o.getUTCHours()}else{var s=i.aCustomTimeInSeconds;i.aWantNegative?s<0&&(s=Math.abs(s),r=I.Symbol.Negative):s=T.wrapInteger(i.aCustomTimeInSeconds,T.cSECONDS_IN_DAY),t=s%T.cSECONDS_IN_MINUTE,a=~~(s/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,n=~~(s/T.cSECONDS_IN_HOUR)}var c="";if(c=i.aWantSeconds?i.aWantLetters?0===n&&0===a?t+D.getWord("s"):a+D.getWord("m")+" "+t+D.getWord("s"):!1===i.aWantHours?a+":"+(t<T.cBASE_10?"0"+t:t):(a<T.cBASE_10?"0"+a:a)+":"+(t<T.cBASE_10?"0"+t:t):i.aWantLetters?a+D.getWord("m"):a<T.cBASE_10?"0"+a:a,i.aWantLetters)return 0===n||!1===i.aWantHours?r+c:r+n+D.getWord("h")+" "+c;if(i.aWant24)return!1===i.aWantHours?c:(n<T.cBASE_10?"0"+n:n)+":"+c;var l=" AM";return n>=T.cHOURS_IN_MERIDIEM?(n>T.cHOURS_IN_MERIDIEM&&(n%=T.cHOURS_IN_MERIDIEM),l=" PM"):0===n&&(n=T.cHOURS_IN_MERIDIEM),n+":"+c+l},getShorthandTime:function(e){var t=~~(e/T.cMSECONDS_IN_SECOND);return t<T.cSECONDS_IN_MINUTE?0+D.getWord("m"):t<T.cSECONDS_IN_HOUR?~~(t/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR+D.getWord("m"):(t/T.cSECONDS_IN_HOUR).toFixed(1)+D.getWord("h")},formatTimeColon:function(e,t){var a="",n=e;n<0&&(n*=-1,a=I.Symbol.Negative);var i,r,o,s=~~(n/T.cMSECONDS_IN_SECOND),c="",l="",u="",d="",p="";if(s>=T.cSECONDS_IN_DAY&&(c=~~(s/T.cSECONDS_IN_DAY)+"::"),s>=T.cSECONDS_IN_HOUR&&(l=(i=~~(s/T.cSECONDS_IN_HOUR)%T.cHOURS_IN_DAY)+":",""!==c&&i<T.cBASE_10&&(l="0"+l)),s>=T.cSECONDS_IN_MINUTE?(u=(r=~~(s/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR)+":",""!==l&&r<T.cBASE_10&&(u="0"+u)):u="0:",o=s%T.cSECONDS_IN_MINUTE,d=o.toString(),o<T.cBASE_10&&(d="0"+d),t){var h=~~(n%T.cMSECONDS_IN_SECOND/T.cBASE_10);p="."+h,h<T.cBASE_10&&(p=".0"+h)}return a+c+l+u+d+p},formatTimeLetter:function(e,t,a){var n=e,i="",r="",o="",s="",c="",l="",u="",d="",p=T.cDAYS_IN_YEAR;if(0===e)return"0"+D.getWord("s");if(n<0&&(n*=-1,d=I.Symbol.Negative),n<T.cSECONDS_IN_YEAR?n>=T.cSECONDS_IN_MONTH?(r=~~(n/T.cSECONDS_IN_MONTH)+D.getWord("mo")+" ",p=T.cDAYS_IN_MONTH):(n>=T.cSECONDS_IN_WEEK&&(o=~~(n/T.cSECONDS_IN_WEEK)+D.getWord("w")+" "),p=T.cDAYS_IN_WEEK):i=~~(n/T.cSECONDS_IN_YEAR)+D.getWord("y")+" ",n>=T.cSECONDS_IN_DAY){if(a)return~~(n/T.cSECONDS_IN_DAY)+D.getWord("d");s=~~(n/T.cSECONDS_IN_DAY)%p+D.getWord("d")+(n<T.cSECONDS_IN_YEAR?" ":"")}return n<T.cSECONDS_IN_YEAR&&(n>=T.cSECONDS_IN_HOUR&&(c=~~(n/T.cSECONDS_IN_HOUR)%T.cHOURS_IN_DAY+D.getWord("h")+" "),n>=T.cSECONDS_IN_MINUTE&&(l=~~(n/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR+D.getWord("m")+(t||n<T.cSECONDS_IN_MINUTE?" ":"")),(t||n<T.cSECONDS_IN_MINUTE)&&(u=(n%T.cSECONDS_IN_MINUTE).toString()+D.getWord("s"))),d+i+r+o+s+c+l+u},formatMilliseconds:function(e){return T.formatTimeLetter(~~(e/T.cMSECONDS_IN_SECOND))},formatMinutes:function(e){return T.formatTimeLetter(e*T.cSECONDS_IN_MINUTE)},formatISO:function(e){return e.toISOString().split(".")[0]},formatTooltipTime:function(e,t){var a=e,n=t?" ":"",i=[T.cSECONDS_IN_MINUTE,T.cSECONDS_IN_HOUR,T.cSECONDS_IN_DAY,T.cSECONDS_IN_YEAR],r=["m","h","d"];if(a<T.cSECONDS_IN_MINUTE)return a+n+D.getWord("s");for(var o=0;o<r.length;o++)if(a<i[o+1])return~~(a/i[o])+n+D.getWord(r[o]);return""},formatTooltipTimeMS:function(e,t){return T.formatTooltipTime(~~(e/T.cMSECONDS_IN_SECOND),t)},formatWeektime:function(e,t){var a=e instanceof Date?e:new Date(e),n={year:"numeric",month:"numeric",day:"numeric",weekday:"long"};return t&&(n.hour="numeric",n.minute="numeric"),a.toLocaleString(window.navigator.language,n)},formatLocal:function(e,t){return e.toLocaleString(window.navigator.language,t)},isTimely:function(e,t,a){var n=t||new Date,i=e.Start||n,r=void 0===a?e.Finish:new Date(e.Finish.getTime()+a*T.cMSECONDS_IN_SECOND);return n>=i&&n<=r},isDaylight:function(){var e=new Date,t=e.getUTCHours(),a=e.getUTCMinutes();if(t%2==0){if(a>=T.cDAYTIME_DAY_START)return!0}else if(a<T.cDAYTIME_NIGHT_START)return!0;return!1},getDayPeriodRemaining:function(){var e=new Date,t=e.getUTCHours(),a=e.getUTCMinutes(),n="";return t%2==0?a>=T.cDAYTIME_DAY_START?((n=T.cDAYTIME_DAY_START+T.cDAYTIME_DAY_MINUTES-a)>T.cDAYTIME_TRANSITION_MINUTES?n>=T.cDAYTIME_DAY_MINUTES-T.cDAYTIME_TRANSITION_MINUTES?K.setDimming((T.cDAYTIME_DAY_MINUTES-n+1)/T.cDAYTIME_TRANSITION_MINUTES,!0):K.setDimming(1):K.setDimming(n/T.cDAYTIME_TRANSITION_MINUTES,!0),a===T.cDAYTIME_DAY_START&&O.Options.bol_alertDaylight&&(D.speak(D.getPhraseTitle("approaching day")),I.notify({aTitle:D.getWordCapital("day"),aIcon:"img/notification/day.png"}))):(n=T.cDAYTIME_DAY_START-a,K.setDimming(.1)):a<T.cDAYTIME_NIGHT_START?(n=T.cDAYTIME_NIGHT_START-a)>T.cDAYTIME_TRANSITION_MINUTES?K.setDimming(1):K.setDimming(n/T.cDAYTIME_TRANSITION_MINUTES,!0):(n=T.cDAYTIME_NIGHT_START+T.cDAYTIME_NIGHT_MINUTES-a,K.setDimming(.1),a===T.cDAYTIME_NIGHT_START&&O.Options.bol_alertDaylight&&(D.speak(D.getPhrase("approaching night")),I.notify({aTitle:D.getWordCapital("night"),aIcon:"img/notification/night.png"}))),n+D.getWord("m")},getUTCMidnight:function(){return(new Date).setUTCHours(0,0,0,0)},getTimeSinceMidnight:function(e,t){t=t||T.UnitEnum.Seconds,e=e||T.ReferenceEnum.UTC;var a=new Date,n=a.getUTCHours(),i=a.getUTCMinutes(),r=a.getUTCSeconds();switch(e){case T.ReferenceEnum.UTC:break;case T.ReferenceEnum.Server:n=n+T.cUTC_OFFSET_SERVER+T.DST_IN_EFFECT;break;case T.ReferenceEnum.Local:n=a.getHours(),i=a.getMinutes(),r=a.getSeconds()}return n=T.wrapInteger(n,T.cHOURS_IN_DAY),t===T.UnitEnum.Hours?n:t===T.UnitEnum.Minutes?n*T.cMINUTES_IN_HOUR+i:n*T.cSECONDS_IN_HOUR+i*T.cSECONDS_IN_MINUTE+r},getDaysSince:function(e,t){return~~Math.abs((e.getTime()-t.getTime())/T.cMSECONDS_IN_DAY)},getSecondsSinceWeekstart:function(e){return(new Date).getUTCDay()*T.cSECONDS_IN_DAY+e},getUNIXSeconds:function(){return~~((new Date).getTime()/T.cMSECONDS_IN_SECOND)},addDaysToDate:function(e,t){var a=new Date(e);return a.setDate(e.getDate()+t),a},getDaysInMonth:function(e){return new Date(e.getUTCFullYear(),e.getUTCMonth()+1,0).getUTCDate()},getCurrentBihourlyMinutesUTC:function(){var e=new Date;return e.getUTCHours()%2*T.cMINUTES_IN_HOUR+e.getUTCMinutes()},getCurrentBihourlyTimestampLocal:function(e){var t=new Date,a=t.getUTCHours(),n=(a%2==0?a:a-1)*T.cMINUTES_IN_HOUR-t.getTimezoneOffset();return n=T.wrapInteger(n,T.cMINUTES_IN_DAY),T.getTimeFormatted({aCustomTimeInSeconds:(n+e)*T.cSECONDS_IN_MINUTE,aWantSeconds:!1})},getSecondsTillWeektime:function(e,t){var a=T.getSecondsSinceWeekstart(t);return a>e?T.cSECONDS_IN_WEEK-a+e:e-a},updateChecklistCountdowns:function(){var e=T.formatTimeLetter(T.SECONDS_TILL_DAILY,!0),t=T.formatTimeLetter(T.SECONDS_TILL_WEEKLY,!0);$(".jsCountdownToDaily").text(e),$(".jsCountdownToWeekly").text(t)},convertDailyObject:function(e){for(var t={pve:[],pvp:[],wvw:[],fractals:[]},a=T.DailyAssociation,n=[],i=0;i<e.pve.length;i++){var r=e.pve[i];if(r.level.max===Q.GameLimit.LevelMax)for(c=0;c<r.required_access.length;c++)if(r.required_access[c]===T.Daily.AccessEnum.Max){n.push(r);break}}var o={pve:n,pvp:e.pvp,wvw:e.wvw};for(var i in o){var s=o[i];for(var c in s)a[s[c].id]?t[i].push(s[c].id+" "+a[s[c].id]):t[i].push("0 unknown")}for(var i in e.fractals){var l=e.fractals[i].id;t.fractals.push(l)}return t},extractDailyChain:function(e){if(e&&e.pve)for(var t in e.pve){var a=e.pve[t].split(" ");if("Boss"===a[1])return C.getChainByAlias(a[2].toLowerCase())}return null},getDaily:function(e){var t=e||{},a=3,n=t.aWantGetTomorrow||t.aWantSetTomorrow?U.URL_API.Tomorrow:U.URL_API.Daily;return $.getJSON(n,function(e){if(t.aWantGetTomorrow)T.DailyTomorrow=T.convertDailyObject(e),C.ChainTomorrow=T.extractDailyChain(T.DailyTomorrow);else{T.DailyToday=T.convertDailyObject(e);var n,i=T.extractDailyChain(T.DailyToday),r=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Minutes);if(null!==i)if(n=T.convertScheduleKeyToUTCMinutes(i.scheduleKeys[0]),t.aWantSetTomorrow)C.ChainToday=i;else{if(null!==C.ChainToday&&t.aIsReset){var o=C.ChainToday.alias;if(C.ChainToday=null,C.refreshChainDailyIcon(),i.alias===o)return void setTimeout(function(){T.getDaily({aIsReset:!0})},a*T.cMSECONDS_IN_MINUTE)}n+T.cMINUTES_IN_TIMEFRAME>=r?C.ChainToday=i:T.getDaily({aWantSetTomorrow:!0})}else C.ChainToday=null;if(C.ChainToday&&(C.refreshChainDailyIcon(),!0===t.aIsReset)){if(O.isServerReset){var s=D.getModifiedWord("boss","daily",U.CaseEnum.Sentence)+" "+D.getObjectName(C.ChainToday)+" "+D.getTranslation("will start")+" "+D.getTranslation("at")+" "+T.getTimeFormatted({aWantSeconds:!1,aCustomTimeInSeconds:T.convertScheduleKeyToLocalSeconds(C.ChainToday.scheduleKeys[0])})+" "+D.getTranslation("in")+" "+T.getTimeFormatted({aWantLetters:!0,aWantSeconds:!1,aCustomTimeInSeconds:T.getSecondsUntilChainStarts(C.ChainToday)});I.greet(s,15)}if(O.Options.bol_alertAutosubscribe&&O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription){var c=$("#chnTime_"+C.ChainToday.nexus);c.hasClass("chnTimeSubscribed")||c.trigger("click")}}if(!0===t.aIsReset&&O.isServerReset&&T.DailyToday.pve&&-1!==T.DailyToday.pve[1].indexOf("Forger")){var l=U.convertExternalString(H.Announcement.Messages.Forger);I.greet(l,25),O.Options.bol_alertMystic&&setTimeout(function(){D.speak(U.toText(l)),I.notify({aTitle:"Daily Forger",aIcon:"img/notification/forge.png"})},5e3)}}})}},H={Announcement:GW2T_DASHBOARD_DATA.Announcement,Countdown:GW2T_DASHBOARD_DATA.Countdown,Story:GW2T_DASHBOARD_DATA.Story,Faux:GW2T_DASHBOARD_DATA.Faux,Sale:GW2T_SALE_DATA,Pact:GW2T_DASHBOARD_DATA.Pact,SaleCountdowns:null,GemSubscription:null,isDashboardEnabled:!0,isAnnouncementEnabled:!1,isCountdownEnabled:!1,isCountdownTickEnabled:!1,isStoryEnabled:!1,isStoryDashboard:!0,isDailyEnabled:!0,isSaleEnabled:!1,isSaleOpened:!1,isGemPaused:!1,isPactEnabled:!0,isVertical:!0,Timeline:GW2T_TIMELINE,isTimelineEnabled:!0,isTimelineGenerated:!1,minutesInTimelineSpacing:null,initializeDashboard:function(){for(var e=new Date,t=0;t<H.Countdown.Events.length;t++)if(H.Countdown.Events[t].Finish&&e<H.Countdown.Events[t].Finish){H.isCountdownEnabled=!0;break}var a=H.getAnnouncement(H.Announcement.NewsPVE);if(a){var n="<strong>"+D.getWordCapital("new")+": </strong>",i=$("#dsbAnnouncement").show().html(n+a).find("a");U.convertExternalLink(i),U.convertInternalLink(i),M.bindMapLinks("#dsbAnnouncement"),H.isAnnouncementEnabled=!0}if(H.Sale.Items.length-H.Sale.numPaddingItems>0&&T.isTimely(H.Sale,e)&&(H.isSaleEnabled=!0),!1===H.isCountdownEnabled&&!1===H.isAnnouncementEnabled&&!1===H.isSaleEnabled&&!1===H.isPactEnabled||!1===H.isDashboardEnabled)H.isDashboardEnabled=!1;else{if(!1===O.Options.bol_showDashboard&&H.toggleDashboard(!0),H.isCountdownTickEnabled=!0,$("#dsbToggle").click(function(){$("#opt_bol_showDashboard").trigger("click")}),H.isCountdownEnabled){$("#dsbCountdown").show();for(var r,o,s,c=D.getURLKey(),t=0;t<H.Countdown.Events.length;t++)(r=H.Countdown.Events[t]).isTimely=!0,r.StartStamp=T.formatWeektime(r.Start,!0),r.FinishStamp=T.formatWeektime(r.Finish,!0),o=void 0===r.name?D.getObjectName(r):r.name,-1!==(s=void 0===(s=void 0===r.official?r[c]:U.getGW2OfficialLink(r.official))?r.url:s).indexOf(I.cSiteURL)?r.Anchor="<a href='"+s+"'>"+o+"</a>":r.Anchor="<a"+U.convertExternalAnchor(s)+">"+o+"</a>",$("#dsbCountdown").append("<div id='dsbCountdown_"+t+"' class='dsbCountdownEntry'><div class='dsbCountdownSide0'><code></code>"+r.Anchor+"</div> <div class='dsbCountdownSide1'><time id='dsbCountdownTime_"+t+"'></time> <span class='dsbCountdownDate'><abbr></abbr> <var></var></span></div></div>");I.qTip.init("#dsbCountdown"),H.refreshDashboard(e)}if(H.isStoryEnabled&&H.isStoryDashboard){var l=D.getObjectName(H.Story),u=H.Story.url.length?"<a"+U.convertExternalAnchor(H.Story.url)+">"+l+"</a>":l;$("#dsbStory").prepend("<div id='dsbStoryTitle'>"+u+"</div>").show()}H.isSaleEnabled&&H.generateDashboardSaleHeader(),H.isPactEnabled&&H.generateDashboardPactHeader(),H.isDailyEnabled&&H.generateDashboardDailyHeader(e),I.toggleToggleIcon(".dsbToggleIcon",!1,!1)}},getAnnouncement:function(e,t){return e&&e.content.length>0&&T.isTimely(e,t)?e.content:null},getUrgent:function(e,t){var a=H.getAnnouncement(e,t);a&&I.urge(a)},generateDashboardSaleHeader:function(){for(var e,t=[],a=!1,n=0;n<H.Sale.Items.length;n++)void 0===(e=H.Sale.Items[n]).side&&(e.discount&&(isFinite(e.discount)||e.discount.length&&e.discount[0].length>2)&&(a=!0),e.p&&e.p.gem&&t.push(e.p.gem));var i=T.getMinMax(t),r=i.oMin===i.oMax?i.oMax:i.oMin+"-"+i.oMax;$("#dsbMenuSale").append("<div><kbd id='dsbSaleHeader' class='curToggle'><img id='dsbSaleSymbol' src='"+U.URL_IMG.Placeholder+"' /><img id='dsbSaleToggleIcon' class='dsbToggleIcon' src='img/ui/toggle.png' /><var>"+(H.Sale.Items.length-H.Sale.numPaddingItems)+" "+D.getWordCapital("promotions")+"</var> <span class='dsbSalePriceCurrent'>"+r+"<ins class='s16 s16_gem'></ins></span></kbd></div>").addClass("dsbTabEnabled"),$("#dsbSale").append("<div id='dsbSaleTable' class='jsScrollable'></div>"),$("#dsbSaleSymbol").attr("src","img/ui/"+(a?"gemstore_special":"gemstore")+I.cPNG),$("#dsbMenuSale").click(function(){H.generateDashboardSale()})},generateDashboardSale:function(){var e=function(e,t){return"<span class='dsbSalePercent'>"+U.convertRatioToPercent(-1*(1-e/t),0)+"</span> "},t=function(t,a,n){var i=void 0===n?a:n;return e(t,a)+"<span class='dsbSalePriceOld'>"+i+"</span> "},a=200,n=$("#dsbSaleTable");H.isVertical&&n.addClass("dsbSaleVertical");var i=function(){I.toggleToggleIcon("#dsbSaleToggleIcon",!0),n.empty(),H.Sale.note.length>0&&n.append("<div class='dsbNote'>Note: "+U.convertExternalString(H.Sale.note)+"</div>"),n.append("<div id='dsbSaleSide0'></div><div id='dsbSaleSide1'></div>");var i="<ins class='s16 s16_gem'></ins>";H.SaleCountdowns={};for(var r=[],o=0,s=0;s<H.Sale.Items.length;s++){var c=H.Sale.Items[s],l=c.i,u=c.n,d=E.getPaymentAmount(c),p=c.discount,h=c.url||U.getWikiSearchDefault(u),m=U.getYouTubeLink(u);if(o=void 0!==c.side?c.side:o,c.Finish){if(!1===T.isTimely(c))continue;H.SaleCountdowns[s]=~~(c.Finish.getTime()/T.cMSECONDS_IN_SECOND)}var g=null;g=U.isInteger(p)?p:g;var f=null!==(g=Array.isArray(p)&&p[0].length>2?p[0][2]:g)?t(d,g):"",C="";if(p&&Array.isArray(p)){C+="<span class='dsbDiscount'>";for(var v=0;v<p.length;v++){var b=p[v],S=Math.ceil(b[1]/b[0]),y=b.length>2?t(S,p[0][2],b[2]):e(S,p[0][1]),k=b[0]>1?"/"+b[0]+" = "+Math.ceil(b[1]/b[0])+i:"";C+=y+"<span class='dsbSalePriceCurrent'> "+E.formatGemToCoin(b[1])+I.Symbol.ArrowRight+b[1]+i+k+"</span> <br />"}C+="</span>"}var _="";c.p.gem>=0?_="<span class='dsbSalePriceCoin'>"+E.formatGemToCoin(d)+" "+I.Symbol.ArrowRight+" </span><span class='dsbSalePriceMoney'>"+E.formatGemToMoney(d)+" = </span><span class='dsbSalePriceCurrent'>"+d+i+"</span>":c.p.coin>=0?_="<span class='dsbSalePriceCurrent'>"+E.formatGemString(E.convertCoinToGem(d))+"</span> "+I.Symbol.ArrowRight+" <span class='dsbSalePriceCoin'>"+E.formatCoinStringShort(d)+"</span><span class='dsbSalePriceMoney'> = "+E.formatGemToMoney(E.convertCoinToGem(d))+"</span>":c.p.blticket>=0&&(_="<span class='dsbSalePriceCurrent'>"+E.formatPayment("blticket",d)+"</span>");var P=isNaN(l)&&void 0===Q.Boxes.Items[l];!1===P&&r.push(l);var A=P?"":"id='dsbSaleEntry_"+l+"'",D=P?l:U.URL_IMG.Placeholder;$("#dsbSaleSide"+o).append("<div class='dsbSaleEntry' "+A+"><div class='dsbSaleItem'><a"+U.convertExternalAnchor(h)+"><img class='dsbSaleIcon' src='"+D+"' /></a> <span class='dsbSaleVideo'> <a"+U.convertExternalAnchor(m)+"'><ins class='s16 s16_youtube'></ins></a> </span><var class='dsbSaleName'>"+u+"</var></div><div class='dsbSaleInfo'><span id='dsbSaleCountdown_"+s+"' class='dsbSaleCountdown'></span>"+_+f+C+"</div></div>")}var L=n.height();n.css({height:0}).animate({height:L},a,function(){$(this).css({height:"auto"})}),Q.getItems(r,function(){for(var e in r){var t=Q.getCachedItem(r[e]);if(t){var a=$("#dsbSaleEntry_"+r[e]);Q.scanItem(t,{aElement:a.find(".dsbSaleIcon").attr("src",t.icon)}),a.find(".dsbSaleName").html(t.name).addClass(Q.getRarityClass(t.rarity))}}})};!1===n.is(":empty")?(H.isSaleOpened=!1,I.toggleToggleIcon("#dsbSaleToggleIcon",!1),n.animate({height:0},a,function(){$(this).css({height:"auto"}).empty(),$("#dsbSale").hide(),$("#dsbMenuSale").removeClass("dsbTabActive")})):(H.isSaleOpened=!0,$("#dsbSale").show(),$("#dsbMenuSale").addClass("dsbTabActive"),n.append(I.cThrobber),Q.initializeFaux(),H.updateSaleData(function(){I.isAPIEnabled?i():Q.loadItemsSubdatabase("gem",function(){i()})}))},updateDashboardSaleCountdown:function(){for(var e in H.SaleCountdowns){var t=H.SaleCountdowns[e]-T.TIMESTAMP_UNIX_SECONDS;t>T.cSECONDS_IN_DAY?($("#dsbSaleCountdown_"+e).html("<span class='dsbSaleCountdownFar'>"+T.formatTimeLetter(t,!0,!0)+"</span>"),delete H.SaleCountdowns[e]):$("#dsbSaleCountdown_"+e).html(T.formatTimeLetter(t,!0))}},updateSaleData:function(e){U.getScript(U.URL_DATA.Sale,function(){H.Sale=GW2T_SALE_DATA,E.updateExchangeRatios(function(){e()})},!1)},initializeGemSubscription:function(e){var t=O.Utilities.GemSubscription.key;if(H.GemSubscription={},(void 0===localStorage[t]||e)&&(localStorage[t]=JSON.stringify(H.GemSubscription)),!0!==e)try{var a=JSON.parse(localStorage[t]);Array.isArray(a.Available)&&Array.isArray(a.Discounted)?(a.Available.forEach(function(e){H.subscribeGemAvailable(e)}),a.Discounted.forEach(function(e){H.subscribeGemDiscounted(e)}),H.saveGemSubscription()):"object"==typeof a&&(H.GemSubscription=a)}catch(e){}},subscribeGemAvailable:function(e){H.GemSubscription[e]=X.ChecklistEnum.Tracked},subscribeGemDiscounted:function(e){H.GemSubscription[e]=X.ChecklistEnum.Found},isGemSubscribedForAvailable:function(e){return H.GemSubscription[e]===X.ChecklistEnum.Tracked},isGemSubscribedForDiscounted:function(e){return H.GemSubscription[e]===X.ChecklistEnum.Found},isGemSubscribed:function(e){return!!H.GemSubscription[e]},unsubscribeGem:function(e){delete H.GemSubscription[e]},saveGemSubscription:function(){localStorage[O.Utilities.GemSubscription.key]=JSON.stringify(H.GemSubscription)},updateGemSubscription:function(e){var t="Gem",a=function(e){return"<a class='jsGemUnsubscribe' data-item='"+e+"'>"+D.getPhraseOriginal("Unsubscribe this item")+"?</a>"},n=function(){null===H.GemSubscription&&H.initializeGemSubscription();for(var n,i,r=T.isTimely(H.Sale),o=0;o<H.Sale.Items.length;o++)void 0===(n=H.Sale.Items[o]).side&&(T.isTimely(n)||void 0===n.Finish&&r)&&(i=E.getPaymentAmount(n),H.Sale.Values[n.i]=i,0===i&&void 0===H.Sale.Values.free_gem_store_item&&(H.Sale.Values.free_gem_store_item=0));if(e)e();else{var s=U.getRecordData(t),c=!1,l=!1,u=D.getWord("alarm"),d=D.getPhraseOriginal(" gem item is available"),p=D.getPhraseOriginal(" gem item discount");A.iterateRecord(s,function(e){var t=e.i,n=E.getPaymentAmount(e),i=H.Sale.Values[t],r=!1,o=!1,s=!1;n>0&&(r=!0),i>=0&&(o=!0,n=Math.abs(n)),(i<n||0===i)&&(s=!0),H.isGemSubscribedForAvailable(t)&&(o||r)&&(I.print(e.n+d+"! "+a(t)),I.notify({aTitle:e.n,aBody:D.getWordCapital("available"),aIcon:"img/notification/store.png"}),c=!0),H.isGemSubscribedForDiscounted(t)&&(s?(I.print(e.n+p+"! "+E.formatGemString(n)+" − "+E.formatGemString(n-i)+" = "+E.formatGemString(i)+" "+a(t)),I.notify({aTitle:e.n,aBody:D.getWordCapital("discount"),aIcon:"img/notification/store.png"}),l=!0):void 0===i&&!1===r&&(H.subscribeGemAvailable(t),H.saveGemSubscription()))}),$(".jsGemUnsubscribe").each(function(){var e=$(this).removeClass("jsGemUnsubscribe").attr("data-item");e&&$(this).click(function(){H.unsubscribeGem(e),H.saveGemSubscription(),I.print(D.getWordCapital("done")+".")})}),O.Options.bol_alertGem&&(c&&D.speak(u+"! "+d),l&&D.speak(u+"! "+p)),(c||l)&&(I.print("<a data-page='Gem'>"+D.getPhraseOriginal("View Gem Wishlist")+"</a> - <a id='dsbGemPause_"+T.TIMESTAMP_UNIX_SECONDS+"'>"+D.getPhraseOriginal("Pause alarm")+"</a> - <a href='http://gw2timer.com/?bol_alertGem=false'>"+D.getPhraseOriginal("Disable alarm")+"</a>"),I.bindConsoleLink(),$("#dsbGemPause_"+T.TIMESTAMP_UNIX_SECONDS).click(function(){H.isGemPaused=!0,I.clear()}))}};U.getScript(U.URL_DATA.Gem,function(){H.updateSaleData(function(){n()})},!1)},generateDashboardPactHeader:function(e){var t=H.getDashboardPactWeekday(),a=D.getObjectName(H.Pact),n="";for(var i in H.Pact.Codes)n+=i+"@"+H.Pact.Codes[i][t]+" ";n+="- "+a;var r=$("#dsbMenuPact");r.empty().append("<div><kbd id='dsbPactHeader' class='curToggle'><img src='img/map/vendor_karma.png' /><img id='dsbPactToggleIcon' class='dsbToggleIcon' src='img/ui/toggle.png' /><var>"+a+"</var></kbd></div>").addClass("dsbTabEnabled"),$("#dsbPact").empty().append("<div id='dsbPactMenu'><img data-src='img/map/waypoint.png' style='width:32px;height:32px;' /><input id='dsbPactCodes' class='cssInputText jsTitle' type='text' value='"+n+"' title='<dfn>Copy and paste</dfn> this into game chat to follow.' /> "+(I.isMapEnabled?"<img data-src='img/map/path.png' /><dfn class='curZoom' id='dsbPactDraw'>"+D.getPhrase("draw route",U.CaseEnum.Every)+"</dfn> ":"")+"<a class='jsTitle'"+U.convertExternalAnchor("http://wiki.guildwars2.com/wiki/Pact_Supply_Network_Agent")+"title='New items at daily reset.<br />New vendor locations 8 hours after that.<br />Limit 1 purchase per vendor per day.'><img data-src='img/ui/menu/info.png' />"+D.getWordCapital("info")+"</a> <a id='dsbPactHistoryLink' class='jsTitle' data-page='Pact' title='Previous recipes and frequency statistics.'><img data-src='img/ui/tradingpost.png' />"+D.getWordCapital("history")+"</a> <a id='dsbPactProfitLink' class='jsTitle' "+U.convertExternalAnchor("https://wiki.guildwars2.com/wiki/Map_bonus_reward/profit")+"title='Buy Pact Scout Mapping Materials from vendors and consume in profitable zone weeks.'><img data-src='img/ui/coin_gold.png' />"+D.getWordCapital("profit")+"</a> <a class='jsTitle'"+U.convertExternalAnchor(H.Pact.SpreadsheetEdit)+"title='Update and verify the collaborative daily offers list.'><img data-src='img/ui/import.png' />"+D.getWordCapital("update")+"</a></div><div id='dsbPactTable' class='jsScrollable'></div>").hide(),I.qTip.reinit(),U.convertInternalLink("#dsbPactHistoryLink");var o=I.bindInputSelect("#dsbPactCodes");I.bindClipboard(o,n),e&&r.unbind("click"),r.click(function(){H.generateDashboardPact()}),$("#dsbPactDraw").click(function(){if(!0!==$(this).data("hasDrawn")){var e=[];for(var a in H.Pact.Coords){var n=H.Pact.Coords[a][t];void 0!==n&&e.push(n)}M.redrawPersonalPath(P.getGreedyPath(e),"default"),$(this).data("hasDrawn",!0)}else M.clearPersonalPins(),$(this).data("hasDrawn",!1)})},generateDashboardPact:function(){var e=200,t=H.getDashboardPactWeekday(),a=H.Pact.Coords[H.Pact.DefaultVendor],n=$("#dsbPactTable"),i=function(t){var a=n.height();n.css({height:0}).animate({height:a},e,function(){$(this).css({height:"auto"})}),I.removeThrobber(n);var i="",r="";if(t){var o=new Date(t),s=new Date;i=T.formatWeektime(t,!0)+" ("+T.formatMilliseconds(s-o)+" "+D.getWord("ago")+")",r=o>T.ResetToday&&o<T.ResetTomorrow?"":D.getWordCapital("expired")+". "}n.append("<div id='dsbPactNote'>This daily recipes list is user contributed. Please correct items using the <a"+U.convertExternalAnchor(H.Pact.SpreadsheetEdit)+">Update</a> link.<br />"+r+"<time id='dsbPactTime'>"+i+"</time></div>")},r=function(e){var r,o={},s=!0;try{var c=e.feed.entry[0];for(var l in H.Pact.OffersAssoc){var u=parseInt(c["gsx$"+l.toLowerCase()].$t);(u||H.Pact.Products[u])&&(o[l]=u,s=!1)}r=e.feed.updated.$t}catch(e){}if(s)return I.removeThrobber(n),void I.write("Error parsing external data. Please collaboratively update the list.");var d=[];for(var l in H.Pact.OffersAssoc){var p=o[l],h=H.Pact.Products[p]||p;d.push(p),d.push(h)}Q.getPricedItems(d,function(){for(var e in H.Pact.OffersAssoc){var s=o[e];if(void 0!==s){var c=H.Pact.Products[s]||s,l=Q.getCachedItem(s)||Q.getCachedItem(c),u=Q.getCachedItem(c);if(null!==l){var d=D.isLanguageDefault?l.name:s.toString();$("<div id='dsbPactEntry_"+e+"' class='dsbPactEntry'></div>").appendTo(n).html("<div class='dsbPactItem'><a"+U.convertExternalAnchor(U.getWikiSearchDefault(d))+"><img id='dsbPactIcon_"+e+"' class='dsbPactIcon' src='"+U.URL_IMG.Placeholder+"' /></a> <span id='dsbPactName_"+e+"' class='dsbPactName curZoom "+Q.getRarityClass(l.rarity)+"' data-coord='"+(H.Pact.Coords[e]||a)[t]+"'>"+u.name+"</span> </div><div class='dsbPactInfo'><span class='dsbPactPriceCoin' id='dsbPactPriceCoin_"+e+"'></span> <span class='dsbPactVendor'>"+e+"</span> <span class='dsbPactPriceKarma'>"+E.formatKarmaString(H.Pact.Prices[s]||H.Pact.PriceDefault)+"</span></div>");var p=E.getCachedPrice(s),h=p?E.formatCoinStringColored(p.oPriceSell):E.formatCoinStringColored(0);$("#dsbPactPriceCoin_"+e).html(h),M.bindMapLinkBehavior($("#dsbPactName_"+e),M.ZoomEnum.Ground,M.Pin.Program);var m=$("#dsbPactIcon_"+e);m.attr("src",u.icon),Q.scanItem(u,{aElement:m})}}}i(r)})};if($("#dsbPactMenu").is(":visible"))I.toggleToggleIcon("#dsbPactToggleIcon",!1),n.animate({height:0},e,function(){$(this).css({height:"auto"}).empty(),$("#dsbPact").hide(),$("#dsbMenuPact").removeClass("dsbTabActive")});else if($("#dsbPact").show(),$("#dsbMenuPact").addClass("dsbTabActive"),I.loadImg($("#dsbPactMenu")),I.toggleToggleIcon("#dsbPactToggleIcon",!0),n.empty(),H.Pact.isEnabled)n.append(I.cThrobber),U.getJSON(H.Pact.SpreadsheetData,function(e){I.isAPIEnabled?r(e):Q.loadItemsSubdatabase("pact",function(){r(e)})},!1);else for(var o in H.Pact.OffersAssoc){var s=$("<dfn id='dsbPactName_"+o+"' class='dsbPactName' data-coord='"+(H.Pact.Coords[o]||a)[t]+"'>"+o+"</dfn>").appendTo(n);M.bindMapLinkBehavior(s,M.ZoomEnum.Ground,M.Pin.Program)}},getDashboardPactWeekday:function(){var e=new Date,t=e.getUTCDay();return e.getUTCHours()<H.Pact.resetHour?T.wrapInteger(t-1,T.cDAYS_IN_WEEK):t},generateDashboardDailyHeader:function(e){$("#dsbMenuDaily").empty().append("<div><kbd id='dsbDailyHeader' class='curToggle'><img src='img/ui/daily.png' /><img id='dsbDailyToggleIcon' class='dsbToggleIcon' src='img/ui/toggle.png' /><var>"+D.getModifiedWord("achievements","daily",U.CaseEnum.Every)+"</var></kbd></div>").addClass("dsbTabEnabled").click(function(){H.generateDashboardDaily()}).one("click",function(){I.loadStylesheet("features")})},generateDashboardDaily:function(){var e=200,t=$("#dsbDaily"),a=new Date;if(!1===t.is(":empty"))I.toggleToggleIcon("#dsbDailyToggleIcon",!1),t.animate({height:0},e,function(){$(this).css({height:"auto"}).empty(),t.hide(),$("#dsbMenuDaily").removeClass("dsbTabActive")});else{t.show(),$("#dsbMenuDaily").addClass("dsbTabActive"),I.loadImg($("#dsbDailyMenu")),I.toggleToggleIcon("#dsbDailyToggleIcon",!0);var n=$("<div class='dlyCalendar'></div>").appendTo(t);G.fillDailyCalendar(n,a,H.isVertical)}},updateDashboardCountdown:function(e){for(var t=0;t<H.Countdown.Events.length;t++){var a=H.Countdown.Events[t];if(a.isTimely){var n=a.isIndefinite?I.Symbol.Infinity:T.formatTimeLetter(~~((a.DesiredTime.getTime()-e.getTime())/T.cMSECONDS_IN_SECOND),!0);document.getElementById("dsbCountdownTime_"+t).innerHTML=n}}},refreshDashboard:function(e){var t=e.getUTCHours(),a=e.getUTCMinutes();for(var n in H.Countdown.Events){var i=H.Countdown.Events[n];if(i.isTimely){var r,o,s,c=$("#dsbCountdown_"+n);e<i.Start?(i.DesiredTime=i.Start,r="cssStateInactive",o=I.Symbol.ArrowUp+"@",s=i.StartStamp):e<i.Finish?(i.DesiredTime=i.Finish,r="cssStateActive",o=I.Symbol.ArrowDown+"@",s=i.FinishStamp):(i.isTimely=!1,c.remove()),void 0!==i.isIndefinite&&(r="cssStateWaiting",s=I.Symbol.Infinity),i.isTimely&&(c.find("code").removeClass().addClass("cssState "+r),c.find("abbr").text(o),c.find("var").text(s))}}!1===T.isTimely(H.Story,e)&&(H.isStoryEnabled=!1,$("#dsbStory").hide()),!1===T.isTimely(H.Sale,e)&&(H.isSaleEnabled=!1,$("#dsbSale").hide()),t===H.Pact.resetHour&&0===a&&H.generateDashboardPactHeader(!0)},toggleDashboard:function(e){I.toggleElement("#dsbContainer",O.Options.bol_showDashboard,"fast",e)},generateTimeline:function(){H.isTimelineGenerated=!0,$("#tmlTitle").text(D.getWordCapital("timeline"));var e=$("#tmlContainer").append("<div class='tmlLine curToggle' id='tmlHeader'></div>");$("#tmlHeader").click(function(){$("#opt_bol_condenseTimelineHeader").trigger("click")}),X.initializeChecklist(X.Checklists.Timeline,H.Timeline.length);for(var t=0;t<H.Timeline.length;t++){for(var a=H.Timeline[t],n=U.escapeHTML(void 0===a.zone?D.getObjectName(a):M.getZoneName(a.zone)),i=a.isWB?"":"title='<dfn>"+n+"</dfn>'",r=a.isWB?"tmlLineWB":"tmlLineStandard",o=$("<div class='tmlLine "+r+"' "+i+"></div>").appendTo(e),s=0;s<a.Segments.length;s++){var c=a.Segments[s],l="",u=D.getObjectName(c)||"",d=c.primacy<C.EventPrimacyEnum.Primary?"tmlTimesliceEmpty":"",p=a.isWB?"tmlTimesliceWB":"",h=a.isWB?"data-offset='"+s+"'":"",m=c.primacy===C.EventPrimacyEnum.Boss?"tmlSegmentNameBoss":"";switch(c.primacy){case C.EventPrimacyEnum.Normal:l=I.Symbol.Ellipsis;break;case C.EventPrimacyEnum.Boss:l=I.Symbol.Star+" "}c.duration=T.parseChainTime(c.duration),c.time=T.parseChainTime(c.time);var g=c.duration/T.cMINUTES_IN_2_HOURS*T.cPERCENT_100;o.append("<div class='tmlSegment tmlTimeslice "+p+" "+d+"' style='width:"+g+"%' data-start='"+c.time+"' data-finish='"+(c.time+c.duration)+"' "+h+"><div class='tmlSegmentContent'><span class='tmlSegmentName "+m+"'>"+l+u+"</span><span class='tmlSegmentCountdown'></span><var class='tmlSegmentSpecial'></var></div></div>")}!function(e,t){$("<kbd class='tmlLineCollapse jsSleepable' title='"+D.getWordCapital("hide")+" <dfn>"+n+"</dfn>'></kbd>").appendTo(e).click(function(){e.hide("fast"),X.setChecklistItem(X.Checklists.Timeline,t,X.ChecklistEnum.Disabled)})}(o,t),X.getChecklistItem(X.Checklists.Timeline,t)===X.ChecklistEnum.Disabled&&o.hide()}$("#tmlToggle").click(function(){$("#opt_bol_showTimeline").trigger("click")}),$("#tmlCondense").click(function(){$("#opt_bol_condenseTimelineLine").trigger("click")}),$("#tmlOpaque").click(function(){$("#opt_bol_opaqueTimeline").trigger("click")}),O.Enact.bol_condenseTimelineHeader(!0),O.Enact.bol_condenseTimelineLine(!0),H.toggleTimeline(!0),H.opaqueTimeline(),I.qTip.init(".tmlLine"),$("#itemTimeline").show()},updateTimelineIndicator:function(){if(!1!==H.isTimelineGenerated){var e=T.cMINUTES_IN_2_HOURS,t=T.getCurrentBihourlyMinutesUTC(),a=t/e*T.cPERCENT_100;$("#tmlIndicator").css({left:a+"%"}),$(".tmlLineName").css({left:a+"%"}),$(".tmlTimeslice").each(function(){var a=$(this).hasClass("tmlSegmentActive"),n=$(this).find(".tmlSegmentCountdown"),i=$(this).data("start")-t;i=0===i?e:T.wrapInteger(i,e),$(this).hasClass("tmlTimesliceWB")&&a||$(this).hasClass("tmlTimesliceEmpty")?n.html(""):n.html(T.formatMinutes(i))}),I.ModeCurrent===I.ModeEnum.Overlay?$(".tmlTimestampActive").find(".tmlSegmentTimestamp").text(K.currentDaytimeString):$("#tmlIndicatorTime").html(K.currentDaytimeText);var n=$("#tmlIndicatorTime"),i=12;a>90?n.css({marginLeft:-(n.width()+i)+"px"}):n.css({marginLeft:0})}},updateTimelineSegments:function(e){if(!1!==H.isTimelineGenerated){var t=T.cMINUTES_IN_2_HOURS/T.cMINUTES_IN_TIMEFRAME,a=0,n=T.getCurrentBihourlyMinutesUTC(),i=n-n%H.minutesInTimelineSpacing;if(0===n)H.updateTimelineHeader();else{var r=n-H.minutesInTimelineSpacing;$("#tmlSegmentTimestamp_"+r).html(T.getCurrentBihourlyTimestampLocal(r+T.cMINUTES_IN_2_HOURS)).removeClass("tmlSegmentTimestampCurrent").addClass("tmlSegmentTimestampFutureFar").parent().css({opacity:0}).animate({opacity:1},1e3).closest(".tmlSegment").removeClass("tmlTimestampActive")}if($("#tmlSegmentTimestamp_"+i).closest(".tmlSegment").addClass("tmlTimestampActive"),$(".tmlTimeslice").each(function(){n>=$(this).data("start")&&n<$(this).data("finish")?($(this).hasClass("tmlSegmentActive")||$(this).addClass("tmlSegmentActive"),$(this).hasClass("tmlTimesliceWB")&&(a=parseInt($(this).attr("data-offset")))):$(this).removeClass("tmlSegmentActive")}),n%T.cMINUTES_IN_TIMEFRAME==0||e){var o=0;$(".tmlTimesliceWB").each(function(){var e,n,i,r=$(this).find(".tmlSegmentName").empty(),s=$(this).find(".tmlSegmentSpecial").empty(),c=parseInt($(this).attr("data-offset"));c>=a?(i=o,o++):i=t-a+c;var l=T.getTimeframeChains(i);for(var u in l)l[u].series!==C.ChainSeriesEnum.DryTop&&function(t){var a=t.flags.isSpecial?s:r;(e=$("<img class='tmlIcon curZoom chnSlot_"+t.nexus+"' src='"+t.iconSrc+"' />").appendTo(a)).attr("title","<dfn>"+D.getObjectName(t)+"</dfn>").click(function(){C.viewChainFinale(t)}).contextmenu(function(e){e.preventDefault(),C.viewChainFinale(t)}).dblclick(function(){$("#chnCheck_"+t.nexus).trigger("click")}),I.preventMapPropagation(e),n=$("<span class='tmlStripe'>"+D.getObjectName(t)+"<span>").insertAfter(e),X.reapplyChainIconState(t,e,!0),I.bindClipboard(e,t.waypointText)}(l[u])}),I.qTip.init(".tmlIcon")}}},updateTimelineHeader:function(){if(!1!==H.isTimelineGenerated)for(var e,t,a=T.getCurrentBihourlyMinutesUTC(),n=$("#tmlHeader").empty(),i=T.cMINUTES_IN_2_HOURS/H.minutesInTimelineSpacing,r=0;r<i;r++){var o=T.cPERCENT_100/i,s=O.Options.bol_condenseTimelineHeader?"tmlSegmentTimestampCondensed":"",c="";(e=H.minutesInTimelineSpacing*r)<a-H.minutesInTimelineSpacing?(t=T.getCurrentBihourlyTimestampLocal(e+T.cMINUTES_IN_2_HOURS),c="tmlSegmentTimestampFutureFar"):t=T.getCurrentBihourlyTimestampLocal(e),n.append("<div class='tmlSegment' style='width:"+o+"%'><div class='tmlSegmentContent'><span id='tmlSegmentTimestamp_"+e+"' class='tmlSegmentTimestamp "+s+" "+c+"'>"+t+"</span></div></div>")}},toggleSpecialIcons:function(e){$(".tmlSegmentSpecial").css({visibility:e?"visible":"hidden"}),$(".tmlLineWB").toggleClass("tmlLineSpecial",e)},toggleTimeline:function(e){I.toggleElement("#tmlContainer",O.Options.bol_showTimeline,"fast",e),$("#tmlTitle").toggle(!O.Options.bol_showTimeline)},opaqueTimeline:function(){I.toggleHUDOpacity("#itemTimeline","tml",O.Options.bol_opaqueTimeline)}},K={isClockStyled:!1,tickerFrequency:250,tickerSecondPrevious:null,stopwatchFrequency:50,awakeTimestampPrevious:0,awakeTimestampTolerance:5,currentFrameOffsetMinutes:0,currentPredictionColor:"",currentDaytimeSymbol:"",currentDaytimeWord:"",currentDaytimeString:"",currentDaytimeText:"",oldQuadrantAngle:0,paneSizePrevious:0,handSecond:{},handMinute:{},handHour:{},clockBackground:{},clockCircumference:{},timeProgress0:{},timeProgress1:{},timeDaylight:{},timeLocal:{},timeDaytime:{},timeDirectory:{},timeSimple:{},timeMap:{},timeWvW:{},timeLog:{},countdownWvW:{},timestampUTC:{},timestampLocal:{},timestampServer:{},timestampReset:{},stopwatchUp:{},stopwatchDown:{},WpChain0:{},WpChain1:{},WpChain2:{},WpChain3:{},IconSD0:{},IconSD1:{},IconSD2:{},IconSD3:{},IconHC0:{},IconHC1:{},IconHC2:{},IconHC3:{},IconsStandard:[],IconsHardcore:[],lsClipboards:[],TickerTimeout:{},StopwatchTimeout:{},StopwatchTimestamp:0,StopwatchTimesleep:0,isStopwatchPaused:!1,StopwatchTimerStart:0,StopwatchTimerFinish:0,initializeClock:function(){H.generateTimeline(),H.updateTimelineSegments(!0),H.initializeDashboard(),I.initializeDirectory(),K.handSecond=$("#clkSecondHand")[0],K.handMinute=$("#clkMinuteHand")[0],K.handHour=$("#clkHourHand")[0],K.clockBackground=$("#paneClockBackground")[0],K.clockCircumference=$("#clkCircumference")[0],K.timeProgress0=$("#chnProgress0")[0],K.timeProgress1=$("#chnProgress1")[0],K.timeLocal=$("#itemTimeLocalActual")[0],K.timeDaytime=$("#itemTimeDayTime")[0],K.timeDirectory=$("#dirHeaderClock")[0],K.timeSimple=$("#itemSimpleTime")[0],K.timeMap=$("#mapTime")[0],K.timeWvW=$("#wvwTime")[0],K.timeLog=$("#logTime")[0],K.countdownWvW=$("#lboCountdown")[0],K.timestampUTC=$("#optTimestampUTC")[0],K.timestampReset=$("#optTimeTillReset")[0],K.stopwatchUp=$("#watUp")[0],K.stopwatchDown=$("#watDown")[0],K.updateTimeFrame(new Date),T.getDaily(),K.updateDaytimeIcon(),K.tickFrequent(),K.updateDigitalClockMinutely(),K.initializeClipboard(),K.refreshFestival(),I.ModeCurrent===I.ModeEnum.Website&&O.Options.int_setClock!==O.IntEnum.Clock.None&&$("#chnProgressBar").hide(),$("#itemTimeLocalActual").click(function(){$("#opt_bol_use24Hour").trigger("click")}),$("#clkToggle").click(function(){O.Options.int_setClock!==O.IntEnum.Clock.None?(K.paneSizePrevious=O.Options.int_setClock,X.setFieldsetState("int_setClock",O.IntEnum.Clock.None)):X.setFieldsetState("int_setClock",K.paneSizePrevious)})},styleClock:function(){!1===K.isClockStyled&&(K.isClockStyled=!0,$("#paneClockBackground").addClass("paneClockBackground"),$("#paneClockFace").addClass("paneClockFace"))},setClock:function(){var e=200,t=0;switch(O.Options.int_setClock){case O.IntEnum.Clock.Compact:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime").show(),I.bulkAnimate([{s:"#itemClock",p:{top:"0px",left:"70px",width:"220px",height:"220px"}},{s:"#paneClockFace",p:{width:"360px",height:"360px",top:"-70px",left:"0px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"32px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"24px"}},{s:"#clkIconSD0",p:{top:"4px",left:"290px"}},{s:"#clkIconSD1",p:{top:"148px",left:"290px"}},{s:"#clkIconSD2",p:{top:"148px",left:"4px"}},{s:"#clkIconSD3",p:{top:"4px",left:"4px"}},{s:"#clkIconHC0",p:{top:"52px",left:"306px"}},{s:"#clkIconHC1",p:{top:"132px",left:"306px"}},{s:"#clkIconHC2",p:{top:"132px",left:"20px"}},{s:"#clkIconHC3",p:{top:"52px",left:"20px"}},{s:"#clkWaypoint0",p:{top:"24px",left:"274px"}},{s:"#clkWaypoint1",p:{top:"164px",left:"274px"}},{s:"#clkWaypoint2",p:{top:"164px",left:"52px"}},{s:"#clkWaypoint3",p:{top:"24px",left:"52px"}}],e),$("#paneClockIcons .iconHC").css({width:"32px",height:"32px"}),$("#itemTimeLocal").css({width:"100%",right:"auto",bottom:"90px","text-align":"center",opacity:.5}),$("#itemTimeDaytime").css({width:"100%",top:"90px",bottom:"auto",left:"auto","text-align":"center",opacity:.5}),t=I.cPANE_CLOCK_HEIGHT_COMPACT;break;case O.IntEnum.Clock.Full:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime").show(),I.bulkAnimate([{s:"#itemClock",p:{top:"70px",left:"70px",width:"220px",height:"220px"}},{s:"#paneClockFace",p:{width:"360px",height:"360px",top:"0px",left:"0px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"12px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"12px"}},{s:"#clkIconSD0",p:{top:"4px",left:"148px"}},{s:"#clkIconSD1",p:{top:"148px",left:"290px"}},{s:"#clkIconSD2",p:{top:"290px",left:"148px"}},{s:"#clkIconSD3",p:{top:"148px",left:"4px"}},{s:"#clkIconHC0",p:{top:"12px",left:"212px"}},{s:"#clkIconHC1",p:{top:"212px",left:"298px"}},{s:"#clkIconHC2",p:{top:"298px",left:"100px"}},{s:"#clkIconHC3",p:{top:"100px",left:"12px"}},{s:"#clkWaypoint0",p:{top:"52px",left:"164px"}},{s:"#clkWaypoint1",p:{top:"164px",left:"274px"}},{s:"#clkWaypoint2",p:{top:"274px",left:"164px"}},{s:"#clkWaypoint3",p:{top:"164px",left:"52px"}}],e),$("#paneClockIcons .iconHC").css({width:"48px",height:"48px"}),$("#itemTimeLocal").css({width:"auto",right:"10px",bottom:"10px","text-align":"left",opacity:1}),$("#itemTimeDaytime").css({width:"auto",top:"auto",bottom:"10px",left:"10px","text-align":"left",opacity:1}),t=I.cPANE_CLOCK_HEIGHT;break;case O.IntEnum.Clock.Bar:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime").hide(),I.bulkAnimate([{s:"#itemClock",p:{top:"0px",left:"0px",width:"85px",height:"85px"}},{s:"#paneClockFace",p:{width:"132px",height:"132px",top:"-24px",left:"-24px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"32px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"24px"}},{s:"#clkIconSD0",p:{top:"0px",left:"82px"}},{s:"#clkIconSD1",p:{top:"0px",left:"152px"}},{s:"#clkIconSD2",p:{top:"0px",left:"222px"}},{s:"#clkIconSD3",p:{top:"0px",left:"292px"}},{s:"#clkIconHC0",p:{top:"48px",left:"98px"}},{s:"#clkIconHC1",p:{top:"48px",left:"168px"}},{s:"#clkIconHC2",p:{top:"48px",left:"238px"}},{s:"#clkIconHC3",p:{top:"48px",left:"308px"}},{s:"#clkWaypoint0",p:{top:"-8px",left:"98px"}},{s:"#clkWaypoint1",p:{top:"-8px",left:"168px"}},{s:"#clkWaypoint2",p:{top:"-8px",left:"238px"}},{s:"#clkWaypoint3",p:{top:"-8px",left:"308px"}}],e),$("#paneClockIcons .iconHC").css({width:"32px",height:"32px"}),t=I.cPANE_CLOCK_HEIGHT_BAR;break;case O.IntEnum.Clock.None:$("#plateMenu").animate({top:0},e),$("#paneContent").animate({top:I.cPANE_MENU_HEIGHT,"min-height":I.cPANEL_HEIGHT_MIN-I.cPANE_MENU_HEIGHT+"px"},e,function(){$("#paneClock").hide()})}I.CLOCK_AND_MENU_HEIGHT=t+I.cPANE_MENU_HEIGHT,O.Options.int_setClock!==O.IntEnum.Clock.None&&($("#plateMenu").animate({top:t},e),$("#paneClock, #paneClockWall, #paneClockBackground, #paneClockIcons, #paneClockCanvas").animate({height:t},e),$("#paneContent").animate({top:t+I.cPANE_MENU_HEIGHT,"min-height":I.cPANEL_HEIGHT_MIN-(t+I.cPANE_MENU_HEIGHT)+"px"},e))},setDimming:function(e,t){0===O.Options.int_setDimming&&I.ModeCurrent!==I.ModeEnum.Simple&&(t?$(K.clockBackground).animate({opacity:e}):K.clockBackground.style.opacity=e)},setMarkerAngle:function(e,t){$(e).attr("transform","rotate("+t/10+", 50, 50)")},rotateClockElement:function(e,t){e.setAttribute("transform","rotate("+t+", 50, 50)")},reapplyFilters:function(){if(I.BrowserCurrent===I.BrowserEnum.Firefox){var e=$("#clkCircumference"),t=$("#clkHands"),a="url(#clkFilterShadowOuter)",n="url(#clkGradientCircumference)",i="url(#clkFilterShadowHand)";e.removeAttr("filter").attr("filter",a),e.css("stroke",n),t.removeAttr("filter").attr("filter",i)}},initializeClockItems:function(){K.IconsStandard=null,K.IconsHardcore=null,K.IconsStandard=new Array(K.IconSD0,K.IconSD1,K.IconSD2,K.IconSD3),K.IconsHardcore=new Array(K.IconHC0,K.IconHC1,K.IconHC2,K.IconHC3);var e="click",t="dblclick";I.ModeCurrent===I.ModeEnum.Website&&!1===I.isProgramEmbedded&&(e="dblclick",t="click");for(var a=0;a<T.cNUM_TIMEFRAMES_IN_HOUR;a++)$([K.IconsStandard[a],K.IconsHardcore[a]]).each(function(){$(this).unbind(t).on(t,function(){C.viewChainFinale(C.Chains[$(this).data(C.cIndexSynonym)])}).unbind(e).on(e,function(){$("#chnCheck_"+C.Chains[$(this).data(C.cIndexSynonym)].nexus).trigger("click")})})},checkoffChainIcon:function(e){var t,a,n,i=C.Chains[e];if(i.series===C.ChainSeriesEnum.Standard||i.series===C.ChainSeriesEnum.Hardcore)for(t=0;t<T.cNUM_TIMEFRAMES_IN_HOUR;t++){switch(i.series){case C.ChainSeriesEnum.Standard:a=T.getStandardChain(t),n=K.IconsStandard[t];break;case C.ChainSeriesEnum.Hardcore:a=T.getHardcoreChain(t),n=K.IconsHardcore[t]}a&&e===a.nexus&&X.reapplyChainIconState(a,n)}},colorPrediction:function(e){e!==K.currentPredictionColor&&(K.currentPredictionColor=e,K.handMinute.style.stroke=e,K.timeProgress0.style.background="linear-gradient(to right, transparent 0%, "+e+" 100%)")},tickFrequent:function(){var e=new Date,t=e.getSeconds();K.tickerSecondPrevious!==t?(K.tickerSecondPrevious=t,K.tickSecond(e)):K.TickerTimeout=setTimeout(K.tickFrequent,K.tickerFrequency)},tickSecond:function(e){var t=T.getTimeFormatted(),a=e.getSeconds(),n=T.getTimeSinceMidnight();T.TIMESTAMP_UNIX_SECONDS=T.getUNIXSeconds(),T.SECONDS_TILL_DAILY=T.cSECONDS_IN_DAY-n,T.SECONDS_TILL_WEEKLY=T.getSecondsTillWeektime(T.cWEEKLY_RESET_SECONDS,n);var i=e.getMinutes(),r=e.getHours()%T.cHOURS_IN_MERIDIEM,o=i*T.cSECONDS_IN_MINUTE+a,s=6*a,c=6*i+a/10,l=30*r+i/2,u=function(e,t){void 0===t&&(t=0),setTimeout(function(){K.rotateClockElement(K.handSecond,s+e[t]),t<e.length-1&&u(e,t+1)},50)};K.rotateClockElement(K.clockCircumference,c),K.rotateClockElement(K.handMinute,c),K.rotateClockElement(K.handHour,l),O.Options.bol_showSecondHand&&u([-.5,1,-.5,.25,0]);var d=1-(i%T.cMINUTES_IN_TIMEFRAME*60+a)/T.cSECONDS_IN_TIMEFRAME,p=T.cPERCENT_100*d;if(K.timeProgress0.style.width=100-p+"%",K.timeProgress1.style.width=p+"%",i%T.cMINUTES_IN_TIMEFRAME==0&&0===a)$(K.timeProgress0).css({width:"100%"}).animate({width:"0%"},800),$(K.timeProgress1).css({width:"0%"}).animate({width:"100%"},800),K.updateTimeFrame(e),O.Options.bol_alertGem&&!1===H.isGemPaused&&H.updateGemSubscription();else{var h=T.TIMESTAMP_UNIX_SECONDS;K.awakeTimestampPrevious<h-K.awakeTimestampTolerance&&K.updateTimeFrame(e),K.awakeTimestampPrevious=h}switch(C.CurrentChains.forEach(C.updateCurrentChainTimeHTML),0===a&&(i%T.cMINUTES_IN_MINIFRAME==0&&(K.updateDaytimeIcon(),K.updateDryTopClipboard(),H.updateTimelineSegments(),H.isDashboardEnabled&&H.refreshDashboard(e)),K.refreshFestival(),K.updateDigitalClockMinutely(),C.updateChainsTimeHTML(),K.updateWaypointsClipboard(),O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&(K.doSubscribedSpeech(O.Options.int_alertSubscribedFirst),K.doSubscribedSpeech(O.Options.int_alertSubscribedSecond)),O.Options.bol_alertBuild&&O.enforceBuildVersion()),I.ModeCurrent){case I.ModeEnum.Simple:K.timeSimple.innerHTML=T.getTimeFormatted({aWant24:!0,aWantHours:!1,aWantLetters:!0,aCustomTimeInSeconds:T.cSECONDS_IN_TIMEFRAME-T.getCurrentTimeframeElapsedTime()});break;case I.ModeEnum.Overlay:P.switchMapCheck()}K.timeLocal.innerHTML=t,K.timeDirectory.innerHTML=t,K.timestampUTC.innerHTML=T.TIMESTAMP_UNIX_SECONDS,K.timestampReset.innerHTML=T.getTimeFormatted({aCustomTimeInSeconds:T.SECONDS_TILL_DAILY,aWant24:!0}),o>=K.currentFrameOffsetMinutes&&o<K.currentFrameOffsetMinutes+C.CurrentChainSD.minFinish?K.colorPrediction("lime"):o>=K.currentFrameOffsetMinutes+C.CurrentChainSD.minFinish&&o<K.currentFrameOffsetMinutes+C.CurrentChainSD.avgFinish?K.colorPrediction("orange"):o>=K.currentFrameOffsetMinutes+C.CurrentChainSD.avgFinish&&K.colorPrediction("red"),T.isChecklistCountdownsStarted&&T.updateChecklistCountdowns(),H.isCountdownTickEnabled&&H.updateDashboardCountdown(e),H.isSaleOpened&&H.updateDashboardSaleCountdown(),0!==K.StopwatchTimerStart&&K.tickStopwatchDown(),W.isObjectiveTimerTickEnabled&&(K.timeLog.innerHTML=t,W.updateObjectiveTimers(),null!==W.MatchFinishTimeMS&&(K.countdownWvW.innerHTML=T.formatTimeLetter(W.secTillWvWReset--,!0)),0===a&&W.updateAllObjectiveAge()),K.TickerTimeout=setTimeout(K.tickFrequent,K.tickerFrequency)},doSubscribedSpeech:function(e){if(e>0){var t=T.cMINUTES_IN_TIMEFRAME-T.getCurrentTimeframeElapsedTime(T.UnitEnum.Minutes),a=C.NextChainSD1,n=C.NextChainHC1,i=C.NextChainLS1,r=!1,o=!1,s=!1,c=!1,l="",u="",d="";if(e>T.cMINUTES_IN_TIMEFRAME&&(a=C.NextChainSD2,n=C.NextChainHC2,i=C.NextChainLS2,t+=T.cMINUTES_IN_TIMEFRAME),e===t){var p=" "+D.getSpeechWord("and")+" ",h=D.getPluralTime(t,"minute"),m=" "+D.getSpeechWord("will start")+h;l=D.getSpeechWord(D.orderModifier(D.orderModifier("boss","world"),"subscribed"))+" ",r=U.objToBool(a)&&C.isChainSubscribed(a)&&C.isChainUnchecked(a),o=U.objToBool(n)&&C.isChainSubscribed(n)&&C.isChainUnchecked(n),s=U.objToBool(i)&&C.isChainSubscribed(i)&&C.isChainUnchecked(i),(r||o)&&(r&&o?l+=D.getChainPronunciation(a)+p+D.getChainPronunciation(n):r?l+=D.getChainPronunciation(a):o&&(l+=D.getChainPronunciation(n)),D.speak(l),D.speak(m),r&&I.notify({aTitle:D.getObjectName(a),aBody:h,aIcon:a.iconSrc}),o&&I.notify({aTitle:D.getObjectName(n),aBody:h,aIcon:n.iconSrc}));var g,f=e>T.cMINUTES_IN_TIMEFRAME?C.NextChainsMS2:C.NextChainsMS1;if(f.length>0){u=D.getSpeechWord("event","subscribed")+" ";for(var v=0;v<f.length;v++)g=f[v],U.objToBool(g)&&C.isChainSubscribed(g)&&C.isChainUnchecked(g)&&(u+=D.getChainPronunciation(g),v+1<f.length&&f.length>1&&(u+=p),c=!0);c&&(u+=m,D.speak(u),I.notify({aTitle:D.getObjectName(g),aBody:u,aIcon:g.iconSrc}))}H.isStoryEnabled&&s&&(d=D.getSpeechWord("event","subscribed")+" "+D.getChainPronunciation(i),d+=m,D.speak(d),I.notify({aTitle:D.getObjectName(i),aBody:d,aIcon:i.iconSrc}))}}},updateTimeFrame:function(e){if(O.checkResetTimestamps(e),C.CurrentChainSD=T.getStandardChain(),C.NextChainSD1=T.getStandardChain(1),C.NextChainSD2=T.getStandardChain(2),C.NextChainSD3=T.getStandardChain(3),C.NextChainSD4=T.getStandardChain(4),C.CurrentChainsSD=[C.CurrentChainSD,C.NextChainSD1,C.NextChainSD2,C.NextChainSD3],C.CurrentChainHC=T.getHardcoreChain(),C.NextChainHC1=T.getHardcoreChain(1),C.NextChainHC2=T.getHardcoreChain(2),C.NextChainHC3=T.getHardcoreChain(3),C.NextChainHC4=T.getHardcoreChain(4),H.isStoryEnabled&&(C.NextChainLS1=T.getLivingStoryChain(1),C.NextChainLS2=T.getLivingStoryChain(2)),C.NextChainsMS1=T.getMiscellaneousChains(1),C.NextChainsMS2=T.getMiscellaneousChains(2),C.PreviousChains2=T.getTimeframeChains(-2),C.PreviousChains1=T.getTimeframeChains(-1),C.CurrentChains=T.getTimeframeChains(),C.NextChains1=T.getTimeframeChains(1),C.sortChainsListHTML(),C.CurrentChains.forEach(C.queueEventsHighlight),I.ModeCurrent===I.ModeEnum.Simple&&($("#itemSimpleCurrentSD").text(D.getObjectName(C.CurrentChainSD)),$("#itemSimpleNextSD").text(D.getObjectName(C.NextChainSD1)),$("#itemSimpleCurrentHC").text(""),$("#itemSimpleNextHC").text(""),C.CurrentChainHC||C.NextChainHC1?($("#itemSimpleHC").show(),C.CurrentChainHC&&$("#itemSimpleCurrentHC").text(D.getObjectName(C.CurrentChainHC)),C.NextChainHC1&&$("#itemSimpleNextHC").text(D.getObjectName(C.NextChainHC1))):$("#itemSimpleHC").hide()),O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&O.Options.bol_alertAtEnd){var t=", "+D.getSpeechWord("checked"),a="",n="",i="",r="",o=U.objToBool(C.CurrentChainSD),s=U.objToBool(C.CurrentChainHC),c=U.objToBool(C.NextChainSD1),l=U.objToBool(C.NextChainHC1),u=D.getSpeechWord("world boss","current")+" "+D.getSpeechWord("is")+" ";C.CurrentChainSD&&!C.isChainUnchecked(C.CurrentChainSD)&&(a=t),C.CurrentChainHC&&!C.isChainUnchecked(C.CurrentChainHC)&&(i=t),C.NextChainSD1&&!C.isChainUnchecked(C.NextChainSD1)&&(n=t),C.NextChainHC1&&!C.isChainUnchecked(C.NextChainHC1)&&(r=t),!1===O.Options.bol_alertChecked&&(a.length>0&&(o=!1),i.length>0&&(s=!1),n.length>0&&(c=!1),r.length>0&&(l=!1)),o&&s?(D.speak(u+D.getChainPronunciation(C.CurrentChainSD)+a,5),D.speak(D.getSpeechWord("and")+", "+D.getChainPronunciation(C.CurrentChainHC)+i,4)):o?D.speak(u+D.getChainPronunciation(C.CurrentChainSD)+a,5):s&&D.speak(u+D.getChainPronunciation(C.CurrentChainHC)+i,5),o&&I.notify({aTitle:D.getObjectName(C.CurrentChainSD),aBody:D.getWordCapital("current"),aIcon:C.CurrentChainSD.iconSrc}),s&&I.notify({aTitle:D.getObjectName(C.CurrentChainHC),aBody:D.getWordCapital("current"),aIcon:C.CurrentChainHC.iconSrc}),(o||s)&&(c&&l?(D.speak(D.getSpeechWord("then")+", "+D.getChainPronunciation(C.NextChainSD1)+n,4),D.speak(D.getSpeechWord("and")+", "+D.getChainPronunciation(C.NextChainHC1)+r,4)):c?D.speak(D.getSpeechWord("then")+", "+D.getChainPronunciation(C.NextChainSD1)+n,4):l&&D.speak(D.getSpeechWord("then")+", "+D.getChainPronunciation(C.NextChainHC1)+r,4),c&&I.notify({aTitle:D.getObjectName(C.NextChainSD1),aBody:D.getWordCapital("next"),aIcon:C.NextChainSD1.iconSrc}),l&&I.notify({aTitle:D.getObjectName(C.NextChainHC1),aBody:D.getWordCapital("next"),aIcon:C.NextChainHC1.iconSrc}))}var d=e.getSeconds(),p=60*e.getMinutes()+d;$("#clkMarkers line").each(function(){$(this).attr("stroke","black")}),$("#paneClockIcons .iconSD").removeClass("clkIconCurrent clkIconNext"),$("#paneClockIcons .iconHC").removeClass("clkIconCurrent clkIconNext");var h=function(e,t,a,n,i,r,o,s,c,l,u,d,p,h){$([K.IconSD0,K.IconHC0]).each(function(){$(this).addClass("clkIconCurrent")}),$([K.IconSD1,K.IconHC1]).each(function(){$(this).addClass("clkIconNext")}),K.setMarkerAngle(t,C.CurrentChainSD.minFinish+u),K.setMarkerAngle(a,C.CurrentChainSD.avgFinish+u),K.setMarkerAngle(i,C.NextChainSD1.minFinish+d),K.setMarkerAngle(r,C.NextChainSD1.avgFinish+d),K.setMarkerAngle(o,C.NextChainSD2.minFinish+p),K.setMarkerAngle(s,C.NextChainSD2.avgFinish+p),K.setMarkerAngle(c,C.NextChainSD3.minFinish+h),K.setMarkerAngle(l,C.NextChainSD3.avgFinish+h);var m=function(e,t){e?(t.show(),t.attr("src",e.iconSrc),t.data(C.cIndexSynonym,e.nexus),t.attr("title","<dfn>"+D.getObjectName(e)+"</dfn>"),I.qTip.init(t),X.reapplyChainIconState(e,t)):t.hide()};m(C.CurrentChainSD,K.IconSD0),m(C.NextChainSD1,K.IconSD1),m(C.NextChainSD2,K.IconSD2),m(C.NextChainSD3,K.IconSD3),m(C.CurrentChainHC,K.IconHC0),m(C.NextChainHC1,K.IconHC1),m(C.NextChainHC2,K.IconHC2),m(C.NextChainHC3,K.IconHC3),$(e).attr("stroke","lime"),$(t).attr("stroke","orange"),$(a).attr("stroke","red"),$(n).attr("stroke","green")},m=function(e){var t,a,n,i;switch(e){case T.cSECS_MARK_0:t="0",a="1",n="2",i="3";break;case T.cSECS_MARK_1:t="1",a="2",n="3",i="0";break;case T.cSECS_MARK_2:t="2",a="3",n="0",i="1";break;case T.cSECS_MARK_3:t="3",a="0",n="1",i="2"}K.currentFrameOffsetMinutes=e,K.WpChain0=$("#clkWaypoint"+t),K.IconSD0=$("#clkIconSD"+t),K.WpChain1=$("#clkWaypoint"+a),K.IconSD1=$("#clkIconSD"+a),K.WpChain2=$("#clkWaypoint"+n),K.IconSD2=$("#clkIconSD"+n),K.WpChain3=$("#clkWaypoint"+i),K.IconSD3=$("#clkIconSD"+i),K.IconHC0=$("#clkIconHC"+t),K.IconHC1=$("#clkIconHC"+a),K.IconHC2=$("#clkIconHC"+n),K.IconHC3=$("#clkIconHC"+i),C.refreshChainDailyIcon(),h($("#clkMarker"+t),$("#clkMarker"+t+"A"),$("#clkMarker"+t+"B"),$("#clkMarker"+a),$("#clkMarker"+a+"A"),$("#clkMarker"+a+"B"),$("#clkMarker"+n+"A"),$("#clkMarker"+n+"B"),$("#clkMarker"+i+"A"),$("#clkMarker"+i+"B"),T["cSECS_MARK_"+t],T["cSECS_MARK_"+a],T["cSECS_MARK_"+n],T["cSECS_MARK_"+i]);var r=document.getElementById("clkQuadrant"),o=parseInt(t)*T.cCIRCLE_RIGHT_DEGREE;0===o&&0!==K.oldQuadrantAngle&&(o=T.cCIRCLE_FULL_DEGREE),$({angle:K.oldQuadrantAngle}).animate({angle:o},{duration:600,step:function(){K.rotateClockElement(r,this.angle)},done:function(){K.rotateClockElement(r,o)}}),o===T.cCIRCLE_FULL_DEGREE&&(o=0),K.oldQuadrantAngle=o};p>=T.cSECS_MARK_0&&p<T.cSECS_MARK_1?m(T.cSECS_MARK_0):p>=T.cSECS_MARK_1&&p<T.cSECS_MARK_2?m(T.cSECS_MARK_1):p>=T.cSECS_MARK_2&&p<T.cSECS_MARK_3?m(T.cSECS_MARK_2):p>=T.cSECS_MARK_3&&p<=T.cSECS_MARK_4&&m(T.cSECS_MARK_3),K.updateWaypointsClipboard(),K.updateDryTopClipboard(),K.initializeClockItems()},initializeClipboard:function(){for(var e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)I.bindClipboard("#clkWaypoint"+e)},updateDaytimeIcon:function(){var e=T.isDaylight(),t=e?I.Symbol.Day:I.Symbol.Night,a=e?D.getWord("day"):D.getWord("night");K.currentDaytimeSymbol=t,K.currentDaytimeWord=a,$("#itemTimeDayIcon").text(t)},updateDigitalClockMinutely:function(){var e=T.getDayPeriodRemaining();K.timeDaytime.innerHTML=e,K.currentDaytimeString=T.getTimeFormatted({aWantSeconds:!1})+" "+K.currentDaytimeSymbol+e,K.currentDaytimeText=K.currentDaytimeString+" "+K.currentDaytimeWord,K.timeMap.innerHTML=K.currentDaytimeString,K.timeWvW.innerHTML=K.currentDaytimeString,K.timeLocal.title=T.formatWeektime(new Date,!0)+"<br /><dfn>Anet:</dfn> "+T.getTimeFormatted({aReference:T.ReferenceEnum.Server,aWantSeconds:!1})+"<br /><dfn>UTC:</dfn> "+T.getTimeFormatted({aReference:T.ReferenceEnum.UTC,aWantSeconds:!1,aWant24:!0})+"<br /><dfn>Daily:</dfn> "+T.formatTimeLetter(T.SECONDS_TILL_DAILY,!1)+"<br /><dfn>Weekly:</dfn> "+T.formatTimeLetter(T.SECONDS_TILL_WEEKLY,!1),K.timeDirectory.title=K.timeLocal.title,I.qTip.init(K.timeLocal),I.qTip.init(K.timeDirectory),H.updateTimelineIndicator()},updateWaypointsClipboard:function(){var e=function(e,t,a,n,i){var r="";r+=t.waypoint+" "+D.getChainAlias(t),a&&!1!==a.flags.isClipped?!1!==a.flags.isClipped&&(r+=" "+D.getTranslation("and")+" "+a.waypoint+" "+D.getChainAlias(a)+T.getTimeTillChainFormatted(a)):r+=T.getTimeTillChainFormatted(t),r+=", "+D.getTranslation("then")+" "+n.waypoint+" "+D.getChainAlias(n),i&&!1!==i.flags.isClipped?!1!==i.flags.isClipped&&(r+=" "+D.getTranslation("and")+" "+i.waypoint+" "+D.getChainAlias(i)+T.getTimeTillChainFormatted(i)):r+=T.getTimeTillChainFormatted(n),r+=I.siteTagCurrent,I.updateClipboard(e,r)};e(K.WpChain0,C.CurrentChainSD,C.CurrentChainHC,C.NextChainSD1,C.NextChainHC1),e(K.WpChain1,C.NextChainSD1,C.NextChainHC1,C.NextChainSD2,C.NextChainHC2),e(K.WpChain2,C.NextChainSD2,C.NextChainHC2,C.NextChainSD3,C.NextChainHC3),e(K.WpChain3,C.NextChainSD3,C.NextChainHC3,C.NextChainSD4,C.NextChainHC4)},updateDryTopClipboard:function(){if(C.isDryTopGenerated){var e=T.getCurrentDryTopEvents(),t=T.getCurrentDryTopEvents(1);I.updateClipboard("#chnDryTopWaypoint0",e),I.updateClipboard("#chnDryTopWaypoint1",t);var a=$("#mapDryTopClip0"),n=$("#mapDryTopClip1");C.isDryTopIconsShown&&(a.val(e),n.val(t)),I.updateClipboard(a,e),I.updateClipboard(n,t)}},initializeStopwatch:function(){$("#watToggle").click(function(){$("#itemStopwatch").toggle("fast")}),$("#watStart").click(function(){$("#watToggle").show(),$("#itemStopwatch").show().css("font-size",O.Options.int_sizeStopwatchFont);var e=(new Date).getTime();if(0===K.StopwatchTimestamp){var t=parseInt($("#watOffsetMinutes").val())*T.cMSECONDS_IN_MINUTE,a=parseInt($("#watOffsetSeconds").val())*T.cMSECONDS_IN_SECOND;K.StopwatchTimestamp=(new Date).getTime()-(t+a),K.tickStopwatchUp()}else K.isStopwatchPaused?(K.isStopwatchPaused=!1,K.StopwatchTimestamp=K.StopwatchTimestamp+(e-K.StopwatchTimesleep),K.tickStopwatchUp()):(window.clearTimeout(K.StopwatchTimeout),K.StopwatchTimesleep=e,K.isStopwatchPaused=!0)}),$("#watStop").click(function(){0===K.StopwatchTimerStart&&$("#watToggle").hide(),window.clearTimeout(K.StopwatchTimeout),K.isStopwatchPaused=!1,K.StopwatchTimestamp=0,K.stopwatchUp.innerHTML=""}),$("#watLap").click(function(){0!==K.StopwatchTimestamp?I.print(K.stopwatchUp.innerHTML):I.write("Stopwatch must be running to lap time.")}),$("#watTimerStart").click(function(){$("#watToggle").show(),$("#itemStopwatch").show().css("font-size",O.Options.int_sizeStopwatchFont);var e=parseInt($("#watOffsetSeconds").val())*T.cMSECONDS_IN_SECOND;K.StopwatchTimerStart=(new Date).getTime(),K.StopwatchTimerFinish=K.StopwatchTimerStart+O.Options.int_minStopwatchAlert*T.cMSECONDS_IN_MINUTE+e,I.write("Alert set for "+new Date(K.StopwatchTimerFinish).toLocaleString()),D.verifyNativeTTS(),K.tickStopwatchDown()}),$("#opt_int_minStopwatchAlert").onEnterKey(function(){$(this).trigger("change"),$("#watTimerStart").trigger("click")}),$("#watTimerStop").click(function(){0===K.StopwatchTimestamp&&$("#watToggle").hide(),K.StopwatchTimerStart=0,K.stopwatchDown.innerHTML=""}),I.bindInputSelect("#mapAlarmStopwatchUp input, #mapAlarmStopwatchDown input")},tickStopwatchUp:function(){var e=(new Date).getTime()-K.StopwatchTimestamp;K.stopwatchUp.innerHTML=T.formatTimeColon(e,!0),K.StopwatchTimeout=setTimeout(function(){K.tickStopwatchUp()},K.stopwatchFrequency)},tickStopwatchDown:function(){var e=new Date,t=K.StopwatchTimerFinish-e.getTime();if(t>0)K.stopwatchDown.innerHTML=T.formatTimeLetter(~~(t/T.cMSECONDS_IN_SECOND),!0);else{$("#watTimerStop").trigger("click");var a=e.toLocaleString(),n=O.Options.str_textStopwatchAlert;I.print(a+": "+U.escapeHTML(n)),D.speak(n),I.notify({aTitle:n,aBody:a,aIcon:"img/notification/alert.png",aDelay:60})}},refreshFestival:function(){return}},(I={cSiteName:"GW2Timer.com",cSiteLink:"gw2timer.com/",cSiteURL:"http://gw2timer.com/",cSiteExternal:"http://gw2timer.com/out/?u=",cSiteTitle:"",cImageHost:"http://i.imgur.com/",cGameName:"Guild Wars 2",cGameNick:"GW2",cErrorAPI:"ArenaNet API server may be down.",cAJAXGlobalTimeout:3e4,cPNG:".png",cJSON:".json",cTXT:".txt",cThrobber:"<div class='itemThrobber'><em></em></div>",cChatcodePrefix:"[&",cChatencodedPrefix:"%255B%2526",cChatcodeSuffix:"]",cTextDelimiterChar:"|",cTextDelimiterRegex:/[|]/g,cTextReplace:"{0}",cOptionsDelimiter:": ",cClipboardAttribute:"data-clipboard-text",cClipboardSuccessText:"Text copied to clipboard :)<br />",cTooltipAttribute:"data-tip",cPageAttribute:"data-page",consoleTimeout:{},siteTagDefault:" - gw2timer.com",siteTagCurrent:" - gw2timer.com",Symbol:{Filler:"&zwnj;",Unicode:"中",ArrowUp:"⇑",ArrowDown:"⇓",ArrowLeft:"⇐",ArrowRight:"⇒",ArrowClockwise:"↻",ArrowCounterwise:"↺",Horizontal:"⇄",Vertical:"⇅",TriUp:"▲",TriDown:"▼",TriRight:"►",TriLeft:"◄",Block:"■",Star:"☆",Wait:"⏳",Infinity:"∞",Approx:"≈",Negative:"−",Quantity:"×",Ellipsis:"…",Day:"☀",Night:"☽",Expand:"◢",Collapse:"◣",External:"↗",Help:"[?]",StateActive:"<span class='cssState cssStateActive'></span>",StateInactive:"<span class='cssState cssStateInactive'></span>",StateWaiting:"<span class='cssState cssStateWaiting'></span>"},cOUT_OF_VIEW:-9999,cPANEL_WIDTH:360,cPANEL_HEIGHT_MIN:220,cPANE_CLOCK_HEIGHT:360,cPANE_CLOCK_HEIGHT_COMPACT:220,cPANE_CLOCK_HEIGHT_BAR:85,cPANE_MENU_HEIGHT:48,cTOOLTIP_MOUSEMOVE_MS:20,cTOOLTIP_NUM_RERENDER:8,cTOOLTIP_OFFSET_ADD_X:0,cTOOLTIP_OFFSET_ADD_Y:56,cTOOLTIP_OVERFLOW_ADD_X:16,cTOOLTIP_OVERFLOW_ADD_Y:38,cTOOLTIP_PADDING_ADD_Y:12,CLOCK_AND_MENU_HEIGHT:0,posX:0,posY:0,isSleeping:!1,cMSECONDS_SLEEP:3e3,SleepTimeout:{},Scrl:{Anchor:{},Interval:{},Container:{},isOn:!1,posX:0,posY:0},isProgramLoaded:!1,isProgramEmbedded:!1,isProgramExternal:!1,isProgramFocused:!0,isAPIEnabled:!0,isMapEnabled:!0,isTouchEnabled:!1,isCustomScrollEnabled:!0,isSpeechSynthesisEnabled:!1,isSpeechNativeEnabled:!1,isSpeechNativeLoaded:!1,isProjectionEnabled:!1,ModeCurrent:null,ModeEnum:{Website:"Website",Mobile:"Mobile",Simple:"Simple",Tile:"Tile",Overlay:"Overlay",Projection:"Projection"},cPlatePrefix:"#plate",cPlateMenuPrefix:"#plateMenu_",PageInitial:"",PageCurrent:"",PagePrevious:"",PlateEnum:{Directory:"Directory",Chains:"Chains",Map:"Map",Help:"Help",Options:"Options"},isMapPlateInitialized:!1,isAccountPanelInitialized:!1,SpecialPageEnum:{Account:"Account",Audit:"Audit",WvW:"WvW",Leaderboard:"Leaderboard"},LoadedStylesheets:{},PageEnum:{Chains:{Scheduled:"Scheduled",Special:"Special",Drytop:"Drytop",Legacy:"Legacy",Temple:"Temple",Timetable:"Timetable"},Map:{Daily:"Daily",Resource:"Resource",JP:"JP",Collectible:"Collectible",Guild:"Guild",TP:"TP",Notepad:"Notepad",Personal:"Personal"},Help:{FAQ:"FAQ",About:"About",Embed:"Embed",Schedules:"Schedules",Legacies:"Legacies",Temples:"Temples",Contested:"Contested"},Account:{Manager:"Manager",Bank:"Bank",Materials:"Materials",Vault:"Vault",Wardrobe:"Wardrobe",Outfits:"Outfits",Gliders:"Gliders",Dyes:"Dyes",Minis:"Minis",Carriers:"Carriers",Champions:"Champions",Finishers:"Finishers",Nodes:"Nodes",Cats:"Cats",Achievements:"Achievements",Masteries:"Masteries",Raids:"Raids",Dungeons:"Dungeons",Characters:"Characters",Hero:"Hero",Possessions:"Possessions",Ascended:"Ascended",Inventory:"Inventory",Catalog:"Catalog",Cleanup:"Cleanup",Recipes:"Recipes",Crafting:"Crafting",SAB:"SAB",Trading:"Trading",Gem:"Gem",Museum:"Museum",Pact:"Pact",Buying:"Buying",Selling:"Selling",Bought:"Bought",Sold:"Sold"}},Directory:{Directory:{Scheduled:"Boss Timers",Map:"World Map",Leaderboard:"WvW Leaderboard",Manager:"Account Manager",Gem:"Gem Alarm",Options:"Options"},Events:{Tile:"Timers Only",Timetable:"Full Timetable",Special:"Special Bosses",DryTop:"Dry Top",Help:"Help",Forum:"Forum"},Map:{Resource:"Resource Nodes",JP:"Jumping Puzzles",Collectible:"Collectible Items",Guild:"Guild Missions"},Checklist:{Personal:"Personal",Notepad:"Notepad",Daily:"Dailies",Raids:"Raids",Dungeons:"Dungeons"},Account:{Audit:"Audit",Characters:"Characters",Hero:"Hero",Achievements:"Achievements",Masteries:"Masteries",Recipes:"Recipes"},Inventory:{Inventory:"Inventory",Bank:"Bank",Materials:"Materials",Vault:"Vault",Possessions:"Possessions",Catalog:"Catalog",Cleanup:"Cleanup",Ascended:"Ascended"},Wardrobe:{Wardrobe:"Skins",Outfits:"Outfits",Gliders:"Gliders",Dyes:"Dyes",Minis:"Minis",Carriers:"Carriers",Champions:"Champions",Finishers:"Finishers",Nodes:"Nodes",Cats:"Cats",SAB:"SAB"},Trading:{TP:"Tracker",Trading:"Exchange",Buying:"Buying",Selling:"Selling",Bought:"Bought",Sold:"Sold",Museum:"Museum",Pact:"Pact"}},DirectoryExternal:{Forum:U.URL_META.Forum},DirectoryCompound:{Special:!0,Timetable:!0,DryTop:!0},SectionCurrent:{},ArticleCurrent:null,contentCurrentPlate:"",isContentLoaded_Map:!1,isContentLoaded_Help:!1,isSectionLoaded_Daily:!1,cHeaderPrefix:"#header",BrowserCurrent:-1,BrowserEnum:{Unknown:-1,IE:0,Opera:1,Firefox:2,Chrome:3},ClickEnum:{Left:1,Middle:2,Right:3},ScreenWidth:{Huge:2560,Large:1024,Medium:640},initializeFirst:function(){if(D.stopSpeech(),window!==window.top){I.isProgramEmbedded=!0;try{parent.document}catch(e){I.isProgramExternal=!0}}U.enforceURLArgumentsFirst(),I.enforceProgramMode(),U.updateLanguageLinks(),T.checkDST(),T.cUTC_OFFSET_USER=-(new Date).getTimezoneOffset()/T.cMINUTES_IN_HOUR,T.cUTC_OFFSET_USER<=T.cUTC_OFFSET_EASTERN&&T.cUTC_OFFSET_USER>=T.cUTC_OFFSET_HAWAII&&(O.Options.bol_use24Hour=!1);var e=T.getUNIXSeconds();O.initializeTimestamp(O.Utilities.timestampDaily),O.initializeTimestamp(O.Utilities.timestampWeekly),K.awakeTimestampPrevious=e,screen.height>=800?O.Options.int_setInitialZoomWvW=3:screen.height>=480?O.Options.int_setInitialZoomWvW=2:O.Options.int_setInitialZoomWvW=1,screen.width<1200&&(O.Options.bol_condenseBank=!0);var t=navigator.userAgent;-1!==t.indexOf("MSIE")||-1!==t.indexOf("Trident")?I.BrowserCurrent=I.BrowserEnum.IE:-1!==t.indexOf("Chrome")?I.BrowserCurrent=I.BrowserEnum.Chrome:-1!==t.indexOf("Firefox")?I.BrowserCurrent=I.BrowserEnum.Firefox:-1!==t.indexOf("Opera")&&(I.BrowserCurrent=I.BrowserEnum.Opera);try{window.speechSynthesis&&I.BrowserCurrent===I.BrowserEnum.Chrome&&I.ModeCurrent!==I.ModeEnum.Overlay&&(I.isSpeechSynthesisEnabled=!0,window.speechSynthesis.onvoiceschanged=function(){window.speechSynthesis.getVoices()})}catch(e){}$.ajaxSetup({timeout:I.cAJAXGlobalTimeout}),I.Scrl.Anchor=$("#itemAutoscroll"),I.qTip.start(),localStorage.obj_utlStoredWeapons&&(localStorage.obj_utlStoredCompasses=localStorage.obj_utlStoredWeapons),localStorage.obj_utlStoredWeaponsWvW&&(localStorage.obj_utlStoredCompassesWvW=localStorage.obj_utlStoredWeaponsWvW)},initializeLast:function(){I.initializeTooltip(),I.bindHelpButtons("#plateOptions"),I.bindWindowReadjust(),I.initializePlateMenu(),I.initializeHUD(),I.styleContextMenu("#mapContext"),I.askNotifications(!0),$("#mapHUDContainer").toggle(O.Options.bol_showHUD),$("#mapSwitchButton").click(function(){I.switchMap()}),$("#wvwSwitchButton").click(function(){I.switchMap()}),$(".mapDisplayButton").click(function(){$("#opt_bol_showPanel").trigger("click")}),$("#mapAccountButton, #wvwAccountButton").one("click",function(){I.loadAccountPanel()}).click(function(){I.toggleAccount()}),U.enforceURLArgumentsLast(),I.PageCurrent===I.PlateEnum.Chains&&U.openSectionFromURL(),$("#itemWarning").remove(),$("#cslClose").click(function(){I.clear()}),$("#cslSelect").click(function(){I.selectConsole()}),$("#cslToggle").click(function(){I.getConsole().toggle("fast")}),$(".hudItem").one("mouseenter",function(){$(this).find("img").each(function(){$(this).attr("src",$(this).attr("data-src"))})}),$("#mapAlarmPopup").one("mouseenter",function(){I.loadImg($(this)),K.initializeStopwatch(),$("#optAlarmSpeaker").click(function(){D.speak(D.getWord("alarm"))}),$("#optMute").click(function(){D.stopSpeech()})}),U.convertExternalLink(".linkExternal"),I.BrowserCurrent!==I.BrowserEnum.IE&&$("head").append("<style>.leaflet-clickable{cursor: url('img/cursor/pointer.cur'), pointer;}</style>"),$(window).focus(function(){I.isProgramFocused=!0}).blur(function(){I.isProgramFocused=!1}),$(document).mouseup(function(e){$(".jsRemovable, .jsHidable").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||($(this).hasClass("jsHidable")&&$(this).hide(),$(this).hasClass("jsRemovable")&&$(this).remove())})}).onEscapeKey(function(){I.isConsoleShown()&&I.clear()}),I.isCustomScrollEnabled&&$(document).on("ps-scroll-y",function(){I.clearAutoscroll()}),I.isMapEnabled&&I.bindScrollbar("#cslContent, #plateDirectory, #plateChains, #plateOptions"),O.cleanLocalStorage(),O.enforceProgramVersion(),D.translateAfter(),U.initializeLanguageButton(),P.wantTourPrediction()?$("#chnEvent_"+C.CurrentChainSD.nexus+"_"+C.CurrentChainSD.CurrentPrimaryEvent.num).trigger("click"):I.isMapEnabled&&(M.showCurrentZone(M.getZoneCenter(M.cInitialZone)),M.goToDefault(O.Options.int_setInitialZoom),I.ModeCurrent===I.ModeEnum.Overlay&&P.updateCharacter(0)),I.isMapEnabled&&(I.isProjectionEnabled?M.toggleFloor(!1):("wvw"===I.PageInitial&&$("#wvwSwitchButton").one("click",function(){M.toggleFloor(!0)}),M.toggleFloor(!0))),O.Options.bol_alertGem&&H.updateGemSubscription(),I.isProgramLoaded=!0},initializeChainsUI:function(){$("#plateChains header").click(function(){var e=U.getSubstringFromHTMLID($(this));$(this).next().slideToggle("fast",function(){var t=$(this).attr("id");if($(this).is(":visible")){I.updateScrollbar();var a=$(I.cPlatePrefix+I.PlateEnum.Chains),n=$(this).prev();switch(n.find("kbd").html(I.Symbol.Collapse),I.scrollToElement(n,{aContainer:a,aSpeed:"fast"}),t){case"sectionChains_Drytop":I.isMapEnabled&&(M.goToZone("dry",M.ZoomEnum.Bird),P.toggleDryTopIcons(!0)),$("#mapHUDContainerInner").hide();break;case"sectionChains_Special":H.toggleSpecialIcons(!0)}I.SectionCurrent[I.PlateEnum.Chains]=e===I.PageEnum.Chains.Scheduled?"":e}else{switch(I.updateScrollbar(),$(this).prev().find("kbd").html(I.Symbol.Expand),t){case"sectionChains_Drytop":P.toggleDryTopIcons(!1),$("#mapHUDContainerInner").show();break;case"sectionChains_Special":H.toggleSpecialIcons(!1)}I.SectionCurrent[I.PlateEnum.Chains]=""}U.updateQueryString()})}),$("#plateChains header:not(:first)").each(function(){$(this).next().toggle(0),$(this).find("kbd").html(I.Symbol.Expand)}),$("#plateChains header:first").each(function(){$(this).find("kbd").html(I.Symbol.Collapse)}),I.ModeCurrent===I.ModeEnum.Tile?($("#headerChains_Drytop").hide(),$("#sectionChains_Scheduled .chnDetails").hide()):$("#headerChains_Drytop").one("click",function(){P.generateDryTop()}),$("#headerChains_Legacy").one("click",function(){C.initializeUnscheduledChains(C.LegacyChains),I.readjustTile()}),$("#headerChains_Temple").one("click",function(){C.initializeUnscheduledChains(C.TempleChains),I.readjustTile()}),$("#chnToggle").click(function(){$("#opt_bol_expandWB").trigger("click")}),$("#headerChains_Timetable").one("click",function(){C.isTimetableGenerated=!0,C.initializeTimetableHTML(),I.readjustTile()}),I.readjustTile()},openChainsSection:function(e){$("#plateChains section").each(function(){var t=U.getSubstringFromHTMLID($(this));$(this).is(":visible")&&t!==e&&$(this).prev().trigger("click")}),e&&!1===$("#sectionChains_"+e).is(":visible")&&$("#headerChains_"+e).trigger("click")},getConsole:function(e){return e&&$("#itemConsole").show(),$("#cslContent")},getTextDuration:function(e,t){var a=18,n=3+parseInt(e.length/a);return t?n:n*T.cMSECONDS_IN_SECOND},askNotifications:function(e){O.Options.bol_alertDesktop&&("Notification"in window?"denied"!==Notification.permission&&Notification.requestPermission(function(t){e||I.notify("This is an example of a notification you will receive.")}):e||I.write("Your browser does not seem to support desktop notifications."))},isNotificationsAllowed:function(){return O.Options.bol_alertDesktop&&"Notification"in window&&"granted"===Notification.permission},notify:function(e){if(!1!==I.isNotificationsAllowed()){e="string"==typeof e?{aTitle:e}:e;var t=$.extend({aTitle:I.cSiteName,aBody:"",aIcon:"img/meta/logo_192x192.png",aDelay:O.Options.int_secAlertDesktop},e);t.aDelay*=T.cMSECONDS_IN_SECOND;var a=new Notification(t.aTitle,{icon:t.aIcon,body:t.aBody});a.onclick=function(e){window.focus(),this.close()},setTimeout(a.close.bind(a),t.aDelay)}},write:function(e,t,a,n){$("#itemConsole").show();var i=$("#cslContent").show();e=void 0===e?"undefinedstring":null===e?"nullstring":e.toString(),void 0===a&&(a=!1),!0===a&&i.empty(),!1===isFinite(t)&&(t=I.getTextDuration(e,!0));var r=!1!==n?"<br />":"";i.append(e+r),I.updateScrollbar(i),window.clearTimeout(I.consoleTimeout),0!==t&&(I.consoleTimeout=setTimeout(function(){i.css({opacity:1}).animate({opacity:0},600,function(){$(this).empty().css({opacity:1}),$("#itemConsole").hide()})},t*T.cMSECONDS_IN_SECOND))},greet:function(e,t,a){!1===I.isProgramEmbedded&&"wvw"!==I.PageInitial&&I.write(e,t,a)},print:function(e,t,a){t&&I.clear(),window.clearTimeout(I.consoleTimeout);var n=document.getElementById("itemConsole"),i=document.getElementById("cslContent"),r=!1!==a?"<br />":"";n.style.display="block",i.insertAdjacentHTML("beforeend",e+r)},paste:function(e){I.print("Click the box below to auto-copy:"),$("<textarea class='cssInputText cslText'></textarea>").appendTo(I.getConsole()).val(e),I.print(""),I.bindConsoleInput()},help:function(e){I.print("<div class='cslModal cntComposition'>"+e+"</div>",!0),U.convertExternalLink("#cslContent a")},warn:function(e,t){var a="Unable to retrieve "+e+". "+I.cErrorAPI;t?I.print(a):I.write(a)},urge:function(e,t){var a="<div class='cslUrgent'>"+e+"</div>";I.write(a,t,!1,!1),I.bindConsoleLink()},clear:function(){window.clearTimeout(I.consoleTimeout),$("#itemConsole").hide(),$("#cslContent").empty()},selectConsole:function(){I.selectText("#cslContent")},log:function(e,t){"string"==typeof e?I.print(e,t):I.prettyJSON(e,t)},printJSON:function(e){I.print(U.escapeJSON(e))},prettyJSON:function(e){I.print("<pre>"+U.escapeJSON(e)+"</pre>")},isConsoleShown:function(){var e=$("#itemConsole").is(":visible");return e&&I.clear(),e},bindConsoleInput:function(){I.getConsole().find(".cssInputText").each(function(){I.bindClipboard($(this),$(this).val(),!1),$(this).unbind("click").click(function(){$(this).select()})})},bindConsoleLink:function(){var e=I.getConsole().find("a");e.length&&(U.convertExternalLink(e),U.convertInternalLink(e))},selectText:function(e){var t=document.querySelector(e),a=window.getSelection(),n=document.createRange();n.selectNodeContents(t),a.removeAllRanges(),a.addRange(n)},scrollToElement:function(e,t){var a,n=t||{},i=$(e);switch(I.ModeCurrent){case I.ModeEnum.Mobile:$("body").scrollTop(i.offset().top);break;case I.ModeEnum.Tile:$("#windowMain").animate({scrollTop:i.offset().top-$("#windowMain").offset().top+$("#windowMain").scrollTop()},n.aSpeed||0);break;default:n.aContainer=n.aContainer||i.closest(".jsScrollable"),n.aContainer?(a=$(n.aContainer)).animate({scrollTop:i.offset().top-a.offset().top+a.scrollTop()+(n.aOffset||0)},n.aSpeed||0,function(){n.aCallback&&n.aCallback()}):(i.scrollTop(0),n.aCallback&&n.aCallback())}},removeThrobber:function(e){$(e).find(".itemThrobber").remove()},getBar:function(e,t,a){var n=e>100?100:e;return"<samp><s class='"+(t?"cssRight":"")+"' style='width:"+n+"%'>"+(a?"<mark></mark>":"")+"</s></samp>"},bulkAnimate:function(e,t){for(var a=0;a<e.length;a++){var n=e[a];$(n.s).animate(n.p,{duration:t,queue:!1})}},toggleElement:function(e,t,a,n){var i=$(e);n?i.toggle(t):t?i.show(a):i.hide(a)},toggleHUDOpacity:function(e,t,a){var n=$(e);a?(n.addClass(t+"Opaque"),n.removeClass(t+"OpaqueNot")):(n.addClass(t+"OpaqueNot"),n.removeClass(t+"Opaque"))},toggleToggleIcon:function(e,t,a){a||void 0===a?t?$(e).animate({rotation:0},200):$(e).animate({rotation:-90},200):t?$(e).css({rotation:0}):$(e).css({rotation:-90})},blinkElement:function(e,t,a){var n=parseInt(t/a);n=n%2==0?n:n+1;var i=!0,r=1,o=$(e),s=setInterval(function(){i?o.css({visibility:"hidden"}):o.css({visibility:"visible"}),i=!i,r===n&&clearInterval(s),r++},a)},bloatElement:function(e,t,a){var n=parseInt(t/a);n=n%2==0?n:n+1;for(var i=!0,r=0;r<n;r++)i?$(e).hide(a):$(e).show(a),i=!i},animateNumber:function(e,t,a,n){$({value:0}).animate({value:T.cPERCENT_100},{duration:a||3e3,easing:n||"swing",step:function(a){t(e*(a/T.cPERCENT_100))}})},colorizeValue:function(e,t,a){var n=$(e);n.removeClass("cssLimitEqual cssLimitWithin cssLimitExceed");var i;return i=void 0===a?t>0?"cssLimitWithin":t<0?"cssLimitExceed":"cssLimitEqual":t<=a?"cssLimitWithin":"cssLimitExceed",n.addClass(i),n},toggleHighlight:function(e,t){return void 0===t?e.hasClass("cssHighlight")?(e.removeClass("cssHighlight"),!1):(e.addClass("cssHighlight"),!0):t?(e.addClass("cssHighlight"),!0):(e.removeClass("cssHighlight"),!1)},suspendElement:function(e,t){void 0===t||!0===t?$(e).addClass("jsSuspended"):$(e).removeClass("jsSuspended")},styleContextMenu:function(e){$(e).addClass("jsHidable").find("li").each(function(){if(!$(this).hasClass("jsIgnore")){if(!1===$(this).hasClass("itemContextSubmenu"))!1===D.isLanguageDefault&&$(this).text(D.getPhraseOriginal($(this).text()));else{var e=$(this).find("> span");e.html(D.getPhraseOriginal(e.text())).append(" <kbd>"+I.Symbol.TriRight+"</kbd>")}$(this).prepend("<ins class='s16 s16_bullet'></ins> ")}}),$(e).find(".itemContextSubmenu").each(function(){$(this).mouseenter(function(){var e=$(this),t=$(this).find("ul").first(),a=e.offset(),n=e.width()/2,i=6,r=a.left+n,o=a.top,s=t.width(),c=t.height(),l=$(window).width(),u=$(window).height(),d=r+s>l?-(s-n)+"px":"50%",p=o+c>u?u-(o+c+i)+"px":"auto";t.css({left:d}),t.css({marginTop:p})})})},showContextMenu:function(e){var t=$(e),a=t.width(),n=t.height(),i=$(window).width(),r=$(window).height(),o=0,s=0,c=4;I.posX+a>i&&(o=I.posX+a+c-i),I.posY+n>r&&(s=I.posY+n+c-r),t.css({top:I.posY-s,left:I.posX-o}).show()},createFilterBar:function(e,t,a,n){var i=$(e),r=$(t),o=$("<input class='cntSearch cssInputText' type='text' />").appendTo(i);I.bindInputBarText(o),o.on("input",$.throttle(Q.cSEARCH_LIMIT,function(){var e=$(this).val().toLowerCase(),t=[],i="",o=!1;e.length>0?(t=e.split(" "),r.each(function(){var e=!0;if(i=$(this).data("keywords")||$(this).val()){for(var n=0;n<t.length;n++)if(-1===i.indexOf(t[n])){a?$(this).closest(a).hide():$(this).hide(),e=!1;break}e&&(o=!0,$(this).show())}}),o&&n&&$(n).hide()):(r.each(function(){a?$(this).closest(a).show():$(this).show()}),n&&$(n).show())})).click(function(e){e.stopPropagation(),$(this).select()})},createSearchBar:function(e,t){var a=t||{},n=a.aBarID?"id='"+a.aBarID+"'":"",i=$("<input "+n+" class='cntSearch cssInputText "+(a.aBarClass||"")+"' type='text' />").appendTo($(e));return Q.bindItemSearch(i,t),i},bindInputBarText:function(e,t){var a=t||D.getWordCapital("search")+"...";$(e).attr("placeholder",a)},bindInputSelect:function(e){return $(e).click(function(){$(this).select()})},preventMapPropagation:function(e){return $(e).each(function(){var e=L.DomUtil.get($(this)[0]);L.Browser.touch?L.DomEvent.on(e,"click",L.DomEvent.stopPropagation):(L.DomEvent.disableClickPropagation(e),L.DomEvent.on(e,"mousewheel",L.DomEvent.stopPropagation),L.DomEvent.on(e,"contextmenu",L.DomEvent.stopPropagation))})},bindClipboard:function(e,t,a){var n=e instanceof jQuery?e[0]:e,i=new Clipboard(n);return(a||void 0===a)&&i.on("success",function(e){I.write(I.cClipboardSuccessText+e.text,5)}),t&&I.updateClipboard(n,t),i},updateClipboard:function(e,t){$(e).attr(I.cClipboardAttribute,t)},bindScrollbar:function(e,t){if(I.isCustomScrollEnabled)try{var a=$(e).addClass("jsScrollable"),n=1;switch(I.BrowserCurrent){case I.BrowserEnum.Opera:n=5;break;case I.BrowserEnum.Firefox:n=3}a.perfectScrollbar({wheelSpeed:n,suppressScrollX:void 0===t||!t}),a.one("mouseenter",function(){a.perfectScrollbar("update")}),I.bindAutoscroll(a)}catch(e){}},updateScrollbar:function(e){if(I.isCustomScrollEnabled){var t=$(e);if(I.isMapEnabled)try{void 0===e?($("#plateDirectory").perfectScrollbar("update"),$("#plateChains").perfectScrollbar("update"),$("#plateMap").perfectScrollbar("update"),$("#plateHelp").perfectScrollbar("update"),$("#plateOptions").perfectScrollbar("update")):(!1===t.hasClass("ps-container")&&(t=t.closest(".ps-container")),t&&t.perfectScrollbar("update"))}catch(e){}else $("#windowMain").perfectScrollbar("update")}},bindAutoscroll:function(e){e.mousedown(function(e){e.which===I.ClickEnum.Middle?(clearInterval(I.Scrl.Interval),I.Scrl.isOn?I.clearAutoscroll():(I.Scrl.isOn=!0,I.Scrl.Anchor.css({top:I.posY,left:I.posX,backgroundImage:"url('img/cursor/autoscroll.png')"}).show(),I.Scrl.posX=I.posX,I.Scrl.posY=I.posY,I.Scrl.Container=$(this),I.tickAutoscroll())):e.which!==I.ClickEnum.Left&&e.which!==I.ClickEnum.Right||I.Scrl.isOn&&I.clearAutoscroll()})},clearAutoscroll:function(){clearInterval(I.Scrl.Interval),I.Scrl.isOn=!1,I.Scrl.Anchor.hide()},tickAutoscroll:function(){I.Scrl.isOn&&(I.Scrl.Interval=setInterval(function(){var e=5,t=720,a=I.posY-I.Scrl.posY,n=32,i=32,r=a<0?-1:1;a=Math.abs(a);var o=Math.pow(2,(a+n)/i);o>t&&(o=t),a>e&&I.Scrl.Container.scrollTop(I.Scrl.Container.scrollTop()+r*o)},50))},bindSortableTable:function(e,t){var a=$(e),n=t||{},i=n.aIsList,r=function(e,t){var n=[];(i?a.find("li"):a.find("tr")).slice(1).each(function(){var t=i?$(this).attr("data-value"):$(this).find("td:eq("+e+")").attr("data-value");n.push({item:$(this),value:isNaN(t)?t:parseFloat(t)})}),U.sortObjects(n,{aKeyName:"value",aIsDescending:t});for(var r=0;r<n.length;r++)n[r].item.appendTo(a)},o=0,s=i?a.find("li:first"):a.find("th");s.each(function(){!function(e,t){e.addClass("curToggle").append("&nbsp;<span class='jsSortableHeaderSymbol'>"+I.Symbol.TriDown+"</span>").click(function(){I.toggleSortableHeader($(this)),r(t,$(this).data("isdescending"))})}($(this),o),o++}),n.aPresortColumn&&s.eq(n.aPresortColumn).trigger("click")},toggleSortableHeader:function(e){var t=$(e),a=t.data("isdescending");void 0===a&&(a=!1),t.data("isdescending",!a);var n=a?I.Symbol.TriUp:I.Symbol.TriDown;t.find(".jsSortableHeaderSymbol").html(n)},generateSectionMenu:function(e){if(!($(e+" header.jsSection").length<=0)){var t=e.substring(I.cPlatePrefix.length,e.length);$(e+" header.jsSection").each(function(){var a=$(this),n=U.getSubstringFromHTMLID($(this)),i=a.next().addClass("cntSection"),r=$(this).children("var").first(),o=r.length&&!1===D.isLanguageDefault?D.getModifiedPhrase(a.text().toLowerCase(),U.CaseEnum.Title):a.text();r.text(o),i.hide(),a.wrapInner("<span></span>"),a.append("<sup>"+I.Symbol.Expand+"</sup>"),a.click(function(){var a=!1;$(this).next().is(":visible")?($(this).children("sup").text(I.Symbol.Expand),I.displaySectionMarkers(n,!1),I.SectionCurrent[t]="",$(e+" header.jsSection").show(),$(e+" header.cntHeader").show()):(a=!0,$(this).children("sup").text(I.Symbol.Collapse),$(e+" .plateBeamIcon[data-section='"+n+"']").addClass("plateBeamIconActive"),I.displaySectionMarkers(n,!0),I.SectionCurrent[t]=n,!0===$(this).data("beamclicked")&&($(e+" header.jsSection").not(this).hide(),$(e+" header.cntHeader").hide(),$(this).removeData("beamclicked")),$(this).hasClass("jsMapDefault")&&M.goToDefault()),U.updateQueryString(),!0!==$(this).data("donotanimate")?I.ModeCurrent===I.ModeEnum.Website?$(this).next().toggle("fast",function(){I.updateScrollbar(e)}):($(this).next().toggle(),I.updateScrollbar(e)):$(this).next().toggle(),$(this).removeData("donotanimate"),a&&I.scrollToElement($(this),{aContainer:e,aSpeed:"fast",aOffset:-12})}),a.one("click",function(){I.loadImg($(this).next())}),$("<div class='curClick jsSectionDone'><img src='img/ui/close.png' />"+o+"</div>").appendTo(i).click(function(){$(this).parent().prev().trigger("click")}),(I.isMapEnabled||!1===a.hasClass("mapOnly"))&&a.find("img").attr("id","plateBeamIcon_"+n).addClass("plateBeamIcon curClick").click(function(t){t.stopPropagation(),$(e+" header.jsSection").each(function(){$(this).next().is(":visible")&&$(this).attr("id")!==a.attr("id")&&($(this).data("donotanimate",!0),$(this).trigger("click"))}),a.data("beamclicked",!0),a.trigger("click")})}),$("<img id='plateBeamIconCollapse_"+t+"' class='plateBeamIcon plateBeamIconCollapse curClick' src='img/ui/adjust_minus.png' title='&lt;dfn&gt;"+D.getPhraseTitle("collapse all section")+"&lt;/dfn&gt;' />").prependTo(e).click(function(){$(e+" header.jsSection").each(function(){$(this).next().is(":visible")&&$(this).trigger("click")}),$(e+" .plateBeamIcon").removeClass("plateBeamIconActive")}),I.qTip.init(e+" .plateBeamIcon")}},displaySectionMarkers:function(e,t){var a,n=$("#mapToggle_"+e);n.length&&(a=n.data("checked"),n.data("hideonly")?t||n.trigger("click"):t?a||(n.trigger("click"),n.data("checked",!0)):a&&(n.trigger("click"),n.data("checked",!1)))},loadStylesheet:function(e){e!==I.ModeEnum.Website&&void 0===I.LoadedStylesheets[e]&&($("head").append("<link rel='stylesheet' type='text/css' href='style/"+e.toLowerCase()+".css' />"),I.LoadedStylesheets[e]=!0)},loadImg:function(e){("string"==typeof e?$(e):e.find("img")).each(function(){$(this).attr("data-src")&&($(this)[0].src=$(this).data("src"))})},bindHelpButtons:function(e){$(e+" .jsHelpCollapsible").each(function(){$(this).text("[?+]").attr("title","<dfn>More Info</dfn>"),$(this).next().hide(),$(this).click(function(){$(this).next().toggle(),$(this).next().is(":visible")?$(this).text("[?-]"):$(this).text("[?+]")})}),$(e+" .jsHelpTooltip").each(function(){var e="<dfn>Info:</dfn> "+$(this).attr("title");$(this).text(I.Symbol.Help).attr("title",e)}),I.qTip.init(e+" .jsHelpCollapsible"),I.qTip.init(e+" .jsHelpTooltip")},toggleButtonState:function(e){var t=!e.data("checked");return e.data("checked",t),t},bindPseudoCheckbox:function(e,t){void 0===t&&(t=.3),$(e).click(function(){!0!==$(this).data("checked")?($(this).css({opacity:t}),$(this).data("checked",!0)):($(this).css({opacity:1}),$(this).data("checked",!1))})},initializeDirectory:function(){var e,t,a,n,i,r,o,s,c,l=$("#dirContent"),u=!D.isLanguageDefault,d=0;X.initializeChecklist(X.Checklists.Directory,U.getObjectLength(I.Directory));for(var p in I.Directory){if(e=$("<div class='dirGroup'></div>").appendTo(l),t=p.toLowerCase(),a=u?D.getWordCapital(t):p,i=0===d?"dirHeaderPrimary":"dirHeaderSecondary curToggle",n=$("<h2 class='dirHeader "+i+"'><ins class='dirHeaderIcon mnu mnu_"+t+"'></ins><var class='dirHeaderName'>"+a+"</var></h2>").appendTo(e),r=$("<ul id='dirList_"+d+"' class='dirList'></ul>").appendTo(e),I.ModeCurrent===I.ModeEnum.Mobile)break;0!==d&&(n.click(function(){var e=$(this).next();X.setChecklistItem(X.Checklists.Directory,U.getSubintegerFromHTMLID(e),e.is(":visible")?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked),e.toggle()}),X.getChecklistItem(X.Checklists.Directory,d)===X.ChecklistEnum.Checked&&r.hide());for(var h in I.Directory[p])s=o=I.Directory[p][h],I.DirectoryCompound[h]?s=D.getTranslation(o):u&&(s=D.getModifiedPhrase(o.toLowerCase(),U.CaseEnum.Title)),c=$("<li class='curClick'>"+s+"</li>").appendTo(r).data("keywords",(a+" "+s).toLowerCase()),function(e){c.click(function(t){t.which===I.ClickEnum.Left&&(I.DirectoryExternal[e]?U.openExternalURL(I.DirectoryExternal[e]):U.interpretPage(e))})}(h);d++}var m=$(".dirHeaderPrimary").first();m.find(".dirHeaderName").addClass("curToggle").attr("id","dirHeaderClock").click(function(){$("#opt_bol_use24Hour").trigger("click")}),I.ModeCurrent!==I.ModeEnum.Tile&&($("#itemDashboard").insertAfter(m),I.createFilterBar($("<div id='dirSearch'></div>").insertAfter("#dsbContainer"),".dirGroup .curClick",null,".dirHeaderSecondary"))},initializePlateMenu:function(){$(".plateMenuButton").each(function(){$(this).click(function(){var e=$(this).attr("id");switch($(".plateMenuButton").removeClass("plateMenuButtonActive"),$(this).addClass("plateMenuButtonActive"),I.PageCurrent=e.substring(I.cPlateMenuPrefix.length-1,e.length),I.contentCurrentPlate=I.cPlatePrefix+I.PageCurrent,P.MapSwitchWebsite===P.MapEnum.Mists&&(I.PagePrevious=I.PageCurrent),I.PageCurrent){case I.PlateEnum.Directory:O.Options.bol_hideHUD&&$("#mapHUDContainerInner").show(),C.isTouringManual=!1,I.ModeCurrent===I.ModeEnum.Website&&(I.openChainsSection(),$("#plateBeamIconCollapse_Map").trigger("click"));break;case I.PlateEnum.Chains:O.Options.bol_hideHUD&&$("#mapHUDContainerInner").show(),C.isTouringManual=!1;break;case I.PlateEnum.Map:I.isMapEnabled&&M.movePin(M.Pin.Event)}$("#paneContent article").hide(),I.PageCurrent!==I.PlateEnum.Chains&&I.PageCurrent!==I.PlateEnum.Directory&&O.Options.bol_hideHUD&&$("#mapHUDContainerInner").hide(),I.isCustomScrollEnabled&&($(I.contentCurrentPlate+" .cntHeader").css({opacity:0}).animate({opacity:1},400),$(I.contentCurrentPlate).animate({width:"show"},200)),$(I.contentCurrentPlate).show(),U.updateQueryString(),I.isMapEnabled&&M.toggleLayer(M.ZoneCurrent.Layers.Path,P.isChainPathsAllowed())}).one("click",K.styleClock)}),$(I.cPlateMenuPrefix+"Map").one("click",I.loadMapPlate),$(I.cPlateMenuPrefix+"Help").one("click",I.loadHelpPlate),$(I.cPlateMenuPrefix+"Options").one("click",I.loadOptionsPlate)},switchMap:function(e){if(P.MapSwitchWebsite===P.MapEnum.Tyria&&!1===W.isWvWPrepped){W.isWvWPrepped=!0,I.loadStylesheet("wvw"),I.loadImg("#wvwHUDPane .hudButton"),$("#lboCurrent").append(I.cThrobber);var t=setInterval(function(){"absolute"===$("#wvwLeaderboard").css("position")&&(window.clearInterval(t),U.getScript(U.URL_DATA.WvW,function(){W.initializeWvW(e)}))},100)}switch(P.MapSwitchWebsite){case P.MapEnum.Tyria:$("#mapPane").hide(),$("#wvwPane").show(),W.isMapInitialized&&W.refreshMap(),I.PagePrevious=I.PageCurrent,I.PageCurrent=I.SpecialPageEnum.WvW,P.MapSwitchObject=W,P.MapSwitchWebsite=P.MapEnum.Mists,P.MapSwitchSuffix=W.OptionSuffix;break;case P.MapEnum.Mists:$("#wvwPane").hide(),$("#mapPane").show(),M.refreshMap(),I.PageCurrent=I.PagePrevious,I.PagePrevious=I.SpecialPageEnum.WvW,P.MapSwitchObject=M,P.MapSwitchWebsite=P.MapEnum.Tyria,P.MapSwitchSuffix=M.OptionSuffix}U.updateQueryString()},toggleAccount:function(){var e=$("#panelAccount"),t=$("#accContent");e.is(":visible")?(t.hide(),A.reinitializePanel(),e.css({width:"100%"}).animate({width:0},"fast",function(){if($(this).hide(),I.isMapEnabled)switch($("#panelMap").show(),P.MapSwitchWebsite){case P.MapEnum.Tyria:$("#mapPane").show(),M.refreshMap();break;case P.MapEnum.Mists:$("#wvwPane").show(),W.isMapInitialized&&W.refreshMap()}}),I.PageCurrent=I.PagePrevious,I.PagePrevious=I.SpecialPageEnum.Account):(e.show().css({width:0}).animate({width:"100%"},"fast",function(){t.show(),A.adjustAccountPanel()}),I.PagePrevious=I.PageCurrent,I.PageCurrent=I.SpecialPageEnum.Account,$("#panelMap").hide()),U.updateQueryString()},loadAccountPanel:function(e){!1===A.isAccountInitialized&&!1===I.isAccountPanelInitialized&&(I.isAccountPanelInitialized=!0,I.loadStylesheet("account"),$("#panelAccount").load(U.getPageSrc("account"),function(){U.getScript(U.URL_DATA.Account,function(){A.initializeAccount(e)})}))},bindAfterAJAXContent:function(e){var t=I.cPlatePrefix+e;I.generateSectionMenu(t),I.isMapEnabled&&I.bindScrollbar(t),I.bindHelpButtons(t),M.bindMapLinks(t),U.convertExternalLink(t+" a"),I.qTip.init("button"),U.openSectionFromURL(),D.translateElements()},loadMapPlate:function(e){I.isMapPlateInitialized||(I.isMapPlateInitialized=!0,e&&$(I.cPlateMenuPrefix+"Map").trigger("click"),I.loadStylesheet("features"),$("#plateMap").append(I.cThrobber).load(U.getPageSrc("map"),function(){I.bindAfterAJAXContent(I.PlateEnum.Map),I.ModeCurrent===I.ModeEnum.Mobile&&$(".mapOnly").remove(),$("#headerMap_Daily").one("click",function(){G.generateAndInitializeDailies(),I.isSectionLoaded_Daily=!0}),$("#headerMap_Resource").one("click",function(){G.generateAndInitializeResources()}),$("#headerMap_JP").one("click",function(){G.generateAndInitializeJPs()}),$("#headerMap_Personal").one("click",function(){X.initializePersonalChecklist()}),$("#headerMap_TP").one("click",function(){E.initializeCalculator(),E.initializeTrading(),E.initializeExchange()}),$("#headerMap_Notepad").one("click",function(){X.initializeNotepad()}),$("#headerMap_Collectible").one("click",function(){G.generateCollectiblesUI()}),$("#headerMap_Guild").one("click",function(){G.generateGuildUI()}),I.qTip.init("#plateMap label"),"string"==typeof e&&$("#plateBeamIcon_"+e).trigger("click")}))},loadHelpPlate:function(){$("#plateHelp").append(I.cThrobber).load(U.getPageSrc("help"),function(){I.bindAfterAJAXContent(I.PlateEnum.Help),I.bindInputSelect(".jsCopyCode")})},loadOptionsPlate:function(){$("#plateOptions label").each(function(){$(this).data("keywords",$(this).text().toLowerCase())}),I.createFilterBar("#optSearch","#plateOptions label",null,"#plateOptions h2")},initializeHUD:function(){U.convertModeLink(".hudHelpColumn a"),U.convertExternalLink(".hudHelpColumn a"),I.bindScrollbar(".hudHelpScroll"),$(".hudPeripheral").css({visibility:"visible"})},showHomeLink:function(){var e=$("#itemHome").css({display:"table"});$("<a id='itemHomeButton' title='&lt;dfn&gt;Switch back to full site.&lt;/dfn&gt;' href='./'> <img id='iconSimpleHome' src='img/ui/about.png' /></a>").appendTo(e),I.qTip.init(e)},enforceProgramMode:function(){if(I.ModeCurrent===I.ModeEnum.Projection){var e=32;I.ModeCurrent=I.ModeEnum.Overlay,I.isProjectionEnabled=!0,$("#panelMap, #windowMain").css({background:"transparent"}),$("#itemVignette").remove(),$("#itemProjector, #prjController").show(),$("#itemTimeline").css({top:e+"px"}),$("#prjController").contextmenu(function(e){e.preventDefault();var t="#"+P.MapSwitchWebsite;I.showContextMenu(t+"Context")}),$("#prjToggleTerrain").click(function(){P.MapSwitchObject.toggleFloor()}),$("#prjToggleHUD").click(function(){$("#opt_bol_showHUD"+P.MapSwitchSuffix).trigger("click")}),$("#prjTogglePanel").click(function(){$("#opt_bol_showPanel").trigger("click")})}switch(I.loadStylesheet(I.ModeCurrent),I.ModeCurrent){case I.ModeEnum.Website:$("head").append("<link rel='alternate' media='only screen and (max-width: 640px)' href='http://gw2timer.com/?mode=Mobile'>");break;case I.ModeEnum.Overlay:I.cPANE_MENU_HEIGHT=32,I.loadImg("#mapGPSIcon"),$(".hudSelect").removeAttr("title"),K.styleClock(),$(document.body).on("keydown",this,function(e){116===e.keyCode&&window.location.reload(!0)});break;case I.ModeEnum.Simple:I.isMapEnabled=!1,I.showHomeLink(),$("#itemTimeline").appendTo("#panelApp"),$("#itemLanguage").insertAfter("#itemHome"),I.readjustSimple(),K.styleClock();break;case I.ModeEnum.Mobile:I.isMapEnabled=!1,I.isCustomScrollEnabled=!1,I.showHomeLink(),$("head").append("<meta name='viewport' content='width=device-width, initial-scale=1' />").append("<link rel='canonical' href='http://gw2timer.com' />"),$("#itemLanguage").insertAfter("#itemHome");break;case I.ModeEnum.Tile:if(I.isMapEnabled=!1,H.isVertical=!1,I.showHomeLink(),$("#itemLanguage").prependTo("#plateChains"),$("#itemLanguage").insertAfter("#itemHome"),I.isProgramEmbedded)$("<style type='text/css'>.chnBar, .chnSlot {margin-bottom:4px !important; margin-right: 4px !important;}</style>").appendTo("head");else{var t=parseInt($("#chnProgressBar").css("margin-top"));$("#itemTimeline").prependTo("#panelApp"),$("#windowMain").scroll(function(){$("#itemTimeline").is(":visible")?$("#chnProgressBar").css("margin-top",Math.max(-$("#itemTimeline").outerHeight(!0)+t,-$("#windowMain").scrollTop())):$("#chnProgressBar").css("margin-top",t)});var a=$("#itemDashboard"),n=$("<div id='dsbContainerOuter'></div>").appendTo("#plateChains");a.appendTo(n),$(".dsbTab").click(function(){setTimeout(function(){I.updateScrollbar("#windowMain"),I.scrollToElement(a)},600)})}I.bindScrollbar("#windowMain")}!1===I.isMapEnabled&&$("#itemDisplayButton").remove(),I.ModeCurrent===I.ModeEnum.Website&&!1===I.isProgramEmbedded?$("#paneClockIcons img").addClass("curZoom"):$("#paneClockIcons img").addClass("curClick"),I.isProgramEmbedded&&($("#itemWarning, .hudTitle").remove(),$(".btnSite, .hudLinks").hide()),I.ModeCurrent===I.ModeEnum.Simple&&I.ModeCurrent!==I.ModeEnum.Overlay&&(H.isDashboardEnabled=!1),I.isProgramEmbedded||I.ModeCurrent===I.ModeEnum.Mobile||I.ModeCurrent===I.ModeEnum.Tile?(I.setInitialPlate(I.PlateEnum.Chains),!1===I.isMapEnabled&&($("#mapAlarmPopup").appendTo("#chnAlarm").removeClass("hudPopup").addClass("cntPopup"),I.loadImg($("#chnAlarm"))),I.ModeCurrent!==I.ModeEnum.Tile&&K.styleClock()):I.setInitialPlate(I.PlateEnum.Directory)},getMode:function(){return I.isProjectionEnabled?I.ModeEnum.Projection:I.ModeCurrent},setInitialPlate:function(e){I.PageCurrent=e,$("#plate"+e).show(),$(I.cPlateMenuPrefix+e).addClass("plateMenuButtonActive")},sleepOverlay:function(){I.isSleeping&&(I.isSleeping=!1,$(".jsSleepable, .hudPeripheral, .btnWindow").removeClass("jsSleeped")),window.clearTimeout(I.SleepTimeout),I.SleepTimeout=setTimeout(function(){if(!M.isMouseOnHUD&&!W.isMouseOnHUD){var e=I.isProjectionEnabled?".mapDisplayButton":"";I.isSleeping=!0,$(".jsSleepable, .hudPeripheral, .btnWindow").not(e).addClass("jsSleeped")}},I.cMSECONDS_SLEEP)},bindWindowReadjust:function(){$(window).on("resize",$.throttle(200,function(){switch(I.ModeCurrent){case I.ModeEnum.Simple:I.readjustSimple();break;case I.ModeEnum.Tile:I.readjustTile()}W.isWvWLoaded&&(W.readjustLeaderboard(),W.readjustLog()),A.isAccountInitialized&&A.adjustAccountPanel()}))},readjustSimple:function(){var e=$(window).height()/2,t=$(window).width()/2,a=I.cPANE_CLOCK_HEIGHT/2;$("#paneSimple").css({"margin-top":e-a-72}),$("#paneClock").css({"margin-top":e-a,"margin-left":t-a})},readjustTile:function(){if(I.ModeCurrent===I.ModeEnum.Tile){var e=T.stepFunction($(window).width(),200,14,22,1);$(".chnTitle h1, .chnTitle time").css({fontSize:e+"px"})}},initializeTooltip:function(){I.qTip.init("#mapAlarm img, a, ins, kbd, span, time, fieldset, label, input, button")},qTip:{name:"qTip",offsetX:0,offsetY:0,TipElm:null,start:function(){this.TipElm=document.createElement("div"),this.TipElm.setAttribute("id",this.name),document.body.appendChild(this.TipElm),document.onmousemove=$.throttle(I.cTOOLTIP_MOUSEMOVE_MS,function(e){I.qTip.move(e)})},init:function(e){var t,a;$(e).each(function(){t=$(this)[0],a=t.getAttribute("title"),t&&a&&(t.setAttribute(I.cTooltipAttribute,a),t.removeAttribute("title"),t.removeAttribute("alt"),t.onmouseenter=function(){I.qTip.show(this.getAttribute(I.cTooltipAttribute))},t.onmouseleave=function(){I.qTip.hide()})})},reinit:function(){$(".jsTitle").each(function(){$(this).removeClass("jsTitle"),I.qTip.init($(this))})},move:function(e){e&&(I.posX=e.pageX,I.posY=e.pageY);var t=$("#qTip").width(),a=$("#qTip").height(),n=t+I.cTOOLTIP_OVERFLOW_ADD_X,i=a+I.cTOOLTIP_OVERFLOW_ADD_Y,r=$(window).width(),o=$(window).height();I.ModeCurrent===I.ModeEnum.Overlay&&I.sleepOverlay(),this.offsetX=I.cTOOLTIP_OFFSET_ADD_X,this.offsetY=-(a+I.cTOOLTIP_OFFSET_ADD_Y),I.posY+this.offsetY<0&&(I.posY+i<o?this.offsetY=I.cTOOLTIP_OVERFLOW_ADD_Y:this.offsetY=o-(a+I.posY+I.cTOOLTIP_PADDING_ADD_Y)),(I.posX+n>r||I.posX+I.cPANEL_WIDTH>r)&&(I.posX-n<0?this.offsetX=-I.posX:this.offsetX=-n),this.TipElm.style.left=I.posX+this.offsetX+"px",this.TipElm.style.top=I.posY+this.offsetY+"px"},show:function(e){this.TipElm.innerHTML=e,this.TipElm.style.display="block",this.TipElm.classList.add("cssFadeIn");for(var t=0;t<I.cTOOLTIP_NUM_RERENDER;t++)I.qTip.move()},hide:function(){this.TipElm.innerHTML="",this.TipElm.style.display="none",this.TipElm.classList.remove("cssFadeIn")}}}).initializeFirst(),O.initializeOptions(),T.initializeSchedule(),P.initializeMap(),K.initializeClock(),I.initializeLast()});