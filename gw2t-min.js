$(window).on("load",function(){var O,U,X,E,D,C,M,P,G,W,T,K,I={};O={lengthOfPrefixes:3,prefixOption:"opt_",legalLocalStorageKeys:new Array,isServerReset:!1,Utilities:{programVersion:{key:"int_utlProgramVersion",value:150806},lastLocalResetTimestamp:{key:"int_utlLastLocalResetTimestamp",value:0}},enforceProgramVersion:function(){var e=O.Utilities.programVersion.value,t=parseInt(localStorage[O.Utilities.programVersion.key]);if(isFinite(t)&&t!==e){var n=I.ModeCurrent===I.ModeEnum.Overlay?15:30;I.clear(),I.write(I.cSiteName+" was updated since your last visit.<br />This version: "+e+"<br />Your version: "+t+"<br />Would you like to see the <a class='urlUpdates' href='"+U.URL_META.News+"'>changes</a>?<br /><br />Try out the new <a class='urlUpdates' href='http://gw2timer.com/?mode=Tile'>Tile Mode!</a><br />Auto-scales for laptops, tablets, and small screens.<br />",n),U.convertExternalLink(".urlUpdates")}localStorage[O.Utilities.programVersion.key]=O.Utilities.programVersion.value},Options:{enu_Language:"en",enu_Server:"1008",bol_hideChecked:!1,bol_expandWB:!0,bol_collapseChains:!0,int_setClock:0,int_setDimming:0,int_setPredictor:0,bol_alignPanelRight:!0,bol_showPanel:!0,bol_showMap:!0,bol_showZoneRectangles:!1,bol_showPersonalPaths:!0,bol_showChainPaths:!0,bol_tourPrediction:!0,bol_showWorldCompletion:!1,bol_displaySectors:!0,bol_displayWaypoints:!0,bol_displayPOIs:!0,bol_displayVistas:!0,bol_displayChallenges:!0,bol_displayHearts:!0,bol_displayEvents:!1,bol_showWorldCompletionWvW:!1,bol_displaySectorsWvW:!0,bol_displayWaypointsWvW:!0,bol_displayPOIsWvW:!0,bol_displayVistasWvW:!0,bol_displayChallengesWvW:!0,bol_displayCharacter:!0,bol_followCharacter:!1,bol_displayCharacterWvW:!0,bol_followCharacterWvW:!1,int_msecGPSRefresh:100,int_setAlarm:0,int_volAlarm:100,bol_alertArrival:!0,bol_alertAtStart:!0,bol_alertAtEnd:!0,bol_alertChecked:!1,int_alertSubscribedFirst:1,int_alertSubscribedSecond:15,bol_alertAutosubscribe:!0,bol_alertUnsubscribe:!0,int_sizeNotepadFont:12,int_sizeNotepadHeight:400,bol_refreshPrices:!0,bol_useMainTPSearch:!0,int_numTradingCalculators:25,int_numTradingResults:30,int_secTradingRefresh:60,int_shiftLogin:0,bol_clearChainChecklistOnReset:!0,bol_clearPersonalChecklistOnReset:!0,bol_use24Hour:!0,bol_detectDST:!0,bol_useSiteTag:!0},OptionRange:{},LanguageCode:{en:"en-US",de:"de-DE",es:"es-ES",fr:"fr-FR",cs:"cs-CZ",it:"it-IT",pl:"pl-PL",pt:"pt-BR",ru:"ru-RU",zh:"zh-CN"},OptionEnum:{Language:{Default:"en",English:"en",German:"de",Spanish:"es",French:"fr",Czech:"cs",Italian:"it",Polish:"pl",Portuguese:"pt",Russian:"ru",Mandarin:"zh"},Server:{AnvilRock:"1001",BorlisPass:"1002",YaksBend:"1003",HengeofDenravi:"1004",Maguuma:"1005",SorrowsFurnace:"1006",GateofMadness:"1007",JadeQuarry:"1008",FortAspenwood:"1009",EhmryBay:"1010",StormbluffIsle:"1011",Darkhaven:"1012",SanctumofRall:"1013",CrystalDesert:"1014",IsleofJanthir:"1015",SeaofSorrows:"1016",TarnishedCoast:"1017",NorthernShiverpeaks:"1018",Blackgate:"1019",FergusonsCrossing:"1020",Dragonbrand:"1021",Kaineng:"1022",DevonasRest:"1023",EredonTerrace:"1024",FissureofWoe:"2001",Desolation:"2002",Gandara:"2003",Blacktide:"2004",RingofFire:"2005",Underworld:"2006",FarShiverpeaks:"2007",WhitesideRidge:"2008",RuinsofSurmia:"2009",SeafarersRest:"2010",Vabbi:"2011",PikenSquare:"2012",AuroraGlade:"2013",GunnarsHold:"2014",JadeSea:"2101",FortRanik:"2102",AuguryRock:"2103",VizunahSquare:"2104",Arborstone:"2105",Kodash:"2201",Riverside:"2202",ElonaReach:"2203",AbaddonsMouth:"2204",DrakkarLake:"2205",MillersSound:"2206",Dzagonur:"2207",BaruchBay:"2301"}},IntEnum:{Predictor:{Auto:0,Min:1,MinAvg:2,Avg:3},Clock:{Compact:0,Full:1,Bar:2,None:3},Alarm:{Off:0,Checklist:1,Subscription:2}},validateEnum:function(e,t){var n,i=O.OptionEnum[U.getVariableSuffix(e)];for(n in i)if(i[n]===t)return t;return O.Options[e]},TypeEnum:{isBoolean:"bol",isInteger:"int",isFloat:"flt",isEnum:"enu",isString:"str"},initializeLegalLocalStorageKeys:function(){var e;for(e in O.Utilities)O.legalLocalStorageKeys.push(O.Utilities[e].key);for(e in O.Options)O.legalLocalStorageKeys.push(e);for(e in X.Checklists)O.legalLocalStorageKeys.push(X.Checklists[e].key);for(e in X.Collectibles)O.legalLocalStorageKeys.push(X.Collectibles[e].key);for(e in X.Textlists)O.legalLocalStorageKeys.push(X.Textlists[e].key)},cleanLocalStorage:function(){var e,t,n,i;for(e=0;e<localStorage.length;e++){n=localStorage.key(e);for(t in O.legalLocalStorageKeys)if(n===O.legalLocalStorageKeys[t]){i=!0;break}i!==!0?localStorage.removeItem(n):i=!1}},convertLocalStorageDataType:function(e){var t=e.toLowerCase();return"true"===t?!0:"false"===t?!1:isFinite(t)?t%0===0?parseInt(t):parseFloat(t):e},getObjectLength:function(e){var t=0;for(var n in e)t++;return t},intToBool:function(e){return e>0?!0:!1},boolToInt:function(e){return e?1:0},stringToBool:function(e){return"true"===e.toLowerCase()?!0:!1},boolToString:function(e){return e?"true":"false"},randomBool:function(){return Math.random()>.5?!0:!1},isInteger:function(e){return!isNaN(e)&&function(e){return(0|e)===e}(parseFloat(e))},objToBool:function(e){return e?!0:!1},updateLocalResetTimestamp:function(){O.Utilities.lastLocalResetTimestamp.value=T.getUNIXSeconds(),localStorage[O.Utilities.lastLocalResetTimestamp.key]=O.Utilities.lastLocalResetTimestamp.value},checkResetTimestamp:function(){var e=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Seconds),t=T.getUNIXSeconds()-e;O.Utilities.lastLocalResetTimestamp.value<t&&O.clearServerSensitiveOptions(0===e)},getIndexOfSelectedRadioButton:function(e){var t=$("fieldset[name="+e+"] input:radio[name="+e+"]");return t.index(t.filter(":checked"))},initializeOptions:function(){O.initializeLegalLocalStorageKeys();var e,t,n;for(e in O.Options)$("#"+O.prefixOption+e).each(function(){t=$(this).attr("type"),n=U.getVariablePrefix(e),"radio"===t?O.OptionRange[e]=new Array(0,$("fieldset[name="+e+"] input").length-1):("number"===t||"range"===t)&&(O.OptionRange[e]=new Array($(this).prop("min"),$(this).prop("max")))}),I.isProgramEmbedded?void 0!==U.Args[e]&&(O.Options[e]=O.convertLocalStorageDataType(U.sanitizeURLOptionsValue(e,U.Args[e]))):(void 0!==U.Args[e]&&(localStorage[e]=U.sanitizeURLOptionsValue(e,U.Args[e])),void 0===localStorage[e]?localStorage[e]=O.Options[e]:O.Options[e]=O.convertLocalStorageDataType(localStorage[e])),$("#"+O.prefixOption+e).each(function(){t=$(this).attr("type"),n=U.getVariablePrefix(e),"checkbox"===t?$(this).prop("checked",O.Options[e]):"number"===t||"range"===t?$(this).val(O.Options[e]):"radio"===t&&$("input:radio[name="+e+"]:eq("+O.Options[e]+")").prop("checked",!0),"radio"===t?$("fieldset[name="+e+"]").change(function(){var e=$(this).attr("name");O.Options[e]=O.getIndexOfSelectedRadioButton(e),localStorage[e]=O.Options[e]}):$(this).change(function(){var e=$(this).attr("type"),t=$(this).attr("id").slice(O.prefixOption.length);if("checkbox"===e)O.Options[t]=$(this).prop("checked");else if("number"===e||"range"===e){var n=$(this).val(),i=parseInt(n);O.Options[t]=isFinite(n)&&i>=O.OptionRange[t][0]&&i<=O.OptionRange[t][1]?i:O.OptionRange[t][0],$(this).val(O.Options[t])}else O.Options[t]=$(this).val();localStorage[t]=O.Options[t]})});O.bindOptionsInputs(),U.initializeAPIURLs()},clearServerSensitiveOptions:function(e){O.isServerReset=!0;var t=10;e?I.write("Daily Reset!",t):I.write("Daily Timestamp Expired!",t);var n,i,a;if(O.Options.bol_clearChainChecklistOnReset){for(n in C.Chains)i=C.Chains[n],$("#chnCheck_"+i.nexus).removeClass("chnChecked"),$("#chnBar_"+i.nexus).css({opacity:1}),X.getChecklistItem(X.Checklists.Chain,i.nexus)!==X.ChecklistEnum.Disabled&&$("#chnBar_"+i.nexus).show();X.clearChecklist(X.Checklists.Chain,X.ChecklistJob.UncheckTheChecked)}O.Options.bol_alertAutosubscribe&&O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&(C.updateChainToday(),C.ChainToday&&(a=$("#chnTime_"+C.ChainToday.nexus),a.hasClass("chnTimeSubscribed")||a.trigger("click"))),O.Options.bol_clearPersonalChecklistOnReset&&($("#chlDungeonUncheck").trigger("click"),$("#chlCustomUncheck").trigger("click"),X.clearChecklist(X.Checklists.Dungeon,X.ChecklistJob.UncheckTheChecked),X.clearChecklist(X.Checklists.Custom,X.ChecklistJob.UncheckTheChecked)),I.isSectionLoaded_Daily&&(G.shiftLoginTrack(),G.regenerateDailiesCalendar()),I.write("",t),O.updateLocalResetTimestamp()},bindOptionsInputs:function(){var e;for(e in O.Enact)!function(e){var t,n=O.prefixOption+e,i=$("#"+n).attr("type");t="radio"===i?"fieldset[name="+e+"]":"#"+n,$(t).change(function(){O.Enact[e]()})}(e);$("#opt_bol_showWorldCompletion").change(function(){O.Options.bol_showWorldCompletion===!0&&M.isMappingIconsGenerated===!1&&location.reload(),$("#mapOptionsCompletion label input").each(function(){X.setCheckboxEnumState($(this),X.boolToChecklistEnum(O.Options.bol_showWorldCompletion))})}),$("#opt_bol_displayEvents").change(function(){O.Options.bol_displayEvents===!0&&M.isEventIconsGenerated===!1&&location.reload(),M.isEventIconsGenerated&&M.refreshCurrentZone()}),$("#mapOptionsCompletion label input").each(function(){$(this).change(function(){M.isAPIRetrieved_MAPFLOOR&&M.refreshCurrentZone()})}),O.Enact.int_setAlarm(),O.Enact.bol_detectDST(),O.Enact.bol_useSiteTag(),O.Enact.bol_alignPanelRight(!0),O.Enact.bol_showPanel(),I.ModeCurrent!==I.ModeEnum.Simple&I.ModeCurrent!==I.ModeEnum.Tile&&(O.Enact.int_setClock(),O.Enact.int_setDimming(),O.Enact.bol_showMap()),$("#optRestoreAllChains").click(function(){var e,t=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";for(var n in C.Chains)e=C.Chains[n],$("#chnCheck_"+e.nexus).removeClass("chnChecked"),$("#chnBar_"+e.nexus).show().css({opacity:1}).css({display:t}),C.isTimetableGenerated&&$(".chnSlot_"+e.nexus).show().css({opacity:1}).css({display:t}).find(".chnCheck").removeClass("chnChecked");for(X.clearChecklist(X.Checklists.Chain),n=0;n<T.cNUM_TIMEFRAMES_IN_HOUR;n++){K.checkoffChainIcon(T.getStandardChain(n).nexus);var i=T.getHardcoreChain(n);i&&K.checkoffChainIcon(i.nexus)}}),$("#optChainsExpand").click(function(){$(".chnDetails").show()}),$("#optChainsCollapse").click(function(){$(".chnDetails").hide(),I.scrollToElement($("#plateChains"))}),$("#optClearLocalStorage").click(function(){confirm(I.cSiteName+" Reset: This is will clear all options and everything you have written in this website. Continue?")&&(localStorage.clear(),location.reload())}),$("#optPrintLocalStorage").click(function(){var e,t=new Array;for(e=0;e<localStorage.length;e++){var n=U.escapeHTML(localStorage.key(e));t.push(n)}t.sort();var i="";for(e in t){var a=U.escapeHTML(localStorage.getItem(t[e]));i+=t[e]+": "+a+"<br />"}I.write(i,30,!0)})},Enact:{int_setAlarm:function(){var e="img/ui/placeholder.png";switch(O.Options.int_setAlarm){case O.IntEnum.Alarm.Checklist:e="img/ui/check.png";break;case O.IntEnum.Alarm.Subscription:e="img/ui/subscription.png"}O.Options.int_setAlarm===O.IntEnum.Alarm.Off?$("#optAlarmSpeaker").attr("src","img/ui/mute.png"):$("#optAlarmSpeaker").attr("src","img/ui/speaker.png"),$("#optAlarmIcon").attr("src",e)},int_volAlarm:function(){D.isSpeaking()===!1&&D.speak(D.getWord("alarm"))},bol_hideChecked:function(){$(".chnBar").each(function(){X.hideCheckedChainBar(U.getSubintegerFromHTMLID($(this)))})},bol_expandWB:function(){for(var e in C.CurrentChains)C.isChainRegular(C.CurrentChains[e])&&$("#chnDetails_"+C.CurrentChains[e].nexus).toggle(O.Options.bol_expandWB)},bol_use24Hour:function(){C.initializeTimetableHTML(),C.updateChainsTimeHTML(),K.updateDigitalClockMinutely()},bol_detectDST:function(){T.checkDST()},int_setClock:function(){K.setClock()},int_setDimming:function(){switch(O.Options.int_setDimming){case 1:$("#paneClockBackground").css({opacity:1});break;case 2:$("#paneClockBackground").css({opacity:0})}},bol_showZoneRectangles:function(){M.toggleLayer(M.Layer.ZoneRectangle,O.Options.bol_showZoneRectangles)},bol_showPersonalPaths:function(){M.isMapInitialized&&M.drawPersonalPath(),W.isMapInitialized&&W.drawPersonalPath()},bol_showChainPaths:function(){M.toggleLayerArray(P.LayerArray.ChainPath,O.Options.bol_showChainPaths)},bol_displayCharacter:function(){O.Options.bol_displayCharacter?(M.tickGPS(),M.updateCharacter(0)):(M.movePin(M.Pin.Character),M.movePin(M.Pin.Camera))},bol_showPanel:function(){O.Options.bol_showMap&&I.isMapEnabled&&($("#panelApp").toggle(O.Options.bol_showPanel),M.refreshMap(),W.isMapInitialized&&W.refreshMap())},bol_alignPanelRight:function(e){I.isMapEnabled&&(O.Options.bol_alignPanelRight?e!==!0&&($("#panelApp").insertAfter("#panelMap"),$(".paneApp").css({right:"0px",borderLeft:"1px solid #444",borderRight:"none",boxShadow:"-5px 0px 5px #223"}),$("#itemLanguagePopup").css({left:"-98px"}),$("#jsConsole, #jsConsoleButtons").css({left:"24px"})):($("#panelApp").insertBefore("#panelMap"),$(".paneApp").css({right:"auto",borderLeft:"none",borderRight:"1px solid #444",boxShadow:"5px 0px 5px #223"}),$("#itemLanguagePopup").css({left:"64px"}),$("#jsConsole, #jsConsoleButtons").css({left:I.cPANEL_WIDTH+24+"px"})))},bol_showMap:function(){I.isMapEnabled===!1&&($("#panelMap").toggle(O.Options.bol_showMap),M.refreshMap())},bol_refreshPrices:function(){O.Options.bol_refreshPrices&&E.isTradingCalculatorsInitialized?E.loopRefresh():E.cancelLoopRefresh()},int_shiftLogin:function(){G.shiftLoginTrack()},bol_useSiteTag:function(){I.siteTagCurrent=O.Options.bol_useSiteTag?I.siteTagDefault:""}}},U={URL_META:{News:"http://forum.renaka.com/topic/5500046/",Overlay:"http://forum.renaka.com/topic/5546166/"},URL_API:{TilesTyria:"https://tiles.guildwars2.com/1/1/{z}/{x}/{y}.jpg",MapFloorTyria:"https://api.guildwars2.com/v1/map_floor.json?continent_id=1&floor=1",TilesMists:"https://tiles.guildwars2.com/2/1/{z}/{x}/{y}.jpg",MapFloorMists:"https://api.guildwars2.com/v1/map_floor.json?continent_id=2&floor=1",MapsList:"https://api.guildwars2.com/v1/maps.json",EventNames:"https://api.guildwars2.com/v1/event_names.json",EventDetails:"https://api.guildwars2.com/v1/event_details.json",ItemListing:"https://api.guildwars2.com/v2/commerce/listings/",ItemPrices:"https://api.guildwars2.com/v2/commerce/prices/",ItemDetails:"https://api.guildwars2.com/v2/items/",ItemRender:"https://render.guildwars2.com/file/",CoinPrice:"https://api.guildwars2.com/v2/commerce/exchange/gems?quantity=",GemPrice:"https://api.guildwars2.com/v2/commerce/exchange/coins?quantity=",ItemSearch:"http://www.gw2spidy.com/api/v0.9/json/item-search/",ItemSearchFallback:"http://www.gw2shinies.com/api/json/idbyname/",ItemData:"http://www.gw2spidy.com/api/v0.9/json/item/",Matches:"https://api.guildwars2.com/v1/wvw/matches.json",MatchDetails:"https://api.guildwars2.com/v1/wvw/match_details.json?match_id=",GuildDetails:"https://api.guildwars2.com/v1/guild_details.json?guild_id="},URL_IMG:{Placeholder:"img/ui/placeholder.png",Waypoint:"img/map/waypoint.png",WaypointOver:"img/map/waypoint_h.png",Landmark:"img/map/landmark.png",LandmarkOver:"img/map/landmark_h.png",Vista:"img/map/vista.png",Challenge:"img/map/challenge.png",Heart:"img/map/heart.png"},URL_DATA:{WvW:"data/wvw.js",DryTop:"data/drytop.js",Resource:"data/resource.js",JP:"data/jp.js",Collectible:"data/collectible.js",Guild:"data/guild.js"},initializeAPIURLs:function(){var e=D.getFullySupportedLanguage();U.URL_API.MapFloorTyria+="&lang="+e,U.URL_API.MapFloorMists+="&lang="+e,U.URL_API.EventNames+="?lang="+e},Args:{},KeyEnum:{Page:"page",Section:"section",Article:"article",Mode:"mode",Go:"go"},CaseEnum:{None:0,Lower:1,Sentence:2,Title:3,Every:4,All:5},isEnumWithin:function(e,t){for(var n in t)if(t[n].toLowerCase()===e.toLowerCase())return!0;return!1},getURLArguments:function(){var e=window.location.search.substr(1).split("&");if(""===e)return{};for(var t={},n=0;n<e.length;++n){var i=e[n].split("=");2===i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return t},enforceURLArgumentsFirst:function(){U.Args=U.getURLArguments(),U.enforceURLArgumentsSpecial();var e,t=U.Args[U.KeyEnum.Mode];if(t)for(e in I.ModeEnum)if(I.ModeEnum[e].toLowerCase()===t.toLowerCase()){I.ModeCurrent=I.ModeEnum[e];break}null===I.ModeCurrent&&(I.ModeCurrent=I.ModeEnum.Website),I.ArticleCurrent=U.Args[U.KeyEnum.Article]},enforceURLArgumentsLast:function(){U.openPageFromURL()},enforceURLArgumentsSpecial:function(){var e,t,n,i=function(e){$("body").hide(),document.location=e},a=U.Args[U.KeyEnum.Page];if(a&&U.isEnumWithin(a,I.PageEnum)===!1)if(a=a.toLowerCase(),"navi"===a||"overlay"===a)i(U.URL_META.Overlay);else if("m"===a||"mobile"===a)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Mobile;else if("s"===a||"simple"===a)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Simple;else if("t"===a||"tile"===a)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Tile;else{for(e in I.SectionEnum){n=I.SectionEnum[e];for(t in n)if(t.toLowerCase()===a)return void 0!==U.Args[U.KeyEnum.Section]&&(U.Args[U.KeyEnum.Article]=U.Args[U.KeyEnum.Section]),U.Args[U.KeyEnum.Page]=e,void(U.Args[U.KeyEnum.Section]=t)}for(e in M.Zones)if(-1!==a.indexOf(e))return void(U.Args[U.KeyEnum.Go]=e)}for(e in X.Collectibles)if(n=X.Collectibles[e].urlkey,n===a||void 0!==U.Args[n])return U.Args[U.KeyEnum.Page]=I.PageEnum.Map,U.Args[U.KeyEnum.Section]=I.SectionEnum.Map.Collectible,void(U.Args[U.KeyEnum.Article]=n)},sanitizeURLOptionsValue:function(e,t){var n=e.substring(0,O.lengthOfPrefixes),i=t.toLowerCase();switch(n){case O.TypeEnum.isBoolean:return"true"===i||"false"===i?i:O.Options[e].toString();case O.TypeEnum.isInteger:if(isFinite(i)){var a=parseInt(i);if(a>=O.OptionRange[e][0]&&a<=O.OptionRange[e][1])return a.toString()}return O.Options[e].toString();case O.TypeEnum.isFloat:if(isFinite(i)){var r=parseFloat(i);if(r>=O.OptionRange[e][0]&&r<=O.OptionRange[e][1])return r.toString()}return O.Options[e].toString();case O.TypeEnum.isEnum:return O.validateEnum(e,t);case O.TypeEnum.isString:return U.escapeHTML(t)}return"null"},stripToAlphanumeric:function(e){return e.replace(/\W/g,"")},stripToSentence:function(e){return e.replace(/[^\w\s\'\"\:\,]/gi,"")},stripToCalculation:function(e){return e.replace(/[^0-9.()\-+/*]/gi,"")},toFirstUpperCase:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},toEveryUpperCase:function(e){var t=e.split(" ");if(t.length>1){for(var n in t)t[n]=U.toFirstUpperCase(t[n]);return t.join(" ")}return U.toFirstUpperCase(e)},toCase:function(e,t){var n,i=[];if(void 0===t||t===U.CaseEnum.None)return e;switch((t===U.CaseEnum.Title||t===U.CaseEnum.Every)&&(i=e.split(" ")),t){case U.CaseEnum.Lower:return e.toLowerCase();case U.CaseEnum.Sentence:return U.toFirstUpperCase(e);case U.CaseEnum.Title:if(i.length>1){for(i[0]=U.toFirstUpperCase(i[0]),n=1;n<i.length;n++)2!==i[n].length&&(i[n]=U.toFirstUpperCase(i[n]));return i.join(" ")}return U.toFirstUpperCase(e);case U.CaseEnum.Every:if(i.length>1){for(n in i)i[n]=U.toFirstUpperCase(i[n]);return i.join(" ")}return U.toFirstUpperCase(e);case U.CaseEnum.All:return e.toUpperCase()}},wrapSubstringHTML:function(e,t,n){var i=e.toLowerCase().indexOf(t.toLowerCase()),a=i+t.length,r="";return-1!==i?(void 0===n&&(n="u"),r=e.substring(0,i)+"<"+n+">"+e.substring(i,a)+"</"+n+">"+e.substring(a,e.length)):r=e,r},escapeHTML:function(e){return e.replace(/&/g,"&").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},replaceCharAt:function(e,t,n){return e.substr(0,t)+n+e.substr(t+n.length)},repeatChar:function(e,t){return Array(t+1).join(e)},countOccurrence:function(e,t){return e.split(t).length-1},updateAddressBar:function(e){history.replaceState("",null,e),K.reapplyFilters()},updateQueryString:function(){if(""!==I.PageCurrent){var e=I[I.sectionPrefix+I.PageCurrent],t=I.ArticleCurrent,n=U.Args[U.KeyEnum.Go],i="?"+U.KeyEnum.Page+"="+I.PageCurrent,a="",r="",o="",s="",c=I.PageCurrent;I.ModeCurrent!==I.ModeEnum.Website&&(s="&mode="+I.ModeCurrent),e&&(a="&"+U.KeyEnum.Section+"="+e,c=e),t&&(r="&"+U.KeyEnum.Article+"="+t),n&&(o="&"+U.KeyEnum.Go+"="+n),U.updateAddressBar(i+a+r+o+s),U.updateTitle(c)}},updateTitle:function(e){document.title=I.cSiteName+"/"+e},openSectionFromURL:function(){setTimeout(function(){if(void 0!==U.Args[U.KeyEnum.Section]){var e=U.stripToAlphanumeric(U.Args[U.KeyEnum.Section]),t=$(I.cHeaderPrefix+I.PageCurrent+"_"+U.toFirstUpperCase(e));t.length||(t=$(I.cHeaderPrefix+I.PageCurrent+"_"+e.toUpperCase())),I.PageCurrent===I.PageEnum.Chains&&$("#headerChains_Scheduled").trigger("click"),t.trigger("click")}},0)},openPageFromURL:function(){if(void 0!==U.Args[U.KeyEnum.Page]){var e=U.stripToAlphanumeric(U.Args[U.KeyEnum.Page]);for(var t in I.PageEnum)if(e.toLowerCase()===I.PageEnum[t].toLowerCase())return void $(I.cMenuPrefix+I.PageEnum[t]).trigger("click");switch(e=e.toLowerCase()){case"wvw":$("#mapSwitchButton").trigger("click")}}},convertExternalLink:function(e){$(e).each(function(){$(this).attr("href",I.cSiteURL+"out?"+encodeURI($(this).attr("href"))),$(this).attr("target","_blank")})},convertExternalURL:function(e){return I.cSiteURL+"out?"+encodeURI(e)},openExternalURL:function(e){var t=e;I.ModeCurrent!==I.ModeEnum.Overlay&&(t=I.cSiteURL+"out?"+encodeURI(e)),window.open(t,"_blank")},getVariableSuffix:function(e){var t=e.indexOf("_");return e.substring(t+1,e.length)},getVariablePrefix:function(e){var t=e.indexOf("_");return e.substring(0,t)},getSubstringFromHTMLID:function(e){return U.getVariableSuffix(e.attr("id"))},getSubintegerFromHTMLID:function(e){return parseInt(U.getVariableSuffix(e.attr("id")))},getPageSrc:function(e){return e.toLowerCase()+"src.html"},getImageHosted:function(e){return I.cImageHost+e+I.cPNG},encodeURL:function(e){return encodeURI(e).replace(/'/g,"%27")},getWikiLink:function(e){return e=e.replace(/ /g,"_"),"http://wiki.guildwars2.com/wiki/"+U.encodeURL(e)},getWikiLanguageLink:function(e){return e=e.replace(/ /g,"_"),"http://wiki-"+D.getFullySupportedLanguage()+".guildwars2.com/wiki/"+U.encodeURL(e)},getWikiSearchLink:function(e){return e=e.replace(/ /g,"+"),"http://wiki.guildwars2.com/index.php?title=Special%3ASearch&search="+U.encodeURL(e)},getGW2NewsLink:function(e){return"https://www.guildwars2.com/"+D.getFullySupportedLanguage()+"/news/"+e},getYouTubeLink:function(e){return"http://www.youtube.com/results?search_query="+U.encodeURL(e)},getTradingSearchLink:function(e){return"https://www.gw2tp.com/search?name="+U.encodeURL(e)},getTradingItemLink:function(e,t){return"http://www.gw2spidy.com/item/"+U.encodeURL(e)+"#"+U.stripToSentence(t)},getChatlinkFromPoiID:function(e){for(var t=String.fromCharCode(4),n=0;4>n;n++)t+=String.fromCharCode(e>>8*n&255);return"[&"+btoa(t)+"]"},getChatlinkFromItemID:function(e){var t="";try{t="[&"+btoa(String.fromCharCode(2)+String.fromCharCode(1)+String.fromCharCode(e%256)+String.fromCharCode(Math.floor(e/256))+String.fromCharCode(0)+String.fromCharCode(0))+"]"}catch(n){}return t}},X={Checklists:{Chain:{key:"str_chlChain",value:""},ChainSubscription:{key:"str_chlChainSubscription",value:""},JP:{key:"str_chlJP",value:""},ResourceRich:{key:"str_chlResourceRich",value:""},ResourceRegular:{key:"str_chlResourceRegular",value:""},ResourceZone:{key:"str_chlResourceZone",value:""},Dungeon:{key:"str_chlDungeon",value:"",money:0},Custom:{key:"str_chlCustom",value:""},TradingOverwrite:{key:"str_chlTradingOverwrite",value:""},TradingNotify:{key:"str_chlTradingNotify",value:""}},Collectibles:{BuriedChests:{key:"str_chlBuriedChests",urlkey:"chests",value:""},BanditChests:{key:"str_chlBanditChests",urlkey:"banditchests",value:""},MatrixCubeKey:{key:"str_chlMatrixCubeKey",urlkey:"matrixcubekey",value:""},LionsArchExterminator:{key:"str_chlLionsArchExterminator",urlkey:"lionsarchexterminator",value:""},CoinProspect:{key:"str_chlCoinProspect",urlkey:"coinprospect",value:""},CoinUplands:{key:"str_chlCoinUplands",urlkey:"coinuplands",value:""},CoinChallenger:{key:"str_chlCoinChallenger",urlkey:"coinchallenger",value:""},LostBadges:{key:"str_chlLostBadges",urlkey:"lostbadges",value:""},GoldenLostBadges:{key:"str_chlGoldenLostBadges",urlkey:"goldenlostbadges",value:""},DiveMaster:{key:"str_chlDiveMaster",urlkey:"divemaster",value:""},SpeedyReader:{key:"str_chlSpeedyReader",urlkey:"speedyreader",value:""},CleaningUp:{key:"str_chlCleaningUp",urlkey:"cleaningup",value:""},HistoryBuff:{key:"str_chlHistoryBuff",urlkey:"historybuff",value:""}},ChecklistEnum:{Unchecked:"0",Checked:"1",Disabled:"2",Unfound:"0",Tracked:"1",Found:"2"},ChecklistJob:{UncheckAll:0,CheckAll:1,UncheckTheChecked:2},Textlists:{CustomText:{key:"str_txlCustomText",value:new Array,valueDefault:new Array},NotepadText:{key:"str_txlNotepadText",value:new Array,valueDefault:new Array},TradingItem:{key:"str_txlTradingItem",value:new Array},TradingName:{key:"str_txlTradingName",value:new Array},TradingBuy:{key:"str_txlTradingBuy",value:new Array},TradingSell:{key:"str_txlTradingSell",value:new Array},TradingQuantity:{key:"str_txlTradingQuantity",value:new Array},NotifyBuyLow:{key:"str_txlNotifyBuyLow",value:new Array},NotifyBuyHigh:{key:"str_txlNotifyBuyHigh",value:new Array},NotifySellLow:{key:"str_txlNotifySellLow",value:new Array},NotifySellHigh:{key:"str_txlNotifySellHigh",value:new Array},ExchangeUnit:{key:"str_txlExchangeUnit",value:new Array}},boolToChecklistEnum:function(e){return e?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked},initializeChecklist:function(e,t,n,i){var a,r,o,s=localStorage[e.key];if(e.length=t,n){X.clearChecklist(e),r=n.split(",");for(a in r)o=parseInt(r[a]),isFinite(o)&&X.setChecklistItem(e,o-1,X.ChecklistEnum.Checked)}else if(void 0===s)X.clearChecklist(e,i);else if(s.length>t)localStorage[e.key]=s.substring(0,t);else if(s.length<t){var c=U.repeatChar(X.ChecklistEnum.Unchecked,t-s.length);localStorage[e.key]=s+c}e.value=localStorage[e.key]},setChecklistItem:function(e,t,n){t=parseInt(t);var i=n.toString();if(1===i.length&&e.value[t]!==i&&t>=0&&t<e.value.length){var a=U.replaceCharAt(e.value,t,i);localStorage[e.key]=a,e.value=a}},trackChecklistItem:function(e,t){t=parseInt(t);var n=e.value.charAt(t);switch(n){case X.ChecklistEnum.Unfound:n=X.ChecklistEnum.Tracked;break;case X.ChecklistEnum.Tracked:n=X.ChecklistEnum.Found;break;case X.ChecklistEnum.Found:n=X.ChecklistEnum.Unfound;break;default:n=X.ChecklistEnum.Unfound}var i=U.replaceCharAt(e.value,t,n);return localStorage[e.key]=i,e.value=i,n},getChecklistItem:function(e,t,n){var i=e.value.charAt(t);return void 0===n?i:n===O.TypeEnum.isInteger?parseInt(i):n===O.TypeEnum.isBoolean?O.intToBool(parseInt(i)):i},isChecked:function(e,t){var n=U.getSubintegerFromHTMLID(t);return X.getChecklistItem(e,n)===X.ChecklistEnum.Checked?!0:!1},getCheckedIndexes:function(e){var t,n="",i=e.value;for(t=0;t<i.length;t++)i[t]===X.ChecklistEnum.Checked&&(n+=t+1+",");return n=n.slice(0,-1)},clearChecklist:function(e,t){var n,i="",a="";switch(t){case X.ChecklistJob.CheckAll:for(n=0;n<e.length;n++)i+=X.ChecklistEnum.Checked;break;case X.ChecklistJob.UncheckTheChecked:for(a=void 0!==localStorage[e.key]?localStorage[e.key]:e.value,n=0;n<a.length;n++)i+=a[n]===X.ChecklistEnum.Checked?X.ChecklistEnum.Unchecked:a[n];break;default:for(n=0;n<e.length;n++)i+=X.ChecklistEnum.Unchecked}e.value=i,localStorage[e.key]=i},countChecklist:function(e,t){return U.countOccurrence(e.value,t)},getCheckboxEnumState:function(e){return e.prop("disabled")===!0?X.ChecklistEnum.Disabled:e.prop("checked")===!0?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked},setCheckboxEnumState:function(e,t){switch(t){case X.ChecklistEnum.Disabled:e.prop("disabled",!0),e.prop("checked",!1);break;case X.ChecklistEnum.Checked:e.prop("checked",!0);break;default:e.prop("checked",!1)}e.trigger("change")},triggerCheckbox:function(e,t){var n=X.getCheckboxEnumState(e);t===X.ChecklistEnum.Checked&&n===X.ChecklistEnum.Unchecked||t===X.ChecklistEnum.Unchecked&&n===X.ChecklistEnum.Checked?e.trigger("click"):t===X.ChecklistEnum.Disabled&&n!==X.ChecklistEnum.Disabled&&e.trigger("dblclick")},triggerCheckboxEnumState:function(e,t,n){var i=X.getChecklistItem(e,t);X.triggerCheckbox(n,i)},styleCheckbox:function(e,t,n){var i=X.getChecklistItem(e,t);switch(i){case X.ChecklistEnum.Disabled:n.parent().removeClass("chlCheckboxChecked").addClass("chlCheckboxDisabled");break;case X.ChecklistEnum.Checked:n.parent().removeClass("chlCheckboxDisabled").addClass("chlCheckboxChecked");break;default:n.parent().removeClass("chlCheckboxDisabled").removeClass("chlCheckboxChecked")}},initializeCheckboxlist:function(e,t,n){X.initializeChecklist(e,t.length,null,n),t.each(function(t){$(this).change(function(){var n=X.getCheckboxEnumState($(this));X.setChecklistItem(e,t,n)}),X.triggerCheckboxEnumState(e,t,$(this))})},initializeTextlist:function(e,t,n,i,a){t.each(function(){var t=$(this).val();e.value.push(t),e.valueDefault&&e.valueDefault.push(t)});var r;if(void 0===localStorage[e.key])localStorage[e.key]=e.value.join(I.cTextDelimiterChar);else{var o=localStorage[e.key].split(I.cTextDelimiterChar);for(r=0;r<e.value.length;r++)e.value[r]=o[r]?o[r]:"";localStorage[e.key]=e.value.join(I.cTextDelimiterChar)}var s=function(){t.each(function(t){e.value[t]=$(this).val().replace(I.cTextDelimiterRegex,"")}),localStorage[e.key]=e.value.join(I.cTextDelimiterChar)};t.each(function(t){$(this).attr("maxlength",i),$(this).val(e.value[t]),$(this).change(function(){n&&I.write(n+" #"+(t+1)+" updated."),s()})}),a&&a.click(function(){confirm("Reset texts to default?")&&t.each(function(t){$(this).val(e.valueDefault[t]).trigger("change")})})},initializeChainChecklist:function(e){var t=$("#chnBar_"+e.nexus),n=$("#chnCheck_"+e.nexus),i=$("#chnTime_"+e.nexus);X.reapplyChainBarState(e.nexus,t,n,i),C.isChainRegular(e)&&i.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=$(".chnSlot_"+e).find("time");X.getChecklistItem(X.Checklists.ChainSubscription,e)===X.ChecklistEnum.Checked?($(this).removeClass("chnTimeSubscribed"),t.removeClass("chnTimeSubscribed"),X.setChecklistItem(X.Checklists.ChainSubscription,e,X.ChecklistEnum.Unchecked)):($(this).addClass("chnTimeSubscribed"),t.addClass("chnTimeSubscribed"),X.setChecklistItem(X.Checklists.ChainSubscription,e,X.ChecklistEnum.Checked),O.Options.int_setAlarm!==O.IntEnum.Alarm.Subscription&&I.write("Please set <img src='img/ui/speaker.png' /> to &quot;"+D.getSentence("subscription")+"&quot; to enable alarm."))}),n.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=$("#chnBar_"+e),n=$(".chnSlot_"+e),i=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";switch(X.getChecklistItem(X.Checklists.Chain,e)){case X.ChecklistEnum.Unchecked:t.css({opacity:1}).animate({opacity:K.iconOpacityChecked},K.iconOpacitySpeed),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).hide("fast"),$(this).addClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Checked),C.isTimetableGenerated&&n.css({opacity:1}).animate({opacity:K.iconOpacityChecked},K.iconOpacitySpeed).find(".chnCheck").addClass("chnChecked");break;case X.ChecklistEnum.Checked:t.css({opacity:1}).show("fast").css({display:i}),t.css({opacity:K.iconOpacityChecked}).animate({opacity:1},K.iconOpacitySpeed),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).show("fast").css({display:i}),$(this).removeClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Unchecked),C.isTimetableGenerated&&n.show("fast").css({display:i}).css({opacity:K.iconOpacityChecked}).animate({opacity:1},K.iconOpacitySpeed).find(".chnCheck").removeClass("chnChecked");break;case X.ChecklistEnum.Disabled:t.css({opacity:1}).show("fast").css({display:i}),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).show("fast").css({display:i}),$(this).removeClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Unchecked),C.isTimetableGenerated&&n.hide().css({opacity:1}).find(".chnCheck").removeClass("chnChecked")}X.hideCheckedChainBar(e),K.checkoffChainIcon(e)}),$("#chnDelete_"+e.nexus).click(function(){var e=U.getSubintegerFromHTMLID($(this));$("#chnBar_"+e).hide("slow"),C.isTimetableGenerated&&$(".chnSlot_"+e).hide("slow"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Disabled),K.checkoffChainIcon(e)})},reapplyChainBarState:function(e,t,n,i){switch(X.getChecklistItem(X.Checklists.Chain,e)){case X.ChecklistEnum.Unchecked:break;case X.ChecklistEnum.Checked:t.css({opacity:K.iconOpacityChecked}),n.addClass("chnChecked"),O.Options.bol_hideChecked&&t.hide();
break;case X.ChecklistEnum.Disabled:t.hide()}C.isChainRegular(C.Chains[e])&&X.getChecklistItem(X.Checklists.ChainSubscription,e)===X.ChecklistEnum.Checked&&i.addClass("chnTimeSubscribed")},hideCheckedChainBar:function(e){var t=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";X.getChecklistItem(X.Checklists.Chain,e)===X.ChecklistEnum.Checked&&(O.Options.bol_hideChecked?($("#chnBar_"+e).hide("fast"),C.isTimetableGenerated&&$(".chnSlot_"+e).hide("fast")):($("#chnBar_"+e).show("fast").css({display:t}),C.isTimetableGenerated&&$(".chnSlot_"+e).show("fast").css({display:t})))},getChainChecklistState:function(e){return X.getChecklistItem(X.Checklists.Chain,e.nexus)},initializeDungeonChecklist:function(){X.initializeChecklist(X.Checklists.Dungeon,$("#chlDungeon input").length),$("#chlDungeon .chlDungeonBar").each(function(){$(this).prepend("<ins class='chl_"+$(this).data("name").toLowerCase()+"'></ins>")});var e=function(){var e=X.Checklists.Dungeon.money,t=~~(e/E.Exchange.COPPER_IN_GOLD),n=~~(e/E.Exchange.SILVER_IN_GOLD)%E.Exchange.COPPER_IN_SILVER,i=e%E.Exchange.COPPER_IN_SILVER;$("#chlDungeonCalculator_Gold").text(t),$("#chlDungeonCalculator_Silver").text(n),$("#chlDungeonCalculator_Copper").text(i)};$("#chlDungeon input").each(function(t){$(this).change(function(){var n=X.getCheckboxEnumState($(this));X.setChecklistItem(X.Checklists.Dungeon,t,n),X.styleCheckbox(X.Checklists.Dungeon,t,$(this));var i=$("#chlDungeonCalculator"),a=X.Checklists.Dungeon.money,r=$(this).data("money");switch($(this).data("mode")){case"E":r+=i.data("moneyaddexp")}switch(n){case X.ChecklistEnum.Disabled:X.Checklists.Dungeon.money=a-r;break;case X.ChecklistEnum.Checked:X.Checklists.Dungeon.money=a+r;break;default:X.Checklists.Dungeon.money=a-r}e()})}),$("#chlDungeon label").each(function(e){$(this).dblclick(function(){var t=$(this).find("input:first-child");t.prop("disabled")===!1?(t.prop("checked")===!0&&X.triggerCheckbox(t,X.ChecklistEnum.Unchecked),t.prop("disabled",!0).prop("checked",!1)):t.prop("disabled",!1),X.setChecklistItem(X.Checklists.Dungeon,e,X.getCheckboxEnumState(t)),X.styleCheckbox(X.Checklists.Dungeon,e,t)})}),$("#chlDungeon input").each(function(e){X.triggerCheckboxEnumState(X.Checklists.Dungeon,e,$(this))}),$("#chlDungeonUncheck").click(function(){X.clearChecklist(X.Checklists.Dungeon,X.ChecklistJob.UncheckTheChecked),$("#chlDungeon input").each(function(e){$(this).prop("checked")===!0&&$(this).trigger("click"),X.styleCheckbox(X.Checklists.Dungeon,e,$(this))})})},initializeCustomChecklist:function(){var e=$("#chlCustom input:checkbox");X.initializeChecklist(X.Checklists.Custom,e.length),e.each(function(e){$(this).change(function(){var t=X.getCheckboxEnumState($(this));X.setChecklistItem(X.Checklists.Custom,e,t),X.styleCheckbox(X.Checklists.Custom,e,$(this)),t===X.ChecklistEnum.Checked?$(this).parent().next().addClass("chlCustomTextChecked"):$(this).parent().next().removeClass("chlCustomTextChecked")}),X.triggerCheckboxEnumState(X.Checklists.Custom,e,$(this))}),$("#chlCustomUncheck").click(function(){X.clearChecklist(X.Checklists.Custom,X.ChecklistJob.UncheckTheChecked),$("#chlCustom input:checkbox").each(function(e){$(this).prop("checked")===!0&&$(this).trigger("click"),X.styleCheckbox(X.Checklists.Custom,e,$(this))})});var t=$("#chlCustom input:text"),n=$("#chlCustomRestore");X.initializeTextlist(X.Textlists.CustomText,t,"Custom checklist item",48,n)},initializeNotepad:function(){$("#chlNotepadButtons button").each(function(e){$(this).click(function(){$("#chlNotepadSheets textarea").hide().eq(e).show().css({opacity:.5}).animate({opacity:1},400),$("#chlNotepadButtons button").removeClass("btnFocused"),$(this).addClass("btnFocused")})}).first().click();var e=$("#chlNotepadSheets textarea"),t=$("#chlNotepadRestore");X.initializeTextlist(X.Textlists.NotepadText,e,"Notepad sheet",4096,t),e.css("height",O.Options.int_sizeNotepadHeight),e.css("font-size",O.Options.int_sizeNotepadFont),e.first().show()}},E={Exchange:{COPPER_IN_SILVER:100,COPPER_IN_GOLD:1e4,SILVER_IN_GOLD:100,CENTS_IN_DOLLAR:100,GEM_PER_DOLLAR:.8,DOLLAR_PER_GEM:1.25,GEM_SAMPLE:100,COIN_SAMPLE:1e6,TAX_LIST:.05,TAX_SOLD:.1,TAX_TOTAL:.15,TAX_INVERSE:.85,INFLUENCE_PER_COPPER:.05,COPPER_PER_INFLUENCE:20},Rarity:{Junk:0,Basic:1,Fine:2,Masterwork:3,Rare:4,Exotic:5,Ascended:6,Legendary:7},cNUM_ITEM_RARITIES:8,cREFRESH_LIMIT:5e3,cSEARCH_LIMIT:750,cEXCHANGE_LIMIT:250,isTradingCalculatorsInitialized:!1,RefreshTimeout:{},ProgressTimeout:{},ProgressWait:0,ProgressTick:0,SwapIndex:-1,CalculatorHistoryArray:new Array(64),CalcHistoryIndex:0,copper:function(e){return"<copper>"+e+"</copper>"},silver:function(e){return"<silver>"+e+"</silver>"},gold:function(e){return"<gold>"+e+"</gold>"},parseCoinString:function(e){if(void 0===e||null===e)return 0;var t=e.split("."),n=t.length,i=0,a=0,r=0;return 0===n?0:(1===n&&(a=parseInt(t[0])),n>=2&&(i=parseInt(t[n-1]),a=parseInt(t[n-2])),2===n&&1===t[n-1].length&&(i*=T.cBASE_10),n>=3&&(r=parseInt(t[n-3])),isFinite(i)||(i=0),isFinite(a)||(a=0),isFinite(r)||(r=0),parseInt(i+a*E.Exchange.COPPER_IN_SILVER+r*E.Exchange.COPPER_IN_GOLD))},parseGemString:function(e){return void 0===e||null===e?0:isFinite(parseInt(e))?parseInt(e):0},parseQuantityString:function(e){var t=parseInt(e);return isFinite(t)||(t=1),t},createCoinString:function(e,t){if(void 0===e||isFinite(e)===!1)return"0.00";e=parseInt(e);var n=".",i="",a="",r="",o="",s="",c="";t&&(n="",i="<gold>",a="<silver>",r="<copper>",o="</gold><goldcoin></goldcoin>",s="</silver><silvercoin></silvercoin>",c="</copper><coppercoin></coppercoin>");var l=Math.abs(~~(e/E.Exchange.COPPER_IN_GOLD)),u=Math.abs(~~(e/E.Exchange.SILVER_IN_GOLD)%E.Exchange.COPPER_IN_SILVER),d=Math.abs(e%E.Exchange.COPPER_IN_SILVER),h=0>e?"−":"";return l>0&&u<T.cBASE_10&&(u="0"+u),(t&&u>0&&d<T.cBASE_10||!t&&d<T.cBASE_10)&&(d="0"+d),l>0?h+i+l+o+n+a+u+s+n+r+d+c:u>0?h+a+u+s+n+r+d+c:t?r+d+c:h+a+"0"+n+s+r+d+c},parseMoneyString:function(e){if(void 0===e||null===e)return 0;var t=e.split("."),n=t.length,i=0,a=0;return 0===n?0:(1===n&&(a=parseInt(t[0])),n>=2&&(i=parseInt(t[n-1]),a=parseInt(t[n-2])),n>=2&&1===t[n-1].length?i*=T.cBASE_10:n>=2&&t[n-1].length>=2&&(i=parseInt(i.toString().substring(0,2))),isFinite(i)||(i=0),isFinite(a)||(a=0),parseInt(i+a*E.Exchange.CENTS_IN_DOLLAR))},createMoneyString:function(e){if(void 0===e||isFinite(e)===!1)return"0.00";e=parseInt(e);var t=Math.abs(~~(e/E.Exchange.CENTS_IN_DOLLAR)),n=Math.abs(e%E.Exchange.CENTS_IN_DOLLAR),i=0>e?"−":"";return n<T.cBASE_10&&(n="0"+n),i+t+"."+n},createPercentString:function(e,t){if(void 0===e||isFinite(e)===!1)return"0%";void 0===t&&(t=0);var n=0>e?"−":"";return n+Math.abs(100*e).toFixed(t)+"%"},setRarityClass:function(e,t){e.each(function(){for(var e=0;e<E.cNUM_ITEM_RARITIES;e++)$(this).removeClass("rarity"+e.toString())}),void 0!==E.Rarity[t]&&e.addClass("rarity"+E.Rarity[t].toString())},animateValue:function(e,t,n){t>n?e.css({color:"#ff2200"}).animate({color:"#ffeebb"},5e3):n>t?e.css({color:"#44dd44"}).animate({color:"#ffeebb"},5e3):e.css({"border-radius":32}).animate({"border-radius":4},1e3)},deductTax:function(e){return parseInt(e-e*E.Exchange.TAX_TOTAL)},calculateTrading:function(e){var t=E.parseCoinString(e.find(".trdBuy").val()),n=E.parseCoinString(e.find(".trdSell").val()),i=E.parseQuantityString(e.find(".trdQuantity").val()),a=e.find(".trdCost"),r=e.find(".trdTax"),o=e.find(".trdRevenue"),s=e.find(".trdProfit"),c=e.find(".trdBreak"),l=e.find(".trdMargin"),u=(n-n*E.Exchange.TAX_TOTAL-t)*i,d=(n-n*E.Exchange.TAX_SOLD)*i,h=t*i,p=n*E.Exchange.TAX_LIST*i,C=n*E.Exchange.TAX_SOLD*i;a.val("−"+E.createCoinString(Math.round(h))),r.val("−"+E.createCoinString(Math.round(p))+" + −"+E.createCoinString(Math.round(C))),c.val(E.createCoinString(Math.round(t/E.Exchange.TAX_INVERSE))),o.val(E.createCoinString(Math.round(d))),s.val(E.createCoinString(Math.round(u))),l.val(E.createPercentString(d/(h+p)-1,2)),$([s,l]).each(function(){var e=Math.round(u);$(this).removeClass("trdZero trdGain trdLoss"),0===e?$(this).addClass("trdZero"):e>0?$(this).addClass("trdGain"):0>e&&$(this).addClass("trdLoss")})},updateTradingDetails:function(e){var t=e.find(".trdName").val(),n=e.find(".trdItem").val();isFinite(parseInt(n))!==!1&&0!==t.length&&$.getJSON(U.URL_API.ItemDetails+n,function(t){E.setRarityClass(e.find(".trdName"),t.rarity),e.attr("data-rarity",t.rarity),e.find(".trdIcon").attr("src",t.icon),e.find(".trdLink").val(U.getChatlinkFromItemID(n))})},updateTradingPrices:function(e){var t=e.find(".trdName").val(),n=e.find(".trdItem").val();if(isFinite(parseInt(n))!==!1&&0!==t.length){var i=0,a=0,r=0,o=0,s=e.find(".trdName"),c=e.find(".trdCurrentBuy"),l=e.find(".trdCurrentSell"),u=e.find(".trdNotifyBuyLow"),d=e.find(".trdNotifyBuyHigh"),h=e.find(".trdNotifySellLow"),p=e.find(".trdNotifySellHigh"),C=E.parseCoinString(u.val()),m=E.parseCoinString(d.val()),g=E.parseCoinString(h.val()),f=E.parseCoinString(p.val());$.getJSON(U.URL_API.ItemPrices+n,function(t){i=E.parseCoinString(e.find(".trdCurrentBuy").first().val()),a=E.parseCoinString(e.find(".trdCurrentSell").first().val()),void 0!==t.buys&&(r=parseInt(t.buys.unit_price)),void 0!==t.sells&&(o=parseInt(t.sells.unit_price)),c.val(E.createCoinString(r)),l.val(E.createCoinString(o)),X.getChecklistItem(X.Checklists.TradingOverwrite,U.getSubintegerFromHTMLID(e))===X.ChecklistEnum.Checked&&(e.find(".trdBuy").val(c.val()).trigger("input"),e.find(".trdSell").val(l.val()).trigger("input"))}).done(function(){E.animateValue(c,i,r),E.animateValue(l,a,o),X.isChecked(X.Checklists.TradingNotify,e)&&(s.removeClass("trdMatched"),C>=r&&0!==C&&0!==r?(s.addClass("trdMatched"),u.addClass("trdMatched"),D.speak(D.getString("buy low")+" "+t)):u.removeClass("trdMatched"),r>=m&&0!==m&&0!==r?(s.addClass("trdMatched"),d.addClass("trdMatched"),D.speak(D.getString("buy high")+" "+t)):d.removeClass("trdMatched"),g>=o&&0!==g&&0!==o?(s.addClass("trdMatched"),h.addClass("trdMatched"),D.speak(D.getString("sell low")+" "+t)):h.removeClass("trdMatched"),o>=f&&0!==f&&0!==o?(s.addClass("trdMatched"),p.addClass("trdMatched"),D.speak(D.getString("sell high")+" "+t)):p.removeClass("trdMatched"))}).fail(function(){I.write("&quot;"+U.escapeHTML(e.find(".trdName").val())+"&quot; is not a tradeable item.")})}},updateAllTradingDetails:function(){$("#trdList .trdEntry").each(function(){E.updateTradingDetails($(this))})},updateAllTradingPrices:function(){$("#trdList .trdEntry").each(function(){E.updateTradingPrices($(this))})},clearCalculator:function(e){E.setRarityClass(e.find(".trdName")),e.find(".trdIcon").attr("src",U.URL_IMG.Placeholder),e.find(".trdItem").val("").trigger("change"),e.find(".trdCurrentBuy").val(""),e.find(".trdCurrentSell").val(""),e.find(".trdLink").val(""),e.find(".trdResultsContainer").remove(),e.find(".trdNotifyBuyLow").val("").trigger("change"),e.find(".trdNotifyBuyHigh").val("").trigger("change"),e.find(".trdNotifySellLow").val("").trigger("change"),e.find(".trdNotifySellHigh").val("").trigger("change"),E.clearMatched(e)},clearMatched:function(e){e.find(".trdName").removeClass("trdMatched"),e.find(".trdNotifyBuyLow").removeClass("trdMatched"),e.find(".trdNotifyBuyHigh").removeClass("trdMatched"),e.find(".trdNotifySellLow").removeClass("trdMatched"),e.find(".trdNotifySellHigh").removeClass("trdMatched")},initializeTrading:function(){var e,t,n,i,a,r="",o=function(e){var t=$("<div class='trdResultsContainer jsRemovable'></div>").insertAfter(e.find(".trdName"));return $("<div class='trdResults cntPopup'>"+I.cThrobber+"</div>").appendTo(t)},s=function(e,t,n){$(".trdResults .itemThrobber").remove();var i=$("<dfn class='rarity"+E.Rarity[e.rarity]+"' data-id='"+e.id+"'><img src='"+e.icon+"'>"+U.wrapSubstringHTML(e.name,t,"u")+"</dfn>").appendTo(n);i.click(function(){var e=$(this).parents(".trdResultsContainer"),t=e.parents(".trdEntry");t.find(".trdItem").val($(this).data("id")).trigger("change"),t.find(".trdName").val($(this).text()).trigger("change"),E.updateTradingDetails(t),E.updateTradingPrices(t),e.remove()})};for(e=0;e<O.Options.int_numTradingCalculators;e++)r="#trdEntry_"+e,$("#trdList").append("<div id='trdEntry_"+e+"' class='trdEntry'><div class='trdAccordion trdAccordionShut'><samp><img class='trdIcon' src='"+U.URL_IMG.Placeholder+"' /></samp><div class='trdResultsFocus'><input class='trdName' type='text' /></div><div class='trdButtons'><button class='trdSearch' tabindex='-1'>S</button><button class='trdWiki' tabindex='-1'>W</button><br /></div><div class='trdExpand'><samp>$~O</samp><input class='trdBuy' type='text' /><samp>−$~</samp><input class='trdCost trdOutput' type='text' tabindex='-1' /><br /><samp>O~$</samp><input class='trdSell' type='text' /><samp>$=$</samp><input class='trdBreak trdOutput' type='text' tabindex='-1' /><br /><samp>×</samp><input class='trdQuantity' type='text' /><samp>−$%</samp><input class='trdTax trdOutput' type='text' tabindex='-1' /><br /><samp>+$</samp><input class='trdProfit trdOutput' type='text' tabindex='-1' /><samp>=$</samp><input class='trdRevenue trdOutput' type='text' tabindex='-1' /><br /><samp>+$%</samp><input class='trdMargin trdOutput' type='text' tabindex='-1' /><samp>[]</samp><input class='trdLink trdOutput' type='text' tabindex='-1' /><input class='trdItem trdOutput' type='text' /><br /><samp>$~!</samp><input class='trdNotifyBuyHigh' type='text' /><input class='trdCurrentBuy trdOutput' type='text' tabindex='-1' /><input class='trdNotifyBuyLow' type='text' /><label title='<dfn>"+D.getSentence("overwrite")+"</dfn>: Replace your buy and sell prices with the current prices when refreshing.'><input class='trdOverwrite' type='checkbox' tabindex='-1' />&zwnj;</label><br /><samp>!~$</samp><input class='trdNotifySellHigh' type='text' /><input class='trdCurrentSell trdOutput' type='text' tabindex='-1' /><input class='trdNotifySellLow' type='text' /><label title='<dfn>"+D.getSentence("notify")+"</dfn>: Turn on sound notification for this item.'><input class='trdNotify' type='checkbox' tabindex='-1' />&zwnj;</label><br /><br /></div></div><div class='trdPreview'><input class='trdCurrentBuy trdOutput' type='text' tabindex='-1' /><input class='trdCurrentSell trdOutput' type='text' tabindex='-1' /><div class='trdSwap'><button class='trdSwapUp' tabindex='-1'></button><button class='trdSwapDown' tabindex='-1'></button></div></div></div>"),I.qTip.init($(r+" .trdOverwrite").parent()),I.qTip.init($(r+" .trdNotify").parent()),t=$(r+" .trdName"),n=$(r+" .trdBuy"),i=$(r+" .trdSell"),a=$(r+" .trdQuantity"),$(r+" input").click(function(){$(this).select()}),$(r+" .trdWiki").click(function(){var e=$(this).parents(".trdEntry").find(".trdName").val();U.openExternalURL(U.getWikiLink(e))}),$(r+" .trdSearch").click(function(){var e=$(this).parents(".trdEntry").find(".trdItem").val(),t=$(this).parents(".trdEntry").find(".trdName").val();U.openExternalURL(0===e.length?U.getTradingSearchLink(t):U.getTradingItemLink(e,t))}),$([n,i,a]).each(function(){$(this).on("input",function(){E.calculateTrading($(this).parent())})}),$(r+" .trdCurrentBuy, "+r+" .trdCurrentSell").each(function(){$(this).dblclick(function(){var e=E.parseCoinString($(this).val());0!==e&&($(this).prev().val(E.createCoinString(e+1)).trigger("change"),$(this).next().val(E.createCoinString(e-1)).trigger("change"),E.updateTradingPrices($(this).parents(".trdEntry")))})}),$(r+" .trdSwap").hover(function(){$(this).parents(".trdEntry").find(".trdName").addClass("trdHovered"),E.SwapIndex=U.getSubintegerFromHTMLID($(this).parents(".trdEntry"))},function(){$(".trdName").removeClass("trdHovered")}),$(r+" .trdSwapUp, "+r+" .trdSwapDown").each(function(){$(this).click(function(){var e=E.SwapIndex,t=$(this).hasClass("trdSwapUp")?!0:!1;if((!t||0!==e)&&!t!==$(".trdEntry").length-1){var n=t?e-1:e+1,i=$("#trdEntry_"+e),a=$("#trdEntry_"+n),r=new Array,o=new Array,s=0,c=0;i.find("input[type='text']").each(function(){r.push($(this).val())}),a.find("input[type='text']").each(function(){o.push($(this).val())}),i.find("input[type='text']").each(function(){$(this).val(o[s]).trigger("change"),s++}),a.find("input[type='text']").each(function(){$(this).val(r[c]).trigger("change"),c++});var l=i.find(".trdIcon").attr("src"),u=a.find(".trdIcon").attr("src");i.find(".trdIcon").attr("src",u),a.find(".trdIcon").attr("src",l);var d=i.attr("data-rarity"),h=a.attr("data-rarity");i.attr("data-rarity",h),a.attr("data-rarity",d),E.setRarityClass(i.find(".trdName"),h),E.setRarityClass(a.find(".trdName"),d),E.clearMatched(i),E.clearMatched(a),i.find(".trdName").removeClass("trdHovered"),a.find(".trdName").addClass("trdHovered"),E.SwapIndex=t?E.SwapIndex-1:E.SwapIndex+1}})}),$(t).on("input",$.throttle(E.cSEARCH_LIMIT,function(){var e,t=U.escapeHTML($(this).val()),n=$(this).parents(".trdEntry");if(t.length<3)return void E.clearCalculator(n);if(t.length>=3&&O.isInteger(t))return n.find(".trdResultsContainer").remove(),e=o(n),void $.getJSON(U.URL_API.ItemDetails+t,function(n){s(n,t,e)}).fail(function(){I.write("No results found for Item ID: "+t+"."),n.find(".trdResultsContainer").remove()});var i,a;O.Options.bol_useMainTPSearch?(i=U.URL_API.ItemSearch+t,a="data_id"):(i=U.URL_API.ItemSearchFallback+t,a="item_id"),$.ajax({dataType:"json",url:i,timeout:5e3,success:function(i){n.find(".trdResultsContainer").remove();var r,c,l,u=O.Options.bol_useMainTPSearch?i.results:i;if(u&&u.length>0)for(e=o(n),r=0;r<u.length&&r<O.Options.int_numTradingResults;r++)l=u[r],c=parseInt(l[a]),$.getJSON(U.URL_API.ItemDetails+c,function(n){s(n,t,e)});else I.write("No results found for &quot;"+t+"&quot;.")}}).fail(function(){I.write("Error retrieving search results. Current search provider may be down.<br />Switching to alternate provider..."),$("#opt_bol_useMainTPSearch").trigger("click")})})).onEnterKey(function(){U.openExternalURL(U.getTradingSearchLink($(this).val()))}).onEscapeKey(function(){$(this).parents(".trdEntry").find(".trdResultsContainer").remove()}).click(function(){$(this).trigger("input")});r="#trdEntry_0",$(r+" .trdIcon").attr("src","img/ui/faq.png"),$(r+" .trdName").val("Bifrost"),$(r+" .trdBuy").val("4500.37.68"),$(r+" .trdSell").val("550037.68"),$(r+" .trdQuantity").val("1"),$(r).css("margin-bottom","6px");var c=function(e,t,n){n=void 0===n?"":": "+n,$(r+" .trd"+e).attr("title","<dfn>"+D.getString(t)+"</dfn>"+n)};c("Name","name"),c("Buy","your buy"),c("Sell","your sell"),c("Quantity","quantity"),c("Cost","cost","Money needed to buy the items."),c("Break","breakpoint","Sell higher than this to make a profit."),c("Tax","tax","Pay 5% fee of sell price to list, and deduct 10% tax of sell price when sold."),c("Profit","profit","Gains after losses from buying and tax."),c("Margin","margin","Revenue over cost and fee."),c("Revenue","revenue","What you will receive at the trader."),c("Link","chatlink","Paste this in game chat to see the item."),c("Item","ID","API item number."),c("NotifyBuyLow","notify if current buy < this buy"),c("NotifyBuyHigh","notify if this buy < current buy"),c("NotifySellLow","notify if current sell < this sell"),c("NotifySellHigh","notify if this sell < current sell"),c("CurrentBuy","current buy","Double click to flank price."),c("CurrentSell","current sell","Double click to flank price."),I.qTip.init($(r+" input")),X.initializeTextlist(X.Textlists.TradingItem,$("#trdList .trdItem"),null,16),X.initializeTextlist(X.Textlists.TradingName,$("#trdList .trdName"),null,64),X.initializeTextlist(X.Textlists.TradingBuy,$("#trdList .trdBuy"),null,16),X.initializeTextlist(X.Textlists.TradingSell,$("#trdList .trdSell"),null,16),X.initializeTextlist(X.Textlists.TradingQuantity,$("#trdList .trdQuantity"),null,16),X.initializeTextlist(X.Textlists.NotifyBuyLow,$("#trdList .trdNotifyBuyLow"),null,16),X.initializeTextlist(X.Textlists.NotifyBuyHigh,$("#trdList .trdNotifyBuyHigh"),null,16),X.initializeTextlist(X.Textlists.NotifySellLow,$("#trdList .trdNotifySellLow"),null,16),X.initializeTextlist(X.Textlists.NotifySellHigh,$("#trdList .trdNotifySellHigh"),null,16),X.initializeCheckboxlist(X.Checklists.TradingOverwrite,$("#trdList .trdOverwrite"),X.ChecklistJob.CheckAll),X.initializeCheckboxlist(X.Checklists.TradingNotify,$("#trdList .trdNotify"),X.ChecklistJob.CheckAll),$("#trdList .trdSell").trigger("input"),E.updateAllTradingDetails(),$("#trdToggle").click(function(){$("#trdEntry_0 .trdBuy").is(":visible")?($(".trdAccordion").addClass("trdAccordionShut").removeClass("trdAccordionOpen"),$(".trdPreview").removeClass("cssHidden")):($(".trdAccordion").removeClass("trdAccordionShut").addClass("trdAccordionOpen"),$(".trdPreview").addClass("cssHidden"))}),$("#trdRefresh").click($.throttle(E.cREFRESH_LIMIT,function(){E.loopRefresh(!0)})),$("#trdMute").click(function(){D.resetSpeechQueue()}),$("#trdPrint").click(function(){I.clear(),I.write("ItemID,Name,Buy,Sell,Quantity,BuyLow,BuyHigh,SellLow,SellHigh");for(var e=X.Textlists.TradingItem.value.length,t=0;e>t;t++)I.write(U.escapeHTML(X.Textlists.TradingItem.value[t])+","+U.escapeHTML(X.Textlists.TradingName.value[t])+","+U.escapeHTML(X.Textlists.TradingBuy.value[t])+","+U.escapeHTML(X.Textlists.TradingSell.value[t])+","+U.escapeHTML(X.Textlists.TradingQuantity.value[t])+","+U.escapeHTML(X.Textlists.NotifyBuyLow.value[t])+","+U.escapeHTML(X.Textlists.NotifyBuyHigh.value[t])+","+U.escapeHTML(X.Textlists.NotifySellLow.value[t])+","+U.escapeHTML(X.Textlists.NotifySellHigh.value[t]),30)})},updateCoinTo:function(e){var t=0,n=0,i=0,a=0,r=0,o=0,s=0,c=0,l=$("#trdExchange .trdCoinTo"),u=$("#trdExchange .trdCoinToGem"),d=$("#trdExchange .trdCoinToMoney"),h=$("#trdExchange .trdCoinToGemInverse"),p=$("#trdExchange .trdCoinToMoneyInverse"),C=0,m=E.parseCoinString(l.val());0===m?(u.val(""),d.val(""),h.val(""),p.val("")):($.getJSON(U.URL_API.GemPrice+m,function(e){void 0!==e.quantity&&(t=parseInt(u.val()),i=E.parseMoneyString(d.val()),n=parseInt(e.quantity),a=Math.round(n*E.Exchange.DOLLAR_PER_GEM),u.val(n),d.val(E.createMoneyString(a)))}).always(function(){(void 0===e||e)&&(E.animateValue(u,t,n),E.animateValue(d,i,a)),0===n&&(u.val("0"),d.val("0"))}),$.getJSON(U.URL_API.CoinPrice+E.Exchange.GEM_SAMPLE,function(e){void 0!==e.quantity&&(C=E.Exchange.GEM_SAMPLE/e.quantity)}).always(function(){0!==C&&(r=parseInt(h.val()),s=E.parseMoneyString(p.val()),o=Math.round(m*C),c=Math.round(o*E.Exchange.DOLLAR_PER_GEM),h.val(o),p.val(E.createMoneyString(c)),(void 0===e||e)&&(E.animateValue(h,r,o),E.animateValue(p,s,c)))}))},updateGemTo:function(e){var t=0,n=0,i=0,a=0,r=0,o=0,s=$("#trdExchange .trdGemTo"),c=$("#trdExchange .trdGemToCoin"),l=$("#trdExchange .trdGemToMoney"),u=$("#trdExchange .trdGemToCoinInverse"),d=0,h=s.val();0===h?(c.val(""),l.val("")):($.getJSON(U.URL_API.CoinPrice+h,function(e){void 0!==e.quantity&&(t=E.parseCoinString(c.val()),i=E.parseMoneyString(l.val()),n=parseInt(e.quantity),a=parseInt(h*E.Exchange.DOLLAR_PER_GEM),c.val(E.createCoinString(n)),l.val(E.createMoneyString(a)))}).always(function(){(void 0===e||e)&&(E.animateValue(c,t,n),E.animateValue(l,i,a)),0===n&&(c.val("0"),l.val("0"))}),$.getJSON(U.URL_API.GemPrice+E.Exchange.COIN_SAMPLE,function(e){void 0!==e.quantity&&(d=E.Exchange.COIN_SAMPLE/e.quantity)}).always(function(){0!==d&&(r=E.parseCoinString(u.val()),o=Math.round(h*d),u.val(E.createCoinString(o)),(void 0===e||e)&&E.animateValue(u,r,o))}))},updateMoneyTo:function(e){var t=0,n=0,i=0,a=0,r=$("#trdExchange .trdMoneyTo"),o=$("#trdExchange .trdMoneyToGem"),s=$("#trdExchange .trdMoneyToCoin"),c=E.parseMoneyString(r.val()),l=c*E.Exchange.GEM_PER_DOLLAR;0===c?(o.val(""),s.val("")):$.getJSON(U.URL_API.CoinPrice+l,function(e){void 0!==e.quantity&&(t=parseInt(o.val()),i=E.parseCoinString(s.val()),n=l,a=parseInt(e.quantity),o.val(l),s.val(E.createCoinString(a)))}).always(function(){(void 0===e||e)&&(E.animateValue(o,t,n),E.animateValue(s,i,a)),0===a&&(o.val("0"),s.val("0"))})},updateNotifyCoinTo:function(e){var t=0,n=0,i=$("#trdExchange .trdNotifyCoinTo"),a=$("#trdExchange .trdNotifyCoinToGem"),r=$("#trdExchange .trdNotifyCoinToGemHigh"),o=E.parseGemString(r.val()),s=E.parseCoinString(i.val());0===s?a.val(""):$.getJSON(U.URL_API.GemPrice+s,function(e){void 0!==e.quantity&&(t=parseInt(a.val()),n=parseInt(e.quantity),a.val(n))}).always(function(){(void 0===e||e)&&E.animateValue(a,t,n),0===n?a.val("0"):n>=o&&0!==o?(r.addClass("trdMatched"),D.speak(D.getString("buy gem high"))):r.removeClass("trdMatched")})},updateNotifyGemTo:function(e){var t=0,n=0,i=$("#trdExchange .trdNotifyGemTo"),a=$("#trdExchange .trdNotifyGemToCoin"),r=$("#trdExchange .trdNotifyGemToCoinHigh"),o=E.parseCoinString(r.val()),s=i.val();0===s?a.val(""):$.getJSON(U.URL_API.CoinPrice+s,function(e){void 0!==e.quantity&&(t=E.parseCoinString(a.val()),n=parseInt(e.quantity),a.val(E.createCoinString(n)))}).always(function(){(void 0===e||e)&&E.animateValue(a,t,n),0===n?a.val("0"):n>=o&&0!==o?(r.addClass("trdMatched"),D.speak(D.getString("buy coin high"))):r.removeClass("trdMatched")})},updateAllExchange:function(){E.updateCoinTo(),E.updateGemTo(),E.updateMoneyTo(),E.updateNotifyCoinTo(),E.updateNotifyGemTo()},initializeExchange:function(){var e=$("#trdExchange .trdCoinTo"),t=$("#trdExchange .trdGemTo"),n=$("#trdExchange .trdMoneyTo"),i=$("#trdExchange .trdNotifyCoinTo"),a=$("#trdExchange .trdNotifyGemTo"),r=$("#trdExchange .trdNotifyCoinToGemHigh"),o=$("#trdExchange .trdNotifyGemToCoinHigh");e.val("200.."),t.val("4000"),n.val("50");var s=function(e,t){$("#trdExchange .trd"+e).attr("title","<dfn>"+D.getString(t)+"</dfn>")};s("CoinTo","your coin"),s("GemTo","your gem"),s("MoneyTo","your dollar"),s("CoinToGem","your coin to gem"),s("GemToCoin","your gem to coin"),s("MoneyToGem","your dollar to gem"),s("CoinToMoney","your coin to dollar"),s("GemToMoney","your gem to dollar"),s("MoneyToCoin","your dollar to coin"),s("CoinToGemInverse","gem to your coin"),s("GemToCoinInverse","coin to your gem"),s("CoinToMoneyInverse","dollar to your coin"),s("NotifyCoinTo","your coin"),s("NotifyGemTo","your gem"),s("NotifyCoinToGem","your coin to current gem"),s("NotifyGemToCoin","your gem to current coin"),s("NotifyCoinToGemHigh","notify if current gem > this gem"),s("NotifyGemToCoinHigh","notify if current coin > this coin"),I.qTip.init($("#trdExchange input")),$("#trdExchange input").click(function(){$(this).select()}),e.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateCoinTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateCoinTo()})),t.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateGemTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateGemTo()})),n.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateMoneyTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateMoneyTo()})),i.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyCoinTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyCoinTo()})),a.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyGemTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyGemTo()})),X.initializeTextlist(X.Textlists.ExchangeUnit,$([e,t,n,i,a,r,o]),null,16),$(".trdProgress").data("width",$(".trdProgress").width()),E.isTradingCalculatorsInitialized=!0,E.loopRefresh()},cancelLoopRefresh:function(){window.clearTimeout(E.ProgressTimeout),window.clearTimeout(E.RefreshTimeout),$(".trdProgress").width($(".trdProgress").data("width"))},animateProgress:function(){var e=$(".trdProgress");E.ProgressTick<E.ProgressWait&&e.width(e.width()-e.data("width")/E.ProgressWait),E.ProgressTick-=1,E.ProgressTimeout=setTimeout(E.animateProgress,T.cMILLISECONDS_IN_SECOND)},loopRefresh:function(e){if(E.cancelLoopRefresh(),(e===!0||O.Options.bol_refreshPrices)&&(E.updateAllTradingPrices(),E.updateAllExchange(),O.Options.bol_refreshPrices)){var t=O.Options.int_secTradingRefresh*T.cMILLISECONDS_IN_SECOND;E.ProgressTick=O.Options.int_secTradingRefresh,E.ProgressWait=O.Options.int_secTradingRefresh,E.animateProgress(),E.RefreshTimeout=setTimeout(E.loopRefresh,t)}},initializeCalculator:function(){$("#trdCalculation .trdCalculator").onEnterKey(function(){E.doCalculation($(this))}).click(function(){$(this).select()}),$("#trdCalculation .trdCalcSubmit").click(function(){E.doCalculation($(this).prev())});for(var e in E.CalculatorHistoryArray)E.CalculatorHistoryArray[e]="";$("#trdCalculation .trdCalculator").onArrowUpKey(function(){if(0===E.CalcHistoryIndex){var e=U.stripToCalculation($(this).val());E.CalculatorHistoryArray[0]!==$(this).val().toString()&&(E.CalculatorHistoryArray.pop(),E.CalculatorHistoryArray.unshift(e))}E.CalcHistoryIndex+1<E.CalculatorHistoryArray.length&&(E.CalcHistoryIndex++,$(this).val(E.CalculatorHistoryArray[E.CalcHistoryIndex]))}),$("#trdCalculation .trdCalculator").onArrowDownKey(function(){E.CalcHistoryIndex-1>=0&&(E.CalcHistoryIndex--,$(this).val(E.CalculatorHistoryArray[E.CalcHistoryIndex]))})},doCalculation:function(pCalculator){var expression=U.stripToCalculation(pCalculator.val()),result="";try{result=eval(expression)}catch(pException){}pCalculator.val(parseFloat(result)).select(),result.toString().length>0&&(E.CalculatorHistoryArray.pop(),E.CalculatorHistoryArray.unshift(expression),E.CalcHistoryIndex=0)}},D={Phrase:{s_TEMPLATE:{de:"",es:"",fr:"",cs:"",it:"",pl:"",pt:"",ru:"",zh:""},s_w:{de:"w",es:"s",fr:"s",cs:"t",it:"s",pl:"t",pt:"s",ru:"н",zh:"週"},s_d:{de:"t",es:"d",fr:"j",cs:"d",it:"g",pl:"d",pt:"d",ru:"д",zh:"日"},s_h:{de:"h",es:"h",fr:"h",cs:"h",it:"o",pl:"g",pt:"h",ru:"ч",zh:"時"},s_m:{de:"m",es:"m",fr:"m",cs:"m",it:"m",pl:"m",pt:"m",ru:"м",zh:"分"},s_s:{de:"s",es:"s",fr:"s",cs:"s",it:"s",pl:"s",pt:"s",ru:"с",zh:"秒"},s_hour:{de:"stunde",es:"hora",fr:"heure",cs:"hodina",it:"ora",pl:"godzinę",pt:"hora",ru:"час",zh:"時"},s_minute:{de:"minute",es:"minuto",fr:"minute",cs:"minuta",it:"minuto",pl:"minuta",pt:"minuto",ru:"минута",zh:"分"},s_second:{de:"sekunde",es:"segundo",fr:"seconde",cs:"sekunda",it:"secondo",pl:"sekund",pt:"segundo",ru:"секунду",zh:"秒"},s_hours:{de:"studen",es:"horas",fr:"heures",cs:"hodin",it:"secondi",pl:"godzin",pt:"horas",ru:"часов",zh:"時"},s_minutes:{de:"minuten",es:"minutos",fr:"minutes",cs:"minut",it:"minuti",pl:"minut",pt:"minutos",ru:"минут",zh:"分"},s_seconds:{de:"sekunden",es:"segundos",fr:"secondes",cs:"sekund",it:"ore",pl:"sekund",pt:"segundos",ru:"секунд",zh:"秒"},s_half_an_hour:{de:"eine halbe stunde",es:"media hora",fr:"demi-heure",cs:"půl hodiny",it:"mezz'ora",pl:"pół godziny",pt:"meia hora",ru:"полчаса",zh:"半小時"},s_arrival:{de:"ankunft",es:"llegada",fr:"arrivée",cs:"příjezd",it:"arrivo",pl:"przyjazd",pt:"chegada",ru:"прибытие",zh:"到來"},s_world_boss:{de:"weltboss",es:"jefe mundo",fr:"chef monde",cs:"svět boss",it:"boss mondo",pl:"świat szef",pt:"chefe mundo",ru:"мир босс",zh:"世界頭目"},s_section:{de:"paragraph",es:"sección",fr:"section",cs:"oddíl",it:"sezione",pl:"sekcja",pt:"seção",ru:"параграф",zh:"節"},s_map:{de:"karte",es:"mapa",fr:"carte",cs:"mapa",it:"mappa",pl:"mapa",pt:"mapa",ru:"ка́рта",zh:"地圖"},s_center:{de:"zentrum",es:"centro",fr:"centre",cs:"střed",it:"centro",pl:"środek",pt:"centro",ru:"центр",zh:"中心"},s_character:{de:"person",es:"personaje",fr:"personnage",cs:"postava",it:"personaggio",pl:"postać",pt:"personagem",ru:"персона́ж",zh:"人物"},s_Vista:{de:"Aussichtspunkt",es:"Vista",fr:"Panorama"},s_Hero_Challenge:{de:"Heldenherausforderung",es:"Desafío de héroe",fr:"Défi de héros"},s_checklist:{de:"prüfliste",es:"lista de comprobación",fr:"liste de contrôle",cs:"kontrolní seznam",it:"elenco di controllo",pl:"lista kontrolna",pt:"lista de verificação",ru:"контрольный список",zh:"檢查清單"},s_subscription:{de:"abonnement",es:"suscripción",fr:"abonnement",cs:"předplatné",it:"sottoscrizione",pl:"abonament",pt:"assinatura",ru:"подписка",zh:"訂閱"},s_alarm:{de:"alarm",es:"alarma",fr:"alarme",cs:"alarmu",it:"allarme",pl:"alarmu",pt:"alarme",ru:"будильник",zh:"鬧鐘"},s_mode:{de:"modus",es:"modo",fr:"mode",cs:"režim",it:"modalità",pl:"tryb",pt:"modo",ru:"режим",zh:"方式"},s_chatlink:{de:"chatlink",es:"vínculo chat",fr:"lien chat",cs:"chat odkaz",it:"collegamento chat",pl:"czat łącze",pt:"link bate-papo",ru:"чат связь",zh:"連結聊天"},s_wvw:{de:"WvW",es:"McM",fr:"McM",cs:"SpS",it:"McM",pl:"SkS",pt:"McM",ru:"МпМ",zh:"世界戰場"},s_is:{de:"ist",es:"es",fr:"est",cs:"je",it:"è",pl:"jest",pt:"é",ru:"является",zh:"是"},s_subscribe:{de:"abonnieren",es:"subscribir",fr:"abonner",cs:"předplatit si",it:"sottoscrivere",pl:"abonować",pt:"assinar",ru:"подписываться",zh:"訂閱"},s_will_start:{de:"wird starten",es:"se iniciará",fr:"débutera",cs:"začne",it:"inizierà",pl:"rozpocznie się",pt:"começará",ru:"начнется",zh:"開始"},s_click:{de:"klicken",es:"clic",fr:"cliquer",cs:"kliknout",it:"clic",pl:"klikać",pt:"clicar",ru:"щелкнуть",zh:"按一下"},s_expand:{de:"erweitern",es:"expandir",fr:"développer",cs:"rozbalit",it:"espandere",pl:"rozwinąć",pt:"expandir",ru:"развернуть",zh:"展開"},s_collapse:{de:"reduzieren",es:"contraer",fr:"réduire",cs:"sbalit",it:"comprimere",pl:"zwinąć",pt:"recolher",ru:"свернуть",zh:"摺疊"},s_ago:{de:"vor",es:"hace",fr:"il ya",cs:"před",it:"fa",pl:"temu",pt:"há",ru:"назад",zh:"前"},s_also:{de:"auch",es:"también",fr:"aussi",cs:"také",it:"anche",pl:"też",pt:"também",ru:"то́же",zh:"也"},s_checked:{de:"abgehakt",es:"visto",fr:"coché",cs:"odškrtnout",it:"controllato",pl:"zakończony",pt:"marcado",ru:"галочка",zh:"勾掉"},s_current:{de:"aktuelle",es:"actual",fr:"actuel",cs:"současný",it:"corrente",pl:"bieżący",pt:"corrente",ru:"текущий",zh:"活期"},s_daily:{de:"täglich",es:"diaria",fr:"quotidien",cs:"denní",it:"giornaliero",pl:"dzienny",pt:"diário",ru:"ежедневно",zh:"每天"},s_next:{de:"nächste",es:"siguiente",fr:"prochain",cs:"příští",it:"seguente",pl:"następny",pt:"próximo",ru:"следующий",zh:"下一"},s_off:{de:"aus",es:"desactivado",fr:"désactivé",cs:"vypnuto",it:"disattivato",pl:"wyłączany",pt:"desativado",ru:"выключено",zh:"關"},s_predicted:{de:"vorhergesagt",es:"previsto",fr:"prédit",cs:"předpovídal",it:"previsto",pl:"przewiduje",pt:"predito",ru:"предсказанный",zh:"預測"},s_subscribed:{de:"abonniert",es:"suscrito",fr:"souscrit",cs:"odebírané",it:"sottoscritti",pl:"subskrypcji",pt:"assinado",ru:"подписал",zh:"訂閱"},s_then:{de:"dann",es:"luego",fr:"puis",cs:"pak",it:"poi",pl:"potem",pt:"então",ru:"затем",zh:"接著"},s_at:{de:"um",es:"a",fr:"à",cs:"v",it:"a",pl:"o",pt:"a",ru:"в",zh:"在"},s_and:{de:"und",es:"y",fr:"et",cs:"a",it:"e",pl:"i",pt:"e",ru:"и",zh:"和"},s_if:{de:"wenn",es:"si",fr:"si",cs:"jestliže",it:"se",pl:"jeśli",pt:"se",ru:"если",zh:"如果"},s_in:{de:"in",es:"en",fr:"en",cs:"za",it:"in",pl:"w",pt:"em",ru:"в",zh:"在"},s_to:{de:"zu",es:"a",fr:"contre",cs:"ku",it:"a",pl:"na",pt:"a",ru:"до",zh:"比"},s_Scheduled_Bosses:{de:"Geplant",es:"Programado",fr:"Planifié",cs:"Plánované",it:"Pianificata",pl:"Zaplanowane",pt:"Agendado",ru:"Запланирован",zh:"已排程"},s_Dry_Top:{de:"Trockenkuppe",es:"Cima Seca",fr:"Cimesèche"},s_Legacy_Bosses:{de:"Legacy",es:"Heredado",fr:"Hérité",cs:"Starší",it:"Legacy",pl:"Starsze",pt:"Herdado",ru:"Устаревший",zh:"舊版"},s_Orr_Temples:{de:"Tempel",es:"Templos",fr:"Temples",cs:"Chrámy",it:"Templi",pl:"Świątynie",pt:"Templos",ru:"Храмы",zh:"寺廟"},s_Full_Timetable:{de:"Zeitplan",es:"Horario",fr:"Horaire",cs:"Plán",it:"Programma",pl:"Harmonogram",pt:"Horário",ru:"Расписание",zh:"時間表"},s_news:{de:"nachrichten",es:"noticias",fr:"actualités",cs:"zprávy",it:"notizie",pl:"wiadomości",pt:"notícias",ru:"новости",zh:"新聞"},s_simple:{de:"einfach",es:"simple",fr:"simple",cs:"prostý",it:"semplice",pl:"prosty",pt:"simples",ru:"простой",zh:"簡單"},s_mobile:{de:"mobil",es:"móvil",fr:"mobile",cs:"mobilní",it:"mobile",pl:"mobilna",pt:"móvel",ru:"мобильный",zh:"行動"},s_tile:{de:"kachel",es:"mosaico",fr:"mosaïque",cs:"dlaždice",it:"affianca",pl:"sąsiadująco",pt:"ladrilho",ru:"замостить",zh:"磚"},s_chests:{de:"truhen",es:"cofres",fr:"coffres",cs:"truhly",it:"scrigni",pl:"skrzynie",pt:"baús",ru:"сундуки",zh:"寶箱"},s_this:{de:"dieses",es:"esto",fr:"ce",cs:"toto",it:"questo",pl:"to",pt:"isto",ru:"это",zh:"這"},s_your:{de:"dein",es:"tu",fr:"ton",cs:"tvůj",it:"tuo",pl:"twój",pt:"teu",ru:"твой",zh:"你的"},s_name:{de:"namen",es:"nombre",fr:"nom",cs:"název",it:"nome",pl:"nazwa",pt:"nome",ru:"имя",zh:"名"},s_buy:{de:"kaufen",es:"comprar",fr:"acheter",cs:"koupit",it:"comprare",pl:"kupić",pt:"comprar",ru:"купить",zh:"買"},s_sell:{de:"verkaufen",es:"vender",fr:"vendre",cs:"prodat",it:"vendere",pl:"sprzedać",pt:"vender",ru:"продать",zh:"賣"},s_quantity:{de:"quantität",es:"cantidad",fr:"quantité",cs:"množství",it:"quantità",pl:"ilość",pt:"quantidade",ru:"количество",zh:"量"},s_profit:{de:"gewinn",es:"beneficio",fr:"profit",cs:"zisk",it:"profitto",pl:"zysk",pt:"lucro",ru:"прибыль",zh:"利潤"},s_cost:{de:"kosten",es:"costo",fr:"coût",cs:"náklady",it:"costo",pl:"koszt",pt:"custo",ru:"стоимость",zh:"成本"},s_breakpoint:{de:"gewinnschwelle",es:"punto muerto",fr:"seuil de rentabilité",cs:"bod zvratu",it:"punto di pareggio",pl:"próg rentowności",pt:"ponto de equilíbrio",ru:"точка безубыточности",zh:"收支平衡點"},s_tax:{de:"steuer",es:"impuestos",fr:"impôt",cs:"daň",it:"fiscale",pl:"podatek",pt:"fiscal",ru:"налог",zh:"稅"},s_revenue:{de:"einnahmen",es:"ingresos",fr:"revenus",cs:"příjmy",it:"entrate",pl:"dochody",pt:"receita",ru:"доходов",zh:"收入"},s_margin:{de:"marge",es:"margen",fr:"marge",cs:"marže",it:"margine",pl:"marża",pt:"margem",ru:"валовая",zh:"邊際"},s_low:{de:"niedrigen",es:"bajo",fr:"bas",cs:"nízký",it:"bassa",pl:"niski",pt:"baixa",ru:"низкая",zh:"低"},s_high:{de:"hohen",es:"alta",fr:"haut",cs:"vysoký",it:"alta",pl:"wysoki",pt:"alta",ru:"высокая",zh:"高"},s_notify:{de:"benachrichtigen",es:"notificar",fr:"notifier",cs:"oznámit",it:"notifica",pl:"powiadom",pt:"notificar",ru:"уведомить",zh:"通知"},s_overwrite:{de:"überschreiben",es:"sobrescribir",fr:"remplacer",cs:"přepsat",it:"sovrascrivi",pl:"zastąp",pt:"substituir",ru:"перезаписать",zh:"覆寫"},s_gem:{de:"edelsteine",es:"gema",fr:"gemme",cs:"klenot",it:"gemma",pl:"klejnot",pt:"gema",ru:"самоцвет",zh:"寶石"},s_coin:{de:"münze",es:"moneda",fr:"monnaie",cs:"mince",it:"moneta",pl:"moneta",pt:"moeda",ru:"монета",zh:"硬幣"},s_dollar:{de:"dollar",es:"dólar",fr:"dollar",cs:"dolar",it:"dollaro",pl:"polar",pt:"dólar",ru:"доллар",zh:"元"}},Element:{s_TEMPLATE:{de:"",es:"",fr:"",cs:"",it:"",pl:"",pt:"",ru:"",zh:""},s_menuChains:{de:"Ketten",es:"Cadenas",fr:"Chaînes",cs:"Řetězy",it:"Catene",pl:"Łańcuchy",pt:"Cadeias",ru:"Цепи",zh:"鏈"},s_menuMap:{de:"Extras",es:"Herramientas",fr:"Outils",cs:"Nástroje",it:"Strumenti",pl:"Narzędzia",pt:"Ferramentas",ru:"Инструменты",zh:"工具"},s_menuHelp:{de:"Hilfe",es:"Ayuda",fr:"Assistance",cs:"Pomoci",it:"Guida",pl:"Pomoc",pt:"Ajuda",ru:"Помощь",zh:"輔助"},s_menuOptions:{de:"Optionen",es:"Opciónes",fr:"Options",cs:"Možnosti",it:"Opzioni",pl:"Opcje",pt:"Opções",ru:"Параметры",zh:"選項"}},getTranslation:function(e,t){if(O.Options.enu_Language===O.OptionEnum.Language.Default)return e;
var n,i,a=e;-1!==a.indexOf(" ")&&(a=a.replace(/ /g,"_"));var n=t["s_"+a];return n&&(i=n[O.Options.enu_Language])?i:e},getWord:function(e){return O.Options.enu_Language===O.OptionEnum.Language.Default?e:D.Phrase["s_"+e][O.Options.enu_Language]},getPhrase:function(e){return D.getTranslation(e,D.Phrase)},getSentence:function(e){return U.toFirstUpperCase(D.getTranslation(e,D.Phrase))},getElement:function(e){return D.getTranslation(e,D.Element)},getString:function(e,t){void 0===t&&(t=U.CaseEnum.Every);var n=e.split(" ");for(var i in n)n[i]=D.getTranslation(n[i],D.Phrase);return U.toCase(n.join(" "),t)},getModifiedWord:function(e,t,n){var i="";if(t){var a=D.getPhrase(e),r=D.getPhrase(t);i=D.isLanguageModifierFirst()?r+" "+a:a+" "+r}else i=D.getPhrase(e);return U.toCase(i,n)},translatePageHeader:function(e){O.Options.enu_Language!==O.OptionEnum.Language.Default&&$("#plate"+e+" .cntHeader").text(D.getElement("menu"+e))},translateAfter:function(){O.Options.enu_Language!==O.OptionEnum.Language.Default&&($(".jsTranslate").each(function(){$(this).text(D.getPhrase($(this).text()))}),$("#paneMenu kbd").each(function(){$(this).attr("title","<dfn>"+D.getElement($(this).attr("id"))+"</dfn>"),I.qTip.init($(this))}),$("#paneMenu var").each(function(){$(this).text(D.getElement($(this).parent().attr("id")))}),D.translatePageHeader(I.PageEnum.Options)),$(".mapHUDButton").each(function(){var e=$(this).data("title");$(this).attr("title","<dfn>"+D.getString(e)+"</dfn>"),I.qTip.init($(this))}),$("#optAlarmLegend").text(D.getModifiedWord("mode","alarm",U.CaseEnum.Every)),$("#opt_int_setAlarm").after(" "+D.getSentence("off")),$("#optAlarmChecklist").after(" "+D.getSentence("checklist")),$("#optAlarmSubscription").after(" "+D.getSentence("subscription"))},isLanguageFullySupported:function(){return O.Options.enu_Language===O.OptionEnum.Language.English||O.Options.enu_Language===O.OptionEnum.Language.German||O.Options.enu_Language===O.OptionEnum.Language.Spanish||O.Options.enu_Language===O.OptionEnum.Language.French?!0:!1},getFullySupportedLanguage:function(){return D.isLanguageFullySupported()?O.Options.enu_Language:O.OptionEnum.Language.Default},getNameKey:function(){return"name_"+D.getFullySupportedLanguage()},getURLKey:function(){return"url_"+D.getFullySupportedLanguage()},getObjectName:function(e){return e["name_"+D.getFullySupportedLanguage()]},getDefaultObjectName:function(e){return e["name_"+O.OptionEnum.Language.Default]},getObjectURL:function(e){return e["url_"+D.getFullySupportedLanguage()]},isLanguageSecondary:function(){return O.Options.enu_Language===O.OptionEnum.Language.German||O.Options.enu_Language===O.OptionEnum.Language.Spanish||O.Options.enu_Language===O.OptionEnum.Language.French?!0:!1},isLanguageModifierFirst:function(){return O.Options.enu_Language===O.OptionEnum.Language.French||O.Options.enu_Language===O.OptionEnum.Language.Spanish||O.Options.enu_Language===O.OptionEnum.Language.Italian||O.Options.enu_Language===O.OptionEnum.Language.Portuguese||O.Options.enu_Language===O.OptionEnum.Language.Mandarin?!1:!0},isLanguageLogographic:function(){return O.Options.enu_Language===O.OptionEnum.Language.Mandarin?!0:!1},ChainTitle:[{en:"Fire Elemental",de:"Feuerelementar",es:"Elemental de Fuego",fr:"Elémentaire de Feu",zh:"火焰元素"},{en:"Golem Mark II",de:"Golem Typ II",es:"Gólem Serie II",fr:"Golem Marque II",zh:"魔像馬克II型"},{en:"Claw of Jormag",de:"Klaue Jormags",es:"Garra de Jormag",fr:"Griffe de Jormag",zh:"卓瑪之爪"},{en:"Frozen Maw",de:"Svanir-Schamane",es:"Chamán Svanir",fr:"Chamane de Svanir",zh:"斯瓦尼亞薩滿"},{en:"Mega Destroyer",de:"Mega Zerstörer",es:"Mega Destructor",fr:"Méga Destructeur",zh:"超能毀滅者"},{en:"Shadow Behemoth",de:"Schatten-Behemoth",es:"Behemot de las Sombras",fr:"Béhémoth des Ombres",zh:"暗影巨獸"},{en:"The Shatterer",de:"Den Zerschmetterer",es:"El Asolador",fr:"Le Destructeur",zh:"碎裂巨獸"},{en:"Taidha Covington",de:"Taidha Covington",es:"Taidha Covington",fr:"Taidha Covington",zh:"泰達·科文頓"},{en:"Modniir Ulgoth",de:"Ulgoth den Modniir",es:"Ulgoth el Modniir",fr:"Ulgoth le Modniir",zh:"莫迪爾沃爾格斯"},{en:"Great Jungle Wurm",de:"Großen Dschungelwurm",es:"Gran Sierpe de la Selva",fr:"Grande Guivre de la Jungle",zh:"巨型叢林地虫"},{en:"Karka Queen",de:"Karka-Königin",es:"Reina Karka",fr:"Reine Karka",zh:"喀殼虫女王"},{en:"Tequatl the Sunless",de:"Tequatl den Sonnenlosen",es:"Tequatl el Sombrío",fr:"Tequatl le Sans-soleil",zh:"吞噬托"},{en:"Triple Wurm",de:"Dreifach Wurm",es:"Sierpe Triple",fr:"Guivre Triple",zh:"進化巨型叢林地虫"},{en:"Dry Top Q1",de:"Trockenkuppe Q1",es:"Cima Seca Q1",fr:"Cimesèche Q1"},{en:"Dry Top Q2",de:"Trockenkuppe Q2",es:"Cima Seca Q2",fr:"Cimesèche Q2"},{en:"Dry Top Q3",de:"Trockenkuppe Q3",es:"Cima Seca Q3",fr:"Cimesèche Q3"},{en:"Dry Top Q4",de:"Trockenkuppe Q4",es:"Cima Seca Q4",fr:"Cimesèche Q4"},{en:"Lyssa",de:"Verderbte Hohepriesterin der Lyssa",es:"Suma Sacerdotisa Corrupta de Lyssa",fr:"Grande Prêtresse Corrompue de Lyssa",zh:"Lyssa 的寺廟"},{en:"Dwayna",de:"Besessene Dwayna-Statue",es:"Estatua Poseída de Dwayna",fr:"Statue Possédée de Dwayna",zh:"Dwayna 的寺廟"},{en:"Melandru",de:"Auferstandenen Priester der Melandru",es:"Sacerdote de Melandru Resurgido",fr:"Prêtre Revenant de Melandru",zh:"Melandru 的寺廟"},{en:"Grenth",de:"Auferstandenen Priester des Grenth",es:"Sacerdote de Grenth Resurgido",fr:"Prêtre Revenant de Grenth",zh:"Grenth 的寺廟"},{en:"Arah",de:"Tore von Arah",es:"Puertas de Arah",fr:"Portes d'Arah",zh:"Arah 的寺廟"},{en:"Balthazar",de:"Auferstandenen Priester des Balthasar",es:"Sacerdote de Balthazar Resurgido",fr:"Prêtre Revenant de Balthazar",zh:"Balthazar 的寺廟"},{en:"Balthazar North",de:"Nord Invasion von Orr",es:"Invasión del Norte de Orr",fr:"Invasion du Nord de Orr",zh:"北部入侵 Orr"},{en:"Balthazar Central",de:"Zentral Invasion von Orr",es:"Invasión Central de Orr",fr:"Invasion Central de Orr",zh:"中部入侵 Orr"},{en:"Balthazar South",de:"Invasion der Südlichen Orr",es:"Invasión del Sur de Orr",fr:"Invasion du Sud de Orr",zh:"南部入侵 Orr"},{en:"Fire Shaman",de:"Feuerschamanen",es:"Chamán de Fuego",fr:"Chamane de Feu",zh:"火薩滿"},{en:"Rhendak the Crazed",de:"Rhendak den Verrückten",es:"Rhendak el Perturbado",fr:"Rhendak le Fou",zh:"瘋狂 Rhendak"},{en:"Foulbear Chieftain",de:"Faulbär-Häuptling",es:"Cabecilla de Osoinmundo",fr:"Chef Oursefol",zh:"臭熊頭目"},{en:"Dredge Commissar",de:"Schaufler-Kommissar",es:"Comisario Draga",fr:"Kommissar Draguerre",zh:"疏浚政委"},{en:"Nebo Terrace",de:"Nebo-Terrasse",es:"Terraza de Nebo",fr:"Terrasse de Nebo",zh:"階地 Nebo"},{en:"Eye of Zhaitan",de:"Auge des Zhaitan",es:"Ojo de Zhaitan",fr:"Œil de Zhaïtan",zh:"眼的 Zhaitan"}],getChainTitle:function(e){return C.Chains[e].series===C.ChainSeriesEnum.DryTop?D.isLanguageFullySupported()?D.ChainTitle[e][O.Options.enu_Language]:D.ChainTitle[e][O.OptionEnum.Language.Default]:O.Options.enu_Language===O.OptionEnum.Language.Default?C.Chains[e].title:D.getChainTitleAny(e)},getChainTitleAny:function(e){return C.Chains[e].series===C.ChainSeriesEnum.DryTop?C.Chains[e].title:D.isLanguageFullySupported()||O.Options.enu_Language===O.OptionEnum.Language.Mandarin?D.ChainTitle[e][O.Options.enu_Language]:D.ChainTitle[e][O.OptionEnum.Language.Default]},getChainAlias:function(e){return O.Options.enu_Language===O.OptionEnum.Language.Default?C.Chains[e].alias:D.getChainTitle(e)},speechWait:0,speak:function(e,t){if(I.isSpeechSynthesisEnabled){var n=new SpeechSynthesisUtterance(e);return n.lang=O.LanguageCode[O.Options.enu_Language],n.volume=O.Options.int_volAlarm/T.cPERCENT_100,n.rate=.8,void window.speechSynthesis.speak(n)}var i=function(e){var t=document.getElementById("jsTTSAudio");t.src="http://tts-api.com/tts.mp3?q="+e,t.volume=O.Options.int_volAlarm/T.cPERCENT_100,t.load(),t.play()};if(void 0===t){var a=D.isLanguageLogographic()?4:12;t=1+Math.round(e.length/a)}var r=t*T.cMILLISECONDS_IN_SECOND;0===D.speechWait?(D.speechWait+=r,i(e),setTimeout(function(){D.speechWait-=r},r)):(D.speechWait+=r,setTimeout(function(){D.speechWait>0&&(i(e),D.speechWait-=r)},D.speechWait-r))},isSpeaking:function(){return 0===D.speechWait?!1:!0},stopSpeech:function(){I.isSpeechSynthesisEnabled?window.speechSynthesis.cancel():document.getElementById("jsTTSAudio").src=""},resetSpeechQueue:function(e){void 0===e&&(e=0),D.speechWait>e*T.cMILLISECONDS_IN_SECOND&&(D.speechWait=0,D.stopSpeech())},getSpeech:function(e,t){return I.isSpeechSynthesisEnabled?t?D.getModifiedWord(e,t):D.getPhrase(e):t?t+e:e},getChainPronunciation:function(e){return O.Options.enu_Language===O.OptionEnum.Language.Default||I.BrowserCurrent!==I.BrowserEnum.Chrome?C.Chains[e.nexus].pronunciation:D.getChainTitle(e.nexus)},sortObjects:function(e){var t=D.getNameKey();e.sort(function(e,n){return e[t]>n[t]?1:e[t]<n[t]?-1:0})}},C={Chains:GW2T_CHAIN_DATA,DryTop:{},cIndexSynonym:"nexus",ChainToday:null,CurrentChainSD:{},NextChainSD1:{},NextChainSD2:{},NextChainSD3:{},NextChainSD4:{},CurrentChainHC:{},NextChainHC1:{},NextChainHC2:{},NextChainHC3:{},NextChainHC4:{},CurrentChains:[],CurrentChainsSD:[],PreviousChains1:[],PreviousChains2:[],NextChains1:[],cEventTitleCharLimit:44,cEventNameWidth:320,RegularChains:[],ScheduledChains:[],DryTopChains:[],LegacyChains:[],TempleChains:[],ChainSeriesEnum:{Temple:0,Legacy:1,ScheduledCutoff:1,Standard:2,Hardcore:3,ChainCutoff:4,DryTop:4},EventPrimacyEnum:{Optional:0,Normal:1,Primary:2,Boss:3},isDryTopGenerated:!1,isDryTopIconsShown:!1,isTimetableGenerated:!1,getChainByAlias:function(e){return C.Chains[T.ChainAssociation[e.toLowerCase()]]},getChainRegion:function(e){return M.getZoneRegion(e.extra[0])},updateChainToday:function(e){var t=new Date;e=e||!1,e===!0&&(t=T.addDaysToDate(t,1));var n,i,a=t.getUTCDate(),r=T.DailyCalendar[a].pve[3].split(" ")[0].toLowerCase(),o=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Minutes);void 0!==T.ChainAssociation[r]?(n=C.Chains[T.ChainAssociation[r]],i=T.convertScheduleKeyToUTCMinutes(n.scheduleKeys[0]),C.ChainToday=e===!1?i+T.cMINUTES_IN_TIMEFRAME>=o?n:null:i+T.cMINUTES_IN_TIMEFRAME<o?n:null):C.ChainToday=null},isChainToday:function(e){return C.ChainToday&&e.nexus===C.ChainToday.nexus?!0:!1},showChainDailyIcon:function(){for(var e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)C.isChainToday(C.CurrentChainsSD[e])?K["WpChain"+e].addClass("clkWaypointDaily"):K["WpChain"+e].removeClass("clkWaypointDaily");$(".chnDaily").hide(),C.ChainToday&&$(".chnDaily_"+C.ChainToday.nexus).show(),C.updateTimetable()},isChainScheduled:function(e){return e.series>C.ChainSeriesEnum.ScheduledCutoff?!0:!1},isChainWorldBoss:function(e){return e.series<C.ChainSeriesEnum.ChainCutoff?!0:!1},isChainRegular:function(e){return e.series===C.ChainSeriesEnum.Standard||e.series===C.ChainSeriesEnum.Hardcore?!0:!1},parseChainAlias:function(e){return-1!==e.indexOf("XXX")?e.split("XXX")[0]:e},getEventStepNumber:function(e){if(1===e.length)return e;var t,n="";for(t=0;t<e.length;t++){if(!isFinite(e.charAt(t)))return n;n+=e.charAt(t)}return n},truncateTitleString:function(e,t,n){return n=n||"",e.length>t?e.substring(0,t)+n:e},initializeChain:function(e){var t,n,i,a="";C.isChainWorldBoss(e)&&(a="<input class='chnWaypoint' type='text' value='"+e.waypoint+"' /> ("+e.extra[1]+") "+e.extra[2]+"<ins class='sixteen sixt_ec'></ins> "+e.extra[3]+"<ins class='sixteen sixt_ch'></ins> "+e.extra[4]+"<ins class='sixteen sixt_dg'></ins> "),$(e.htmllist).append("<div id='chnBar_"+e.nexus+"' class='chnBar'><div class='chnTitle'><img id='chnIcon_"+e.nexus+"' src='img/chain/"+C.parseChainAlias(e.alias).toLowerCase()+I.cPNG+"' /><samp id='chnCheck_"+e.nexus+"' class='chnCheck'></samp><h1 id='chnTitle_"+e.nexus+"'>"+D.getChainTitleAny(e.nexus)+"</h1><time id='chnTime_"+e.nexus+"' class='chnTimeFutureFar'></time><aside><img class='chnDaily chnDaily_"+e.nexus+"' src='img/ui/daily.png' /></aside></div><div id='chnDetails_"+e.nexus+"' class='chnDetails'><ol id='chnEvents_"+e.nexus+"' class='chnEvents'></ol><div class='chnDetailsExtra'>"+a+"<kbd id='chnDelete_"+e.nexus+"' title='Permanently hide this event chain (can undo in ▼ icon above).'>[x]</kbd></div></div>");var r=function(e,t){var n=t,i="&lt;br /&gt;",a=function(e){return"&lt;dfn&gt;"+e+"&lt;/dfn&gt;"},r="";r=e.series===C.ChainSeriesEnum.DryTop?a("Event Number: ")+n.num+i+a("Start Time: ")+n.lim+i+i+"&quot;"+D.getObjectName(n).replace(/["']/g,"")+"&quot;":a("Event Number: ")+n.num+i+a("If Success Go To: ")+n.sGotoNum+i+a("If Failure Go To: ")+n.fGotoNum+i+a("If Success Wait: ")+n.sInterim+i+a("If Failure Wait: ")+n.fInterim+i+a("Time Limit: ")+n.lim+i+a("Avg to Complete: ")+n.avg+i+a("Min to Complete: ")+n.min+i+a("Max to Complete: ")+n.max+i+i+"&quot;"+D.getObjectName(n).replace(/["']/g,"")+"&quot;";var o=0,s=C.cEventTitleCharLimit,c=function(){o=12,s=C.cEventTitleCharLimit-4},l=C.getEventStepNumber(n.num);if(l.length!==n.num.length){var u=n.num.slice(l.length);-1!==n.num.indexOf(".")?c():2===n.num.length?-1===u.indexOf("A")&&-1===u.indexOf("a")&&c():-1===u.indexOf("A1")&&-1===u.indexOf("a1")&&c()}$("#chnEvents_"+e.nexus).append("<li id='chnEvent_"+e.nexus+"_"+n.num+"' class='chnStep_"+e.nexus+"_"+n.step+"' style='margin-left:"+o+"px'><ins class='evt_"+n.icon+"' title='"+r+"'></ins><span>"+C.truncateTitleString(D.getObjectName(n),s,"..")+"</span></li>")};for(t in e.events)if(i=e.events[t],i.primacy===C.EventPrimacyEnum.Primary)e.primaryEvents.push(i);else if(i.primacy===C.EventPrimacyEnum.Boss){e.primaryEvents.push(i),e.primaryEvents[0].minSum=0,e.primaryEvents[0].avgSum=0,e.primaryEvents[0].minavgSum=0;break}for(t=1;t<e.primaryEvents.length;t++){var o=T.parseEventTime(e.primaryEvents[t-1].sInterim[0]);e.primaryEvents[t].minSum=T.parseEventTime(e.primaryEvents[t-1].min)+o+e.primaryEvents[t-1].minSum,e.primaryEvents[t].avgSum=T.parseEventTime(e.primaryEvents[t-1].avg)+o+e.primaryEvents[t-1].avgSum,e.primaryEvents[t].minavgSum=e.primaryEvents[t].minSum+~~(Math.abs(e.primaryEvents[t].avgSum-e.primaryEvents[t].minSum)/2)}if(t--,e.minFinish=e.primaryEvents[t].minSum+T.parseEventTime(e.primaryEvents[t].min),e.avgFinish=e.primaryEvents[t].avgSum+T.parseEventTime(e.primaryEvents[t].avg),e.minavgFinish=e.minFinish+~~(Math.abs(e.avgFinish-e.minFinish)/2),n=0,C.isChainScheduled(e)){for(t in e.events)if(e.events[t].primacy!==C.EventPrimacyEnum.Optional&&(C.getEventStepNumber(e.events[t].num)!==C.getEventStepNumber(e.primaryEvents[n].num)&&n++,r(e,e.events[t])),e.events[t].primacy===C.EventPrimacyEnum.Boss)break}else for(t in e.events)r(e,e.events[t]);I.ModeCurrent!==I.ModeEnum.Tile&&($("#chnTitle_"+e.nexus).click(function(){$(this).parent().next().slideToggle(100)}),$("#chnDetails_"+e.nexus).hide()),O.Options.enu_Language===O.OptionEnum.Language.Default&&I.isMapEnabled&&$("#chnBar_"+e.nexus).hover(function(){$("#chnTitle_"+e.nexus).text(D.getChainTitle(e.nexus))},function(){$("#chnTitle_"+e.nexus).text(D.getChainTitleAny(e.nexus))}),$("#chnDetails_"+e.nexus+" .chnWaypoint").click(function(){$(this).select()}),I.qTip.init($("#chnEvents_"+e.nexus+" ins")),I.qTip.init($("#chnDetails_"+e.nexus+" kbd")),X.initializeChainChecklist(e)},initializeAllChains:function(){X.initializeChecklist(X.Checklists.Chain,C.Chains.length),X.initializeChecklist(X.Checklists.ChainSubscription,C.Chains.length);var e;for(var t in C.Chains){e=C.Chains[t];for(var n in e.events)e.events[n].step=parseInt(C.getEventStepNumber(e.events[n].num))-1;switch(e.nexus=parseInt(t),e.isSorted=!1,e.primaryEvents=new Array,e.scheduleKeys=new Array,e.series){case C.ChainSeriesEnum.Standard:e.htmllist="#sectionChains_Scheduled",C.RegularChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.Hardcore:e.htmllist="#sectionChains_Scheduled",C.RegularChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.DryTop:e.htmllist="#sectionChains_Drytop",C.DryTopChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.Legacy:e.htmllist="#sectionChains_Legacy",C.LegacyChains.push(e);break;case C.ChainSeriesEnum.Temple:e.htmllist="#sectionChains_Temple",C.TempleChains.push(e)}C.isChainScheduled(e)&&C.initializeChain(e)}I.initializeChainsUI(),$("#sectionChains_Scheduled .chnBar h1, #sectionChains_Drytop .chnBar h1").addClass("chnTitleFutureFar")},isChainCurrent:function(e){for(var t in C.CurrentChains)if(e.nexus===C.CurrentChains[t].nexus)return!0;return!1},isChainUnchecked:function(e){return X.getChainChecklistState(e)===X.ChecklistEnum.Unchecked?!0:!1},isChainSubscribed:function(e){return X.getChecklistItem(X.Checklists.ChainSubscription,e.nexus)===X.ChecklistEnum.Checked?!0:!1},updateChainsTimeHTML:function(){var e,t,n,i,a="<dfn>"+D.getString("click to")+"<br />"+D.getSentence("subscribe")+"</dfn><br />";for(e in C.ScheduledChains){t=C.ScheduledChains[e];var r,o="";if(t.series!==C.ChainSeriesEnum.DryTop){for(var s in t.scheduleKeys)r=0===parseInt(s)?a:" <br /> ",o=o+r+T.getTimeFormatted({wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(t.scheduleKeys[s])});$("#chnTime_"+t.nexus).prop("title",o)}C.isChainCurrent(t)||(n=T.getTimeFormatted({wantLetters:!0,wantSeconds:!1,customTimeInSeconds:T.getSecondsUntilChainStarts(t)}),i=T.getTimeFormatted({wantLetters:!1,wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(t.scheduleKeys[0])}),$("#chnTime_"+t.nexus).html(n+"<br /><sup>"+i+"</sup>"))}I.qTip.init(".chnTitle time")},updateCurrentChainTimeHTML:function(e){var t=T.getCurrentTimeframeElapsedTime(),n=e.countdownToFinish-t,i=n,a="⇑ ";if(e.series===C.ChainSeriesEnum.DryTop){var r=T.getDryTopMinute(),o=T.getDryTopMinute(1);i=T.getTimeFormatted({reference:T.ReferenceEnum.UTC,want24:!0,wantHours:!1}),$("#chnTime_"+e.nexus).text("(:"+r+") "+i),C.isDryTopIconsShown&&$("#mapDryTopTimer").html("<var style='color:"+T.getCurrentDryTopColor()+"'>:"+r+"</var> "+i+" <var style='color:"+T.getCurrentDryTopColor(1)+"'>:"+o+"</var>")}else 0>=n&&(i=T.cSECONDS_IN_TIMEFRAME-t,a="⇓ "),$("#chnTime_"+e.nexus).text(a+T.getTimeFormatted({wantHours:!1,wantLetters:!0,customTimeInSeconds:i}))},initializeTimetableHTML:function(){if(C.isTimetableGenerated!==!1){$("#sectionChains_Timetable").empty();var e,t,n,i,a;for(e in T.Schedule){n=T.getScheduleSlotChainsByKey(e);for(t in n){if(i=n[t],i.series!==C.ChainSeriesEnum.Standard&&i.series!==C.ChainSeriesEnum.Hardcore)break;a=T.getTimeFormatted({wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(e)}),$("#sectionChains_Timetable").append("<div class='chnSlot chnSlotTime_"+e+" chnSlot_"+i.nexus+"' data-"+C.cIndexSynonym+"='"+i.nexus+"' data-timeframe='"+e+"'><div class='chnTitle'><img src='img/chain/"+C.parseChainAlias(i.alias).toLowerCase()+I.cPNG+"' /><samp class='chnCheck'></samp><h1>"+D.getChainTitleAny(i.nexus)+"</h1><time>"+a+"</time><aside><img class='chnDaily chnDaily_"+i.nexus+"' src='img/ui/daily.png' /></aside></div></div>")}}for(var e in C.RegularChains){i=C.RegularChains[e];var r=$(".chnSlot_"+i.nexus),o=r.find(".chnCheck"),s=r.find("time");X.reapplyChainBarState(i.nexus,r,o,s)}$(".chnTitle h1").hover(function(){$(".chnSlot_"+$(this).parent().parent().data(C.cIndexSynonym)).addClass("chnBarHover")},function(){$(".chnSlot").removeClass("chnBarHover")}),$(".chnSlot samp").click(function(){$("#chnCheck_"+C.Chains[$(this).parent().parent().data(C.cIndexSynonym)].nexus).trigger("click")}),$(".chnSlot time").click(function(){$("#chnTime_"+C.Chains[$(this).parent().parent().data(C.cIndexSynonym)].nexus).trigger("click")}),$(".chnSlotTime_0").addClass("chnBarReset"),C.showChainDailyIcon()}},updateTimetable:function(){if(C.isTimetableGenerated!==!1){var e=T.getTimeframeKey(-1),t=T.getTimeframeKey(),n=T.getTimeframeKey(1);$(".chnSlotTime_"+e).removeClass("chnBarCurrent"),$(".chnSlotTime_"+t).addClass("chnBarCurrent"),$(".chnSlotTime_"+e+" .chnTitle h1").removeClass("chnTitleCurrent"),$(".chnSlotTime_"+t+" .chnTitle h1").removeClass("chnTitleFuture").addClass("chnTitleCurrent"),$(".chnSlotTime_"+n+" .chnTitle h1").addClass("chnTitleFuture");var i=T.getCurrentTimeframe();$(".chnSlot").each(function(){return T.convertScheduleKeyToUTCMinutes($(this).data("timeframe"))<i?void $(this).appendTo("#sectionChains_Timetable"):!1}),C.ChainToday&&$("#sectionChains_Timetable .chnDaily_"+C.ChainToday.nexus).each(function(){T.convertScheduleKeyToUTCMinutes($(this).closest(".chnSlot").data("timeframe"))<i&&$(this).hide()})}},sortChainsListHTML:function(){for(var e,t,n=0,i=C.ScheduledChains.length,a=0,r=0,o="";i>n;){e=T.getTimeframeChains(a);for(r in e){if(n>=i)break;if(t=e[r],t.isSorted===!1){switch(t.series){case C.ChainSeriesEnum.DryTop:o="#sectionChains_Drytop";break;default:o="#sectionChains_Scheduled"}$("#chnBar_"+t.nexus).appendTo(o),t.isSorted=!0,t.scheduleKeyImmediate=T.getTimeframeKey(a),n++}}a++}for(a in C.ScheduledChains){t=C.ScheduledChains[a],t.isSorted=!1;for(r in t.scheduleKeys)if(t.scheduleKeys[r]===t.scheduleKeyImmediate){t.scheduleKeys=t.scheduleKeys.slice(r,t.scheduleKeys.length).concat(t.scheduleKeys.slice(0,r));break}}C.updateChainsTimeHTML();for(a in C.CurrentChains)t=C.CurrentChains[a],$("#chnBar_"+t.nexus).addClass("chnBarCurrent"),C.isChainUnchecked(t)&&I.ModeCurrent!==I.ModeEnum.Tile&&(t.series===C.ChainSeriesEnum.DryTop||t.series!==C.ChainSeriesEnum.DryTop&&O.Options.bol_expandWB)&&$("#chnDetails_"+t.nexus).show("fast"),$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleFuture chnTitleFutureFar").addClass("chnTitleCurrent"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeFuture chnTimeFutureFar").addClass("chnTimeCurrent");for(a in C.PreviousChains1)t=C.PreviousChains1[a],$("#chnBar_"+t.nexus).removeClass("chnBarCurrent").addClass("chnBarPrevious"),O.Options.bol_collapseChains&&I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+t.nexus).hide(),$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleCurrent").addClass("chnTitleFutureFar"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeCurrent").addClass("chnTimeFutureFar");for(a in C.PreviousChains2)t=C.PreviousChains2[a],$("#chnBar_"+t.nexus).removeClass("chnBarPrevious");for(a in C.NextChains1)t=C.NextChains1[a],$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleFutureFar").addClass("chnTitleFuture"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeFutureFar").addClass("chnTimeFuture")},queueEventsHighlight:function(e){var t,n,i=e,a=T.getCurrentTimeframeElapsedTime(),r=!1;if(a>0){for(t in i.primaryEvents)if(n=C.getSumBasedOnOptions(i,t),n>=a&&t>0){C.highlightEvents(i,parseInt(t-1)),r=!0;break}r===!1&&(n=C.getSumBasedOnOptions(i,-1),n>=a?C.highlightEvents(i,t):C.highlightEvents(i,-1))}for(t in i.primaryEvents)n=C.getSumBasedOnOptions(i,t),n>=a&&(n-=a,setTimeout(function(e,t){return function(){C.highlightEvents(e,t)}}(i,parseInt(t)),n*T.cMILLISECONDS_IN_SECOND));n=C.getSumBasedOnOptions(i,-1),n>=a&&(n-=a,setTimeout(function(e){return function(){C.highlightEvents(e,-1)}}(i),n*T.cMILLISECONDS_IN_SECOND))},highlightEvents:function(e,t){var n,i,a=500,r=C.cEventNameWidth,o=e.primaryEvents.length-1,s=C.isChainRegular(e);if(e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated&&(P.LayerArray.DryTopActive=null,P.LayerArray.DryTopActive=new Array,C.isDryTopIconsShown))for(n in e.events)i=e.events[n],M.toggleLayer(i.eventicon,!1),M.toggleLayer(i.eventring,!1);if(t>-1){for(e.CurrentPrimaryEvent=e.primaryEvents[t],n=0;t>n;n++)$(".chnStep_"+e.nexus+"_"+n).removeClass("chnEventCurrent");if($(".chnStep_"+e.nexus+"_"+(t-1)).css({opacity:1}).animate({opacity:.5},a,function(){e.series===C.ChainSeriesEnum.DryTop&&$(this).hide()}),$(".chnStep_"+e.nexus+"_"+t).each(function(){$(this).removeClass("chnEventFuture").addClass("chnEventCurrent").show().css({width:0,opacity:.5}).animate({width:r,opacity:1},a).css({width:"auto"}),e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated&&(i=e.events[$(this).attr("data-eventindex")],P.LayerArray.DryTopActive.push(i.eventicon),P.LayerArray.DryTopActive.push(i.eventring),C.isDryTopIconsShown&&M.toggleLayerArray(P.LayerArray.DryTopActive,!0))}),t<e.primaryEvents.length)for(n=t+1;n<e.primaryEvents.length;n++)$(".chnStep_"+e.nexus+"_"+n).show().removeClass("chnEventCurrent").addClass("chnEventFuture");O.Options.bol_tourPrediction&&!O.Options.bol_followCharacter&&I.PageCurrent===I.PageEnum.Chains&&M.isMapAJAXDone&&C.isChainUnchecked(e)&&s&&$("#sectionChains_Drytop").is(":visible")===!1&&$("#chnEvent_"+e.nexus+"_"+e.CurrentPrimaryEvent.num).trigger("click"),t===o&&O.Options.bol_alertArrival&&s&&(O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&C.isChainUnchecked(e)||O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&C.isChainSubscribed(e)&&C.isChainUnchecked(e))&&D.speak(D.getChainPronunciation(e)+" "+D.getSpeech("arrival")+" "+D.getSpeech("predicted"))}else{if(e.CurrentPrimaryEvent=e.primaryEvents[o],$("#chnEvents_"+e.nexus+" li").show().removeClass("chnEventCurrent"),$(".chnStep_"+e.nexus+"_"+o).css({opacity:1}).animate({opacity:.5},a),O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&O.Options.bol_alertAtEnd&&I.isProgramLoaded&&e.nexus===C.CurrentChainSD.nexus&&s){var c=", "+D.getSpeech("checked"),l="",u="",d=O.objToBool(C.NextChainSD1),h=O.objToBool(C.NextChainHC1),p=D.getSpeech("world boss","next")+" "+D.getSpeech("is")+" ";C.NextChainSD1&&!C.isChainUnchecked(C.NextChainSD1)&&(l=c),C.NextChainHC1&&!C.isChainUnchecked(C.NextChainHC1)&&(u=c),O.Options.bol_alertChecked===!1&&(l.length>0&&(d=!1),u.length>0&&(h=!1)),d&&h?(D.speak(p+D.getChainPronunciation(C.NextChainSD1)+l,5),D.speak(D.getSpeech("also")+", "+D.getChainPronunciation(C.NextChainHC1)+u,3)):d?D.speak(p+D.getChainPronunciation(C.NextChainSD1)+l,5):h&&D.speak(p+D.getChainPronunciation(C.NextChainHC1)+u,5),(d||h)&&D.speak(T.getTimeTillChainFormatted(C.NextChainSD1,"speech"),3)}O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&I.isProgramLoaded&&O.Options.bol_alertUnsubscribe&&s&&C.isChainSubscribed(e)&&$("#chnTime_"+e.nexus).trigger("click")}},getSumBasedOnOptions:function(e,t){if(C.isChainToday(e))return t>-1?e.primaryEvents[t].minSum:(e.countdownToFinish=e.minFinish,e.minFinish);var n=T.getTimeSinceMidnight(T.ReferenceEnum.Local,T.UnitEnum.Hours);if(t>-1){switch(O.Options.int_setPredictor){case O.IntEnum.Predictor.Auto:if(n>=12&&18>n)return e.primaryEvents[t].minSum;if(n>=18)return e.primaryEvents[t].minavgSum;if(n>=0&&6>n)return e.primaryEvents[t].avgSum;if(n>=6&&12>n)return e.primaryEvents[t].minavgSum;break;case O.IntEnum.Predictor.Min:return e.primaryEvents[t].minSum;case O.IntEnum.Predictor.MinAvg:return e.primaryEvents[t].minavgSum;case O.IntEnum.Predictor.Avg:return e.primaryEvents[t].avgSum}return e.primaryEvents[t].minavgSum}switch(O.Options.int_setPredictor){case O.IntEnum.Predictor.Auto:if(n>=12&&18>n)return e.countdownToFinish=e.minFinish,e.minFinish;if(n>=18)return e.countdownToFinish=e.minavgFinish,e.minavgFinish;if(n>=0&&6>n)return e.countdownToFinish=e.avgFinish,e.avgFinish;if(n>=6&&12>n)return e.countdownToFinish=e.minavgFinish,e.minavgFinish;break;case O.IntEnum.Predictor.Min:return e.countdownToFinish=e.minFinish,e.minFinish;case O.IntEnum.Predictor.MinAvg:return e.countdownToFinish=e.minavgFinish,e.minavgFinish;case O.IntEnum.Predictor.Avg:return e.countdownToFinish=e.avgFinish,e.avgFinish}return e.countdownToFinish=e.minavgFinish,e.minavgFinish}},M={MapEnum:"map",Zones:GW2T_ZONE_DATA,ZoneAssociation:GW2T_ZONE_ASSOCIATION,Regions:GW2T_REGION_DATA,Submaps:GW2T_SUBMAP_DATA,cInitialZone:"lion",Map:{},ZoneCurrent:{},cICON_SIZE_STANDARD:32,cRING_SIZE_MAX:256,isMapInitialized:!1,isMouseOnHUD:!1,isUserDragging:!1,isMapAJAXDone:!1,isAPIRetrieved_MAPFLOOR:!1,isMappingIconsGenerated:!1,isEventIconsGenerated:!1,cMAP_BOUND:32768,cMAP_CENTER:[16384,16384],cMAP_CENTER_INITIAL:[-1024,1024],cMAP_MOUSEMOVE_RATE:100,cInertiaThreshold:100,cZoomFactor:2,ZoomEnum:{Same:-1,Min:0,Default:3,Space:3,Sky:5,Bird:6,Ground:7,Max:7},cZIndexRaise:999999,cZIndexBury:-999999,cMETER_TO_INCH:39.3701,cCIRCLE_RIGHT_DEGREE:90,cCIRCLE_HALF_DEGREE:180,cCIRCLE_FULL_DEGREE:360,cRADIAN_TO_DEGREE:180/Math.PI,cUNITS_TO_POINTS:.0416,cPOINTS_TO_UNITS:5e3/208,GPSTimeout:{},GPSPreviousCoord:[],GPSPreviousAngleCharacter:0,GPSPreviousAngleCamera:0,Layer:{Pin:new L.layerGroup,PersonalPin:new L.layerGroup,PersonalPath:new L.layerGroup,ZoneRectangle:new L.layerGroup},Pin:{Program:{},Event:{},Over:{},Character:{},Camera:{}},MappingEnum:{Sector:0,Waypoint:1,Landmark:2,Vista:3,Challenge:4,Heart:5,EventIcon:6,EventRing:7},APIPOIEnum:{Sector:"sectors",Waypoint:"waypoint",Landmark:"landmark",Vista:"vista",Challenge:"skill_challenges",Heart:"tasks"},initializeMap:function(){var e=this,t="#"+this.MapEnum;this.Map=L.map(this.MapEnum+"Pane",{minZoom:this.ZoomEnum.Min,maxZoom:this.ZoomEnum.Max,inertiaThreshold:this.cInertiaThreshold,doubleClickZoom:!1,touchZoom:!1,zoomControl:I.isOnSmallDevice,attributionControl:!1,crs:L.CRS.Simple}).setView(this.cMAP_CENTER_INITIAL,this.ZoomEnum.Default),this.Map.touchZoom.disable(),this.Map.tap&&this.Map.tap.disable();var n;for(var i in this.Zones)n=this.Zones[i],n.center=this.getZoneCenter(i),n.nick=i,n.Layers={Path:new L.layerGroup,Waypoint:new L.layerGroup,Landmark:new L.layerGroup,Vista:new L.layerGroup,Challenge:new L.layerGroup,Heart:new L.layerGroup,Sector:new L.layerGroup,EventIcon:new L.layerGroup,EventRing:new L.layerGroup},e.MapEnum===I.MapEnum.Tyria&&P.LayerArray.ChainPath.push(n.Layers.Path);switch(this.ZoneCurrent=this.Zones[this.cInitialZone],this.MapEnum){case I.MapEnum.Tyria:this.populateMap(I.MapEnum.Tyria),C.ScheduledChains.forEach(P.drawChainPaths);break;case I.MapEnum.Mists:L.tileLayer(U.URL_API.TilesMists,{continuousWorld:!0}).addTo(W.Map)}this.Map.tap||(this.Map.on("click",function(n){if(!e.isMouseOnHUD){var i=e.convertLCtoGC(n.latlng);$(t+"CoordinatesCopy").val(e.formatCoord(i)).select()}}),this.Map.on("dblclick",function(t){e.isMouseOnHUD||e.createPersonalPin(t.latlng,!0)})),$(t+"CoordinatesCopy").onEnterKey(function(){var t=$(this).val(),n=e.parseCoordinatesMulti(t);if(null!==n){e.removePersonalPins();for(var i in n)e.createPersonalPin(e.convertGCtoLC(n[i]));e.drawPersonalPath()}else e.goToArguments(t,e.Pin.Program)}),$(t+"GPSButton").click(function(){e.updateCharacter(1)}).dblclick(function(){e.Map.setZoom(e.Map.getZoom()!==e.ZoomEnum.Ground?e.ZoomEnum.Ground:e.ZoomEnum.Default)}),$(t+"DisplayButton").click(function(){$("#opt_bol_showPanel").trigger("click")}),$(t+"CompassButton").one("mouseenter",e.bindZoneList).click(function(){e.goToDefault()}),this.isMapInitialized=!0,this.refreshMap()},populateMap:function(){var e=this;I.isMapEnabled&&$.getJSON(U.URL_API.MapFloorTyria,function(t){var n,i,a,r,o,s,c,l,u,d,h,p,C;for(i in t.regions){a=t.regions[i];for(r in a.maps)if(e.ZoneAssociation[r]){for(o=a.maps[r],c=e.getZoneFromID(r),c.map_rect=o.map_rect,c.continent_rect=o.continent_rect,e.Layer.ZoneRectangle.addLayer(L.rectangle(e.convertGCtoLCMulti(c.rect),{fill:!1,color:e.Regions[c.region].color,weight:2,clickable:!1})),l=o.points_of_interest.length,n=0;l>n;n++){switch(s=o.points_of_interest[n],s.type){case e.APIPOIEnum.Waypoint:p=e.MappingEnum.Waypoint,d=U.URL_IMG.Waypoint,h="mapWp",C=s.name;break;case e.APIPOIEnum.Landmark:if(O.Options.bol_showWorldCompletion===!1)continue;p=e.MappingEnum.Landmark,d=U.URL_IMG.Landmark,h="mapPoi",C=s.name;break;case e.APIPOIEnum.Vista:if(O.Options.bol_showWorldCompletion===!1)continue;p=e.MappingEnum.Vista,d=U.URL_IMG.Vista,h="mapPoi",C=D.getPhrase("Vista");break;default:continue}switch(u=L.marker(e.convertGCtoLC(s.coord),{title:"<span class='"+h+"'>"+C+"</span>",markername:s.name,mappingtype:p,icon:L.icon({iconUrl:d,iconSize:[16,16],iconAnchor:[8,8]}),link:U.getChatlinkFromPoiID(s.poi_id)}),s.type){case e.APIPOIEnum.Waypoint:u.on("mouseout",function(){try{this._icon.src=U.URL_IMG.Waypoint}catch(e){}}),u.on("mouseover",function(){this._icon.src=U.URL_IMG.WaypointOver}),c.Layers.Waypoint.addLayer(u);break;case e.APIPOIEnum.Landmark:u.on("mouseout",function(){try{this._icon.src=U.URL_IMG.Landmark}catch(e){}}),u.on("mouseover",function(){this._icon.src=U.URL_IMG.LandmarkOver}),c.Layers.Landmark.addLayer(u);break;case e.APIPOIEnum.Vista:c.Layers.Vista.addLayer(u)}s.type===e.APIPOIEnum.Waypoint||s.type===e.APIPOIEnum.Landmark?(u.on("click",function(){$("#mapCoordinatesCopy").val(this.options.link).select(),$("#mapCoordinatesName").val(this.options.markername)
}),e.bindMappingZoomBehavior(u,"dblclick")):e.bindMappingZoomBehavior(u,"click")}if(O.Options.bol_showWorldCompletion){for(l=o.skill_challenges.length,n=0;l>n;n++)s=o.skill_challenges[n],u=L.marker(e.convertGCtoLC(s.coord),{title:"<span class='mapPoi'>"+D.getPhrase("Hero Challenge")+"</span>",mappingtype:e.MappingEnum.Challenge,icon:L.icon({iconUrl:U.URL_IMG.Challenge,iconSize:[16,16],iconAnchor:[8,8]})}),e.bindMappingZoomBehavior(u,"click"),c.Layers.Challenge.addLayer(u);for(l=o.tasks.length,n=0;l>n;n++)s=o.tasks[n],u=L.marker(e.convertGCtoLC(s.coord),{title:"<span class='mapPoi'>"+s.objective+" ("+s.level+")</span>",task:s.objective,mappingtype:e.MappingEnum.Heart,icon:L.icon({iconUrl:U.URL_IMG.Heart,iconSize:[16,16],iconAnchor:[8,8]})}),u.on("click",function(){var e=this.options.task;e.indexOf(".")===e.length-1&&(e=e.slice(0,-1)),U.openExternalURL(U.getWikiLanguageLink(e))}),c.Layers.Heart.addLayer(u);for(l=o.sectors.length,n=0;l>n;n++)s=o.sectors[n],u=L.marker(e.convertGCtoLC(s.coord),{clickable:!1,mappingtype:e.MappingEnum.Sector,icon:L.divIcon({className:"mapSec",html:"<span class='mapSecIn'>"+s.name+"</span>",iconSize:[512,64],iconAnchor:[256,32]})}),c.Layers.Sector.addLayer(u);e.isMappingIconsGenerated=!0}}}}).done(function(){e.isAPIRetrieved_MAPFLOOR=!0,O.Options.bol_displayEvents===!1&&P.donePopulation()}).fail(function(){I.ModeCurrent===I.ModeEnum.Website&&I.write("Guild Wars 2 API server is unreachable.<br />Reasons could be:<br />- The GW2 server is down for maintenance.<br />- Your browser is too old (if IE then need 11+).<br />- Your computer's time is out of sync.<br />- This website's code encountered a bug.<br />Map features will be limited.<br />",15)}).always(function(){O.Options.bol_displayEvents===!0?P.populateEvents():P.finishPopulation()}),this.Pin.Program=this.createPin("img/map/pin_blue.png"),this.Pin.Event=this.createPin("img/map/pin_green.png"),this.Pin.Over=this.createPin("img/map/pin_over.png",[128,128]),this.Pin.Character=this.createPin("img/map/pin_character.png",[40,40]),this.Pin.Camera=this.createPin("img/map/pin_camera.png",[256,256],{clickable:!1}),this.Layer.Pin.eachLayer(function(t){e.bindMarkerCoordBehavior(t,"click"),t.on("dblclick",function(){e.movePin(this)})}),this.toggleLayer(this.Layer.Pin,!1)},bindMapVisualChanges:function(e){var t=this;$("#paneHUDMap").hover(function(){t.isMouseOnHUD=!0},function(){t.isMouseOnHUD=!1}),this.Map.on("dragstart",function(){t.isUserDragging=!0}),this.Map.on("dragend",function(){t.isUserDragging=!1}),this.Map.on("mousemove",$.throttle(t.cMAP_MOUSEMOVE_RATE,function(e){t.isMouseOnHUD||t.isUserDragging||t.showCurrentZone(t.convertLCtoGC(e.latlng))})),this.Map.on("zoomend",function(){t.adjustZoomMapping(),e===I.MapEnum.Tyria&&P.adjustZoomDryTop()})},refreshMap:function(){this.isMapInitialized&&this.Map.invalidateSize()},isZoneValid:function(e){return void 0===this.ZoneAssociation[e]?!1:!0},getZoneFromID:function(e){return this.Zones[this.ZoneAssociation[e]]},getZoneName:function(e){var t;if("string"==typeof e&&this.Zones[e])t=this.Zones[e];else{if(!e.rect)return"nozonename";t=e}return D.getObjectName(t)},getZoneRegion:function(e){return this.Zones[e.toLowerCase()].region},showCurrentZone:function(e){if(document.getElementById("mapCoordinatesMouse").value=e[0]+", "+e[1],!(e[0]>=this.ZoneCurrent.rect[0][0]&&e[1]>=this.ZoneCurrent.rect[0][1]&&e[0]<=this.ZoneCurrent.rect[1][0]&&e[1]<=this.ZoneCurrent.rect[1][1])){var t,n,i,a="";for(t in this.Zones)if(e[0]>=this.Zones[t].rect[0][0]&&e[1]>=this.Zones[t].rect[0][1]&&e[0]<=this.Zones[t].rect[1][0]&&e[1]<=this.Zones[t].rect[1][1]){i=this.Zones[this.ZoneCurrent.nick];for(n in i.Layers)this.Map.removeLayer(i.Layers[n]);this.ZoneCurrent=this.Zones[t],a=this.getZoneName(this.ZoneCurrent),document.getElementById("mapCoordinatesName").value=a,O.Options.bol_showChainPaths&&I.PageCurrent!==I.PageEnum.Map&&this.ZoneCurrent.Layers.Path.addTo(this.Map),O.Options.bol_displayWaypoints&&this.ZoneCurrent.Layers.Waypoint.addTo(this.Map),O.Options.bol_displayPOIs&&this.ZoneCurrent.Layers.Landmark.addTo(this.Map),O.Options.bol_displayVistas&&this.ZoneCurrent.Layers.Vista.addTo(this.Map),O.Options.bol_displayChallenges&&this.ZoneCurrent.Layers.Challenge.addTo(this.Map),O.Options.bol_displayHearts&&this.ZoneCurrent.Layers.Heart.addTo(this.Map),O.Options.bol_displaySectors&&this.ZoneCurrent.Layers.Sector.addTo(this.Map),O.Options.bol_displayEvents&&(this.ZoneCurrent.Layers.EventIcon.addTo(this.Map),this.ZoneCurrent.Layers.EventRing.addTo(this.Map)),I.qTip.init(".leaflet-marker-icon"),this.adjustZoomMapping();break}}},refreshCurrentZone:function(){var e=this.ZoneCurrent.center;this.showCurrentZone(this.getZoneCenter("dry")),this.showCurrentZone(this.getZoneCenter("rata")),this.showCurrentZone(e)},getZoneCenter:function(e){var t=this.Zones[e].rect,n=t[0][0]+~~((t[1][0]-t[0][0])/2),i=t[0][1]+~~((t[1][1]-t[0][1])/2);return[n,i]},getEventCenter:function(e){var t=this.getZoneFromID(e.map_id),n=e.location.center;return this.convertEventCoord(n,t)},scaleDimension:function(e,t){return t=t||this.Map.getZoom(),parseInt(e/Math.pow(this.cZoomFactor,this.ZoomEnum.Max-t))},invertZoomLevel:function(e){return this.ZoomEnum.Max-T.wrapInteger(e,this.ZoomEnum.Max)},adjustZoomMapping:function(){var e,t,n,i,a,r,o=this,s=this.Map.getZoom();switch(s){case 7:e=40,t=32,n=32,i=256;break;case 6:e=32,t=24,n=24,i=128;break;case 5:e=26,t=16,n=16,i=64;break;case 4:e=20,t=12,n=12,i=32;break;case 3:e=16,t=0,n=0,i=0;break;case 2:e=12,t=0,n=0,i=0;break;default:e=0,t=0,n=0,i=0}switch(s){case 7:a=28,r=.9;break;case 6:a=20,r=.6;break;case 5:a=16,r=.3;break;default:a=0,r=0}this.ZoneCurrent.Layers.Waypoint.eachLayer(function(t){o.changeMarkerIcon(t,U.URL_IMG.Waypoint,e)}),this.ZoneCurrent.Layers.Landmark.eachLayer(function(e){o.changeMarkerIcon(e,U.URL_IMG.Landmark,t),e._icon&&(e._icon.style.opacity=s<o.ZoomEnum.Max?.6:.8)}),this.ZoneCurrent.Layers.Vista.eachLayer(function(e){o.changeMarkerIcon(e,U.URL_IMG.Vista,t)}),this.ZoneCurrent.Layers.Challenge.eachLayer(function(e){o.changeMarkerIcon(e,U.URL_IMG.Challenge,t)}),this.ZoneCurrent.Layers.Heart.eachLayer(function(e){o.changeMarkerIcon(e,U.URL_IMG.Heart,t)}),this.ZoneCurrent.Layers.Sector.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=a+"px",e._icon.style.opacity=r,e._icon.style.zIndex=o.cZIndexBury+1,O.Options.bol_displaySectors&&(e._icon.style.display="table"))}),O.Options.bol_displayEvents&&(this.ZoneCurrent.Layers.EventIcon.eachLayer(function(e){o.changeMarkerIcon(e,e._icon.src,n),e._icon&&(e._icon.style.zIndex=M.cZIndexRaise)}),this.ZoneCurrent.Layers.EventRing.eachLayer(function(e){o.changeMarkerIcon(e,e._icon.src,i),e._icon&&(e._icon.style.zIndex=M.cZIndexBury)})),this.updateCharacter(-1)},createStandardIcon:function(e){return L.icon({iconUrl:e,iconSize:[32,32],iconAnchor:[16,16]})},createPin:function(e,t,n){void 0===t&&(t=[32,32]);var i={icon:L.icon({iconUrl:e,iconSize:t,iconAnchor:[t[0]/2,t[1]/2]}),draggable:!0};if(void 0!==n)for(var a in n)i[a]=n[a];var r=L.marker(this.convertGCtoLC([0,0]),i);return this.Layer.Pin.addLayer(r),r},createPersonalPin:function(e,t){var n=this,i=L.marker(e,{icon:L.icon({iconUrl:"img/map/pin_white.png",iconSize:[32,32],iconAnchor:[16,16]}),draggable:!0,opacity:.9});this.toggleLayer(i,!0),this.Layer.PersonalPin.addLayer(i),t&&this.drawPersonalPath(),this.bindMarkerCoordBehavior(i,"click"),i.on("dblclick",function(){n.toggleLayer(this,!1),n.Layer.PersonalPin.removeLayer(this),n.drawPersonalPath()}),i.on("contextmenu",function(){n.removePersonalPins()}),i.on("drag",function(){n.drawPersonalPath()})},insertPersonalPin:function(e,t){var n=new Array,i=0;this.Layer.PersonalPin.eachLayer(function(a){n.push(a.getLatLng()),i===e&&n.push(t),i++}),this.removePersonalPins();for(i in n)this.createPersonalPin(n[i]);this.drawPersonalPath()},removePersonalPins:function(){var e=this;this.Layer.PersonalPin.eachLayer(function(t){e.toggleLayer(t,!1)}),this.Layer.PersonalPin.clearLayers(),this.drawPersonalPath()},drawPersonalPath:function(){var e=this;if(O.Options.bol_showPersonalPaths){var t,n=new Array,i=new Array,a=0;if(this.Layer.PersonalPin.eachLayer(function(t){n.push(t.getLatLng()),i.push(e.getLayerId(t)),a++}),a>1){this.Layer.PersonalPath.clearLayers();for(var r=0;a-1>r;r++)t=L.polyline([n[r],n[r+1]],{color:"white",opacity:.4,precede:r}),t.on("click",function(){e.getPersonalCoords()}),t.on("dblclick",function(t){e.insertPersonalPin(this.options.precede,t.latlng)}),this.Layer.PersonalPath.addLayer(t);this.toggleLayer(this.Layer.PersonalPath,!0)}else this.Layer.PersonalPath.clearLayers(),this.toggleLayer(this.Layer.PersonalPath,!1)}else this.Layer.PersonalPath.clearLayers(),this.toggleLayer(this.Layer.PersonalPath,!1)},getPersonalCoords:function(){var e=this,t=new Array,n=0;this.Layer.PersonalPin.eachLayer(function(i){t.push(e.convertLCtoGC(i.getLatLng())),n++});var i="";n>1?i=this.compileCoordinates(t):1===n&&(i=this.formatCoord(t[0])),$("#"+e.MapEnum+"CoordinatesCopy").val(i).select()},changeMarkerIcon:function(e,t,n){void 0===n&&(n=this.cICON_SIZE_STANDARD),e.setIcon(new L.icon({iconUrl:t,iconSize:[n,n],iconAnchor:[n/2,n/2]}))},getLayerId:function(e){return e._leaflet_id},toggleLayer:function(e,t){void 0!==e&&(void 0===t&&(t=!this.Map.hasLayer(e)),t?e.addTo(this.Map):this.Map.removeLayer(e))},toggleLayerArray:function(e,t){for(var n in e)this.toggleLayer(e[n],t)},toggleSubmap:function(e,t){var n=this.Submaps[e];void 0===n.ImageOverlay?(n.ImageOverlay=L.imageOverlay(n.img,this.convertGCtoLCMulti(n.bounds)),this.toggleSubmap(e,t)):(void 0===t&&(t=!this.Map.hasLayer(n.ImageOverlay)),t?n.ImageOverlay.addTo(this.Map).bringToBack():this.Map.removeLayer(n.ImageOverlay))},toggleSubmapArray:function(e,t){for(var n in e)this.toggleSubmap(e[n],t)},movePin:function(e,t){void 0===t?this.toggleLayer(e,!1):(this.toggleLayer(e,!0),e.setLatLng(Array.isArray(t)?this.convertGCtoLC(t):t),e._icon.style.zIndex=this.cZIndexRaise)},goToView:function(e,t,n){void 0!==n&&this.movePin(n,e),void 0===t&&(t=this.ZoomEnum.Ground),t===this.ZoomEnum.Same&&(t=this.Map.getZoom()),this.Map.setView(this.convertGCtoLC(e),t),this.showCurrentZone(e)},goToLatLng:function(e,t){void 0===t&&(t=this.ZoomEnum.Ground),t===this.ZoomEnum.Same&&(t=this.Map.getZoom()),this.Map.setView(e,t),this.showCurrentZone(this.convertLCtoGC(e))},goToZone:function(e,t){var n=this.getZoneCenter(e);this.showCurrentZone(n),this.goToView(n,t)},goToDefault:function(){this.Map.setView(this.convertGCtoLC(this.cMAP_CENTER),this.ZoomEnum.Default)},goToArguments:function(e,t){var n,i,a=[];if(e)if(a=this.parseCoordinates(e),2===a.length)isFinite(a[0])&&isFinite(a[1])&&this.goToView(a,this.ZoomEnum.Ground,t);else if(a.length>=3){if(isFinite(a[0])&&isFinite(a[1])&&isFinite(a[2])){var r=this.invertZoomLevel(a[2]);this.goToView([a[0],a[1]],r,t)}}else if(i=e.toLowerCase(),"default"===i)this.goToDefault();else for(n in this.Zones)if(-1!==i.indexOf(n)){this.goToView(this.getZoneCenter(n),this.ZoomEnum.Bird);break}U.Args[U.KeyEnum.Go]=null},convertGCtoLC:function(e){return this.Map.unproject(e,this.Map.getMaxZoom())},convertGCtoLCMulti:function(e,t){t=t||0;var n,i=new Array;for(n=t;n<e.length;n++)i.push(this.convertGCtoLC(e[n]));return i},convertLCtoGC:function(e){var t=this.Map.project(e,this.ZoomEnum.Max);return[Math.round(t.x),Math.round(t.y)]},convertLCtoGCMulti:function(e){for(var t=new Array,n=0;n<e.length;n++)t.push(this.convertLCtoGC(e[n]));return t},convertEventCoord:function(e,t){var n=t.continent_rect,i=t.map_rect;return[~~(n[0][0]+(n[1][0]-n[0][0])*(e[0]-i[0][0])/(i[1][0]-i[0][0])),~~(n[0][1]+(n[1][1]-n[0][1])*(1-(e[1]-i[0][1])/(i[1][1]-i[0][1])))]},convertGPSCoord:function(e,t){var n=this.getZoneFromID(t),i=new Array(3);return i[0]=e[0]*this.cMETER_TO_INCH,i[1]=e[2]*this.cMETER_TO_INCH,i[2]=e[1]*this.cMETER_TO_INCH,this.convertEventCoord(i,n)},convertGPSAngle:function(e){return Math.atan2(e[2],e[0])*this.cRADIAN_TO_DEGREE},parseCoordinates:function(e){var t=e.toString().replace(/[^\d,-.]/g,"");return t.split(",")},parseCoordinatesMulti:function(e){var t,n=13,i=e.replace(/\s/g,""),a=new Array,r=new Array;if(i.length>=n&&"["===i.charAt(0)&&"["===i.charAt(1)&&"]"===i.charAt(i.length-1)&&"]"===i.charAt(i.length-2)){i=i.substring(2,i.length-2),a=i.split("],[");for(var o in a)t=a[o].split(","),2===t.length&&(t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),r.push(t));return r}return null},sortCoordinates:function(e,t){var n;for(var i in e)n=e[i],n[0]=Math.round(n[0]),n[1]=Math.round(n[1]);if(e.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}),t)for(var i in e)this.printNumberedCoordinates(e[i],i);else this.printCoordinates(e)},roundCoordinates:function(e){var t;for(var n in e)t=e[n],t[0]=Math.round(t[0]),t[1]=Math.round(t[1]);this.printCoordinates(e)},printNeedles:function(e){for(var t in e)this.printNumberedCoordinates(e[t].c,t)},formatNodes:function(e){for(var t in e)I.write("{c: ["+e[t][0]+", "+e[t][1]+"]},")},printNumberedCoordinates:function(e,t){I.write("{n: "+(parseInt(t)+1)+", c: ["+e[0]+", "+e[1]+"]},")},formatCoord:function(e){return"["+e[0]+", "+e[1]+"]"},compileCoordinates:function(e){var t="";for(var n in e)t=t+"["+e[n][0]+","+e[n][1]+"],";return t=t.substring(0,t.length-1),"["+t+"]"},printCoordinates:function(e){I.write(this.compileCoordinates(e),30)},convertLatLngs:function(e){var t=this.convertLCtoGCMulti(e);this.printCoordinates(t)},getElementCoordinates:function(e){var t=e.attr("data-coord");return this.Zones[t]?this.getZoneCenter(t):this.parseCoordinates(t)},bindMapLinks:function(e,t){if(I.isMapEnabled!==!1){var n=this;$(e+" dfn").each(function(){$(this).text("["+$(this).text()+"]"),n.bindMapLinkBehavior($(this),t,n.Pin.Program)})}},bindMapLinkBehavior:function(e,t,n){if(I.isMapEnabled!==!1){var i=this;e.click(function(){var e=i.getElementCoordinates($(this));i.goToView(e,t,n)}),e.dblclick(function(){var e=i.getElementCoordinates($(this));i.Map.getZoom()===i.ZoomEnum.Max?i.goToView(e,i.ZoomEnum.Default,n):i.goToView(e,i.ZoomEnum.Ground,n)}),e.mouseover(function(){var e=i.getElementCoordinates($(this));i.movePin(i.Pin.Over,e)}),e.mouseout(function(){i.movePin(i.Pin.Over)})}},bindMarkerZoomBehavior:function(e,t){var n=this;e.on(t,function(e){n.Map.getZoom()===n.ZoomEnum.Max?n.Map.setZoom(n.ZoomEnum.Default):n.Map.setView(e.latlng,n.ZoomEnum.Max)})},bindMappingZoomBehavior:function(e,t){var n=this;e.on(t,function(e){n.Map.getZoom()===n.ZoomEnum.Max?n.Map.setZoom(n.ZoomEnum.Sky):n.Map.setView(e.latlng,n.ZoomEnum.Max)})},bindMarkerCoordBehavior:function(e,t){var n=this;e.on(t,function(){var e=n.convertLCtoGC(this.getLatLng());$("#"+n.MapEnum+"CoordinatesCopy").val(n.formatCoord(e)).select()})},bindZoneList:function(){$("#mapZoneList li").each(function(){var e=$(this).attr("data-zone");$(this).text(M.getZoneName(e)),$(this).attr("data-coord",M.getZoneCenter(e).toString()),M.bindMapLinkBehavior($(this),M.ZoomEnum.Same)}),$("#mapZoneList h2").each(function(){var e=$(this).attr("data-region");$(this).text(D.getObjectName(M.Regions[e]))})},updateCharacter:function(e){if(void 0!==GPSPositionArray&&null!==GPSPositionArray&&3===GPSPositionArray.length&&!this.isUserDragging&&void 0!==GPSIdentityJSON&&null!==GPSIdentityJSON){if(this.isZoneValid(GPSIdentityJSON.map_id)===!1)return this.movePin(this.Pin.Character),void this.movePin(this.Pin.Camera);var t=this.convertGPSCoord(GPSPositionArray,GPSIdentityJSON.map_id);if(!(t[0]>this.cMAP_BOUND||t[0]<=0||t[1]>this.cMAP_BOUND||t[1]<=0)&&((O.Options.bol_followCharacter&&this.GPSPreviousCoord[0]!==t[0]&&this.GPSPreviousCoord[1]!==t[1]||e>=0)&&(this.Map.setView(this.convertGCtoLC(t),this.Map.getZoom()),this.showCurrentZone(t),this.GPSPreviousCoord=t,e=-1),O.Options.bol_displayCharacter)){var n=-this.convertGPSAngle(GPSDirectionArray),i=-this.convertGPSAngle(GPSCameraArray);if(this.GPSPreviousAngleCharacter!==n||this.GPSPreviousAngleCamera!==i||0>=e){this.movePin(this.Pin.Character,t),this.movePin(this.Pin.Camera,t),this.Pin.Camera._icon.style.zIndex=this.cZIndexBury;var a=this.Pin.Character._icon.style.transform.toString(),r=this.Pin.Camera._icon.style.transform.toString();-1===a.indexOf("rotate")&&(this.Pin.Character._icon.style.transform=a+" rotate("+n+"deg)"),-1===r.indexOf("rotate")&&(this.Pin.Camera._icon.style.transform=r+" rotate("+i+"deg)"),this.GPSPreviousAngleCharacter=n,this.GPSPreviousAngleCamera=i}}}},tickGPS:function(){(O.Options.bol_followCharacter||O.Options.bol_displayCharacter)&&(M.updateCharacter(),window.clearTimeout(M.GPSTimeout),M.GPSTimeout=setTimeout(M.tickGPS,O.Options.int_msecGPSRefresh))}},P={Layer:{DryTopNicks:new L.layerGroup,Chest:new L.layerGroup},LayerArray:{ChainPath:new Array,Resource:new Array,JP:new Array,Guild_Bounty:new Array,Guild_Trek:new Array,Guild_Challenge:new Array,Guild_Rush:new Array,Guild_Puzzle:new Array,DryTopIcons:new Array,DryTopRings:new Array,DryTopActive:new Array},Events:{},DryTopTimer:{},Resources:{},JPs:{},Chests:{},Collectibles:{},Guild:{},initializeMap:function(){I.isMapEnabled&&M.initializeMap()},wantZoomToFirstEvent:function(){return I.isMapEnabled&&O.Options.bol_tourPrediction&&!O.Options.bol_followCharacter&&I.PageCurrent===I.PageEnum.Chains&&void 0===U.Args[U.KeyEnum.Go]?!0:!1},drawDirectedPath:function(e,t,n){void 0===t&&(t=!0);var i=M.convertGCtoLCMulti(e),a=new L.layerGroup,r=8,o=t?0:r-1;n=n||"lime";for(var s=0;s<i.length-1;s++)a.addLayer(L.polyline([i[s],i[s+1]],{color:n,weight:2*(o+2)})),o=t?o+1:o-1,t&&o>=r?o=0:!t&&0>o&&(o=r-1);return a},drawSpots:function(e,t){var n=M.convertGCtoLCMulti(e),i=new L.layerGroup,a={radius:10,color:"lime",weight:4};if(void 0!==t)for(var r in t)a[r]=t[r];for(var r in n)i.addLayer(L.circleMarker(n[r],a));return i},populateEvents:function(){var e=function(e){return-1!==e.indexOf("guild")||-1!==e.indexOf("subdue")||-1!==e.indexOf("challenge")||-1!==e.indexOf("offshoot")||-1!==e.indexOf("vigil en")||-1!==e.indexOf("haunted")?!0:!1},t=function(e){return-1!==e.indexOf("free")?"img/event/release.png":-1!==e.indexOf("rescue")?"img/event/release.png":-1!==e.indexOf("capture")?"img/event/flag.png":-1!==e.indexOf("retake")?"img/event/flag.png":-1!==e.indexOf("reclaim")?"img/event/flag.png":-1!==e.indexOf("liberate")?"img/event/flag.png":-1!==e.indexOf("protect")?"img/event/shield.png":-1!==e.indexOf("defend")?"img/event/shield.png":-1!==e.indexOf("escort")?"img/event/shield.png":-1!==e.indexOf("kill")?"img/event/boss.png":-1!==e.indexOf("slay")?"img/event/boss.png":-1!==e.indexOf("defeat")?"img/event/boss.png":-1!==e.indexOf("collect")?"img/event/collect.png":-1!==e.indexOf("help")?"img/event/star.png":-1!==e.indexOf("destroy")?"img/event/cog.png":-1!==e.indexOf("gather")?"img/event/collect.png":-1!==e.indexOf("bring")?"img/event/collect.png":-1!==e.indexOf("recover")?"img/event/collect.png":-1!==e.indexOf("return")?"img/event/collect.png":-1!==e.indexOf("retrieve")?"img/event/collect.png":-1!==e.indexOf("burglar")?"img/event/fist.png":"img/event/swords.png"},n=function(e){var t=e.location.radius;switch(e.location.type){case"sphere":return 2e3>t?"img/ring/c_s.png":"img/ring/c_m.png";case"cylinder":return"img/ring/e_m_h.png";case"poly":return"img/ring/e_l_h.png"}return"img/ring/c_m.png"};$.getJSON(U.URL_API.EventNames,function(e){var t;for(t in e)P.Events[e[t].id]={},P.Events[e[t].id].name=e[t].name}).done(function(){$.getJSON(U.URL_API.EventDetails,function(i){var a,r,o,s,c,l,u;for(a in i.events)r=i.events[a],o=r.name.toLowerCase(),s=void 0!==P.Events[a]?P.Events[a].name:r.name,u=M.getZoneFromID(r.map_id),void 0===P.Events[a]||void 0===u||e(o)||988===r.map_id||50===r.map_id||(l=M.convertGCtoLC(M.getEventCenter(r)),c=L.marker(l,{clickable:!1,mappingtype:M.MappingEnum.EventRing,icon:L.icon({iconUrl:n(r),iconSize:[256,256],iconAnchor:[128,128]})}),u.Layers.EventRing.addLayer(c),c=L.marker(l,{title:"<span class='mapPoi'>"+s+" ("+r.level+")</span>",mappingtype:M.MappingEnum.EventIcon,icon:L.icon({iconUrl:t(o),iconSize:[48,48],iconAnchor:[24,24]})}),M.bindMappingZoomBehavior(c,"click"),u.Layers.EventIcon.addLayer(c));M.isEventIconsGenerated=!0}).done(function(){P.donePopulation()}).fail(function(){}).always(function(){P.finishPopulation()})}).fail(function(){P.finishPopulation()}).always(function(){})},donePopulation:function(){M.toggleLayer(M.Layer.ZoneRectangle,O.Options.bol_showZoneRectangles),P.wantZoomToFirstEvent()&&(M.showCurrentZone(M.getZoneCenter(M.cInitialZone)),$("#chnEvent_"+C.CurrentChainSD.nexus+"_"+C.CurrentChainSD.CurrentPrimaryEvent.num).trigger("click"))},finishPopulation:function(){M.isMapAJAXDone=!0,M.bindMapVisualChanges(I.MapEnum.Tyria),M.adjustZoomMapping(),P.adjustZoomDryTop(),M.goToArguments(U.Args[U.KeyEnum.Go],M.Pin.Program),M.tickGPS()},drawChainPaths:function(e){if(I.isMapEnabled!==!1){var t,n,i,a,r,o;if(C.isChainWorldBoss(e))for(t=0;t<e.primaryEvents.length;t++){switch(i=e.primaryEvents[t],t){case 0:a="red";break;case 1:a="orange";break;case 2:a="yellow";break;case 3:a="lime";break;case 4:a="cyan";break;case 5:a="blue";break;case 6:a="violet";break;case 7:a="purple";break;default:a="white"}r=M.convertGCtoLCMulti(i.path,1),o=L.polyline(r,{color:a}),M.Zones[e.extra[0]].Layers.Path.addLayer(o)}var s;for(t in e.events)n=e.events[t],s=n.num,-1!==s.indexOf(".")&&(s=s.replace(".","\\.")),$("#chnEvent_"+e.nexus+"_"+s).each(function(){var e=n.path[0];$(this).attr("data-coord",e[0]+","+e[1]),$(this).attr("data-eventindex",t),I.ModeCurrent!==I.ModeEnum.Mobile&&M.bindMapLinkBehavior($(this),M.ZoomEnum.Ground,M.Pin.Event)})}},generateDryTop:function(){$.getScript(U.URL_DATA.DryTop).done(function(){C.DryTop=GW2T_DRYTOP_DATA;var e,t,n,i,a;for(e in C.DryTop)i=C.DryTop[e],a=L.marker(M.convertGCtoLC(i.coord),{clickable:!1,icon:L.divIcon({className:"mapNick",html:"<span class='mapNickIn'>"+D.getObjectName(i)+"<br /><ins style='color:"+i.color+"'>"+i.time+"</ins></span>",iconSize:[512,64],iconAnchor:[256,32]})}),P.Layer.DryTopNicks.addLayer(a);M.toggleLayer(P.Layer.DryTopNicks,!0),P.DryTopTimer=L.marker(M.convertGCtoLC(M.getZoneCenter("dry")),{clickable:!1,icon:L.divIcon({className:"mapNick",html:"<div class='mapNickIn' id='mapDryTopInfo'><span id='mapDryTopTimer'></span><br /><input id='mapDryTopClip0' type='text' /> <input id='mapDryTopClip1' type='text' /></div>",iconSize:[512,64],iconAnchor:[256,32]})}),M.toggleLayer(P.DryTopTimer,!0),I.qTip.init($("#mapDryTopClip0, #mapDryTopClip1").click(function(){$(this).select()}).hover(function(){M.isMouseOnHUD=!0},function(){M.isMouseOnHUD=!1}));for(e in C.DryTopChains){n=C.DryTopChains[e];for(t in n.events)i=n.events[t],i.eventring=L.marker(M.convertGCtoLC(i.path[0]),{zIndexOffset:M.cZIndexBury,clickable:!1,image:"img/ring/"+i.ring+I.cPNG,icon:L.icon({iconUrl:"img/ring/"+i.ring+I.cPNG,iconSize:[32,32],iconAnchor:[16,16]})}),i.eventicon=L.marker(M.convertGCtoLC(i.path[0]),{title:"<span class='mapEvent'>"+D.getObjectName(i)+"</span>",image:"img/event/"+i.icon+I.cPNG,icon:L.icon({iconUrl:"img/event/"+i.icon+I.cPNG,iconSize:[16,16],iconAnchor:[8,8]})}),M.bindMappingZoomBehavior(i.eventicon,"click"),$("#chnEvent_"+n.nexus+"_"+i.num).hasClass("chnEventCurrent")&&(P.LayerArray.DryTopActive.push(i.eventicon),P.LayerArray.DryTopActive.push(i.eventring),M.toggleLayer(i.eventring,!0),M.toggleLayer(i.eventicon,!0)),P.LayerArray.DryTopRings.push(i.eventring),P.LayerArray.DryTopIcons.push(i.eventicon)}I.qTip.init(".leaflet-marker-icon"),C.isDryTopGenerated=!0,T.initializeDryTopStrings(),P.adjustZoomDryTop()})},toggleDryTopIcons:function(e){C.isDryTopGenerated&&(C.isDryTopIconsShown=e,M.toggleLayer(P.Layer.DryTopNicks,e),M.toggleLayer(P.DryTopTimer,e),e?(M.toggleLayerArray(P.LayerArray.DryTopActive,e),P.adjustZoomDryTop(),K.updateDryTopClipboard()):(M.toggleLayerArray(P.LayerArray.DryTopIcons,e),M.toggleLayerArray(P.LayerArray.DryTopRings,e)))},adjustZoomDryTop:function(){if(C.isDryTopIconsShown){var e,t,n,i,a,r,o=M.Map.getZoom();switch(o){case 7:n=32,a=20,r=.9;break;case 6:n=28,a=16,r=.8;break;case 5:n=24,a=12,r=.6;break;case 4:n=20,a=0,r=0;break;case 3:n=16,a=0,r=0;break;default:n=0,a=0,r=0}i=M.scaleDimension(M.cRING_SIZE_MAX);for(e in P.LayerArray.DryTopIcons)t=P.LayerArray.DryTopIcons[e],M.changeMarkerIcon(t,t.options.image,n),t=P.LayerArray.DryTopRings[e],M.changeMarkerIcon(t,t.options.image,i);P.Layer.DryTopNicks.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=a+"px",e._icon.style.opacity=r,e._icon.style.zIndex=M.cZIndexBury+1,e._icon.style.display="table")}),P.DryTopTimer._icon.style.fontSize=2*a+"px",P.DryTopTimer._icon.style.opacity=r,P.DryTopTimer._icon.style.zIndex=M.cZIndexRaise+1,P.DryTopTimer._icon.style.display="table"}}},G={generateAndInitializeDailies:function(){G.shiftLoginTrack(),$("#lgnTrack ins").each(function(){$(this).click(function(){G.shiftLoginValue(parseInt($(this).data("i")))}).mouseenter(function(){$("#lgnRecordHover").text("("+(parseInt($(this).data("i"))+1)+")")})}),$("#lgnTrack").mouseleave(function(){$("#lgnRecordHover").text("")}),I.qTip.init("#lgnTrack ins"),G.regenerateDailiesCalendar()},shiftLoginTrack:function(){var e=28,t=T.DAILY_START_UNIX;T.DAYS_SINCE_DAILY_START=~~((T.getUNIXSeconds()-t)/T.cSECONDS_IN_DAY);var n=T.wrapInteger(T.DAYS_SINCE_DAILY_START-O.Options.int_shiftLogin,e),i=T.wrapInteger(T.DAYS_SINCE_DAILY_START,e),a=0,r=0;$("#lgnTrack ins").each(function(){$(this).css({"border-radius":"auto",opacity:.3}).removeClass("lgnCurrent lgnOfficial").data("i",r),r===i&&($(this).addClass("lgnOfficial"),T.loginTrackOfficial=r),r++}),$("#lgnTrack ins").each(function(){return a===n+1?!1:(a===n&&$(this).addClass("lgnCurrent"),$(this).css({opacity:1}),void a++)}),$("#lgnRecordCurrent").text(n+1+" / "+e)},shiftLoginValue:function(e){var t=28,n=T.wrapInteger(T.loginTrackOfficial-e,t);$("#opt_int_shiftLogin").val(n).trigger("change"),G.shiftLoginTrack()},regenerateDailiesCalendar:function(){$("#dlyCalendar").empty();var e,t,n=0,i=32;for(e=0;i>e;e++)t=T.addDaysToDate(new Date,e),n=t.getUTCDate(),G.insertDailyDay(T.DailyCalendar[n],t);$("#dlyCalendar div:first").addClass("dlyCurrent").next().addClass("dlyNext"),$("#dlyCalendar .dlyEvent").each(function(){M.bindMapLinkBehavior($(this),M.ZoomEnum.Sky)}),I.qTip.init("#dlyCalendar ins")},insertDailyDay:function(e,t){var n,i,a,r,o,s,c,l,u="",d="",h="",p="",m="",g="",f="",T="</ins>",y="",E="</ins>",S="";switch(n=e.pve,i=e.pvp,a=e.wvw,r=n[0].split(" "),o=n[1].split(" "),s=n[3].split(" "),p="<ins class='dlyRegion dly_region_"+r[1].toLowerCase()+"'>","Vista"===o[0]&&(m="<ins class='dlyRegion dly_region_"+o[1].toLowerCase()+"'>",y="</ins>"),g="<ins class='dlyRegion dly_region_"+M.getZoneRegion(n[2])+"'>","Fractal"===s[0]?d="dly_pve_"+s[0].toLowerCase()+"_"+s[1]:(d="dly_pve_boss",f="<ins class='dlyRegion dly_region_"+C.getChainRegion(C.getChainByAlias(s[0]))+"'>",S="</ins>",h="<em><img src='img/chain/"+s[0].toLowerCase()+I.cPNG+"' /></em>"),c=i[2].split(" "),l=i[3].split(" "),t.getUTCDay()){case 0:u="dlySunday";break;case 6:u="dlySaturday"}$("#dlyCalendar").append("<div><aside></aside>"+h+"<var class='"+u+"'>"+t.getUTCDate()+"</var><span><ins class='dly_daily_pve'></ins>"+p+"<ins class='dly_pve_"+r[0].toLowerCase()+"' title='"+n[0]+"'></ins>"+T+m+"<ins class='dly_pve_"+o[0].toLowerCase()+"' title='"+n[1]+"'></ins>"+y+g+"<ins class='dly_pve_event dlyEvent curZoom' title='"+n[2]+" Events'data-coord='"+n[2].toLowerCase()+"'></ins>"+E+f+"<ins class='"+d+"' title='"+n[3]+"'></ins>"+S+"</span><span><ins class='dly_daily_pvp'></ins><ins class='dly_pvp_"+i[0].toLowerCase()+"' title='"+i[0]+"'></ins><ins class='dly_pvp_"+i[1].toLowerCase()+"' title='"+i[1]+"'></ins><ins class='dly_pvp_profession_"+c[0].toLowerCase()+"_0' title='"+i[2]+"'><ins class='dly_pvp_profession_"+c[1].toLowerCase()+"_1'></ins></ins><ins class='dly_pvp_profession_"+l[0].toLowerCase()+"_0' title='"+i[3]+"'><ins class='dly_pvp_profession_"+l[1].toLowerCase()+"_1'></ins></ins></span><span><ins class='dly_daily_wvw'></ins><ins class='dly_wvw_"+a[0].toLowerCase()+"' title='"+a[0]+"'></ins><ins class='dly_wvw_"+a[1].toLowerCase()+"' title='"+a[1]+"'></ins><ins class='dly_wvw_"+a[2].toLowerCase()+"' title='"+a[2]+"'></ins><ins class='dly_wvw_"+a[3].toLowerCase()+"' title='"+a[3]+"'></ins></span></div>")},generateAndInitializeResources:function(){var e=.3,t=function(e){return X.getChecklistItem(X.Checklists["Resource"+e.options.grade],e.options.index)},n=function(e,t){X.setChecklistItem(X.Checklists["Resource"+e.options.grade],e.options.index,t)},i=function(i){M.bindMarkerZoomBehavior(i,"dblclick"),M.bindMarkerCoordBehavior(i,"contextmenu"),i.on("click",function(){t(i)===X.ChecklistEnum.Checked?(n(i,X.ChecklistEnum.Unchecked),this.setOpacity(1)):(n(i,X.ChecklistEnum.Checked),this.setOpacity(e))})},a=function(){for(var e in P.Resources){var t=P.Resources[e].item;null!==t&&!function(e){$.getJSON(U.URL_API.ItemPrices+t,function(t){var n=E.deductTax(t.sells.unit_price);$("#nodPrice_"+e).html(E.createCoinString(n,!0))})}(e)}};$.getScript(U.URL_DATA.Resource).done(function(){P.Resources=GW2T_RESOURCE_DATA;var n,r,o,s,c,l,u=0,d=0,h=0;for(n in P.Resources){o=P.Resources[n];var p=n.toLowerCase();if(void 0!==o.riches&&o.riches.length>0){s=new L.layerGroup;for(r in o.riches)c=L.marker(M.convertGCtoLC(o.riches[r].c),{grade:"Rich",index:u,icon:L.divIcon({className:"mapNodeRich",html:"<img src='img/node/"+p+I.cPNG+"' />",iconSize:[32,32],iconAnchor:[16,16]})}),i(c),s.addLayer(c),void 0!==o.riches[r].p&&(l=L.polyline(M.convertGCtoLCMulti(o.riches[r].p),{color:"white",dashArray:"5,10",opacity:.3}),s.addLayer(l)),u++;M.toggleLayer(s),P.Layer["Resource_Rich_"+n]=s,P.LayerArray.Resource.push(s)}if(void 0!==o.regulars&&o.regulars.length>0){s=new L.layerGroup;for(r in o.regulars)c=L.marker(M.convertGCtoLC(o.regulars[r].c),{grade:"Regular",index:d,icon:L.divIcon({className:"mapNodeRegular",html:"<img src='img/node/"+p+I.cPNG+"' />",iconSize:[24,24],iconAnchor:[12,12]})}),i(c),s.addLayer(c),d++;M.toggleLayer(s),P.Layer["Resource_Regular_"+n]=s,P.LayerArray.Resource.push(s)}if(void 0!==o.zones){s=new L.layerGroup;for(r in o.zones){var C=o.zones[r],m=M.getZoneCenter(C);m[0]+=o.offset[0],m[1]+=o.offset[1],c=L.marker(M.convertGCtoLC(m),{grade:"Zone",index:h,icon:L.divIcon({className:"mapNodeZone",html:"<img src='img/node/"+p+I.cPNG+"' />",iconSize:[32,32],iconAnchor:[16,16]})}),i(c),s.addLayer(c),h++}M.toggleLayer(s),P.Layer["Resource_Zone_"+n]=s,P.LayerArray.Resource.push(s)}}X.initializeChecklist(X.Checklists.ResourceRich,u),X.initializeChecklist(X.Checklists.ResourceRegular,d),X.initializeChecklist(X.Checklists.ResourceZone,h);for(n in P.LayerArray.Resource)P.LayerArray.Resource[n].eachLayer(function(n){n instanceof L.Marker&&t(n)===X.ChecklistEnum.Checked&&n.setOpacity(e)});for(n in P.Resources)o=P.Resources[n],$("#mapResource_"+o.type).append("<label><input id='nod_"+n+"' type='checkbox' checked='checked' /> <img src='img/node/"+n.toLowerCase()+I.cPNG+"' /> <var>"+D.getObjectName(o)+"</var><samp id='nodPrice_"+n+"'></samp></label>");for(n in P.Resources)$("#nod_"+n).change(function(){var e=U.getSubstringFromHTMLID($(this)),t=$(this).prop("checked"),n=$("#mapResourceShowRegular").prop("checked");M.toggleLayer(P.Layer["Resource_Rich_"+e],t),M.toggleLayer(P.Layer["Resource_Regular_"+e],t&&n),M.toggleLayer(P.Layer["Resource_Zone_"+e],t&&n)});$("#mapToggle_Resource").data("checked",!0).click(function(){var e=I.toggleButtonState($(this));for(n in P.Resources)$("#nod_"+n).prop("checked",e).trigger("change")}),$("#mapToggle_ResourceMetal").click(function(){$("#mapResource_Metal input").trigger("click")}),$("#mapToggle_ResourcePlant").click(function(){$("#mapResource_Plant input").trigger("click")}),$("#mapToggle_ResourceWood").click(function(){$("#mapResource_Wood input").trigger("click")}),$("#mapResourceShowRegular").change(function(){var e=$(this).prop("checked");for(var t in P.Resources){var n=$("#nod_"+t).prop("checked");M.toggleLayer(P.Layer["Resource_Regular_"+t],n&&e),M.toggleLayer(P.Layer["Resource_Zone_"+t],n&&e)}}).trigger("change"),$("#mapResourceUncheck").click(function(){for(var e in P.LayerArray.Resource)P.LayerArray.Resource[e].eachLayer(function(e){e instanceof L.Marker&&e.setOpacity(1)
});X.clearChecklist(X.Checklists.ResourceRich),X.clearChecklist(X.Checklists.ResourceRegular),X.clearChecklist(X.Checklists.ResourceZone)}),$("#mapResourceRefresh").click(function(){a(),I.write("Prices refreshed.")}),a()})},generateAndInitializeJPs:function(){var e=function(e,t){e.setIcon(new L.icon({className:"mapJPDifficulty"+t,iconUrl:"img/map/jp.png",iconSize:[32,32],iconAnchor:[16,16]}))};$.getScript(U.URL_DATA.JP).done(function(){P.JPs=GW2T_JP_DATA,P.Chests=GW2T_CHEST_DATA,X.Checklists.JP.length=O.getObjectLength(P.JPs),P.LayerArray.JP=new Array(X.Checklists.JP.length);var t,n;for(var t in P.JPs){var i=P.JPs[t],a=M.parseCoordinates(i.coord),r=4===i.difficulty?"Explorer":"JP",o=L.marker(M.convertGCtoLC(a),{id:i.id,difficulty:i.difficulty,title:"<div class='mapLoc'><dfn>"+r+":</dfn> "+D.getObjectName(i)+"<img src='"+U.getImageHosted(i.img)+"' /></div>"});e(o,i.difficulty),P.LayerArray.JP[i.id]=o,M.toggleLayerArray(P.LayerArray.JP,!0);var s=D.getObjectName(i);$("#mapJPList_"+i.difficulty).append("<dt id='mapJP_"+i.id+"' data-coord='"+i.coord+"'>"+s+"</dt><label><input type='checkbox' id='mapJPCheck_"+i.id+"' /></label>&nbsp;<cite><a href='"+U.getYouTubeLink(s+" "+I.cGameNick)+"' target='_blank'>[Y]</a> <a href='"+U.getWikiLanguageLink(s)+"' target='_blank'>[W]</a></cite><dd>"+i.description+"</dd>");var c=$("#mapJP_"+i.id);c.attr("title","<div class='mapLoc'><img src='"+U.getImageHosted(i.img)+"' /></div>"),M.bindMapLinkBehavior(c,M.ZoomEnum.Same)}M.bindMapLinks(".mapJPList"),U.convertExternalLink(".mapJPList a"),I.qTip.init(".mapJPList dt");var l=function(e,t){var n=e.c,i=null;e.t&&(i=e.t);var a=L.marker(M.convertGCtoLC(n),{icon:L.divIcon({className:"mapChest"+t,html:"<img src='img/map/chest.png' />",iconSize:[32,32],iconAnchor:[16,16]}),title:i});M.bindMappingZoomBehavior(a,"click"),P.Layer.Chest.addLayer(a)};for(t in P.Chests)for(n in P.Chests[t])l(P.Chests[t][n],t);$("#mapJPToggleJP").change(function(){var t=$(this).prop("checked");if(M.toggleLayerArray(P.LayerArray.JP,t),t)for(var n in P.LayerArray.JP){var i=P.LayerArray.JP[n],t=X.getChecklistItem(X.Checklists.JP,i.options.id);t===X.ChecklistEnum.Unchecked?e(i,i.options.difficulty):e(i,0)}}),$("#mapJPToggleChest").change(function(){M.toggleLayer(P.Layer.Chest,$(this).prop("checked"))}),$("#mapToggle_JP").data("checked",!0).click(function(){var e=I.toggleButtonState($(this));$("#mapJPToggleJP").prop("checked",e).trigger("change"),$("#mapJPToggleChest").prop("checked")&&$("#mapJPToggleChest").prop("checked",e).trigger("change")}),I.qTip.init(".leaflet-marker-icon"),X.initializeChecklist(X.Checklists.JP,X.Checklists.JP.length);var t,u=function(){var e=X.countChecklist(X.Checklists.JP,X.ChecklistEnum.Checked),t=X.Checklists.JP.length;$("#mapJPCounter").text(e+"/"+t)};for(t=0;t<X.Checklists.JP.length;t++)$("#mapJPCheck_"+t).each(function(){var n=X.getChecklistItem(X.Checklists.JP,t,O.TypeEnum.isBoolean);$(this).prop("checked",n),n===!1?$(this).parent().prev().removeClass("mapJPListNameChecked"):($(this).parent().prev().addClass("mapJPListNameChecked"),e(P.LayerArray.JP[t],0))}).change(function(){var t=X.getCheckboxEnumState($(this)),n=U.getSubintegerFromHTMLID($(this));t===X.ChecklistEnum.Unchecked?($(this).parent().prev().removeClass("mapJPListNameChecked"),e(P.LayerArray.JP[n],P.LayerArray.JP[n].options.difficulty)):($(this).parent().prev().addClass("mapJPListNameChecked"),e(P.LayerArray.JP[n],0)),X.setChecklistItem(X.Checklists.JP,n,t),u()}).parent().hover(function(){$(this).prev().css({"text-decoration":"underline"}).trigger("mouseenter")},function(){$(this).prev().css({"text-decoration":"none"}).trigger("mouseleave")}),function(e){P.LayerArray.JP[e].on("click",function(){$("#mapJPCheck_"+e).trigger("click"),I.scrollToElement($("#mapJP_"+this.options.id),$("#plateMap"))}),P.LayerArray.JP[e].on("dblclick",function(){M.Map.getZoom()===M.ZoomEnum.Max?M.Map.setZoom(M.ZoomEnum.Default):M.goToLatLng(this.getLatLng())})}(t);$("#mapJPUncheck").click(function(){var n="";for(t=0;t<X.Checklists.JP.length;t++)$("#mapJPCheck_"+t).prop("checked",!1).parent().prev().removeClass("mapJPListNameChecked"),e(P.LayerArray.JP[t],P.LayerArray.JP[t].options.difficulty),n+="0";X.Checklists.JP.value=n,localStorage[X.Checklists.JP.key]=X.Checklists.JP.value,u()}),u()})},generateCollectiblesUI:function(){$.getScript(U.URL_DATA.Collectible).done(function(){P.Collectibles=GW2T_COLLECTIBLE_DATA;var e,t,n;for(e in P.Collectibles)t=P.Collectibles[e],n=D.getObjectName(t),$("#mapCollectibleList").append("<div><label style='color:"+t.color+"'><ins class='col_"+e.toLowerCase()+"'></ins><input id='ned_"+e+"' type='checkbox' /> "+n+"</label><span><cite><a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"'>[Y]</a>&nbsp;<a href='"+t.wiki+"'>[W]</a>&nbsp;<a href='"+t.credit+"'>[C]</a>&nbsp;&nbsp;-&nbsp;&nbsp;</cite><a id='nedUncheck_"+e+"'>Reset</a></span></div>"),$("#ned_"+e).one("click",function(){var e=U.getSubstringFromHTMLID($(this));G.generateCollectibles(e),M.goToArguments(P.Collectibles[e].view)}),I.ArticleCurrent&&I.ArticleCurrent.toLowerCase()===X.Collectibles[e].urlkey&&($("#ned_"+e).trigger("click"),I.ArticleCurrent=null);U.convertExternalLink("#mapCollectibleList cite a"),$("#mapToggle_Collectible").data("checked",!1).data("hideonly",!0).click(function(){for(e in P.Collectibles)$("#ned_"+e).prop("checked")&&$("#ned_"+e).trigger("click")})})},generateCollectibles:function(e){var t,n,i,a,r,o,s=U.Args[X.Collectibles[e].urlkey],c=P.Collectibles[e],l=D.getObjectName(c),u=new Array,d=function(e,t){e.setIcon(new L.divIcon({className:"mapNeedle"+t,html:"<span style='color:"+e.options.needleColor+"'>"+e.options.needleLabel+"</span>",iconSize:[16,16],iconAnchor:[8,8]}))};X.Collectibles[e].length=P.Collectibles[e].needles.length,X.initializeChecklist(X.Collectibles[e],X.Collectibles[e].length,s),P.LayerArray[e]=new Array,P.Layer[e]=new L.layerGroup;for(t in c.needles)n=parseInt(t)+1,i=c.needles[t],a=X.getChecklistItem(X.Collectibles[e],t),o="<div class='mapLoc'><dfn>"+l+":</dfn> #"+n,i.i?o+="<img src='"+i.i+"' />":i.t&&(o+="<br /><span class='mapTip'>"+i.t+"</span>"),o+="</div>",r=L.marker(M.convertGCtoLC(i.c),{needleIndex:t,needleType:e,needleKey:X.Collectibles[e].urlkey,needleColor:c.color,needleLabel:void 0===i.l?n:i.l,title:o}),d(r,a),r.on("click",function(){var e=X.trackChecklistItem(X.Collectibles[this.options.needleType],this.options.needleIndex);d(this,e);var t=X.getCheckedIndexes(X.Collectibles[this.options.needleType]);0===t.length?U.updateQueryString():U.updateAddressBar("?"+this.options.needleKey+"="+t)}),P.LayerArray[e].push(r),u.push(i.c);var h=L.polyline(M.convertGCtoLCMulti(u),{color:"white",opacity:.2});P.Layer[e].addLayer(h),M.toggleLayerArray(P.LayerArray[e],!0),M.toggleLayer(P.Layer[e],!0),I.qTip.init(".leaflet-marker-icon"),$("#ned_"+e).change(function(){var e=$(this).prop("checked"),t=U.getSubstringFromHTMLID($(this));M.toggleLayerArray(P.LayerArray[t],e),M.toggleLayer(P.Layer[t],e),e&&M.goToArguments(P.Collectibles[t].view)}),$("#nedUncheck_"+e).click(function(){var e=U.getSubstringFromHTMLID($(this)),t=P.LayerArray[e];for(var n in t)d(t[n],X.ChecklistEnum.Unfound);X.clearChecklist(X.Collectibles[e]),U.updateQueryString()})},generateGuildUI:function(){T.isGuildTimerStarted=!0,hideGuildMapDrawings=function(e){M.toggleLayerArray(P.LayerArray["Guild_"+e],!1),$("#gldBook_"+e+" dfn").each(function(){I.toggleHighlight($(this),!1)}),void 0!==P.Guild[e].usedSubmaps&&M.toggleSubmapArray(P.Guild[e].usedSubmaps,!1)},finalizeGuildBook=function(e){U.convertExternalLink("#gldBook_"+e+" a"),I.qTip.init("#gldBook_"+e+" dfn"),$("#gldBook_"+e+" .cssWaypoint").each(function(){new ZeroClipboard($(this)[0]).on("aftercopy",function(e){I.write(K.cZeroClipboardSuccessText+e.data["text/plain"],5)})})},$.getScript(U.URL_DATA.Guild).done(function(){P.Guild=GW2T_GUILD_DATA;var e;for(e in P.Guild){var t=P.Guild[e],n=D.getObjectName(t);$("#mapGuildButtons").append("<div><button class='gldButton curToggle' id='gldButton_"+e+"' title='<dfn>"+n+"</dfn><br />gw2timer.com/guild/"+e.toLowerCase()+"'><img src='img/guild/"+e.toLowerCase()+I.cPNG+"' /></button><a class='cssButton' href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"' target='_blank'>Y</a>&nbsp;<a class='cssButton' href='"+D.getObjectURL(t)+"' target='_blank'>W</a></div>"),$("#mapGuildBooks").append("<div class='gldBook' id='gldBook_"+e+"'></div>")}if($(".gldBook").hide(),I.qTip.init("#mapGuildButtons button"),U.convertExternalLink("#mapGuildButtons a"),$(".gldButton").click(function(){var e=U.getSubstringFromHTMLID($(this)),t=!0;$("#gldBook_"+e).is(":visible")&&(hideGuildMapDrawings(e),t=!1),$(".gldBook").hide(),t&&$("#gldBook_"+e).show(),I.updateScrollbar()}),$("#mapToggle_Guild").data("hideonly",!0).click(function(){$(".gldButton").each(function(){hideGuildMapDrawings(U.getSubstringFromHTMLID($(this))),$(".gldBook").hide(),I.updateScrollbar()}),M.movePin(M.Pin.Program)}),$("#gldButton_Bounty").one("click",function(){D.sortObjects(P.Guild.Bounty.data);for(var e in P.Guild.Bounty.data){var t=P.Guild.Bounty.data[e],n=D.getDefaultObjectName(t),i=D.getObjectName(t);$("#gldBook_Bounty").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Bounty)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldBounty_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"' target='_blank'>[Y]</a> <a href='"+U.getWikiLink(n)+"' target='_blank'>[W]</a></div>");var a=new L.layerGroup;if(void 0!==t.paths)for(var r in t.paths)a.addLayer(P.drawDirectedPath(t.paths[r]));void 0!==t.spawn&&a.addLayer(P.drawSpots(t.spawn)),P.LayerArray.Guild_Bounty.push(a);var o=$("#gldBounty_"+e);o.attr("title","<div class='mapLoc'><img src='"+t.img+"' /></div>").click(function(){I.toggleHighlight($(this)),M.toggleLayer(P.LayerArray.Guild_Bounty[U.getSubintegerFromHTMLID($(this))])}),M.bindMapLinkBehavior(o,M.invertZoomLevel(t.coord[2]))}finalizeGuildBook("Bounty")}),$("#gldButton_Trek").one("click",function(){D.sortObjects(P.Guild.Trek.data);for(var e in P.Guild.Trek.data){var t=P.Guild.Trek.data[e],n=D.getObjectName(t);$("#gldBook_Trek").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Trek)+": "+n+"' src='img/ui/placeholder.png' /> <dfn id='gldTrek_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+n+"</dfn></div>");var i=new L.layerGroup;i.addLayer(L.polyline(M.convertGCtoLCMulti(t.path),{color:"gold"})),P.LayerArray.Guild_Trek.push(i);var a=$("#gldTrek_"+e);a.attr("title","<div class='mapLoc'><img src='"+t.img+"' /></div>").click(function(){I.toggleHighlight($(this)),M.toggleLayer(P.LayerArray.Guild_Trek[U.getSubintegerFromHTMLID($(this))])}),M.bindMapLinkBehavior(a,M.ZoomEnum.Same,M.Pin.Program)}finalizeGuildBook("Trek")}),$("#gldButton_Challenge").one("click",function(){P.Guild.Challenge.usedSubmaps=new Array,D.sortObjects(P.Guild.Challenge.data);for(var e in P.Guild.Challenge.data){var t=P.Guild.Challenge.data[e],n=D.getDefaultObjectName(t),i=D.getObjectName(t);$("#gldBook_Challenge").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Challenge)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldChallenge_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+" - "+t.limit+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"' target='_blank'>[Y]</a> <a href='"+U.getWikiLink(n)+"' target='_blank'>[W]</a></div>"),void 0!==t.submap&&(M.toggleSubmap(t.submap,!1),P.Guild.Challenge.usedSubmaps.push(t.submap));var a=new L.layerGroup;a.addLayer(L.polyline(M.convertGCtoLCMulti(t.path),{color:"gold"})),a.addLayer(P.drawSpots(t.spawn,{color:"gold"})),P.LayerArray.Guild_Challenge.push(a);var r=$("#gldChallenge_"+e);r.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Challenge.data[e].submap,n=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,n),M.toggleLayer(P.LayerArray.Guild_Challenge[e])}),M.bindMapLinkBehavior(r,M.ZoomEnum.Ground,M.Pin.Program)}finalizeGuildBook("Challenge")}),$("#gldButton_Rush").one("click",function(){P.Guild.Rush.usedSubmaps=new Array,D.sortObjects(P.Guild.Rush.data);for(var e in P.Guild.Rush.data){var t=P.Guild.Rush.data[e],n=D.getDefaultObjectName(t),i=D.getObjectName(t);$("#gldBook_Rush").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Rush)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldRush_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"' target='_blank'>[Y]</a> <a href='"+U.getWikiLink(n)+"' target='_blank'>[W]</a></div>"),void 0!==t.submap&&(M.toggleSubmap(t.submap,!1),P.Guild.Rush.usedSubmaps.push(t.submap));var a=new L.layerGroup;a.addLayer(L.polyline(M.convertGCtoLCMulti(t.path),{color:"gold"})),a.addLayer(L.polyline(M.convertGCtoLCMulti(t.track),{color:"lime",dashArray:"5,10"})),a.addLayer(L.marker(M.convertGCtoLC(t.finish),{icon:M.createStandardIcon("img/map/chest.png")})),void 0!==t.traps0&&a.addLayer(P.drawSpots(t.traps0,{radius:5,color:"red",weight:1,opacity:1})),void 0!==t.traps1&&a.addLayer(P.drawSpots(t.traps1,{radius:10,color:"red",weight:1,opacity:1})),a.addLayer(P.drawSpots(t.flags,{radius:2,color:"gold",weight:2,opacity:1})),P.LayerArray.Guild_Rush.push(a);var r=$("#gldRush_"+e);r.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Rush.data[e].submap,n=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,n),M.toggleLayer(P.LayerArray.Guild_Rush[e])}),M.bindMapLinkBehavior(r,M.ZoomEnum.Ground,M.Pin.Program)}finalizeGuildBook("Rush")}),$("#gldButton_Puzzle").one("click",function(){P.Guild.Puzzle.usedSubmaps=new Array,D.sortObjects(P.Guild.Puzzle.data);for(var e in P.Guild.Puzzle.data){var t=P.Guild.Puzzle.data[e],n=D.getDefaultObjectName(t),i=D.getObjectName(t);$("#gldBook_Puzzle").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Puzzle)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldPuzzle_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+" - "+t.limit+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"' target='_blank'>[Y]</a> <a href='"+U.getWikiLink(n)+"' target='_blank'>[W]</a></div>"),void 0!==t.submap&&(M.toggleSubmap(t.submap,!1),P.Guild.Puzzle.usedSubmaps.push(t.submap));var a=new L.layerGroup;a.addLayer(P.drawSpots(t.interactions,{color:"gold"})),a.addLayer(L.marker(M.convertGCtoLC(t.finish),{icon:M.createStandardIcon("img/map/chest.png")})),P.LayerArray.Guild_Puzzle.push(a);var r=$("#gldPuzzle_"+e);r.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Puzzle.data[e].submap,n=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,n),M.toggleLayer(P.LayerArray.Guild_Puzzle[e])}),M.bindMapLinkBehavior(r,M.ZoomEnum.Ground,M.Pin.Program)}finalizeGuildBook("Puzzle")}),$("#mapGuildInfluence input").click(function(){$(this).select()}),$("#gldInfluenceToCoinInput").on("input",function(){$("#gldInfluenceToCoinOutput").val(E.createCoinString($(this).val()*E.Exchange.COPPER_PER_INFLUENCE))}),$("#gldCoinToInfluenceInput").on("input",function(){$("#gldCoinToInfluenceOutput").val(E.parseCoinString($(this).val())*E.Exchange.INFLUENCE_PER_COPPER)}),I.ArticleCurrent)for(e in P.Guild)if(I.ArticleCurrent.toLowerCase()===e.toLowerCase()){$("#gldButton_"+e).trigger("click"),I.ArticleCurrent=null;break}})}},W={MapEnum:"wvw",cInitialZone:"eternal",cMAP_BOUND:16384,cMAP_CENTER:[10400,12400],cMAP_CENTER_INITIAL:[-193.75,162.5],cMAP_CENTER_ACTUAL:[8192,8192],ZoomEnum:{Same:-1,Min:0,Default:3,Space:3,Sky:4,Bird:5,Ground:6,Max:6},ServerRegionThreshold:{Range:99,Americas:1e3,Europe:2e3,France:2100,Germany:2200,Spain:2300},Layer:{PersonalPin:new L.layerGroup,PersonalPath:new L.layerGroup,ZoneRectangle:new L.layerGroup,Pin:new L.layerGroup},LayerArray:{},Pin:{Program:{},Event:{},Over:{},Character:{},Camera:{}},initializeWvW:function(){$.extend(W,$.extend({},M,W)),W.Zones=GW2T_LAND_DATA,W.ZoneAssociation=GW2T_LAND_ASSOCIATION,W.Regions=GW2T_REALM_DATA,W.initializeMap()}},T={GenericCountdown:GW2T_COUNTDOWN_DATA.Countdowns,GenericCountdownHeader:GW2T_COUNTDOWN_DATA.Header,isGenericCountdownSystemEnabled:!0,isGenericCountdownTickEnabled:null,DailyCalendar:GW2T_DAILY_CALENDAR,DST_IN_EFFECT:0,SECONDS_TILL_RESET:0,TIMESTAMP_UNIX_SECONDS:0,cUTC_OFFSET_USER:0,cUTC_OFFSET_SERVER:-8,cUTC_OFFSET_HAWAII:-10,cUTC_OFFSET_EASTERN:-4,cMILLISECONDS_IN_SECOND:1e3,cMILLISECONDS_IN_MINUTE:6e4,cSECONDS_IN_MINUTE:60,cSECONDS_IN_HOUR:3600,cSECONDS_IN_DAY:86400,cSECONDS_IN_WEEK:604800,cMINUTES_IN_HOUR:60,cMINUTES_IN_DAY:1440,cHOURS_IN_MERIDIEM:12,cHOURS_IN_DAY:24,cDAYS_IN_WEEK:7,cSECONDS_IN_TIMEFRAME:900,cMINUTES_IN_TIMEFRAME:15,cMINUTES_IN_DRYTOPFRAME:5,cNUM_TIMEFRAMES_IN_HOUR:4,cSECS_MARK_0:0,cSECS_MARK_1:900,cSECS_MARK_2:1800,cSECS_MARK_3:2700,cSECS_MARK_4:3599,cBASE_10:10,cPERCENT_100:100,DAILY_START_UNIX:1418774400,DAYS_SINCE_DAILY_START:0,cDAYTIME_DAY_MINUTES:80,cDAYTIME_NIGHT_MINUTES:40,cDAYTIME_DAY_START:25,cDAYTIME_NIGHT_START:45,ReferenceEnum:{UTC:0,Local:1,Server:2},UnitEnum:{Milliseconds:0,Seconds:1,Minutes:2,Hours:3},DayEnum:{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},loginTrackOfficial:0,secondsTillGuildReset:-1,isGuildTimerStarted:!1,DryTopSets:{},DryTopCodes:{},Schedule:{},getCurrentDryTopEvents:function(e){return T.DryTopCodes[T.getDryTopMinute(e)].chat+I.siteTagCurrent},getCurrentDryTopColor:function(e){return T.DryTopCodes[T.getDryTopMinute(e)].color},getDryTopMinute:function(e){e=e||0;var t=new Date,n=t.getUTCMinutes(),i=~~(n/T.cMINUTES_IN_DRYTOPFRAME)*T.cMINUTES_IN_DRYTOPFRAME+e*T.cMINUTES_IN_DRYTOPFRAME;return i=T.wrapInteger(i,T.cMINUTES_IN_HOUR),i<T.cBASE_10&&(i="0"+i),i},initializeDryTopStrings:function(){getDryTopSet=function(e){var t=T.DryTopSets[e],n="";for(var i in t)n+=D.getObjectName(t[i])+"@"+t[i].wp+" ";return n.trim()},T.DryTopSets=[[C.DryTop.Victims,C.DryTop.Crystals,C.DryTop.Supplies,C.DryTop.Rustbucket,C.DryTop.Shaman,C.DryTop.TendrilW,C.DryTop.TendrilSE,C.DryTop.Tootsie],[C.DryTop.MineE,C.DryTop.Serene,C.DryTop.Insects,C.DryTop.Bridge,C.DryTop.Experiment,C.DryTop.Golem,C.DryTop.Nochtli,C.DryTop.Colocal],[C.DryTop.MineNE,C.DryTop.Basket,C.DryTop.Suit,C.DryTop.Leyline,C.DryTop.Town],[C.DryTop.Mites,C.DryTop.Haze,C.DryTop.Eway,C.DryTop.Skritts0,C.DryTop.Skritts1,C.DryTop.Skritts2,C.DryTop.Skritts3,C.DryTop.Explosives,C.DryTop.Giant],[C.DryTop.Devourer],[C.DryTop.Mites,C.DryTop.Haze,C.DryTop.Twister,C.DryTop.Chriikkt,C.DryTop.Eway,C.DryTop.Skritts0,C.DryTop.Skritts1,C.DryTop.Skritts2,C.DryTop.Skritts3,C.DryTop.Chickenado],[C.DryTop.Beetle,C.DryTop.Monster]],T.DryTopCodes={"00":{chat:":00 "+getDryTopSet(0),color:"red"},"05":{chat:":05 "+getDryTopSet(1),color:"orange"},10:{chat:":10 "+getDryTopSet(2),color:"yellow"},15:{chat:":15 "+getDryTopSet(0),color:"red"},20:{chat:":20 "+getDryTopSet(1),color:"orange"},25:{chat:":25 "+getDryTopSet(2),color:"yellow"},30:{chat:":30 "+getDryTopSet(0),color:"red"},35:{chat:":35 "+getDryTopSet(1),color:"orange"},40:{chat:":40 "+getDryTopSet(3),color:"lime"},45:{chat:":45 "+getDryTopSet(4),color:"limegreen"},50:{chat:":50 "+getDryTopSet(5),color:"dodgerblue"},55:{chat:":55 "+getDryTopSet(6),color:"orchid"}},K.updateDryTopClipboard(),$("#itemDryTopClip").show()},ChainAssociation:{fe:0,golem:1,jormag:2,maw:3,megades:4,sb:5,shatterer:6,taidha:7,ulgoth:8,wurm:9,queen:10,tequatl:11,triple:12},initializeSchedule:function(){C.FE=C.Chains[0],C.Golem=C.Chains[1],C.Jormag=C.Chains[2],C.Maw=C.Chains[3],C.Megades=C.Chains[4],C.SB=C.Chains[5],C.Shatterer=C.Chains[6],C.Taidha=C.Chains[7],C.Ulgoth=C.Chains[8],C.Wurm=C.Chains[9],C.Queen=C.Chains[10],C.Tequatl=C.Chains[11],C.Triple=C.Chains[12],C.DryTop0=C.Chains[13],C.DryTop1=C.Chains[14],C.DryTop2=C.Chains[15],C.DryTop3=C.Chains[16],T.Schedule={0:{t:"00:00",c:[C.Taidha,C.Tequatl]},15:{t:"00:15",c:[C.Maw]},30:{t:"00:30",c:[C.Megades]},45:{t:"00:45",c:[C.FE]},60:{t:"01:00",c:[C.Shatterer,C.Triple]},75:{t:"01:15",c:[C.Wurm]},90:{t:"01:30",c:[C.Ulgoth]},105:{t:"01:45",c:[C.SB]},120:{t:"02:00",c:[C.Golem,C.Queen]},135:{t:"02:15",c:[C.Maw]},150:{t:"02:30",c:[C.Jormag]},165:{t:"02:45",c:[C.FE]},180:{t:"03:00",c:[C.Taidha,C.Tequatl]},195:{t:"03:15",c:[C.Wurm]},210:{t:"03:30",c:[C.Megades]},225:{t:"03:45",c:[C.SB]},240:{t:"04:00",c:[C.Shatterer,C.Triple]},255:{t:"04:15",c:[C.Maw]},270:{t:"04:30",c:[C.Ulgoth]},285:{t:"04:45",c:[C.FE]},300:{t:"05:00",c:[C.Golem]},315:{t:"05:15",c:[C.Wurm]},330:{t:"05:30",c:[C.Jormag]},345:{t:"05:45",c:[C.SB]},360:{t:"06:00",c:[C.Taidha,C.Queen]},375:{t:"06:15",c:[C.Maw]},390:{t:"06:30",c:[C.Megades]},405:{t:"06:45",c:[C.FE]},420:{t:"07:00",c:[C.Shatterer,C.Tequatl]},435:{t:"07:15",c:[C.Wurm]},450:{t:"07:30",c:[C.Ulgoth]},465:{t:"07:45",c:[C.SB]},480:{t:"08:00",c:[C.Golem,C.Triple]},495:{t:"08:15",c:[C.Maw]},510:{t:"08:30",c:[C.Jormag]},525:{t:"08:45",c:[C.FE]},540:{t:"09:00",c:[C.Taidha]},555:{t:"09:15",c:[C.Wurm]},570:{t:"09:30",c:[C.Megades]},585:{t:"09:45",c:[C.SB]},600:{t:"10:00",c:[C.Shatterer]},615:{t:"10:15",c:[C.Maw]},630:{t:"10:30",c:[C.Ulgoth,C.Queen]},645:{t:"10:45",c:[C.FE]},660:{t:"11:00",c:[C.Golem]},675:{t:"11:15",c:[C.Wurm]},690:{t:"11:30",c:[C.Jormag,C.Tequatl]},705:{t:"11:45",c:[C.SB]},720:{t:"12:00",c:[C.Taidha]},735:{t:"12:15",c:[C.Maw]},750:{t:"12:30",c:[C.Megades,C.Triple]},765:{t:"12:45",c:[C.FE]},780:{t:"13:00",c:[C.Shatterer]},795:{t:"13:15",c:[C.Wurm]},810:{t:"13:30",c:[C.Ulgoth]},825:{t:"13:45",c:[C.SB]},840:{t:"14:00",c:[C.Golem]},855:{t:"14:15",c:[C.Maw]},870:{t:"14:30",c:[C.Jormag]},885:{t:"14:45",c:[C.FE]},900:{t:"15:00",c:[C.Taidha,C.Queen]},915:{t:"15:15",c:[C.Wurm]},930:{t:"15:30",c:[C.Megades]},945:{t:"15:45",c:[C.SB]},960:{t:"16:00",c:[C.Shatterer,C.Tequatl]},975:{t:"16:15",c:[C.Maw]},990:{t:"16:30",c:[C.Ulgoth]},1005:{t:"16:45",c:[C.FE]},1020:{t:"17:00",c:[C.Golem,C.Triple]},1035:{t:"17:15",c:[C.Wurm]},1050:{t:"17:30",c:[C.Jormag]},1065:{t:"17:45",c:[C.SB]},1080:{t:"18:00",c:[C.Taidha,C.Queen]},1095:{t:"18:15",c:[C.Maw]},1110:{t:"18:30",c:[C.Megades]},1125:{t:"18:45",c:[C.FE]},1140:{t:"19:00",c:[C.Shatterer,C.Tequatl]},1155:{t:"19:15",c:[C.Wurm]},1170:{t:"19:30",c:[C.Ulgoth]},1185:{t:"19:45",c:[C.SB]},1200:{t:"20:00",c:[C.Golem,C.Triple]},1215:{t:"20:15",c:[C.Maw]},1230:{t:"20:30",c:[C.Jormag]},1245:{t:"20:45",c:[C.FE]},1260:{t:"21:00",c:[C.Taidha]},1275:{t:"21:15",c:[C.Wurm]},1290:{t:"21:30",c:[C.Megades]},1305:{t:"21:45",c:[C.SB]},1320:{t:"22:00",c:[C.Shatterer]},1335:{t:"22:15",c:[C.Maw]},1350:{t:"22:30",c:[C.Ulgoth]},1365:{t:"22:45",c:[C.FE]},1380:{t:"23:00",c:[C.Golem,C.Queen]},1395:{t:"23:15",c:[C.Wurm]},1410:{t:"23:30",c:[C.Jormag]},1425:{t:"23:45",c:[C.SB]}};var e,t,n,i,a=0;for(e in T.Schedule)T.Schedule[e].c.push(C["DryTop"+a]),a++,a>T.cNUM_TIMEFRAMES_IN_HOUR-1&&(a=0);C.ScheduledChains=new Array,C.initializeAllChains();for(e in T.Schedule){T.Schedule[e].t=T.parseChainTime(T.Schedule[e].t),i=T.Schedule[e];for(t in C.ScheduledChains)for(n in i.c)if(C.ScheduledChains[t].nexus===i.c[n].nexus){C.ScheduledChains[t].scheduleKeys.push(e);break}}C.CurrentChainSD=T.getStandardChain()},getScheduleSlotTime:function(e){return T.Schedule[e].t},getScheduleSlotChainsByKey:function(e){return T.Schedule[e].c},getCurrentTimeframe:function(){var e=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Minutes);return e-e%T.cMINUTES_IN_TIMEFRAME},getTimeframe:function(e){e=e||0;var t=T.getCurrentTimeframe()+e*T.cMINUTES_IN_TIMEFRAME;return T.wrapInteger(t,T.cMINUTES_IN_DAY)},getTimeframeChains:function(e){return T.Schedule[T.getTimeframe(e)].c},getTimeframeChainBySeries:function(e,t){var n,i=T.getTimeframeChains(e);for(n in i)if(i[n].series===t)return i[n];return null},getStandardChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.Standard)},getHardcoreChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.Hardcore)},getTimeframeKey:function(e){return T.getTimeframe(e).toString()},convertScheduleKeyToLocalSeconds:function(e){var t=T.getScheduleSlotTime(e)*T.cSECONDS_IN_MINUTE-(new Date).getTimezoneOffset()*T.cSECONDS_IN_MINUTE;return t=T.wrapInteger(t,T.cSECONDS_IN_DAY)},convertScheduleKeyToUTCMinutes:function(e){return parseInt(e)},getCurrentTimeframeElapsedTime:function(e){var t=new Date,n=t.getUTCMinutes(),i=t.getUTCSeconds();return e===T.UnitEnum.Minutes?n%T.cMINUTES_IN_TIMEFRAME:n%T.cMINUTES_IN_TIMEFRAME*T.cSECONDS_IN_MINUTE+i},getSecondsUntilChainStarts:function(e){var t=T.convertScheduleKeyToLocalSeconds(e.scheduleKeys[0]),n=T.getTimeSinceMidnight(T.ReferenceEnum.Local,T.UnitEnum.Seconds),i=T.cSECONDS_IN_TIMEFRAME*T.cNUM_TIMEFRAMES_IN_HOUR;return t>=T.cSECONDS_IN_DAY-i&&i>=n?T.cSECONDS_IN_DAY-t+n:n>=T.cSECONDS_IN_DAY-i&&i>=t?T.cSECONDS_IN_DAY-n+t:t-n},getTimeTillChainFormatted:function(e,t){var n=T.getSecondsUntilChainStarts(e),i=~~(n/T.cSECONDS_IN_MINUTE)%T.cSECONDS_IN_MINUTE,a=~~(n/T.cSECONDS_IN_HOUR),r=D.getPhrase("m"),o=D.getPhrase("h");return"speech"===t&&(r=" "+D.getSpeech("minute"),o=" "+D.getSpeech("hour"),Math.abs(i)>1&&(r=" "+D.getSpeech("minutes")),Math.abs(a)>1&&(o=" "+D.getSpeech("hours")),0===a&&30===Math.abs(i)&&(i=D.getSpeech("half an hour"),r="",o="")),o+=" ",i+=r,Math.abs(n)>=T.cSECONDS_IN_HOUR?a+=o:a="",0>n?" "+a+i+" "+D.getPhrase("ago"):" "+D.getPhrase("in")+" "+a+i},randIntRange:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},wrapInteger:function(e,t){var n=e;return n%=t,0>n&&(n=t+n),n},stepFunction:function(e,t,n,i,a){var r=~~(e/i)*a+t;return r>n?n:r},parseEventTime:function(e){var t=new Array;return-1!==e.indexOf("~")?(t=e.split("~"),T.parseEventTime(t[0])+~~(T.parseEventTime(t[1])/2)):"*"===e?0:-1===e.indexOf(":")?parseInt(e,T.cBASE_10):(t=e.split(":"),2===t.length?parseInt(t[0],T.cBASE_10)*T.cSECONDS_IN_MINUTE+parseInt(t[1],T.cBASE_10):3===t.length?parseInt(t[0])*T.cSECONDS_IN_HOUR+parseInt(t[1],T.cBASE_10)*T.cSECONDS_IN_MINUTE+parseInt(t[2],T.cBASE_10):0/0)},parseChainTime:function(e){var t=e.split(":");return parseInt(t[0],T.cBASE_10)*T.cMINUTES_IN_HOUR+parseInt(t[1],T.cBASE_10)},checkDST:function(){Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var e=new Date;T.DST_IN_EFFECT=e.dst()&&O.Options.bol_detectDST?1:0},getTimeFormatted:function(e){e=e||{},void 0===e.reference&&(e.reference=T.ReferenceEnum.Local),void 0===e.want24&&(e.want24=O.Options.bol_use24Hour),void 0===e.wantSeconds&&(e.wantSeconds=!0),void 0===e.wantHours&&(e.wantHours=!0),void 0===e.wantLetters&&(e.wantLetters=!1);var t,n,i,a=new Date;if(void 0===e.customTimeInSeconds)switch(e.reference){case T.ReferenceEnum.Local:t=a.getSeconds(),n=a.getMinutes(),i=a.getHours();break;case T.ReferenceEnum.Server:t=a.getSeconds(),n=a.getMinutes(),i=a.getUTCHours()+T.cUTC_OFFSET_SERVER+T.DST_IN_EFFECT,i=T.wrapInteger(i,T.cHOURS_IN_DAY);break;case T.ReferenceEnum.UTC:t=a.getUTCSeconds(),n=a.getUTCMinutes(),i=a.getUTCHours()}else e.customTimeInSeconds=T.wrapInteger(e.customTimeInSeconds,T.cSECONDS_IN_DAY),t=e.customTimeInSeconds%T.cSECONDS_IN_MINUTE,n=~~(e.customTimeInSeconds/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,i=~~(e.customTimeInSeconds/T.cSECONDS_IN_HOUR);var r="";if(r=e.wantSeconds?e.wantLetters?0===i&&0===n?t+D.getWord("s"):n+D.getWord("m")+" "+t+D.getWord("s"):e.wantHours===!1?n+":"+(t<T.cBASE_10?"0"+t:t):(n<T.cBASE_10?"0"+n:n)+":"+(t<T.cBASE_10?"0"+t:t):e.wantLetters?n+D.getWord("m"):n<T.cBASE_10?"0"+n:n,e.wantLetters)return 0===i||e.wantHours===!1?r:i+D.getWord("h")+" "+r;if(e.want24)return e.wantHours===!1?r:(i<T.cBASE_10?"0"+i:i)+":"+r;var o=" AM";return i>=T.cHOURS_IN_MERIDIEM?(i>T.cHOURS_IN_MERIDIEM&&(i%=T.cHOURS_IN_MERIDIEM),o=" PM"):0===i&&(i=T.cHOURS_IN_MERIDIEM),i+":"+r+o},formatMilliseconds:function(e,t){var n,i,a,r,o=~~(e/T.cMILLISECONDS_IN_SECOND),s=~~(e%T.cMILLISECONDS_IN_SECOND/T.cBASE_10),c="",l="",u="",d="",h="",p="";return 0>o&&(o=-1*o,p="−"),o>=T.cSECONDS_IN_DAY&&(n=~~(o/T.cSECONDS_IN_DAY),c=n+"::"),o>=T.cSECONDS_IN_HOUR&&(i=~~(o/T.cSECONDS_IN_HOUR)%T.cHOURS_IN_DAY,l=i+":",""!==c&&i<T.cBASE_10&&(l="0"+l)),o>=T.cSECONDS_IN_MINUTE?(a=~~(o/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,u=a+":",""!==l&&a<T.cBASE_10&&(u="0"+u)):u="0:",r=o%T.cSECONDS_IN_MINUTE,d=r.toString(),r<T.cBASE_10&&(d="0"+d),t&&(h="."+s,s<T.cBASE_10&&(h=".0"+s)),p+c+l+u+d+h},formatSeconds:function(e,t){var n,i,a,r,o,s=e,c="",l="",u="",d="",h="",p="";return 0>s&&(s=-1*s,p="−"),s>=T.cSECONDS_IN_WEEK&&(n=~~(s/T.cSECONDS_IN_WEEK),c=n+D.getWord("w")+" "),s>=T.cSECONDS_IN_DAY&&(i=~~(s/T.cSECONDS_IN_DAY)%T.cDAYS_IN_WEEK,l=i+D.getWord("d")+" "),s>=T.cSECONDS_IN_HOUR&&(a=~~(s/T.cSECONDS_IN_HOUR)%T.cHOURS_IN_DAY,u=a+D.getWord("h")+" "),s>=T.cSECONDS_IN_MINUTE&&(r=~~(s/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,d=r+D.getWord("m")+" "),t&&(o=s%T.cSECONDS_IN_MINUTE,h=o.toString()+D.getWord("s")),p+c+l+u+d+h},isDaylight:function(){var e=new Date,t=e.getUTCHours(),n=e.getUTCMinutes();if(t%2===0){if(n>=T.cDAYTIME_DAY_START)return!0}else if(n<T.cDAYTIME_NIGHT_START)return!0;return!1},getDayPeriodRemaining:function(){var e=new Date,t=e.getUTCHours(),n=e.getUTCMinutes(),i="";return i=t%2===0?n>=T.cDAYTIME_DAY_START?T.cDAYTIME_DAY_START+T.cDAYTIME_DAY_MINUTES-n:T.cDAYTIME_DAY_START-n:n<T.cDAYTIME_NIGHT_START?T.cDAYTIME_NIGHT_START-n:T.cDAYTIME_NIGHT_START+T.cDAYTIME_NIGHT_MINUTES-n,i+D.getWord("m")},getTimeSinceMidnight:function(e,t){t=t||T.UnitEnum.Seconds,e=e||T.ReferenceEnum.UTC;var n=new Date,i=n.getUTCHours(),a=n.getUTCMinutes(),r=n.getUTCSeconds();switch(e){case T.ReferenceEnum.Server:i=i+T.cUTC_OFFSET_SERVER+T.DST_IN_EFFECT;break;case T.ReferenceEnum.UTC:break;case T.ReferenceEnum.Local:i=n.getHours(),a=n.getMinutes(),r=n.getSeconds()}return i=T.wrapInteger(i,T.cHOURS_IN_DAY),t===T.UnitEnum.Hours?i:t===T.UnitEnum.Minutes?i*T.cMINUTES_IN_HOUR+a:i*T.cSECONDS_IN_HOUR+a*T.cSECONDS_IN_MINUTE+r},getUNIXSeconds:function(){return~~((new Date).getTime()/T.cMILLISECONDS_IN_SECOND)},addDaysToDate:function(e,t){var n=new Date(e);return n.setDate(e.getDate()+t),n},getSecondsTillWeekday:function(e,t){void 0===t&&(t=0);var n=new Date,i=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Seconds),a=T.cSECONDS_IN_DAY-i,r=n.getUTCDay(),o=0;return e>r?(o=(e-r-1)*T.cSECONDS_IN_DAY,a+o+t):r>e?(o=(T.cDAYS_IN_WEEK-1-r+e)*T.cSECONDS_IN_DAY,a+o+t):t>=i?t-i:T.cSECONDS_IN_WEEK-(i-t)},updateGuildTimer:function(){T.secondsTillGuildReset<0&&(T.secondsTillGuildReset=T.getSecondsTillWeekday(T.DayEnum.Sunday)),$("#mapGuildTimer").text(T.formatSeconds(T.secondsTillGuildReset,!0)),T.secondsTillGuildReset--},initializeGenericCountdown:function(){var e=!0,t=new Date;for(var n in T.GenericCountdown)if(t<T.GenericCountdown[n].Finish){e=!1;break}if((e||I.isMapEnabled===!1)&&(T.isGenericCountdownSystemEnabled=!1),T.isGenericCountdownTickEnabled=T.isGenericCountdownSystemEnabled,T.isGenericCountdownSystemEnabled){$("#itemMapCountdown").show();var i,a,r,o=D.getNameKey(),s=D.getURLKey();for(var n in T.GenericCountdown)i=T.GenericCountdown[n],i.StartStamp=i.Start.toLocaleString(),i.FinishStamp=i.Finish.toLocaleString(),a=void 0===i.name?i[o]:i.name,r=void 0===i.news?i[s]:U.getGW2NewsLink(i.news),r=void 0===r?i.url:r,i.Anchor=-1!==r.indexOf(I.cSiteURL)?"<a href='"+r+"'>"+a+"</a>":"<a href='"+U.convertExternalURL(r)+"' target='_blank'>"+a+"</a>"}},updateGenericCountdown:function(e){var t,n=T.GenericCountdownHeader,i="";for(var a in T.GenericCountdown)t=T.GenericCountdown[a],e<t.Start?(i=T.formatSeconds(~~((t.Start.getTime()-e.getTime())/T.cMILLISECONDS_IN_SECOND),!0),n+="<span>■</span> "+t.Anchor+" <time>"+i+"</time> ⇑@ "+t.StartStamp+"<br />"):e<t.Finish&&(i=T.formatSeconds(~~((t.Finish.getTime()-e.getTime())/T.cMILLISECONDS_IN_SECOND),!0),n+="<samp>■</samp> "+t.Anchor+" <time>"+i+"</time> ⇓@ "+t.FinishStamp+"<br />");document.getElementById("itemCountdown").innerHTML=n}},K={tickerFrequency:250,tickerSecondPrevious:null,awakeTimestampPrevious:0,awakeTimestampTolerance:5,currentFrameOffsetMinutes:0,currentPredictionColor:"",iconOpacityChecked:.4,iconOpacitySpeed:200,oldQuadrantAngle:0,cDEGREES_IN_CIRCLE:360,cDEGREES_IN_QUADRANT:90,handSecond:{},handMinute:{},handHour:{},clockBackground:{},clockCircumference:{},timeProgress:{},timeDaylight:{},timeLocal:{},timeDaytime:{},timeBoard:{},timestampUTC:{},timestampLocal:{},timestampServer:{},timestampReset:{},WpChain0:{},WpChain1:{},WpChain2:{},WpChain3:{},IconSD0:{},IconSD1:{},IconSD2:{},IconSD3:{},IconHC0:{},IconHC1:{},IconHC2:{},IconHC3:{},IconsStandard:new Array,IconsHardcore:new Array,wpClipboards:[],lsClipboards:[],cZeroClipboardDataAttribute:"data-clipboard-text",cZeroClipboardSuccessText:"Chat link copied to clipboard :)<br />",TickerTimeout:{},initializeClock:function(){K.handSecond=$("#clkSecondHand")[0],K.handMinute=$("#clkMinuteHand")[0],K.handHour=$("#clkHourHand")[0],K.clockBackground=$("#paneClockBackground")[0],K.clockCircumference=$("#clkCircumference")[0],K.timeProgress=$("#chnProgress")[0],K.timeLocal=$("#itemTimeLocalActual")[0],K.timeDaytime=$("#itemTimeDayTime")[0],K.timeBoard=$("#itemBoardTime")[0],K.timestampUTC=$("#optTimestampUTC")[0],K.timestampLocal=$("#optTimestampLocalReset")[0],K.timestampServer=$("#optTimestampServerReset")[0],K.timestampReset=$("#optTimeTillReset")[0],T.initializeGenericCountdown(),K.updateTimeFrame(new Date),K.updateDaytimeIcon(),K.tickFrequent(),K.updateDigitalClockMinutely(),K.initializeClipboard(),$("#itemTimeLocalActual").click(function(){$("#opt_bol_use24Hour").trigger("click")
})},setClock:function(){var e=200,t=0;switch(O.Options.int_setClock){case O.IntEnum.Clock.Compact:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime, #itemLanguage, #itemSocial").show(),I.bulkAnimate([{s:"#clock",p:{top:"0px",left:"70px",width:"220px",height:"220px"}},{s:"#paneClockFace",p:{width:"360px",height:"360px",top:"-70px",left:"0px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"32px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"24px"}},{s:"#clkIconSD0",p:{top:"4px",left:"290px"}},{s:"#clkIconSD1",p:{top:"148px",left:"290px"}},{s:"#clkIconSD2",p:{top:"148px",left:"4px"}},{s:"#clkIconSD3",p:{top:"4px",left:"4px"}},{s:"#clkIconHC0",p:{top:"52px",left:"306px"}},{s:"#clkIconHC1",p:{top:"132px",left:"306px"}},{s:"#clkIconHC2",p:{top:"132px",left:"20px"}},{s:"#clkIconHC3",p:{top:"52px",left:"20px"}},{s:"#clkWaypoint0",p:{top:"24px",left:"274px"}},{s:"#clkWaypoint1",p:{top:"164px",left:"274px"}},{s:"#clkWaypoint2",p:{top:"164px",left:"52px"}},{s:"#clkWaypoint3",p:{top:"24px",left:"52px"}}],e),$("#paneClockIcons .iconHC").css({width:"32px",height:"32px"}),$("#itemTimeLocal").css({width:"100%",right:"auto",bottom:"90px","text-align":"center",color:"#eee",opacity:.5}),$("#itemTimeDaytime").css({width:"100%",top:"90px",bottom:"auto",left:"auto","text-align":"center",color:"#eee",opacity:.5}),$("#itemLanguage").css({bottom:"72px",left:"10px"}),$("#itemSocial").css({bottom:"100px",right:"10px"}),t=I.cPANE_CLOCK_HEIGHT_COMPACT;break;case O.IntEnum.Clock.Full:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime, #itemLanguage, #itemSocial").show(),I.bulkAnimate([{s:"#clock",p:{top:"70px",left:"70px",width:"220px",height:"220px"}},{s:"#paneClockFace",p:{width:"360px",height:"360px",top:"0px",left:"0px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"12px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"12px"}},{s:"#clkIconSD0",p:{top:"4px",left:"148px"}},{s:"#clkIconSD1",p:{top:"148px",left:"290px"}},{s:"#clkIconSD2",p:{top:"290px",left:"148px"}},{s:"#clkIconSD3",p:{top:"148px",left:"4px"}},{s:"#clkIconHC0",p:{top:"12px",left:"212px"}},{s:"#clkIconHC1",p:{top:"212px",left:"298px"}},{s:"#clkIconHC2",p:{top:"298px",left:"100px"}},{s:"#clkIconHC3",p:{top:"100px",left:"12px"}},{s:"#clkWaypoint0",p:{top:"52px",left:"164px"}},{s:"#clkWaypoint1",p:{top:"164px",left:"274px"}},{s:"#clkWaypoint2",p:{top:"274px",left:"164px"}},{s:"#clkWaypoint3",p:{top:"164px",left:"52px"}}],e),$("#paneClockIcons .iconHC").css({width:"48px",height:"48px"}),$("#itemTimeLocal").css({width:"auto",right:"10px",bottom:"10px","text-align":"left",color:"#bbcc77",opacity:1}),$("#itemTimeDaytime").css({width:"auto",top:"auto",bottom:"10px",left:"10px","text-align":"left",color:"#bbcc77",opacity:1}),$("#itemLanguage").css({bottom:"0px",left:"10px"}),$("#itemSocial").css({bottom:"28px",right:"10px"}),t=I.cPANE_CLOCK_HEIGHT;break;case O.IntEnum.Clock.Bar:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime, #itemLanguage, #itemSocial").hide(),I.bulkAnimate([{s:"#clock",p:{top:"0px",left:"0px",width:"85px",height:"85px"}},{s:"#paneClockFace",p:{width:"132px",height:"132px",top:"-24px",left:"-24px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"32px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"24px"}},{s:"#clkIconSD0",p:{top:"0px",left:"82px"}},{s:"#clkIconSD1",p:{top:"0px",left:"152px"}},{s:"#clkIconSD2",p:{top:"0px",left:"222px"}},{s:"#clkIconSD3",p:{top:"0px",left:"292px"}},{s:"#clkIconHC0",p:{top:"48px",left:"98px"}},{s:"#clkIconHC1",p:{top:"48px",left:"168px"}},{s:"#clkIconHC2",p:{top:"48px",left:"238px"}},{s:"#clkIconHC3",p:{top:"48px",left:"308px"}},{s:"#clkWaypoint0",p:{top:"-8px",left:"98px"}},{s:"#clkWaypoint1",p:{top:"-8px",left:"168px"}},{s:"#clkWaypoint2",p:{top:"-8px",left:"238px"}},{s:"#clkWaypoint3",p:{top:"-8px",left:"308px"}}],e),$("#paneClockIcons .iconHC").css({width:"32px",height:"32px"}),t=I.cPANE_CLOCK_HEIGHT_BAR;break;case O.IntEnum.Clock.None:$("#paneMenu").animate({top:0},e),$("#paneContent").animate({top:I.cPANE_MENU_HEIGHT,"min-height":I.cPANEL_HEIGHT_MIN-I.cPANE_MENU_HEIGHT+"px"},e,function(){$("#paneClock").hide()})}switch(I.CLOCK_AND_MENU_HEIGHT=t+I.cPANE_MENU_HEIGHT,O.Options.int_setClock!==O.IntEnum.Clock.None&&($("#paneMenu").animate({top:t},e),$("#paneClock, #paneClockWall, #paneClockBackground, #paneClockIcons").animate({height:t},e),$("#paneContent").animate({top:t+I.cPANE_MENU_HEIGHT,"min-height":I.cPANEL_HEIGHT_MIN-(t+I.cPANE_MENU_HEIGHT)+"px"},e)),I.ModeCurrent){case I.ModeEnum.Overlay:$("#itemSocial").hide()}},setMarkerAngle:function(e,t){$(e).attr("transform","rotate("+t/10+", 50, 50)")},rotateClockElement:function(e,t){e.setAttribute("transform","rotate("+t+", 50, 50)")},reapplyFilters:function(){if(I.BrowserCurrent===I.BrowserEnum.Firefox){var e=$("#clkCircumference"),t=$("#clkHands"),n="url(#clkFilterShadowOuter)",i="url(#clkGradientCircumference)",a="url(#clkFilterShadowHand)";e.removeAttr("filter").attr("filter",n),e.css("stroke",i),t.removeAttr("filter").attr("filter",a)}},initializeClockItems:function(){K.IconsStandard=null,K.IconsHardcore=null,K.IconsStandard=new Array(K.IconSD0,K.IconSD1,K.IconSD2,K.IconSD3),K.IconsHardcore=new Array(K.IconHC0,K.IconHC1,K.IconHC2,K.IconHC3);var e,t,n="click",i="dblclick";for(I.ModeCurrent===I.ModeEnum.Website&&I.isProgramEmbedded===!1&&(n="dblclick",i="click"),e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)$([K.IconsStandard[e],K.IconsHardcore[e]]).each(function(){$(this).unbind(i).on(i,function(){t=C.Chains[$(this).data(C.cIndexSynonym)].primaryEvents[0].path[0],M.goToView(t,M.ZoomEnum.Ground,M.Pin.Event)}).unbind(n).on(n,function(){$("#chnCheck_"+C.Chains[$(this).data(C.cIndexSynonym)].nexus).trigger("click")})})},checkoffChainIcon:function(e){var t,n,i,a=C.Chains[e];if(a.series===C.ChainSeriesEnum.Standard||a.series===C.ChainSeriesEnum.Hardcore)for(t=0;t<T.cNUM_TIMEFRAMES_IN_HOUR;t++){switch(a.series){case C.ChainSeriesEnum.Standard:n=T.getStandardChain(t),i=K.IconsStandard[t];break;case C.ChainSeriesEnum.Hardcore:n=T.getHardcoreChain(t),i=K.IconsHardcore[t]}n&&e===n.nexus&&(X.getChainChecklistState(n)!==X.ChecklistEnum.Unchecked?i.css({opacity:1}).animate({opacity:K.iconOpacityChecked},K.iconOpacitySpeed):i.css({opacity:K.iconOpacityChecked}).animate({opacity:1},K.iconOpacitySpeed))}},colorPrediction:function(e){e!==K.currentPredictionColor&&(K.currentPredictionColor=e,K.handMinute.style.stroke=e,K.timeProgress.style.background="linear-gradient(to right, black 0%, "+e+" 100%)")},tickFrequent:function(){var e=new Date,t=e.getSeconds();return K.tickerSecondPrevious===t?void(K.TickerTimeout=setTimeout(K.tickFrequent,K.tickerFrequency)):(K.tickerSecondPrevious=t,void K.tickSecond(e))},tickSecond:function(e){var t=e.getSeconds();T.TIMESTAMP_UNIX_SECONDS=T.getUNIXSeconds(),T.SECONDS_TILL_RESET=T.cSECONDS_IN_DAY-T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Seconds);var n=e.getMinutes(),i=e.getHours()%T.cHOURS_IN_MERIDIEM,a=60*n+t,r=6*t,o=6*n+t/10,s=30*i+n/60*30;K.rotateClockElement(K.clockCircumference,o),K.rotateClockElement(K.handSecond,r),K.rotateClockElement(K.handMinute,o),K.rotateClockElement(K.handHour,s);var c=1-(n%T.cMINUTES_IN_TIMEFRAME*60+t)/T.cSECONDS_IN_TIMEFRAME,l=I.ModeCurrent===I.ModeEnum.Tile?T.cPERCENT_100*c+"%":~~(I.cPANEL_WIDTH*c)+"px";if(K.timeProgress.style.width=l,n%T.cMINUTES_IN_TIMEFRAME===0&&0===t)0===O.Options.int_setDimming&&I.ModeCurrent!==I.ModeEnum.Simple&&I.ModeCurrent!==I.ModeEnum.Overlay&&$(K.clockBackground).fadeTo(800,1),K.updateTimeFrame(e);else{var u=T.TIMESTAMP_UNIX_SECONDS;K.awakeTimestampPrevious<u-K.awakeTimestampTolerance&&K.updateTimeFrame(e),K.awakeTimestampPrevious=u,0===O.Options.int_setDimming&&I.ModeCurrent!==I.ModeEnum.Simple&&(K.clockBackground.style.opacity=c)}C.CurrentChains.forEach(C.updateCurrentChainTimeHTML),0===t&&(K.updateDigitalClockMinutely(),C.updateChainsTimeHTML(),K.updateWaypointsClipboard(),O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&(K.doSubscribedSpeech(O.Options.int_alertSubscribedFirst),K.doSubscribedSpeech(O.Options.int_alertSubscribedSecond)),n%T.cMINUTES_IN_DRYTOPFRAME===0&&(K.updateDaytimeIcon(),K.updateDryTopClipboard())),K.timeLocal.innerHTML=T.getTimeFormatted(),K.timeBoard.innerHTML=T.getTimeFormatted({want24:!0,wantHours:!1,wantLetters:!0,customTimeInSeconds:T.cSECONDS_IN_TIMEFRAME-T.getCurrentTimeframeElapsedTime()}),K.timestampUTC.innerHTML=T.TIMESTAMP_UNIX_SECONDS,K.timestampLocal.innerHTML=O.Utilities.lastLocalResetTimestamp.value,K.timestampServer.innerHTML=T.TIMESTAMP_UNIX_SECONDS+T.SECONDS_TILL_RESET,K.timestampReset.innerHTML=T.getTimeFormatted({customTimeInSeconds:T.SECONDS_TILL_RESET,want24:!0}),a>=K.currentFrameOffsetMinutes&&a<K.currentFrameOffsetMinutes+C.CurrentChainSD.minFinish?K.colorPrediction("lime"):a>=K.currentFrameOffsetMinutes+C.CurrentChainSD.minFinish&&a<K.currentFrameOffsetMinutes+C.CurrentChainSD.avgFinish?K.colorPrediction("orange"):a>=K.currentFrameOffsetMinutes+C.CurrentChainSD.avgFinish&&K.colorPrediction("red"),T.isGuildTimerStarted&&T.updateGuildTimer(),T.isGenericCountdownTickEnabled&&T.updateGenericCountdown(e),K.TickerTimeout=setTimeout(K.tickFrequent,K.tickerFrequency)},doSubscribedSpeech:function(e){if(e>0){var t=T.cMINUTES_IN_TIMEFRAME-T.getCurrentTimeframeElapsedTime(T.UnitEnum.Minutes),n=C.NextChainSD1,i=C.NextChainHC1,a=!1,r=!1,o=D.getSpeech("world boss","subscribed")+" ",s=5;e>T.cMINUTES_IN_TIMEFRAME&&(n=C.NextChainSD2,i=C.NextChainHC2,t+=T.cMINUTES_IN_TIMEFRAME),a=O.objToBool(n)&&C.isChainSubscribed(n)&&C.isChainUnchecked(n),r=O.objToBool(i)&&C.isChainSubscribed(i)&&C.isChainUnchecked(i),e===t&&(a||r)&&(a&&r?(o+=D.getChainPronunciation(n)+" "+D.getSpeech("and")+" "+D.getChainPronunciation(i),s=6):a?o+=D.getChainPronunciation(n):r&&(o+=D.getChainPronunciation(i)),D.speak(o,s),D.speak(D.getSpeech("will start")+T.getTimeTillChainFormatted(n,"speech"),3))}},updateTimeFrame:function(e){if(O.checkResetTimestamp(),C.CurrentChainSD=T.getStandardChain(),C.NextChainSD1=T.getStandardChain(1),C.NextChainSD2=T.getStandardChain(2),C.NextChainSD3=T.getStandardChain(3),C.NextChainSD4=T.getStandardChain(4),C.CurrentChainsSD=[C.CurrentChainSD,C.NextChainSD1,C.NextChainSD2,C.NextChainSD3],C.CurrentChainHC=T.getHardcoreChain(),C.NextChainHC1=T.getHardcoreChain(1),C.NextChainHC2=T.getHardcoreChain(2),C.NextChainHC3=T.getHardcoreChain(3),C.NextChainHC4=T.getHardcoreChain(4),C.PreviousChains2=T.getTimeframeChains(-2),C.PreviousChains1=T.getTimeframeChains(-1),C.CurrentChains=T.getTimeframeChains(),C.NextChains1=T.getTimeframeChains(1),C.sortChainsListHTML(),C.updateChainToday(),C.CurrentChains.forEach(C.queueEventsHighlight),$("#itemBoardCurrentSD").text(D.getChainTitleAny(C.CurrentChainSD.nexus)),$("#itemBoardNextSD").text(D.getChainTitleAny(C.NextChainSD1.nexus)),$("#itemBoardCurrentHC").text(""),$("#itemBoardNextHC").text(""),C.CurrentChainHC||C.NextChainHC1?($("#itemBoardHC").show(),C.CurrentChainHC&&$("#itemBoardCurrentHC").text(D.getChainTitleAny(C.CurrentChainHC.nexus)),C.NextChainHC1&&$("#itemBoardNextHC").text(D.getChainTitleAny(C.NextChainHC1.nexus))):$("#itemBoardHC").hide(),O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&O.Options.bol_alertAtEnd){var t=", "+D.getSpeech("checked"),n="",i="",a="",r="",o=O.objToBool(C.CurrentChainSD),s=O.objToBool(C.CurrentChainHC),c=O.objToBool(C.NextChainSD1),l=O.objToBool(C.NextChainHC1),u=D.getSpeech("world boss","current")+" "+D.getSpeech("is")+" ";C.CurrentChainSD&&!C.isChainUnchecked(C.CurrentChainSD)&&(n=t),C.CurrentChainHC&&!C.isChainUnchecked(C.CurrentChainHC)&&(a=t),C.NextChainSD1&&!C.isChainUnchecked(C.NextChainSD1)&&(i=t),C.NextChainHC1&&!C.isChainUnchecked(C.NextChainHC1)&&(r=t),O.Options.bol_alertChecked===!1&&(n.length>0&&(o=!1),a.length>0&&(s=!1),i.length>0&&(c=!1),r.length>0&&(l=!1)),o&&s?(D.speak(u+D.getChainPronunciation(C.CurrentChainSD)+n,5),D.speak(D.getSpeech("and")+", "+D.getChainPronunciation(C.CurrentChainHC)+a,4)):o?D.speak(u+D.getChainPronunciation(C.CurrentChainSD)+n,5):s&&D.speak(u+D.getChainPronunciation(C.CurrentChainHC)+a,5),(o||s)&&(c&&l?(D.speak(D.getSpeech("then")+", "+D.getChainPronunciation(C.NextChainSD1)+i,4),D.speak(D.getSpeech("and")+", "+D.getChainPronunciation(C.NextChainHC1)+r,4)):c?D.speak(D.getSpeech("then")+", "+D.getChainPronunciation(C.NextChainSD1)+i,4):l&&D.speak(D.getSpeech("then")+", "+D.getChainPronunciation(C.NextChainHC1)+r,4))}var d=e.getSeconds(),h=e.getMinutes(),p=60*h+d;$("#clkMarkers line").each(function(){$(this).attr("stroke","black")}),$("#paneClockIcons .iconSD").removeClass("clkIconCurrent clkIconNext"),$("#paneClockIcons .iconHC").removeClass("clkIconCurrent clkIconNext");var m=function(e,t,n,i,a,r,o,s,c,l,u,d,h,p){$([K.IconSD0,K.IconHC0]).each(function(){$(this).addClass("clkIconCurrent")}),$([K.IconSD1,K.IconHC1]).each(function(){$(this).addClass("clkIconNext")}),K.setMarkerAngle(t,C.CurrentChainSD.minFinish+u),K.setMarkerAngle(n,C.CurrentChainSD.avgFinish+u),K.setMarkerAngle(a,C.NextChainSD1.minFinish+d),K.setMarkerAngle(r,C.NextChainSD1.avgFinish+d),K.setMarkerAngle(o,C.NextChainSD2.minFinish+h),K.setMarkerAngle(s,C.NextChainSD2.avgFinish+h),K.setMarkerAngle(c,C.NextChainSD3.minFinish+p),K.setMarkerAngle(l,C.NextChainSD3.avgFinish+p);var m=function(e,t){e?(t.show(),t.attr("src","img/chain/"+e.alias.toLowerCase()+I.cPNG),t.data(C.cIndexSynonym,e.nexus),I.ModeCurrent===I.ModeEnum.Simple&&(t.attr("title",D.getChainTitleAny(e.nexus)),I.qTip.init(t)),t.css(X.getChainChecklistState(e)!==X.ChecklistEnum.Unchecked?{opacity:K.iconOpacityChecked}:{opacity:1})):t.hide()};m(C.CurrentChainSD,K.IconSD0),m(C.NextChainSD1,K.IconSD1),m(C.NextChainSD2,K.IconSD2),m(C.NextChainSD3,K.IconSD3),m(C.CurrentChainHC,K.IconHC0),m(C.NextChainHC1,K.IconHC1),m(C.NextChainHC2,K.IconHC2),m(C.NextChainHC3,K.IconHC3),$(e).attr("stroke","lime"),$(t).attr("stroke","orange"),$(n).attr("stroke","red"),$(i).attr("stroke","green")},g=function(e){var t,n,i,a;switch(e){case T.cSECS_MARK_0:t="0",n="1",i="2",a="3";break;case T.cSECS_MARK_1:t="1",n="2",i="3",a="0";break;case T.cSECS_MARK_2:t="2",n="3",i="0",a="1";break;case T.cSECS_MARK_3:t="3",n="0",i="1",a="2"}K.currentFrameOffsetMinutes=e,K.WpChain0=$("#clkWaypoint"+t),K.IconSD0=$("#clkIconSD"+t),K.WpChain1=$("#clkWaypoint"+n),K.IconSD1=$("#clkIconSD"+n),K.WpChain2=$("#clkWaypoint"+i),K.IconSD2=$("#clkIconSD"+i),K.WpChain3=$("#clkWaypoint"+a),K.IconSD3=$("#clkIconSD"+a),K.IconHC0=$("#clkIconHC"+t),K.IconHC1=$("#clkIconHC"+n),K.IconHC2=$("#clkIconHC"+i),K.IconHC3=$("#clkIconHC"+a),C.showChainDailyIcon(),m($("#clkMarker"+t),$("#clkMarker"+t+"A"),$("#clkMarker"+t+"B"),$("#clkMarker"+n),$("#clkMarker"+n+"A"),$("#clkMarker"+n+"B"),$("#clkMarker"+i+"A"),$("#clkMarker"+i+"B"),$("#clkMarker"+a+"A"),$("#clkMarker"+a+"B"),T["cSECS_MARK_"+t],T["cSECS_MARK_"+n],T["cSECS_MARK_"+i],T["cSECS_MARK_"+a]);var r=document.getElementById("clkQuadrant"),o=parseInt(t)*K.cDEGREES_IN_QUADRANT;0===o&&0!==K.oldQuadrantAngle&&(o=K.cDEGREES_IN_CIRCLE),$({angle:K.oldQuadrantAngle}).animate({angle:o},{duration:600,step:function(){K.rotateClockElement(r,this.angle)},done:function(){K.rotateClockElement(r,o)}}),o===K.cDEGREES_IN_CIRCLE&&(o=0),K.oldQuadrantAngle=o};p>=T.cSECS_MARK_0&&p<T.cSECS_MARK_1?g(T.cSECS_MARK_0):p>=T.cSECS_MARK_1&&p<T.cSECS_MARK_2?g(T.cSECS_MARK_1):p>=T.cSECS_MARK_2&&p<T.cSECS_MARK_3?g(T.cSECS_MARK_2):p>=T.cSECS_MARK_3&&p<=T.cSECS_MARK_4&&g(T.cSECS_MARK_3),K.updateWaypointsClipboard(),K.updateDryTopClipboard(),K.initializeClockItems()},initializeClipboard:function(){ZeroClipboard.config({swfPath:"bin/ZeroClipboard.swf"});for(var e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)K.wpClipboards.push(new ZeroClipboard(document.getElementById("clkWaypoint"+e))),K.wpClipboards[e].on("aftercopy",function(e){I.write(K.cZeroClipboardSuccessText+e.data["text/plain"],5)});if(C.DryTopChains.length>0)for(var e=0;2>e;e++)K.lsClipboards.push(new ZeroClipboard(document.getElementById("chnDryTopWaypoint"+e))),K.lsClipboards[e].on("aftercopy",function(e){I.write(K.cZeroClipboardSuccessText+e.data["text/plain"],5)})},updateDaytimeIcon:function(){var e="img/ui/day_night.png";T.isDaylight()&&(e="img/ui/day_light.png"),$("#itemTimeDayIcon").attr("src",e)},updateDigitalClockMinutely:function(){K.timeDaytime.innerHTML=T.getDayPeriodRemaining(),K.timeLocal.title="Anet: "+T.getTimeFormatted({reference:T.ReferenceEnum.Server,wantSeconds:!1})+"<br />UTC: "+T.getTimeFormatted({reference:T.ReferenceEnum.UTC,wantSeconds:!1,want24:!0})+"<br />Reset: "+T.getTimeFormatted({customTimeInSeconds:T.SECONDS_TILL_RESET,wantSeconds:!1,wantLetters:!0}),I.qTip.init(K.timeLocal)},updateWaypointsClipboard:function(){var e=function(e,t,n,i,a){var r="";r+=t.waypoint+" "+D.getChainAlias(t.nexus),n&&n.nexus!==C.Triple.nexus?n.nexus!==C.Triple.nexus&&(r+=" "+D.getPhrase("and")+" "+n.waypoint+" "+D.getChainAlias(n.nexus)+T.getTimeTillChainFormatted(n)):r+=T.getTimeTillChainFormatted(t),r+=", "+D.getPhrase("then")+" "+i.waypoint+" "+D.getChainAlias(i.nexus),a&&a.nexus!==C.Triple.nexus?a.nexus!==C.Triple.nexus&&(r+=" "+D.getPhrase("and")+" "+a.waypoint+" "+D.getChainAlias(a.nexus)+T.getTimeTillChainFormatted(a)):r+=T.getTimeTillChainFormatted(i),r+=I.siteTagCurrent,e.attr(K.cZeroClipboardDataAttribute,r)};e(K.WpChain0,C.CurrentChainSD,C.CurrentChainHC,C.NextChainSD1,C.NextChainHC1),e(K.WpChain1,C.NextChainSD1,C.NextChainHC1,C.NextChainSD2,C.NextChainHC2),e(K.WpChain2,C.NextChainSD2,C.NextChainHC2,C.NextChainSD3,C.NextChainHC3),e(K.WpChain3,C.NextChainSD3,C.NextChainHC3,C.NextChainSD4,C.NextChainHC4)},updateDryTopClipboard:function(){if(C.isDryTopIconsShown){var e=T.getCurrentDryTopEvents(),t=T.getCurrentDryTopEvents(1);document.getElementById("chnDryTopWaypoint0").setAttribute(K.cZeroClipboardDataAttribute,e),document.getElementById("chnDryTopWaypoint1").setAttribute(K.cZeroClipboardDataAttribute,t),$("#mapDryTopClip0").val(e),$("#mapDryTopClip1").val(t)}}},I={cSiteName:"GW2Timer.com",cSiteURL:"http://gw2timer.com/",cImageHost:"http://i.imgur.com/",cGameName:"Guild Wars 2",cGameNick:"GW2",cPNG:".png",cThrobber:"<div class='itemThrobber'><em></em></div>",cTextDelimiterChar:"|",cTextDelimiterRegex:/[|]/g,consoleTimeout:{},siteTagDefault:" - gw2timer.com",siteTagCurrent:" - gw2timer.com",Symbol:{Expand:"[+]",Collapse:"[−]",Help:"[?]"},cPANEL_WIDTH:360,cPANEL_HEIGHT_MIN:220,cPANE_CLOCK_HEIGHT:360,cPANE_CLOCK_HEIGHT_COMPACT:220,cPANE_CLOCK_HEIGHT_BAR:85,cPANE_MENU_HEIGHT:48,cTOOLTIP_WIDTH_MAX:360,cTOOLTIP_OVERFLOW_WIDTH:240,cTOOLTIP_OVERFLOW_MAX:10,cTOOLTIP_DEFAULT_OFFSET_X:-180,cTOOLTIP_DEFAULT_OFFSET_Y:30,cTOOLTIP_ALTERNATE_OFFSET_X:24,cTOOLTIP_ADD_OFFSET_Y:42,cTOOLTIP_ADD_OFFSET_X:36,cTOOLTIP_MOUSEMOVE_RATE:20,CLOCK_AND_MENU_HEIGHT:0,isMouseOnPanel:!1,isProgramLoaded:!1,isProgramEmbedded:!1,isMapEnabled:!0,isScrollEnabled:!1,isSpeechSynthesisEnabled:!1,ModeCurrent:null,ModeEnum:{Website:"Website",Mobile:"Mobile",Simple:"Simple",Tile:"Tile",Overlay:"Overlay"},cPagePrefix:"#plate",cMenuPrefix:"#menu",PageCurrent:"",PagePrevious:"",PageEnum:{Chains:"Chains",Map:"Map",Help:"Help",Options:"Options"},SpecialPageEnum:{WvW:"WvW",DryTop:"DryTop"},SectionEnum:{Chains:{DryTop:"DryTop",Timetable:"Timetable"},Map:{Daily:"Daily",Resource:"Resource",JP:"JP",Collectible:"Collectible",Guild:"Guild",TP:"TP",Notepad:"Notepad",Personal:"Personal"},Help:{FAQ:"FAQ",About:"About",Embed:"Embed",Scheduled:"Scheduled",Legacy:"Legacy",Temples:"Temples",Dungeons:"Dungeons"}},MapEnum:{Tyria:"map",Mists:"wvw"},MapCurrent:0,ArticleCurrent:null,contentCurrentPlate:"",isContentLoaded_Map:!1,isContentLoaded_Help:!1,isSectionLoaded_Daily:!1,sectionPrefix:"sectionCurrent_",cHeaderPrefix:"#header",BrowserCurrent:"Unknown",BrowserEnum:{IE:0,Opera:1,Firefox:2,Chrome:3},isOnSmallDevice:!1,isOnBigDevice:!1,cSMALL_DEVICE_WIDTH:800,cSMALL_DEVICE_HEIGHT:600,cBIG_DISPLAY_HEIGHT:1200,initializeFirst:function(){D.stopSpeech(),window!==window.top&&(I.isProgramEmbedded=!0),U.enforceURLArgumentsFirst(),I.enforceProgramMode(),T.checkDST(),T.cUTC_OFFSET_USER=-((new Date).getTimezoneOffset()/T.cMINUTES_IN_HOUR),T.cUTC_OFFSET_USER<=T.cUTC_OFFSET_EASTERN&&T.cUTC_OFFSET_USER>=T.cUTC_OFFSET_HAWAII&&(O.Options.bol_use24Hour=!1);var e=T.getUNIXSeconds(),t=parseInt(localStorage[O.Utilities.lastLocalResetTimestamp.key]);void 0===localStorage[O.Utilities.lastLocalResetTimestamp.key]||isFinite(t)===!1||t>e?(O.Utilities.lastLocalResetTimestamp.value=e,localStorage[O.Utilities.lastLocalResetTimestamp.key]=O.Utilities.lastLocalResetTimestamp.value):O.Utilities.lastLocalResetTimestamp.value=t,K.awakeTimestampPrevious=e,screen.width<=I.cSMALL_DEVICE_WIDTH&&screen.height<=I.cSMALL_DEVICE_HEIGHT&&I.ModeCurrent===I.ModeEnum.Website&&(I.isOnSmallDevice=!0),window.innerHeight>I.cBIG_DISPLAY_HEIGHT&&(I.isOnBigDevice=!0);var n=navigator.userAgent;-1!==n.indexOf("MSIE")||-1!==n.indexOf("Trident")?I.BrowserCurrent=I.BrowserEnum.IE:-1!==n.indexOf("Chrome")?(I.BrowserCurrent=I.BrowserEnum.Chrome,I.isSpeechSynthesisEnabled=!0):-1!==n.indexOf("Firefox")?I.BrowserCurrent=I.BrowserEnum.Firefox:-1!==n.indexOf("Opera")&&(I.BrowserCurrent=I.BrowserEnum.Opera),$("#plateMap, #plateWvW, #plateHelp").each(function(){$(this).append(I.cThrobber)}),I.qTip.start(),I.PageCurrent=I.PageEnum.Chains},initializeLast:function(){I.initializeTooltip(),I.bindHelpButtons("#plateOptions"),I.initializeUIforMenu(),I.initializeUIForHUD(),$("#mapSwitchButton").one("click",function(){$.getScript(U.URL_DATA.WvW).done(function(){W.initializeWvW()})}).click(function(){I.toggleMap(I.MapEnum.Mists)}),$("#wvwSwitchButton").click(function(){I.toggleMap(I.MapEnum.Tyria)}),U.enforceURLArgumentsLast(),I.PageCurrent===I.PageEnum.Chains&&U.openSectionFromURL(),$("#paneWarning").remove(),$("#jsConsoleButtonClose").click(function(){I.clear()}),$("#jsConsoleButtonSelect").click(function(){I.selectText("#jsConsole")}),$("#mapOptions, #wvwOptions").one("mouseenter",function(){$(this).find("img").each(function(){$(this).attr("src",$(this).attr("data-src"))})}),$("#optAlarmSpeaker").click(function(){D.speak(D.getWord("alarm"))}),$("#optMute").click(function(){D.stopSpeech()}),$("#chnOptions").one("mouseover",function(){I.loadImg($(this))}),U.convertExternalLink(".linkExternal"),I.BrowserCurrent!==I.BrowserEnum.IE&&$("head").append("<style>.leaflet-clickable{cursor: url('img/cursor/pointer.cur'), pointer;}</style>"),$(document).mouseup(function(e){var t=$(".jsRemovable");t.is(e.target)||0!==t.has(e.target).length||t.remove()}),$("#itemLanguage").hover(function(){$("#paneClock").css("z-index",3)},function(){$("#paneClock").css("z-index",1)}),I.isMapEnabled&&I.initializeScrollbar($("#jsConsole, #plateChains, #plateOptions")),O.cleanLocalStorage(),O.enforceProgramVersion(),D.translateAfter(),P.wantZoomToFirstEvent()?$("#chnEvent_"+C.CurrentChainSD.nexus+"_"+C.CurrentChainSD.CurrentPrimaryEvent.num).trigger("click"):I.isMapEnabled&&M.goToDefault(),I.isMapEnabled&&L.tileLayer(U.URL_API.TilesTyria,{continuousWorld:!0}).addTo(M.Map),O.isServerReset&&C.ChainToday&&I.write(D.getModifiedWord("world boss","daily",U.CaseEnum.Sentence)+" "+D.getChainTitleAny(C.ChainToday.nexus)+" "+D.getPhrase("will start")+" "+D.getPhrase("at")+" "+T.getTimeFormatted({wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(C.ChainToday.scheduleKeys[0])})+" "+D.getPhrase("in")+" "+T.getTimeFormatted({wantLetters:!0,wantSeconds:!1,customTimeInSeconds:T.getSecondsUntilChainStarts(C.ChainToday)}),15),T.isGenericCountdownTickEnabled&&(I.PageCurrent===I.PageEnum.Chains?setTimeout(function(){T.isGenericCountdownTickEnabled=!1,$("#itemMapCountdown").animate({opacity:0},1e3,function(){$(this).hide()})},180*T.cMILLISECONDS_IN_SECOND):(T.isGenericCountdownTickEnabled=!1,$("#itemMapCountdown").hide())),I.isProgramLoaded=!0},initializeChainsUI:function(){$("#plateChains header").click(function(){var e=U.getSubstringFromHTMLID($(this));$(this).next().slideToggle("fast",function(){if($(this).is(":visible")){I.updateScrollbar();var t=$(I.cPagePrefix+I.PageEnum.Chains),n=$(this).prev();n.find("kbd").html(I.Symbol.Collapse),I.scrollToElement(n,t,"fast"),"sectionChains_Drytop"===$(this).attr("id")?(M.goToZone("dry",M.ZoomEnum.Bird),I.PageCurrent=I.SpecialPageEnum.DryTop,U.updateTitle(I.SpecialPageEnum.DryTop),P.toggleDryTopIcons(!0)):I[I.sectionPrefix+I.PageEnum.Chains]=e}else I.updateScrollbar(),$(this).prev().find("kbd").html(I.Symbol.Expand),"sectionChains_Drytop"===$(this).attr("id")&&(I.PageCurrent=I.PageEnum.Chains,P.toggleDryTopIcons(!1)),I[I.sectionPrefix+I.PageEnum.Chains]="";U.updateQueryString()})}),$("#plateChains header:not(:first)").each(function(){$(this).next().toggle(0),$(this).find("kbd").html(I.Symbol.Expand)}),$("#plateChains header:first").each(function(){$(this).find("kbd").html(I.Symbol.Collapse)}),I.ModeCurrent!==I.ModeEnum.Tile?$("#headerChains_Drytop").one("click",function(){P.generateDryTop()}):$("#headerChains_Drytop").hide(),$("#headerChains_Legacy").one("click",function(){C.LegacyChains.forEach(C.initializeChain),C.LegacyChains.forEach(P.drawChainPaths),I.readjustTile()}),$("#headerChains_Temple").one("click",function(){C.TempleChains.forEach(C.initializeChain),C.TempleChains.forEach(P.drawChainPaths),I.readjustTile()}),$("#headerChains_Timetable").one("click",function(){C.isTimetableGenerated=!0,C.initializeTimetableHTML(),I.readjustTile()}),I.readjustTile()},write:function(e,t,n){$("#jsConsoleButtons").show();var i=$("#jsConsole"),a=24;e=void 0===e||null===e?"emptystring":e.toString(),void 0===n&&(n=!1),n===!0&&i.empty(),isFinite(t)===!1&&(t=3+parseInt(e.length/a)),i.append(e+"<br />"),I.updateScrollbar(i),window.clearTimeout(I.consoleTimeout),I.consoleTimeout=setTimeout(function(){i.css({opacity:1}).animate({opacity:0},600,function(){$(this).empty().css({opacity:1}),$("#jsConsoleButtons").hide()})},t*T.cMILLISECONDS_IN_SECOND)},clear:function(){window.clearTimeout(I.consoleTimeout),$("#jsConsoleButtons").hide(),$("#jsConsole").empty()},log:function(e,t,n){I.write(e,t||30,n)},selectText:function(e){var t=document.querySelector(e),n=window.getSelection(),i=document.createRange();i.selectNodeContents(t),n.removeAllRanges(),n.addRange(i)},scrollToElement:function(e,t,n){switch(I.ModeCurrent){case I.ModeEnum.Mobile:$("body").scrollTop(e.offset().top);break;case I.ModeEnum.Tile:$("#windowMain").animate({scrollTop:e.offset().top-$("#windowMain").offset().top+$("#windowMain").scrollTop()},n||0);break;default:t?t.animate({scrollTop:e.offset().top-t.offset().top+t.scrollTop()},n||0):e.scrollTop(0)}},bulkAnimate:function(e,t){for(var n in e){var i=e[n];$(i.s).animate(i.p,{duration:t,queue:!1})}},toggleHighlight:function(e,t){return void 0===t?e.hasClass("cssHighlight")?(e.removeClass("cssHighlight"),!1):(e.addClass("cssHighlight"),!0):t?(e.addClass("cssHighlight"),!0):(e.removeClass("cssHighlight"),!1)},initializeScrollbar:function(e){if(I.isScrollEnabled===!1)try{var t=1;switch(I.BrowserCurrent){case I.BrowserEnum.Opera:t=5;break;case I.BrowserEnum.Firefox:t=3}$(e).perfectScrollbar({wheelSpeed:t,suppressScrollX:!0})}catch(n){}},updateScrollbar:function(e){if(I.isScrollEnabled===!1)if(I.isMapEnabled)try{void 0===e?($("#plateMap").perfectScrollbar("update"),$("#plateChains").perfectScrollbar("update"),$("#plateHelp").perfectScrollbar("update"),$("#plateOptions").perfectScrollbar("update")):$(e).perfectScrollbar("update")}catch(t){}else $("#windowMain").perfectScrollbar("update")},generateSectionMenu:function(e){if(!($(e+" header.jsSection").length<=0)){var t=e.substring(I.cPagePrefix.length,e.length),n="menuBeam_"+t,i=$("<div class='menuBeamContainer'></div>").prependTo(e),a=$("<div class='menuBeam' id='"+n+"'></div>").prependTo(i);$(e+" header.jsSection").each(function(){var n=$(this),i=$(this).children("var").first(),r=i.data(O.Options.enu_Language)||n.text();i.text(r),n.next().hide(),n.wrapInner("<span></span>"),n.append("<sup>"+I.Symbol.Expand+"</sup>"),n.click(function(){var n=!1,i=U.getSubstringFromHTMLID($(this));$(e+" .menuBeamIcon").removeClass("menuBeamIconActive"),$(this).next().is(":visible")?($(this).children("sup").text(I.Symbol.Expand),I.displaySectionMarkers(i,!1),I[I.sectionPrefix+t]="",$(e+" header.jsSection").show(),$(e+" header.cntHeader").show()):(n=!0,$(this).children("sup").text(I.Symbol.Collapse),$(e+" .menuBeamIcon[data-section='"+i+"']").addClass("menuBeamIconActive"),I.displaySectionMarkers(i,!0),I[I.sectionPrefix+t]=i,$(this).data("beamclicked")===!0&&($(e+" header.jsSection").not(this).hide(),$(e+" header.cntHeader").hide(),$(this).removeData("beamclicked")),$(this).hasClass("jsMapDefault")&&M.goToDefault()),U.updateQueryString(),$(this).data("donotanimate")!==!0?I.ModeCurrent===I.ModeEnum.Website?$(this).next().toggle("fast",function(){I.updateScrollbar(e)}):($(this).next().toggle(),I.updateScrollbar(e)):$(this).next().toggle(),$(this).removeData("donotanimate"),n&&I.scrollToElement($(this),$(e),"fast")}),n.one("click",function(){I.loadImg($(this).next())}),$("<div class='jsSectionDone'><img src='img/ui/close.png' />"+r+"</div>").appendTo(n.next()).click(function(){$(this).parent().prev().trigger("click")});var o=U.getSubstringFromHTMLID(n),s=n.find("img:eq(0)").attr("src");(I.isMapEnabled||n.hasClass("mapOnly")===!1)&&$("<img class='menuBeamIcon' data-section='"+o+"' src='"+s+"' title='&lt;dfn&gt;"+D.getSentence("section")+": &lt;/dfn&gt;"+r+"' />").appendTo(a).click(function(){$(e+" header.jsSection").each(function(){$(this).next().is(":visible")&&$(this).attr("id")!==n.attr("id")&&($(this).data("donotanimate",!0),$(this).trigger("click"))}),n.data("beamclicked",!0),n.trigger("click")})}),$("<img class='menuBeamIcon menuBeamIconCollapse' src='img/ui/exit.png' title='&lt;dfn&gt;"+D.getString("collapse section")+"&lt;/dfn&gt;' />").prependTo(a).click(function(){$(e+" header.jsSection").each(function(){$(this).next().is(":visible")&&$(this).trigger("click")}),$(e+" .menuBeamIcon").removeClass("menuBeamIconActive")}),I.qTip.init(e+" .menuBeamIcon")}},displaySectionMarkers:function(e,t){var n,i,a=$("#mapToggle_"+e);a.length&&(n=a.data("checked"),i=a.data("hideonly"),i?t||a.trigger("click"):t?n||(a.trigger("click"),a.data("checked",!0)):n&&(a.trigger("click"),a.data("checked",!1)))},loadImg:function(e){e.find("img").each(function(){$(this).attr("data-src")&&($(this)[0].src=$(this).data("src"))})},bindHelpButtons:function(e){$(e+" .jsHelpCollapsible").each(function(){$(this).text("[?+]").attr("title","<dfn>More Info</dfn>"),$(this).next().hide(),$(this).click(function(){$(this).next().toggle(),$(this).text($(this).next().is(":visible")?"[?-]":"[?+]")})}),$(e+" .jsHelpTooltip").each(function(){var e="<dfn>Info:</dfn> "+$(this).attr("title");$(this).text(I.Symbol.Help).attr("title",e)}),I.qTip.init(e+" .jsHelpCollapsible"),I.qTip.init(e+" .jsHelpTooltip")},toggleButtonState:function(e){var t=!e.data("checked");return e.data("checked",t),t},initializeUIforMenu:function(){!function(){var e=200,t=.5;$("#paneMenu").hover(function(){$("#paneMenu kbd").each(function(){$(this).is(":hover")||$(this).animate({opacity:t},e)})},function(){$("#paneMenu kbd").finish().each(function(){$(this).animate({opacity:1},e)})}),$("#paneMenu kbd").hover(function(){$(this).animate({opacity:1},e)},function(){$(this).animate({opacity:t},e)}).mousedown(function(){$(this).finish().css({opacity:t})}).mouseup(function(){$(this).finish().css({opacity:1})})}(),$("#paneMenu kbd").each(function(){$(this).click(function(){var e=$(this).attr("id");switch(I.PageCurrent=e.substring(I.cMenuPrefix.length-1,e.length),I.contentCurrentPlate=I.cPagePrefix+I.PageCurrent,I.MapCurrent===I.MapEnum.Mists&&(I.PagePrevious=I.PageCurrent),I.PageCurrent){case I.PageEnum.Map:I.isMapEnabled&&M.movePin(M.Pin.Event)}$("#paneContent article").hide(),I.ModeCurrent===I.ModeEnum.Website&&($(I.contentCurrentPlate+" .cntHeader").css({opacity:0}).animate({opacity:1},400),$(I.contentCurrentPlate).animate({width:"show"},200)),$(I.contentCurrentPlate).show(),U.updateQueryString(),I.isMapEnabled&&M.toggleLayer(M.ZoneCurrent.Layers.Path,I.PageCurrent!==I.PageEnum.Map&&O.Options.bol_showChainPaths)})}),$("#menuMap").one("click",I.loadMapPlate),$("#menuHelp").one("click",I.loadHelpPlate),T.isGenericCountdownSystemEnabled&&$("#menuChains").hover(function(){T.isGenericCountdownTickEnabled=!0,$("#itemMapCountdown").show().css({opacity:0}).animate({opacity:1},200)
},function(){T.isGenericCountdownTickEnabled=!1,$("#itemMapCountdown").hide()})},toggleMap:function(e){switch(e){case I.MapEnum.Tyria:$("#wvwPane").hide(),$("#mapPane").show(),M.refreshMap(),I.PageCurrent=I.PagePrevious,I.PagePrevious=I.SpecialPageEnum.WvW,I.MapCurrent=I.MapEnum.Tyria;break;case I.MapEnum.Mists:$("#mapPane").hide(),$("#wvwPane").show(),W.isMapInitialized&&W.refreshMap(),I.PagePrevious=I.PageCurrent,I.PageCurrent=I.SpecialPageEnum.WvW,I.MapCurrent=I.MapEnum.Mists}U.updateQueryString()},bindAfterAJAXContent:function(e){var t=I.cPagePrefix+e;I.generateSectionMenu(t),I.isMapEnabled&&I.initializeScrollbar($(t)),I.bindHelpButtons(t),M.bindMapLinks(t),U.convertExternalLink(t+" a"),I.qTip.init("button"),U.openSectionFromURL(),D.translatePageHeader(e)},loadMapPlate:function(){$("#plateMap").load(U.getPageSrc("map"),function(){I.bindAfterAJAXContent(I.PageEnum.Map),I.ModeCurrent===I.ModeEnum.Mobile&&$(".mapOnly").remove(),$("#headerMap_Daily").one("click",function(){G.generateAndInitializeDailies(),I.isSectionLoaded_Daily=!0}),$("#headerMap_Resource").one("click",function(){G.generateAndInitializeResources()}),$("#headerMap_JP").one("click",function(){G.generateAndInitializeJPs()}),$("#headerMap_Personal").one("click",function(){X.initializeDungeonChecklist(),X.initializeCustomChecklist()}),$("#headerMap_TP").one("click",function(){E.initializeCalculator(),E.initializeTrading(),E.initializeExchange()}),$("#headerMap_Notepad").one("click",function(){X.initializeNotepad()}),$("#headerMap_Collectible").one("click",function(){G.generateCollectiblesUI()}),$("#headerMap_Guild").one("click",function(){G.generateGuildUI()}),I.qTip.init("#plateMap label")})},loadHelpPlate:function(){$("#plateHelp").load(U.getPageSrc("help"),function(){I.bindAfterAJAXContent(I.PageEnum.Help),$(".jsCopyCode").click(function(){$(this).select()})})},initializeUIForHUD:function(){var e=200;$(".mapHUDContainer").each(function(){$(this).hover(function(){$(this).find(".cntComposition").show().animate({opacity:.8},e)},function(){$(this).find(".cntComposition").animate({opacity:0},e)})})},showHomeLink:function(){I.qTip.init($("<a title='&lt;dfn&gt;Switch back to full site.&lt;/dfn&gt;' href='./'> <img id='iconSimpleHome' src='img/ui/about.png' /></a>").appendTo("#itemHome"))},enforceProgramMode:function(){switch(I.ModeCurrent){case I.ModeEnum.Website:$("head").append("<link rel='alternate' media='only screen and (max-width: 640px)' href='http://gw2timer.com/?mode=Mobile'>");break;case I.ModeEnum.Overlay:$("#paneWarning").remove(),$("#itemMapCountdown, #mapQuickURL, #itemMapPeripheralSouth, #itemSocial").hide(),$("#jsConsole").css({top:"12px",left:"12px","font-size":"12px"}),$("#jsConsoleButtons").css({left:"0px",bottom:"0px"}),$("#itemMapCoordinates, #itemWvWCoordinates").css({bottom:"6px",left:"6px"}),$("#itemMapCoordinates input, #itemWvWCoordinates input").css({width:"80px",height:"12px",marginLeft:"5px",fontSize:12}),$("#mapCoordinatesName, #wvwCoordinatesName").css({width:"116px"}),$("#paneMenu").css({height:"32px"}),$("#paneMenu ins").css({"margin-top":"0px"}),$("#paneMenu var").each(function(){$(this).remove()}),I.cPANE_MENU_HEIGHT=32,$("#mapGPS, #wvwGPS").css({display:"inline-block"});break;case I.ModeEnum.Simple:I.isMapEnabled=!1,I.showHomeLink(),$("#panelMap, #paneMenu, #paneContent").hide(),$("#panelApp").css({background:"radial-gradient(ellipse at center, #333 0%, #222 50%, #111 100%)"}),$("#paneClock").css({top:"auto",right:"auto",bottom:"auto",left:"auto",border:"none","box-shadow":"none"}),I.readjustSimple(),$(window).resize(function(){I.readjustSimple()}),$("#paneClockWall, #paneClockBackground").css({opacity:0}),$("#itemSocial").hide(),$("#itemLanguage").css({position:"fixed",top:"10px",right:"10px",bottom:"auto",left:"auto"}),$("#itemLanguage span").css({opacity:.7}),$("#itemTimeLocal").css({width:"220px",right:"auto",bottom:"160px",left:"70px","text-align":"center",color:"#eee",opacity:.5}),$("#itemTimeDaytime").css({width:"220px",top:"160px",bottom:"auto",left:"70px","text-align":"center",color:"#eee",opacity:.5}),$("#paneBoard").show();break;case I.ModeEnum.Mobile:I.isMapEnabled=!1,I.isScrollEnabled=!0,I.showHomeLink(),$("head").append("<meta name='viewport' content='width=device-width, initial-scale=1' />").append("<link rel='stylesheet' type='text/css' href='gw2t-mobile.css' />").append("<link rel='canonical' href='http://gw2timer.com' />"),$("#chnOptionsRight").prependTo("#chnOptionsPopup");break;case I.ModeEnum.Tile:I.isMapEnabled=!1,K.iconOpacityChecked=.2,I.showHomeLink(),$("head").append("<meta name='viewport' content='width=device-width, initial-scale=1' />").append("<link rel='stylesheet' type='text/css' href='gw2t-tile.css' />"),$("#itemLanguage").prependTo("#plateChains"),I.initializeScrollbar("#windowMain"),$(window).resize(function(){I.readjustTile()})}$("#paneClockIcons img").addClass(I.ModeCurrent===I.ModeEnum.Website&&I.isProgramEmbedded===!1?"curZoom":"curClick"),I.isProgramEmbedded&&($("#paneWarning").remove(),$(".itemMapPeripheral a, .itemMapPeripheral span").hide(),T.isGenericCountdownSystemEnabled=!1),I.ModeCurrent!==I.ModeEnum.Website&&($("#itemLanguagePopup a").each(function(){var e=$(this).attr("href");$(this).attr("href",e+"&mode="+I.ModeCurrent)}),T.isGenericCountdownSystemEnabled=!1)},readjustSimple:function(){var e=$(window).height()/2,t=$(window).width()/2,n=I.cPANE_CLOCK_HEIGHT/2;$("#paneBoard").css({"margin-top":e-n-72}),$("#paneClock").css({"margin-top":e-n,"margin-left":t-n})},readjustTile:function(){if(I.ModeCurrent===I.ModeEnum.Tile){var e=T.stepFunction($(window).width(),14,22,400,3);$(".chnTitle h1").css({fontSize:e+"px"})}},initializeTooltip:function(){I.qTip.init("#jsConsoleButtons img, #chnOptions img, a, ins, kbd, span, fieldset, label, input, button"),$("#panelApp").hover(function(){I.isMouseOnPanel=!0},function(){I.isMouseOnPanel=!1})},qTip:{name:"qTip",offsetX:-180,offsetY:15,a:null,start:function(){if(!e)var e="qTip";var t=document.getElementById(e);t||(t=document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml","div"):document.createElement("div"),t.setAttribute("id",e),document.getElementsByTagName("body").item(0).appendChild(t)),document.getElementById&&(this.a=document.getElementById(this.name),this.a&&(document.onmousemove=$.throttle(I.cTOOLTIP_MOUSEMOVE_RATE,function(e){I.qTip.move(e)})))},init:function(e){var t,n=document.getElementById("qTip");$(e).each(function(){t=$(this)[0],n=t.getAttribute("title"),t&&n&&(t.setAttribute("tiptitle",n),t.removeAttribute("title"),t.removeAttribute("alt"),t.onmouseover=function(){I.qTip.show(this.getAttribute("tiptitle"))},t.onmouseout=function(){I.qTip.hide()})})},move:function(e){var t=e.pageX,n=e.pageY,i=$("#qTip").width(),a=$("#qTip").height(),r=$(window).width(),o=$(window).height();I.isMouseOnPanel?(I.qTip.offsetY=a+n+I.cTOOLTIP_ADD_OFFSET_Y>o?-a-I.cTOOLTIP_ADD_OFFSET_Y:I.cTOOLTIP_DEFAULT_OFFSET_Y,I.qTip.offsetX=i>=I.cTOOLTIP_OVERFLOW_WIDTH&&I.isMapEnabled&&O.Options.bol_alignPanelRight?r-t-I.cPANEL_WIDTH-I.cTOOLTIP_OVERFLOW_MAX:r-t>I.cPANEL_WIDTH/2?I.cTOOLTIP_ALTERNATE_OFFSET_X:I.cTOOLTIP_DEFAULT_OFFSET_X):(I.qTip.offsetX=t+I.cTOOLTIP_ADD_OFFSET_X+i>r&&i>I.cTOOLTIP_WIDTH_MAX?-i-I.cTOOLTIP_ADD_OFFSET_X:I.cTOOLTIP_ALTERNATE_OFFSET_X,I.qTip.offsetY=a-I.cTOOLTIP_ALTERNATE_OFFSET_X+n>o?-a-I.cTOOLTIP_ADD_OFFSET_Y:n<I.cTOOLTIP_ADD_OFFSET_Y?I.cTOOLTIP_DEFAULT_OFFSET_Y:-I.cTOOLTIP_ADD_OFFSET_Y),this.a.style.left=t+this.offsetX+"px",this.a.style.top=n+this.offsetY+"px"},show:function(e){this.a&&(this.a.innerHTML=e,this.a.style.display="block")},hide:function(){this.a&&(this.a.innerHTML="",this.a.style.display="none")}}},I.initializeFirst(),O.initializeOptions(),T.initializeSchedule(),P.initializeMap(),K.initializeClock(),I.initializeLast()});