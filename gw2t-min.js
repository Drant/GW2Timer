$(window).on("load",function(){var O,U,A,X,E,D,C,M,P,G,W,T,B,K,I={};O={lengthOfPrefixes:3,prefixOption:"opt_",legalLocalStorageKeys:[],isServerReset:!1,Utilities:{programVersion:{key:"int_utlProgramVersion",value:151208},lastLocalResetTimestamp:{key:"int_utlLastLocalResetTimestamp",value:0},BackupPins:{key:"obj_utlBackupPins",value:[]},BackupPinsWvW:{key:"obj_utlBackupPinsWvW",value:[]},StoredPins:{key:"obj_utlStoredPins",value:[]},StoredPinsWvW:{key:"obj_utlStoredPinsWvW",value:[]}},enforceProgramVersion:function(){var e=O.Utilities.programVersion.value,t=parseInt(localStorage[O.Utilities.programVersion.key]);if(isFinite(t)&&t!==e){var n=I.ModeCurrent===I.ModeEnum.Overlay?15:30;I.clear(),I.greet(I.cSiteName+" was updated since your last visit.<br />This version: "+e+"<br />Your version: "+t+"<br />Would you like to see the <a class='urlUpdates' href='"+U.URL_META.News+"'>changes</a>?<br />",n),U.convertExternalLink(".urlUpdates")}localStorage[O.Utilities.programVersion.key]=O.Utilities.programVersion.value},Options:{enu_Language:"en",enu_Server:"1008",bol_hideChecked:!1,bol_expandWB:!0,bol_collapseChains:!0,int_setClock:0,int_setDimming:0,int_setPredictor:0,bol_alignPanelRight:!0,bol_showPanel:!0,bol_showMap:!0,bol_showDashboard:!0,bol_showTimeline:!0,bol_showTimelineOpaque:!1,bol_hideHUD:!0,int_setFloor:1,int_setInitialZoom:3,int_setInitialZoomWvW:3,bol_showZoneBorders:!1,bol_showZoneGateways:!1,bol_showPersonalPaths:!0,bol_showChainPaths:!0,bol_tourPrediction:!0,bol_showWorldCompletion:!1,bol_showZoneOverview:!0,bol_displaySectors:!0,bol_displayWaypoints:!0,bol_displayPOIs:!0,bol_displayVistas:!0,bol_displayChallenges:!0,bol_displayHearts:!0,bol_displayEvents:!1,bol_showWorldCompletionWvW:!1,bol_showZoneOverviewWvW:!0,bol_displaySectorsWvW:!0,bol_displayWaypointsWvW:!0,bol_displayPOIsWvW:!0,bol_displayVistasWvW:!0,bol_displayChallengesWvW:!0,int_secWvWRefresh:10,int_numLogEntries:256,bol_logRedHome:!0,bol_logGreenHome:!0,bol_logBlueHome:!0,bol_logCenter:!0,bol_logNarrate:!1,bol_narrateRedHome:!0,bol_narrateGreenHome:!0,bol_narrateBlueHome:!0,bol_narrateCenter:!0,bol_narrateClaimed:!0,bol_narrateCamp:!0,bol_narrateTower:!0,bol_narrateKeep:!0,bol_narrateCastle:!0,bol_displayCharacter:!0,bol_followCharacter:!0,bol_displayCharacterWvW:!0,bol_followCharacterWvW:!1,int_msecGPSRefresh:100,int_setAlarm:0,int_setVolume:100,bol_alertArrival:!0,bol_alertAtStart:!0,bol_alertAtEnd:!0,bol_alertChecked:!1,int_alertSubscribedFirst:1,int_alertSubscribedSecond:15,bol_alertAutosubscribe:!0,bol_alertUnsubscribe:!0,int_minStopwatchAlert:5,str_textStopwatchAlert:"Alert, alert, alert!",int_sizeStopwatchFont:64,int_sizeNotepadFont:12,int_sizeNotepadHeight:400,bol_refreshPrices:!0,bol_useMainTPSearch:!0,int_numTradingCalculators:25,int_numTradingResults:30,int_secTradingRefresh:60,bol_clearChainChecklistOnReset:!0,bol_clearPersonalChecklistOnReset:!0,bol_use24Hour:!0,bol_detectDST:!0,bol_useSiteTag:!0},OptionRange:{},LanguageCode:{en:"en-US",de:"de-DE",es:"es-ES",fr:"fr-FR",cs:"cs-CZ",it:"it-IT",pl:"pl-PL",pt:"pt-BR",ru:"ru-RU",zh:"zh-CN"},OptionEnum:{Language:{Default:"en",English:"en",German:"de",Spanish:"es",French:"fr",Czech:"cs",Italian:"it",Polish:"pl",Portuguese:"pt",Russian:"ru",Mandarin:"zh"},Server:{AnvilRock:"1001",BorlisPass:"1002",YaksBend:"1003",HengeofDenravi:"1004",Maguuma:"1005",SorrowsFurnace:"1006",GateofMadness:"1007",JadeQuarry:"1008",FortAspenwood:"1009",EhmryBay:"1010",StormbluffIsle:"1011",Darkhaven:"1012",SanctumofRall:"1013",CrystalDesert:"1014",IsleofJanthir:"1015",SeaofSorrows:"1016",TarnishedCoast:"1017",NorthernShiverpeaks:"1018",Blackgate:"1019",FergusonsCrossing:"1020",Dragonbrand:"1021",Kaineng:"1022",DevonasRest:"1023",EredonTerrace:"1024",FissureofWoe:"2001",Desolation:"2002",Gandara:"2003",Blacktide:"2004",RingofFire:"2005",Underworld:"2006",FarShiverpeaks:"2007",WhitesideRidge:"2008",RuinsofSurmia:"2009",SeafarersRest:"2010",Vabbi:"2011",PikenSquare:"2012",AuroraGlade:"2013",GunnarsHold:"2014",JadeSea:"2101",FortRanik:"2102",AuguryRock:"2103",VizunahSquare:"2104",Arborstone:"2105",Kodash:"2201",Riverside:"2202",ElonaReach:"2203",AbaddonsMouth:"2204",DrakkarLake:"2205",MillersSound:"2206",Dzagonur:"2207",BaruchBay:"2301"}},IntEnum:{Predictor:{Auto:0,Min:1,MinAvg:2,Avg:3},Clock:{Compact:0,Full:1,Bar:2,None:3},Alarm:{Off:0,Checklist:1,Subscription:2}},validateEnum:function(e,t){var n,i=O.OptionEnum[U.getVariableSuffix(e)];for(n in i)if(i[n]===t)return t;return O.Options[e]},TypeEnum:{isBoolean:"bol",isInteger:"int",isFloat:"flt",isEnum:"enu",isString:"str"},initializeLegalLocalStorageKeys:function(){var e;for(e in O.Utilities)O.legalLocalStorageKeys.push(O.Utilities[e].key);for(e in O.Options)O.legalLocalStorageKeys.push(e);for(e in X.Checklists)O.legalLocalStorageKeys.push(X.Checklists[e].key);for(e in X.Collectibles)O.legalLocalStorageKeys.push(X.Collectibles[e].key);for(e in X.Textlists)O.legalLocalStorageKeys.push(X.Textlists[e].key)},cleanLocalStorage:function(){var e,t,n,i;for(e=0;e<localStorage.length;e++){n=localStorage.key(e);for(t in O.legalLocalStorageKeys)if(n===O.legalLocalStorageKeys[t]){i=!0;break}i!==!0?localStorage.removeItem(n):i=!1}},convertLocalStorageDataType:function(e){var t=e.toLowerCase();return"true"===t?!0:"false"===t?!1:isFinite(t)?t%0===0?parseInt(t):parseFloat(t):e},getObjectLength:function(e){var t=0;for(var n in e)t++;return t},intToBool:function(e){return e>0?!0:!1},boolToInt:function(e){return e?1:0},stringToBool:function(e){return"true"===e.toLowerCase()?!0:!1},boolToString:function(e){return e?"true":"false"},randomBool:function(){return Math.random()>.5?!0:!1},isInteger:function(e){return!isNaN(e)&&function(e){return(0|e)===e}(parseFloat(e))},objToBool:function(e){return e?!0:!1},updateLocalResetTimestamp:function(){O.Utilities.lastLocalResetTimestamp.value=T.getUNIXSeconds(),localStorage[O.Utilities.lastLocalResetTimestamp.key]=O.Utilities.lastLocalResetTimestamp.value},checkResetTimestamp:function(e){var t=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Seconds),n=T.getUNIXSeconds()-t,i=n-T.cSECONDS_IN_DAY*e.getUTCDay(),a=0===t,r=O.Utilities.lastLocalResetTimestamp.value<i;O.Utilities.lastLocalResetTimestamp.value<n&&O.clearServerSensitiveOptions(a,r)},getIndexOfSelectedRadioButton:function(e){var t=$("fieldset[name="+e+"] input:radio[name="+e+"]");return t.index(t.filter(":checked"))},initializeOptions:function(){O.initializeLegalLocalStorageKeys();var e,t,n,i;for(e in O.Options)i=$("#"+O.prefixOption+e),t=i.attr("type"),n=U.getVariablePrefix(e),"radio"===t?O.OptionRange[e]=new Array(0,$("fieldset[name="+e+"] input").length-1):("number"===t||"range"===t)&&(O.OptionRange[e]=new Array(i.prop("min"),i.prop("max"))),I.isProgramEmbedded?void 0!==U.Args[e]&&n!==O.TypeEnum.isString&&(O.Options[e]=O.convertLocalStorageDataType(U.sanitizeURLOptionsValue(e,U.Args[e]))):(void 0!==U.Args[e]&&n!==O.TypeEnum.isString&&(localStorage[e]=U.sanitizeURLOptionsValue(e,U.Args[e])),void 0===localStorage[e]?localStorage[e]=O.Options[e]:O.Options[e]=O.convertLocalStorageDataType(localStorage[e])),"checkbox"===t?i.prop("checked",O.Options[e]):"number"===t||"range"===t?i.val(O.Options[e]):"radio"===t?$("input:radio[name="+e+"]:eq("+O.Options[e]+")").prop("checked",!0):i.val(O.Options[e]),"radio"===t?$("fieldset[name="+e+"]").change(function(){var e=$(this).attr("name");O.Options[e]=O.getIndexOfSelectedRadioButton(e),localStorage[e]=O.Options[e]}):i.change(function(){var e=$(this).attr("type"),t=$(this).attr("id").slice(O.prefixOption.length);if("checkbox"===e)O.Options[t]=$(this).prop("checked");else if("number"===e||"range"===e){var n=$(this).val(),i=parseInt(n);isFinite(n)&&i>=O.OptionRange[t][0]&&i<=O.OptionRange[t][1]?O.Options[t]=i:O.Options[t]=O.OptionRange[t][0],$(this).val(O.Options[t])}else O.Options[t]=$(this).val();localStorage[t]=O.Options[t]});O.bindOptionsInputs(),U.initializeAPIURLs()},clearServerSensitiveOptions:function(e,t){O.isServerReset=!0;var n=10,i=e?"Daily Reset!":"Daily Timestamp Expired!";if(I.greet(i,n),t){var a=e?"Weekly Reset!":"Weekly Timestamp Expired!";I.greet(a,n)}T.getDaily({isReset:!0});var r,o;if(O.Options.bol_clearChainChecklistOnReset){for(r in C.Chains)o=C.Chains[r],$("#chnCheck_"+o.nexus).removeClass("chnChecked"),$("#chnBar_"+o.nexus).css({opacity:1}),X.getChecklistItem(X.Checklists.Chain,o.nexus)!==X.ChecklistEnum.Disabled&&$("#chnBar_"+o.nexus).show();X.clearChecklist(X.Checklists.Chain,X.ChecklistJob.UncheckTheChecked)}O.Options.bol_clearPersonalChecklistOnReset&&(X.clearCustomChecklistDaily(),t&&X.clearCustomChecklistWeekly()),I.isSectionLoaded_Daily&&G.generateAndInitializeDailies(),I.write("",n),O.updateLocalResetTimestamp()},bindOptionsInputs:function(){var e;for(e in O.Enact)!function(e){var t,n=O.prefixOption+e,i=$("#"+n).attr("type");t="radio"===i?"fieldset[name="+e+"]":"#"+n,$(t).change(function(){O.Enact[e]()})}(e);$("#opt_bol_showWorldCompletion").change(function(){O.Options.bol_showWorldCompletion===!0&&M.isMappingIconsGenerated===!1&&location.reload(),$("#mapOptionsCompletion label input").each(function(){X.setCheckboxEnumState($(this),X.boolToChecklistEnum(O.Options.bol_showWorldCompletion))})}),$("#opt_bol_showWorldCompletionWvW").change(function(){O.Options.bol_showWorldCompletionWvW===!0&&W.isMappingIconsGenerated===!1&&location.reload(),$("#wvwOptionsCompletion label input").each(function(){X.setCheckboxEnumState($(this),X.boolToChecklistEnum(O.Options.bol_showWorldCompletionWvW))})}),$("#opt_bol_displayEvents").change(function(){O.Options.bol_displayEvents===!0&&M.isEventIconsGenerated===!1&&location.reload(),M.isEventIconsGenerated&&M.refreshCurrentZone()}),$("#mapOptionsCompletion label input").each(function(){$(this).change(function(){M.isAPIRetrieved_MAPFLOOR&&M.refreshCurrentZone()})}),$("#wvwOptionsCompletion label input").each(function(){$(this).change(function(){W.isAPIRetrieved_MAPFLOOR&&W.refreshCurrentZone()})}),O.Enact.int_setAlarm(),O.Enact.bol_detectDST(),O.Enact.bol_useSiteTag(),O.Enact.bol_alignPanelRight(!0),O.Enact.bol_showPanel(),O.Enact.bol_showTimeline(),I.ModeCurrent!==I.ModeEnum.Simple&I.ModeCurrent!==I.ModeEnum.Tile&&(O.Enact.int_setClock(),O.Enact.int_setDimming(),O.Enact.bol_showMap()),$("#optRestoreAllChains").click(function(){var e,t=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";for(var n in C.Chains)e=C.Chains[n],$("#chnCheck_"+e.nexus).removeClass("chnChecked"),$("#chnBar_"+e.nexus).show().css({opacity:1}).css({display:t}),C.isTimetableGenerated&&$(".chnSlot_"+e.nexus).show().css({opacity:1}).css({display:t}).find(".chnCheck").removeClass("chnChecked");for(X.clearChecklist(X.Checklists.Chain),n=0;n<T.cNUM_TIMEFRAMES_IN_HOUR;n++){K.checkoffChainIcon(T.getStandardChain(n).nexus);var i=T.getHardcoreChain(n);i&&K.checkoffChainIcon(i.nexus)}}),$("#optChainsExpand").click(function(){$(".chnDetails").show()}),$("#optChainsCollapse").click(function(){$(".chnDetails").hide(),I.scrollToElement("#plateChains")}),$("#optClearLocalStorage").click(function(){confirm(I.cSiteName+" Reset: This is will clear all options and everything you have written in this website. Continue?")&&(localStorage.clear(),location.reload())}),$("#optPrintLocalStorage").click(function(){var e,t=[];for(e=0;e<localStorage.length;e++){var n=U.escapeHTML(localStorage.key(e));t.push(n)}t.sort();var i="";for(e in t){var a=U.escapeHTML(localStorage.getItem(t[e]));i+=t[e]+": "+a+"<br />"}I.write(i,0,!0)})},Enact:{int_setAlarm:function(){var e="img/ui/placeholder.png";switch(O.Options.int_setAlarm){case O.IntEnum.Alarm.Checklist:e="img/ui/check.png";break;case O.IntEnum.Alarm.Subscription:e="img/ui/subscription.png"}O.Options.int_setAlarm===O.IntEnum.Alarm.Off?$("#optAlarmSpeaker").attr("src","img/ui/mute.png"):$("#optAlarmSpeaker").attr("src","img/ui/speaker.png"),$("#optAlarmIcon").attr("src",e)},int_setVolume:function(){D.isSpeaking()===!1&&D.speak(D.getWord("alarm"))},bol_logNarrate:function(){O.Options.bol_logNarrate===!1&&D.stopSpeech()},bol_hideChecked:function(){$(".chnBar").each(function(){X.hideCheckedChainBar(U.getSubintegerFromHTMLID($(this)))})},bol_expandWB:function(){for(var e in C.CurrentChains)C.isChainRegular(C.CurrentChains[e])&&$("#chnDetails_"+C.CurrentChains[e].nexus).toggle(O.Options.bol_expandWB)},bol_use24Hour:function(){C.initializeTimetableHTML(),C.updateChainsTimeHTML(),K.updateDigitalClockMinutely(),B.updateTimelineLegend()},bol_detectDST:function(){T.checkDST()},int_setClock:function(){K.setClock()},int_setDimming:function(){switch(O.Options.int_setDimming){case 1:$("#paneClockBackground").css({opacity:1});break;case 2:$("#paneClockBackground").css({opacity:0})}},int_setFloor:function(){M.changeFloor(O.Options.int_setFloor)},int_setInitialZoom:function(){M.Map.setZoom(O.Options.int_setInitialZoom)},int_setInitialZoomWvW:function(){W.Map.setZoom(O.Options.int_setInitialZoomWvW)},bol_showZoneBorders:function(){P.drawZoneBorders()},bol_showZoneGateways:function(){P.drawZoneGateways()},bol_showPersonalPaths:function(){M.isMapInitialized&&M.drawPersonalPath(),W.isMapInitialized&&W.drawPersonalPath()},bol_showChainPaths:function(){M.toggleLayerArray(P.LayerArray.ChainPath,O.Options.bol_showChainPaths)},bol_displayCharacter:function(){O.Options.bol_displayCharacter?(P.tickGPS(),P.updateCharacter(0)):(M.movePin(M.Pin.Character),M.movePin(M.Pin.Camera))},bol_displayCharacterWvW:function(){O.Options.bol_displayCharacterWvW?(P.tickGPS(),P.updateCharacter(0)):(W.movePin(W.Pin.Character),W.movePin(W.Pin.Camera))},bol_showPanel:function(){O.Options.bol_showMap&&I.isMapEnabled&&($("#panelApp").toggle(O.Options.bol_showPanel),M.refreshMap(),W.isMapInitialized&&W.refreshMap())},bol_alignPanelRight:function(e){I.isMapEnabled&&(O.Options.bol_alignPanelRight?e!==!0&&($("#panelApp").insertAfter("#panelMap"),$(".paneApp").css({right:"0px",borderLeft:"1px solid #444",borderRight:"none",boxShadow:"-5px 0px 5px #223"}),$("#itemLanguagePopup").css({left:"-98px"}),$("#cslContent").css({left:"24px"})):($("#panelApp").insertBefore("#panelMap"),$(".paneApp").css({right:"auto",borderLeft:"none",borderRight:"1px solid #444",boxShadow:"5px 0px 5px #223"}),$("#itemLanguagePopup").css({left:"64px"}),$("#cslContent").css({left:I.cPANEL_WIDTH+24+"px"})))},bol_showMap:function(){I.isMapEnabled&&($("#panelMap").toggle(O.Options.bol_showMap),M.refreshMap())},bol_hideHUD:function(){O.Options.bol_hideHUD===!1&&$("#mapHUDBoxes").show()},bol_showTimeline:function(){if(O.Options.bol_showTimeline){if(B.isTimelineGenerated)return void B.toggleTimeline(!0);B.generateTimeline(),O.Enact.bol_showTimelineOpaque()}else B.toggleTimeline(!1)},bol_showTimelineOpaque:function(){var e;e=O.Options.bol_showTimelineOpaque?I.ModeCurrent===I.ModeEnum.Overlay?"linear-gradient(to right, #111 0%, #383838 50%, #111 100%)":"rgba(0, 0, 0, 0.6)":"none",$("#itemTimeline").css({background:e})},bol_refreshPrices:function(){O.Options.bol_refreshPrices&&E.isTradingCalculatorsInitialized?E.loopRefresh():E.cancelLoopRefresh()},bol_useSiteTag:function(){O.Options.bol_useSiteTag?I.siteTagCurrent=I.siteTagDefault:I.siteTagCurrent=""}}},U={URL_META:{News:"http://forum.renaka.com/topic/5500046/",Overlay:"http://forum.renaka.com/topic/5546166/"},URL_API:{Daily:"https://api.guildwars2.com/v2/achievements/daily",Tomorrow:"https://api.guildwars2.com/v2/achievements/daily/tomorrow",Fractal:"https://api.guildwars2.com/v2/achievements/categories/88",LangKey:"",TilesTyria:"https://tiles.guildwars2.com/1/1/{z}/{x}/{y}.jpg",TilesMists:"https://tiles.guildwars2.com/2/1/{z}/{x}/{y}.jpg",MapFloorTyria:"https://api.guildwars2.com/v1/map_floor.json?continent_id=1&floor=1",MapFloorMists:"https://api.guildwars2.com/v1/map_floor.json?continent_id=2&floor=1",MapsList:"https://api.guildwars2.com/v1/maps.json",EventNames:"https://api.guildwars2.com/v1/event_names.json",EventDetails:"https://api.guildwars2.com/v1/event_details.json",ItemListing:"https://api.guildwars2.com/v2/commerce/listings/",ItemPrices:"https://api.guildwars2.com/v2/commerce/prices/",ItemDatabase:"https://api.guildwars2.com/v2/items",ItemDetails:"https://api.guildwars2.com/v2/items/",ItemRender:"https://render.guildwars2.com/file/",CoinPrice:"https://api.guildwars2.com/v2/commerce/exchange/gems?quantity=",GemPrice:"https://api.guildwars2.com/v2/commerce/exchange/coins?quantity=",ItemSearch:"http://www.gw2spidy.com/api/v0.9/json/item-search/",ItemSearchFallback:"http://www.gw2shinies.com/api/json/idbyname/",Match:"https://api.guildwars2.com/v2/wvw/matches?world=",Matches:"https://api.guildwars2.com/v2/wvw/matches/",GuildDetails:"https://api.guildwars2.com/v1/guild_details.json?guild_id=",Prefix:"https://api.guildwars2.com/v2/",TextToSpeech:"http://code.responsivevoice.org/getvoice.php?tl="},URL_IMG:{Placeholder:"img/ui/placeholder.png",Waypoint:"img/map/waypoint.png",WaypointOver:"img/map/waypoint_h.png",Landmark:"img/map/landmark.png",LandmarkOver:"img/map/landmark_h.png",Vista:"img/map/vista.png",Challenge:"img/map/challenge.png",Heart:"img/map/heart.png"},URL_DATA:{WvW:"data/wvw.js",Itinerary:"data/itinerary.js",Unscheduled:"data/chains-add.js",Daily:"data/daily.js",DryTop:"data/drytop.js",Resource:"data/resource.js",JP:"data/jp.js",Collectible:"data/collectible.js",Guild:"data/guild.js"},initializeAPIURLs:function(){var e=D.getPartiallySupportedLanguage();U.URL_API.LangKey="?lang="+e;var t="&lang="+e;U.URL_API.MapFloorTyria+=t,U.URL_API.MapFloorMists+=t,U.URL_API.EventNames+=t,U.URL_API.TextToSpeech+=e+"&sv=&vn=&pitch=0.5&rate=0.4&vol=1&t="},Args:{},KeyEnum:{Page:"page",Section:"section",Article:"article",Mode:"mode",Go:"go",Draw:"draw"},CaseEnum:{Original:-1,None:0,Lower:1,Sentence:2,Title:3,Every:4,All:5},interpretCommand:function(e,t,n,i){0===e.indexOf(I.cConsoleCommandPrefix)?U.parseConsoleCommand(e,t):t.parsePersonalPath(e)===!1&&t.goToArguments(e,n,i)},parseConsoleCommand:function(e,t){var n=t,i=e.substring(1,e.length).split(" "),a=e.substring(e.indexOf(" ")+1,e.length),r=i[0].toLowerCase(),o={clear:{usage:"Clears the console screen.",f:function(){I.clear()}},speak:{usage:"Speaks the given text. <em>Parameters: str_text</em>",f:function(){D.speak(a)}},gps:{usage:"Prints GPS location information.",f:function(){I.write("Position: "+GPSPositionArray+"<br />Direction: "+GPSDirectionArray+"<br />Camera: "+GPSCameraArray)}},identity:{usage:"Prints GPS general information.",f:function(){I.write(U.formatJSON(GPSIdentityJSON),0)}},lock:{usage:"Map cannot be moved.",f:function(){n.Map.dragging.disable(),n.Map.scrollWheelZoom.disable(),I.write("Map locked.")}},unlock:{usage:"Map can be moved.",f:function(){n.Map.dragging.enable(),n.Map.scrollWheelZoom.enable(),I.write("Map unlocked.")}},nct:{usage:"Disables the map's context menu.",f:function(){n.Map.off("contextmenu"),I.write("Map context menu disabled.")}},dart:{usage:"Draws personal pins at random map locations. <em>Parameters: int_quantity</em>",f:function(){n.drawRandom(i[1])}},nodes:{usage:"Prints a list of ordered coordinates. <em>Parameters: arr_coordinates</em>",f:function(){P.printNodes(P.sortCoordinates(M.parseCoordinatesMulti(i[1])))}},decode:{usage:"Decodes a chatlink to a number ID. <em>Parameters: str_chatlink</em>",f:function(){I.write(U.getGameIDFromChatlink(i[1],!0),0)}},api:{usage:"Prints the output of an API URL &quot;"+U.URL_API.Prefix+"&quot;. <em>Parameters: str_apiurlsuffix, int_limit (optional), str_querystring (optional)</em>",f:function(){U.printAPI(i[1],i[2],i[3])}},daily:{usage:"Prints the daily achievements.",f:function(){U.printDaily()}},item:{usage:"Prints an item's information. <em>Parameters: int_itemid</em>",f:function(){U.printAPI("items/"+i[1])}},items:{usage:"Prints the highest numbered item IDs in the API. <em>Parameters: int_offset</em>",f:function(){U.printItemsAPI(i[1])}},events:{usage:"Prints the event names of the current zone, dynamic events option must be enabled.",f:function(){P.printZoneEvents()}},help:{usage:"Prints this help message.",f:function(){I.write("Available console commands:<br />");var e="";for(var t in o)e+="<b>"+t+"</b> - "+o[t].usage+"<br />";I.write(e,0)}},test:{usage:"Test function for debugging.",f:function(){}}};void 0!==o[r]&&o[r].f()},printAPI:function(e,t,n){I.write("Gathering elements..."),t=parseInt(t)||Number.POSITIVE_INFINITY;var i=[],a=0,r=0,o=void 0===n?"":n,s=U.URL_API.Prefix+e;$.get(s+o,function(e){if(a=e.length,Array.isArray(e))for(var n in e){if(parseInt(n)===t)break;$.getJSON(s+"/"+e[n]+o,function(e){I.write("Retrieved an element."),i.push(U.formatJSON(e))}).done(function(){if(r===a-1||r===t-1){I.clear(),i.sort();for(var e in i)I.write(i[e],0)}r++}).fail(function(){I.write("Unable to retrieve API array element at: "+U.escapeHTML(s+"/"+e[n]))})}else I.write(U.formatJSON(e),0,!0)}).fail(function(){I.write("Unable to retrieve API at: "+U.escapeHTML(s))})},printItemsAPI:function(e){if(O.isInteger(e)===!1)return void I.write("Invalid reverse index.");if(I.write("Retrieving items..."),e=parseInt(e),0===E.ItemsArray.length)$.get(U.URL_API.ItemDatabase,function(e){E.ItemsArray=e}).done(function(){U.printItemsAPI(e)}).fail(function(){I.write("Unable to retrieve API items database.")});else{var t=0,n=0;if(0>=e)n=E.ItemsArray.length+e-1,t=E.ItemsArray[n],$.getJSON(U.URL_API.ItemDetails+t,function(e){I.clear(),I.write("<img class='cssLeft' src='"+e.icon+"' />"+U.formatJSON(e),0)}).fail(function(){I.write("Unable to retrieve item: "+n)});else{I.clear();for(var i=0;e>i;i++)n=E.ItemsArray.length-e-1-i,t=E.ItemsArray[n],$.getJSON(U.URL_API.ItemDetails+t,function(e){I.write("<img class='cssLeft' src='"+e.icon+"' />"+U.formatJSON(e),0)}).fail(function(){I.write("Unable to retrieve item: "+n)})}}},printDaily:function(){if(null!==T.DailyToday){var e=T.DailyToday,t="pve: [&quot;"+e.pve[0]+"&quot;, &quot;"+e.pve[1]+"&quot;, &quot;"+e.pve[2]+"&quot;, &quot;"+e.pve[3]+"&quot;],<br />pvp: [&quot;"+e.pvp[0]+"&quot;, &quot;"+e.pvp[1]+"&quot;, &quot;"+e.pvp[2]+"&quot;, &quot;"+e.pvp[3]+"&quot;],<br />wvw: [&quot;"+e.wvw[0]+"&quot;, &quot;"+e.wvw[1]+"&quot;, &quot;"+e.wvw[2]+"&quot;, &quot;"+e.wvw[3]+"&quot;]";I.write(t,0)}else I.write("API daily achievements object is invalid.")},isEnumWithin:function(e,t){for(var n in t)if(t[n].toLowerCase()===e.toLowerCase())return!0;return!1},getURLArguments:function(){var e=window.location.search.substr(1).split("&");if(""===e)return{};for(var t={},n=0;n<e.length;++n){var i=e[n].split("=");2===i.length&&(t[i[0]]=decodeURIComponent(i[1].replace(/\+/g," ")))}return t},enforceURLArgumentsFirst:function(){U.Args=U.getURLArguments(),U.enforceURLArgumentsSpecial();var e,t=U.Args[U.KeyEnum.Mode];if(t)for(e in I.ModeEnum)if(I.ModeEnum[e].toLowerCase()===t.toLowerCase()){I.ModeCurrent=I.ModeEnum[e];break}null===I.ModeCurrent&&(I.ModeCurrent=I.ModeEnum.Website),I.ArticleCurrent=U.Args[U.KeyEnum.Article]},enforceURLArgumentsLast:function(){U.openPageFromURL()},enforceURLArgumentsSpecial:function(){var e,t,n,i=function(e){$("body").hide(),document.location=e},a=U.Args[U.KeyEnum.Page];if(a&&U.isEnumWithin(a,I.PageEnum)===!1)if(a=a.toLowerCase(),"navi"===a||"overlay"===a)i(U.URL_META.Overlay);else if("m"===a||"mobile"===a)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Mobile;else if("s"===a||"simple"===a)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Simple;else if("t"===a||"tile"===a)U.Args[U.KeyEnum.Mode]=I.ModeEnum.Tile;else{for(e in I.SectionEnum){n=I.SectionEnum[e];for(t in n)if(t.toLowerCase()===a)return void 0!==U.Args[U.KeyEnum.Section]&&(U.Args[U.KeyEnum.Article]=U.Args[U.KeyEnum.Section]),U.Args[U.KeyEnum.Page]=e,void(U.Args[U.KeyEnum.Section]=t)}for(e in M.Zones)if(-1!==a.indexOf(e))return void(U.Args[U.KeyEnum.Go]=e)}for(e in X.Collectibles)if(n=X.Collectibles[e].urlkey,n===a||void 0!==U.Args[n])return U.Args[U.KeyEnum.Page]=I.PageEnum.Map,U.Args[U.KeyEnum.Section]=I.SectionEnum.Map.Collectible,void(U.Args[U.KeyEnum.Article]=n)},sanitizeURLOptionsValue:function(e,t){var n=e.substring(0,O.lengthOfPrefixes),i=t.toLowerCase();switch(n){case O.TypeEnum.isBoolean:return"true"===i||"false"===i?i:O.Options[e].toString();case O.TypeEnum.isInteger:if(isFinite(i)){var a=parseInt(i);if(a>=O.OptionRange[e][0]&&a<=O.OptionRange[e][1])return a.toString()}return O.Options[e].toString();case O.TypeEnum.isFloat:if(isFinite(i)){var r=parseFloat(i);if(r>=O.OptionRange[e][0]&&r<=O.OptionRange[e][1])return r.toString()}return O.Options[e].toString();case O.TypeEnum.isEnum:return O.validateEnum(e,t);case O.TypeEnum.isString:return U.escapeHTML(t)}return"null"},formatJSON:function(e){return JSON.stringify(e,null,2)},stripToAlphanumeric:function(e){return e.replace(/\W/g,"")},stripToSentence:function(e){return e.replace(/[^\w\s\'\"\:\,]/gi,"")},stripToCalculation:function(e){return e.replace(/[^0-9.()\-+\/*]/gi,"")},toFirstUpperCase:function(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},toCase:function(e,t){var n,i=[];if(void 0===t||t===U.CaseEnum.None)return e;switch((t===U.CaseEnum.Title||t===U.CaseEnum.Every)&&(i=e.split(" ")),t){case U.CaseEnum.Lower:return e.toLowerCase();case U.CaseEnum.Sentence:return U.toFirstUpperCase(e);case U.CaseEnum.Title:if(i.length>1){for(i[0]=U.toFirstUpperCase(i[0]),n=1;n<i.length;n++)2!==i[n].length&&(i[n]=U.toFirstUpperCase(i[n]));return i.join(" ")}return U.toFirstUpperCase(e);case U.CaseEnum.Every:if(i.length>1){for(n in i)i[n]=U.toFirstUpperCase(i[n]);return i.join(" ")}return U.toFirstUpperCase(e);case U.CaseEnum.All:return e.toUpperCase()}return e},truncateString:function(e,t,n){return n=n||"",e.length>t?e.substring(0,t)+n:e},wrapSubstringHTML:function(e,t,n){var i=e.toLowerCase().indexOf(t.toLowerCase()),a=i+t.length,r="";return-1!==i?(void 0===n&&(n="u"),r=e.substring(0,i)+"<"+n+">"+e.substring(i,a)+"</"+n+">"+e.substring(a,e.length)):r=e,r},escapeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},replaceCharAt:function(e,t,n){return e.substr(0,t)+n+e.substr(t+n.length)},repeatChar:function(e,t){return Array(t+1).join(e)},countOccurrence:function(e,t){return e.split(t).length-1},updateAddressBar:function(e){history.replaceState("",null,e),K.reapplyFilters()},updateQueryString:function(e){if(""!==I.PageCurrent){var t=I[I.sectionPrefix+I.PageCurrent],n=I.ArticleCurrent,i=U.Args[U.KeyEnum.Go],a="?"+U.KeyEnum.Page+"="+I.PageCurrent,r="",o="",s="",c="";e=void 0===e?"":"&"+e;var l=I.PageCurrent;I.ModeCurrent!==I.ModeEnum.Website&&(c="&mode="+I.ModeCurrent),t&&(r="&"+U.KeyEnum.Section+"="+t,l=t),n&&(o="&"+U.KeyEnum.Article+"="+n),i&&(s="&"+U.KeyEnum.Go+"="+i),U.updateAddressBar(a+r+o+s+c+e),U.updateTitle(l),U.updateLanguageLinks(a+r+c)}},updateTitle:function(e){document.title=I.cSiteName+"/"+e},updateLanguageLinks:function(e){$(".linkLanguage").each(function(){var t=$(this).attr("data-lang"),n="";n=void 0===e?I.ModeCurrent===I.ModeEnum.Website?"?enu_Language="+t:"?enu_Language="+t+"&mode="+I.ModeCurrent:e+"&enu_Language="+t,$(this).attr("href","./"+n)})},openSectionFromURL:function(){setTimeout(function(){if(void 0!==U.Args[U.KeyEnum.Section]){var e=U.stripToAlphanumeric(U.Args[U.KeyEnum.Section]),t=$(I.cHeaderPrefix+I.PageCurrent+"_"+U.toFirstUpperCase(e));t.length||(t=$(I.cHeaderPrefix+I.PageCurrent+"_"+e.toUpperCase())),I.PageCurrent===I.PageEnum.Chains&&$("#headerChains_Scheduled").trigger("click"),t.trigger("click")}},0)},openPageFromURL:function(){if(void 0!==U.Args[U.KeyEnum.Page]){var e=U.stripToAlphanumeric(U.Args[U.KeyEnum.Page]);for(var t in I.PageEnum)if(e.toLowerCase()===I.PageEnum[t].toLowerCase())return void $(I.cMenuPrefix+I.PageEnum[t]).trigger("click");switch(e=e.toLowerCase()){case"wvw":$("#mapSwitchButton").trigger("click")}}},convertExternalLink:function(e){$(e).each(function(){$(this).attr("href",I.cSiteURL+"out/?u="+U.encodeURL($(this).attr("href"))),$(this).attr("target","_blank")})},convertExternalURL:function(e){return I.cSiteURL+"out/?u="+U.encodeURL(e)},convertExternalAnchor:function(e){return" href='"+I.cSiteURL+"out/?u="+U.encodeURL(e)+"' target='_blank' "},openExternalURL:function(e){var t=e;I.ModeCurrent!==I.ModeEnum.Overlay&&(t=I.cSiteURL+"out/?u="+U.encodeURL(e)),window.open(t,"_blank")},getVariableSuffix:function(e){var t=e.indexOf("_");return e.substring(t+1,e.length)},getVariablePrefix:function(e){var t=e.indexOf("_");return e.substring(0,t)},getSubstringFromHTMLID:function(e){return U.getVariableSuffix(e.attr("id"))},getSubintegerFromHTMLID:function(e){return parseInt(U.getVariableSuffix(e.attr("id")))},getPageSrc:function(e){return e.toLowerCase()+"src.html"},getImageHosted:function(e){return I.cImageHost+e+I.cPNG},encodeURL:function(e){return encodeURI(e).replace(/'/g,"%27")},getWikiLink:function(e){return e=e.replace(/ /g,"_"),"http://wiki.guildwars2.com/wiki/"+U.encodeURL(e)},getWikiLanguageLink:function(e){return e=e.replace(/ /g,"_"),"http://wiki-"+D.getFullySupportedLanguage()+".guildwars2.com/wiki/"+U.encodeURL(e)},getWikiSearchLink:function(e){return e=e.replace(/ /g,"+"),"http://wiki.guildwars2.com/index.php?title=Special%3ASearch&search="+U.encodeURL(e)},getGW2OfficialLink:function(e){return"https://www.guildwars2.com/"+D.getFullySupportedLanguage()+"/"+e},getYouTubeLink:function(e){return"http://www.youtube.com/results?search_query="+U.encodeURL(e)},getTradingSearchLink:function(e){return"https://www.gw2tp.com/search?name="+U.encodeURL(e)},getTradingItemLink:function(e,t){return"http://www.gw2spidy.com/item/"+U.encodeURL(e)+"#"+U.stripToSentence(t)},getChatlinkFromPoiID:function(e){for(var t=String.fromCharCode(4),n=0;4>n;n++)t+=String.fromCharCode(e>>8*n&255);return"[&"+btoa(t)+"]"},getChatlinkFromItemID:function(e){var t="";try{t="[&"+btoa(String.fromCharCode(2)+String.fromCharCode(1)+String.fromCharCode(e%256)+String.fromCharCode(Math.floor(e/256))+String.fromCharCode(0)+String.fromCharCode(0))+"]"}catch(n){}return t},getGameIDFromChatlink:function(e,t){var n=function(e){for(var t=window.atob(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n},i=null;"string"==typeof e&&0===e.indexOf("[&")&&e.indexOf("]"===e.length-1)&&(e=e.substring(2,e.length-1));try{var a=n(e),i=a[2]<<8|a[1],r=null;switch(a[0]){case 2:r="item",i=a[3]<<8|a[2],i=(a.length>4?a[4]<<16:0)|i;break;case 4:r="location";break;case 6:r="skill";break;case 8:r="trait";break;case 9:r="recipe";break;case 10:r="skin";break;case 11:r="outfit"}}catch(o){I.write("Invalid chatlink to decode.")}return void 0===t?i:i+" ("+r+")"}},A={},X={Checklists:{Chain:{key:"str_chlChain",value:""},ChainSubscription:{key:"str_chlChainSubscription",value:""},JP:{key:"str_chlJP",value:""},Chest:{key:"str_chlChest",value:""},ResourceRich:{key:"str_chlResourceRich",value:""},ResourceRegular:{key:"str_chlResourceRegular",value:""},ResourceHotspot:{key:"str_chlResourceHotspot",value:""},Dungeon:{key:"str_chlDungeon",value:"",money:0},CustomDaily:{key:"str_chlCustomDaily",value:""},CustomWeekly:{key:"str_chlCustomWeekly",value:""},TradingOverwrite:{key:"str_chlTradingOverwrite",value:""},TradingNotify:{key:"str_chlTradingNotify",value:""}},Collectibles:{LivingStory:{key:"str_chlWintersdayOrphans",urlkey:"orphans",value:""},BuriedChests:{key:"str_chlBuriedChests",urlkey:"chests",value:""},BanditChests:{key:"str_chlBanditChests",urlkey:"banditchests",value:""},MatrixCubeKey:{key:"str_chlMatrixCubeKey",urlkey:"matrixcubekey",value:""},ItzelTotems:{key:"str_chlItzelTotems",urlkey:"itzeltotems",value:""},PriorySeals:{key:"str_chlPriorySeals",urlkey:"prioryseals",value:""},AuricTablets:{key:"str_chlAuricTablets",urlkey:"aurictablets",value:""},ExaltedMasks:{key:"str_chlExaltedMasks",urlkey:"exaltedmasks",value:""},LionsArchExterminator:{key:"str_chlLionsArchExterminator",urlkey:"lionsarchexterminator",value:""},CoinProspect:{key:"str_chlCoinProspect",urlkey:"coinprospect",value:""},CoinUplands:{key:"str_chlCoinUplands",urlkey:"coinuplands",value:""},CoinChallenger:{key:"str_chlCoinChallenger",urlkey:"coinchallenger",value:""},LostBadges:{key:"str_chlLostBadges",urlkey:"lostbadges",value:""},GoldenLostBadges:{key:"str_chlGoldenLostBadges",urlkey:"goldenlostbadges",value:""},DiveMaster:{
key:"str_chlDiveMaster",urlkey:"divemaster",value:""},SpeedyReader:{key:"str_chlSpeedyReader",urlkey:"speedyreader",value:""},CleaningUp:{key:"str_chlCleaningUp",urlkey:"cleaningup",value:""},HistoryBuff:{key:"str_chlHistoryBuff",urlkey:"historybuff",value:""},Strongboxes:{key:"str_chlStrongboxes",urlkey:"strongboxes",value:""},MasteryInsight:{key:"str_chlMasteryInsight",urlkey:"masteryinsight",value:""},HeroChallenge:{key:"str_chlHeroChallenge",urlkey:"herochallenge",value:""}},ChecklistEnum:{Unchecked:"0",Checked:"1",Disabled:"2",Unfound:"0",Tracked:"1",Found:"2"},ChecklistJob:{UncheckAll:0,CheckAll:1,UncheckTheChecked:2},Textlists:{CustomTextDaily:{key:"str_txlCustomTextDaily",value:[],valueDefault:[]},CustomTextWeekly:{key:"str_txlCustomTextWeekly",value:[],valueDefault:[]},NotepadText:{key:"str_txlNotepadText",value:[],valueDefault:[]},TradingItem:{key:"str_txlTradingItem",value:[]},TradingName:{key:"str_txlTradingName",value:[]},TradingBuy:{key:"str_txlTradingBuy",value:[]},TradingSell:{key:"str_txlTradingSell",value:[]},TradingQuantity:{key:"str_txlTradingQuantity",value:[]},NotifyBuyLow:{key:"str_txlNotifyBuyLow",value:[]},NotifyBuyHigh:{key:"str_txlNotifyBuyHigh",value:[]},NotifySellLow:{key:"str_txlNotifySellLow",value:[]},NotifySellHigh:{key:"str_txlNotifySellHigh",value:[]},ExchangeUnit:{key:"str_txlExchangeUnit",value:[]}},boolToChecklistEnum:function(e){return e?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked},initializeChecklist:function(e,t,n,i){var a,r,o,s=localStorage[e.key];if(e.length=t,n){X.clearChecklist(e),r=n.split(",");for(a in r)o=parseInt(r[a]),isFinite(o)&&X.setChecklistItem(e,o-1,X.ChecklistEnum.Checked)}else if(void 0===s)X.clearChecklist(e,i);else if(s.length>t)localStorage[e.key]=s.substring(0,t);else if(s.length<t){var c=U.repeatChar(X.ChecklistEnum.Unchecked,t-s.length);localStorage[e.key]=s+c}e.value=localStorage[e.key]},setChecklistItem:function(e,t,n){t=parseInt(t);var i=n.toString();if(1===i.length&&e.value[t]!==i&&t>=0&&t<e.value.length){var a=U.replaceCharAt(e.value,t,i);localStorage[e.key]=a,e.value=a}},trackChecklistItem:function(e,t){t=parseInt(t);var n=e.value.charAt(t);switch(n){case X.ChecklistEnum.Unfound:n=X.ChecklistEnum.Tracked;break;case X.ChecklistEnum.Tracked:n=X.ChecklistEnum.Found;break;case X.ChecklistEnum.Found:n=X.ChecklistEnum.Unfound;break;default:n=X.ChecklistEnum.Unfound}var i=U.replaceCharAt(e.value,t,n);return localStorage[e.key]=i,e.value=i,n},getChecklistItem:function(e,t,n){var i=e.value.charAt(t);return void 0===n?i:n===O.TypeEnum.isInteger?parseInt(i):n===O.TypeEnum.isBoolean?O.intToBool(parseInt(i)):i},isChecked:function(e,t){var n=U.getSubintegerFromHTMLID(t);return X.getChecklistItem(e,n)===X.ChecklistEnum.Checked?!0:!1},getCheckedIndexes:function(e){var t,n="",i=e.value;for(t=0;t<i.length;t++)i[t]===X.ChecklistEnum.Checked&&(n+=t+1+",");return n=n.slice(0,-1)},clearChecklist:function(e,t){var n,i="",a="";switch(t){case X.ChecklistJob.CheckAll:for(n=0;n<e.length;n++)i+=X.ChecklistEnum.Checked;break;case X.ChecklistJob.UncheckTheChecked:for(a=void 0!==localStorage[e.key]?localStorage[e.key]:e.value,n=0;n<a.length;n++)i+=a[n]===X.ChecklistEnum.Checked?X.ChecklistEnum.Unchecked:a[n];break;default:for(n=0;n<e.length;n++)i+=X.ChecklistEnum.Unchecked}e.value=i,localStorage[e.key]=i},countChecklist:function(e,t){return U.countOccurrence(e.value,t)},getCheckboxEnumState:function(e){return e.prop("disabled")===!0?X.ChecklistEnum.Disabled:e.prop("checked")===!0?X.ChecklistEnum.Checked:X.ChecklistEnum.Unchecked},setCheckboxEnumState:function(e,t){switch(t){case X.ChecklistEnum.Disabled:e.prop("disabled",!0),e.prop("checked",!1);break;case X.ChecklistEnum.Checked:e.prop("checked",!0);break;default:e.prop("checked",!1)}e.trigger("change")},triggerCheckbox:function(e,t){var n=X.getCheckboxEnumState(e);t===X.ChecklistEnum.Checked&&n===X.ChecklistEnum.Unchecked||t===X.ChecklistEnum.Unchecked&&n===X.ChecklistEnum.Checked?e.trigger("click"):t===X.ChecklistEnum.Disabled&&n!==X.ChecklistEnum.Disabled&&e.trigger("dblclick")},triggerCheckboxEnumState:function(e,t,n){var i=X.getChecklistItem(e,t);X.triggerCheckbox(n,i)},styleCheckbox:function(e,t,n){var i=X.getChecklistItem(e,t);switch(i){case X.ChecklistEnum.Disabled:n.parent().removeClass("chlCheckboxChecked").addClass("chlCheckboxDisabled");break;case X.ChecklistEnum.Checked:n.parent().removeClass("chlCheckboxDisabled").addClass("chlCheckboxChecked");break;default:n.parent().removeClass("chlCheckboxDisabled").removeClass("chlCheckboxChecked")}},initializeCheckboxlist:function(e,t,n){X.initializeChecklist(e,t.length,null,n),t.each(function(t){$(this).change(function(){var n=X.getCheckboxEnumState($(this));X.setChecklistItem(e,t,n)}),X.triggerCheckboxEnumState(e,t,$(this))})},initializeTextlist:function(e,t,n,i,a){t.each(function(){var t=$(this).val();e.value.push(t),e.valueDefault&&e.valueDefault.push(t)});var r;if(void 0===localStorage[e.key])localStorage[e.key]=e.value.join(I.cTextDelimiterChar);else{var o=localStorage[e.key].split(I.cTextDelimiterChar);for(r=0;r<e.value.length;r++)o[r]?e.value[r]=o[r]:e.value[r]="";localStorage[e.key]=e.value.join(I.cTextDelimiterChar)}var s=function(){t.each(function(t){e.value[t]=$(this).val().replace(I.cTextDelimiterRegex,"")}),localStorage[e.key]=e.value.join(I.cTextDelimiterChar)};t.each(function(t){$(this).attr("maxlength",i),$(this).val(e.value[t]),$(this).change(function(){n&&I.write(n+" #"+(t+1)+" updated."),s()})}),a&&a.click(function(){confirm("Reset texts to default?")&&t.each(function(t){$(this).val(e.valueDefault[t]).trigger("change")})})},initializeChainChecklist:function(e){var t=$("#chnBar_"+e.nexus),n=$("#chnCheck_"+e.nexus),i=$("#chnTime_"+e.nexus);X.reapplyChainBarState(e.nexus,t,n,i),C.isChainRegular(e)&&i.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=$(".chnSlot_"+e).find("time");X.getChecklistItem(X.Checklists.ChainSubscription,e)===X.ChecklistEnum.Checked?($(this).removeClass("chnTimeSubscribed"),t.removeClass("chnTimeSubscribed"),X.setChecklistItem(X.Checklists.ChainSubscription,e,X.ChecklistEnum.Unchecked)):($(this).addClass("chnTimeSubscribed"),t.addClass("chnTimeSubscribed"),X.setChecklistItem(X.Checklists.ChainSubscription,e,X.ChecklistEnum.Checked),O.Options.int_setAlarm!==O.IntEnum.Alarm.Subscription&&I.write("Please set <img src='img/ui/speaker.png' /> to &quot;"+D.getWordCapital("subscription")+"&quot; to enable alarm."))}),n.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=$("#chnBar_"+e),n=$(".chnSlot_"+e),i=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";switch(X.getChecklistItem(X.Checklists.Chain,e)){case X.ChecklistEnum.Unchecked:t.css({opacity:1}).animate({opacity:K.iconOpacityChecked},K.iconOpacitySpeed),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).hide("fast"),$(this).addClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Checked),C.isTimetableGenerated&&n.css({opacity:1}).animate({opacity:K.iconOpacityChecked},K.iconOpacitySpeed).find(".chnCheck").addClass("chnChecked");break;case X.ChecklistEnum.Checked:t.css({opacity:1}).show("fast").css({display:i}),t.css({opacity:K.iconOpacityChecked}).animate({opacity:1},K.iconOpacitySpeed),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).show("fast").css({display:i}),$(this).removeClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Unchecked),C.isTimetableGenerated&&n.show("fast").css({display:i}).css({opacity:K.iconOpacityChecked}).animate({opacity:1},K.iconOpacitySpeed).find(".chnCheck").removeClass("chnChecked");break;case X.ChecklistEnum.Disabled:t.css({opacity:1}).show("fast").css({display:i}),I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+e).show("fast").css({display:i}),$(this).removeClass("chnChecked"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Unchecked),C.isTimetableGenerated&&n.hide().css({opacity:1}).find(".chnCheck").removeClass("chnChecked")}X.hideCheckedChainBar(e),K.checkoffChainIcon(e)}),$("#chnDelete_"+e.nexus).click(function(){var e=U.getSubintegerFromHTMLID($(this));$("#chnBar_"+e).hide("slow"),C.isTimetableGenerated&&$(".chnSlot_"+e).hide("slow"),X.setChecklistItem(X.Checklists.Chain,e,X.ChecklistEnum.Disabled),K.checkoffChainIcon(e)})},reapplyChainBarState:function(e,t,n,i){switch(X.getChecklistItem(X.Checklists.Chain,e)){case X.ChecklistEnum.Unchecked:break;case X.ChecklistEnum.Checked:t.css({opacity:K.iconOpacityChecked}),n.addClass("chnChecked"),O.Options.bol_hideChecked&&t.hide();break;case X.ChecklistEnum.Disabled:t.hide()}C.isChainRegular(C.Chains[e])&&X.getChecklistItem(X.Checklists.ChainSubscription,e)===X.ChecklistEnum.Checked&&i.addClass("chnTimeSubscribed")},hideCheckedChainBar:function(e){var t=I.ModeCurrent===I.ModeEnum.Tile?"inline-block":"block";X.getChecklistItem(X.Checklists.Chain,e)===X.ChecklistEnum.Checked&&(O.Options.bol_hideChecked?($("#chnBar_"+e).hide("fast"),C.isTimetableGenerated&&$(".chnSlot_"+e).hide("fast")):($("#chnBar_"+e).show("fast").css({display:t}),C.isTimetableGenerated&&$(".chnSlot_"+e).show("fast").css({display:t})))},getChainChecklistState:function(e){return X.getChecklistItem(X.Checklists.Chain,e.nexus)},initializePersonalChecklist:function(){T.isCountdownToResetStarted=!0,$("#chlDungeon, #chlCustomWeekly").hide(),$("#chlDungeonButton").click(function(){$("#chlCustomButtons button").removeClass("btnFocused"),$(this).addClass("btnFocused"),$("#chlCustom").hide(),$("#chlDungeon").show().css({opacity:.5}).animate({opacity:1},400)}),$("#chlCustomDailyButton").addClass("btnFocused").click(function(){$("#chlCustomButtons button").removeClass("btnFocused"),$(this).addClass("btnFocused"),$("#chlDungeon").hide(),$("#chlCustom").show(),$("#chlCustomWeekly").hide(),$("#chlCustomDaily").show().css({opacity:.5}).animate({opacity:1},400)}),$("#chlCustomWeeklyButton").click(function(){$("#chlCustomButtons button").removeClass("btnFocused"),$(this).addClass("btnFocused"),$("#chlDungeon").hide(),$("#chlCustom").show(),$("#chlCustomDaily").hide(),$("#chlCustomWeekly").show().css({opacity:.5}).animate({opacity:1},400)}),X.initializeDungeonChecklist(),X.initializeCustomChecklist()},initializeDungeonChecklist:function(){X.initializeChecklist(X.Checklists.Dungeon,$("#chlDungeon input").length),$("#chlDungeon .chlDungeonBar").each(function(){$(this).prepend("<ins class='chl_"+$(this).data("name").toLowerCase()+"'></ins>")});var e=function(){var e=X.Checklists.Dungeon.money,t=~~(e/E.Exchange.COPPER_IN_GOLD),n=~~(e/E.Exchange.SILVER_IN_GOLD)%E.Exchange.COPPER_IN_SILVER,i=e%E.Exchange.COPPER_IN_SILVER;$("#chlDungeonCalculator_Gold").text(t),$("#chlDungeonCalculator_Silver").text(n),$("#chlDungeonCalculator_Copper").text(i)};$("#chlDungeon input").each(function(t){$(this).change(function(){var n=X.getCheckboxEnumState($(this));X.setChecklistItem(X.Checklists.Dungeon,t,n),X.styleCheckbox(X.Checklists.Dungeon,t,$(this));var i=$("#chlDungeonCalculator"),a=X.Checklists.Dungeon.money,r=$(this).data("money");switch($(this).data("mode")){case"E":r+=i.data("moneyaddexp")}switch(n){case X.ChecklistEnum.Disabled:X.Checklists.Dungeon.money=a-r;break;case X.ChecklistEnum.Checked:X.Checklists.Dungeon.money=a+r;break;default:X.Checklists.Dungeon.money=a-r}e()})}),$("#chlDungeon label").each(function(e){$(this).dblclick(function(){var t=$(this).find("input:first-child");t.prop("disabled")===!1?(t.prop("checked")===!0&&X.triggerCheckbox(t,X.ChecklistEnum.Unchecked),t.prop("disabled",!0).prop("checked",!1)):t.prop("disabled",!1),X.setChecklistItem(X.Checklists.Dungeon,e,X.getCheckboxEnumState(t)),X.styleCheckbox(X.Checklists.Dungeon,e,t)})}),$("#chlDungeon input").each(function(e){X.triggerCheckboxEnumState(X.Checklists.Dungeon,e,$(this))}),$("#chlDungeonUncheck").click(function(){X.clearChecklist(X.Checklists.Dungeon,X.ChecklistJob.UncheckTheChecked),$("#chlDungeon input").each(function(e){$(this).prop("checked")===!0&&$(this).trigger("click"),X.styleCheckbox(X.Checklists.Dungeon,e,$(this))})})},initializeCustomChecklist:function(){for(var e=12,t="<li><label><input type='checkbox' />&zwnj;</label><input type='text' /></li>",n=0;e>n;n++)$("#chlCustomListDaily").append(t),$("#chlCustomListWeekly").append(t);var i=function(e){for(var t=$(e).attr("data-samples").split(I.cTextDelimiterChar),n=0;n<t.length;n++)$(e+" input[type='text']:eq("+n+")").val(t[n])};i("#chlCustomListDaily"),i("#chlCustomListWeekly");var a=function(e,t,n){var i=$("#chlCustomList"+n+" input:checkbox");X.initializeChecklist(e,i.length),i.each(function(t){$(this).change(function(){var n=X.getCheckboxEnumState($(this));X.setChecklistItem(e,t,n),X.styleCheckbox(e,t,$(this)),n===X.ChecklistEnum.Checked?$(this).parent().next().addClass("chlCustomTextChecked"):$(this).parent().next().removeClass("chlCustomTextChecked")}),X.triggerCheckboxEnumState(e,t,$(this))}),$("#chlCustomUncheck"+n).click(function(){X.clearChecklist(e,X.ChecklistJob.UncheckTheChecked),$("#chlCustomList"+n+" input:checkbox").each(function(t){$(this).prop("checked")&&$(this).trigger("click"),X.styleCheckbox(e,t,$(this))})});var a=$("#chlCustomList"+n+" input:text"),r=$("#chlCustomRestore"+n);X.initializeTextlist(t,a,"Custom checklist item",48,r)};a(X.Checklists.CustomDaily,X.Textlists.CustomTextDaily,"Daily"),a(X.Checklists.CustomWeekly,X.Textlists.CustomTextWeekly,"Weekly")},clearCustomChecklistDaily:function(){$("#chlDungeonUncheck").trigger("click"),$("#chlCustomUncheckDaily").trigger("click"),X.clearChecklist(X.Checklists.Dungeon,X.ChecklistJob.UncheckTheChecked),X.clearChecklist(X.Checklists.CustomDaily,X.ChecklistJob.UncheckTheChecked)},clearCustomChecklistWeekly:function(){$("#chlCustomUncheckWeekly").trigger("click"),X.clearChecklist(X.Checklists.CustomWeekly,X.ChecklistJob.UncheckTheChecked)},initializeNotepad:function(){$("#chlNotepadButtons button").each(function(e){$(this).click(function(){$("#chlNotepadSheets textarea").hide().eq(e).show().css({opacity:.5}).animate({opacity:1},400),$("#chlNotepadButtons button").removeClass("btnFocused"),$(this).addClass("btnFocused")})}).first().click();var e=$("#chlNotepadSheets textarea"),t=$("#chlNotepadRestore");X.initializeTextlist(X.Textlists.NotepadText,e,"Notepad sheet",4096,t),e.css("height",O.Options.int_sizeNotepadHeight),e.css("font-size",O.Options.int_sizeNotepadFont),e.first().show()}},E={Exchange:{COPPER_IN_SILVER:100,COPPER_IN_GOLD:1e4,SILVER_IN_GOLD:100,CENTS_IN_DOLLAR:100,GEM_PER_DOLLAR:.8,DOLLAR_PER_GEM:1.25,GEM_SAMPLE:100,COIN_SAMPLE:1e6,TAX_LIST:.05,TAX_SOLD:.1,TAX_TOTAL:.15,TAX_INVERSE:.85,GemInCoin:0,CoinInGem:0},Rarity:{Junk:0,Basic:1,Fine:2,Masterwork:3,Rare:4,Exotic:5,Ascended:6,Legendary:7},cNUM_ITEM_RARITIES:8,cREFRESH_LIMIT:5e3,cSEARCH_LIMIT:750,cEXCHANGE_LIMIT:250,isTradingCalculatorsInitialized:!1,ItemsArray:[],RefreshTimeout:{},ProgressTimeout:{},ProgressWait:0,ProgressTick:0,SwapIndex:-1,CalculatorHistoryArray:new Array(64),CalcHistoryIndex:0,parseCoinString:function(e){if(void 0===e||null===e)return 0;var t=e.split("."),n=t.length,i=0,a=0,r=0;return 0===n?0:(1===n&&(a=parseInt(t[0])),n>=2&&(i=parseInt(t[n-1]),a=parseInt(t[n-2])),2===n&&1===t[n-1].length&&(i*=T.cBASE_10),n>=3&&(r=parseInt(t[n-3])),isFinite(i)||(i=0),isFinite(a)||(a=0),isFinite(r)||(r=0),parseInt(i+a*E.Exchange.COPPER_IN_SILVER+r*E.Exchange.COPPER_IN_GOLD))},parseGemString:function(e){return void 0===e||null===e?0:isFinite(parseInt(e))?parseInt(e):0},parseQuantityString:function(e){var t=parseInt(e);return isFinite(t)||(t=1),t},createCoinString:function(e,t){if(void 0===e||isFinite(e)===!1)return"0.00";e=parseInt(e);var n=".",i="",a="",r="",o="",s="",c="";t&&(n="",i="<gold>",a="<silver>",r="<copper>",o="</gold><goldcoin></goldcoin>",s="</silver><silvercoin></silvercoin>",c="</copper><coppercoin></coppercoin>");var l=Math.abs(~~(e/E.Exchange.COPPER_IN_GOLD)),u=Math.abs(~~(e/E.Exchange.SILVER_IN_GOLD)%E.Exchange.COPPER_IN_SILVER),d=Math.abs(e%E.Exchange.COPPER_IN_SILVER),h=0>e?"−":"";return!t&&l>0&&u<T.cBASE_10&&(u="0"+u),!t&&(u>0&&d<T.cBASE_10||d<T.cBASE_10)&&(d="0"+d),l>0?h+i+l+o+n+a+u+s+n+r+d+c:u>0?h+a+u+s+n+r+d+c:t?r+d+c:h+a+"0"+n+s+r+d+c},parseMoneyString:function(e){if(void 0===e||null===e)return 0;var t=e.split("."),n=t.length,i=0,a=0;return 0===n?0:(1===n&&(a=parseInt(t[0])),n>=2&&(i=parseInt(t[n-1]),a=parseInt(t[n-2])),n>=2&&1===t[n-1].length?i*=T.cBASE_10:n>=2&&t[n-1].length>=2&&(i=parseInt(i.toString().substring(0,2))),isFinite(i)||(i=0),isFinite(a)||(a=0),parseInt(i+a*E.Exchange.CENTS_IN_DOLLAR))},createMoneyString:function(e){if(void 0===e||isFinite(e)===!1)return"0.00";e=parseInt(e);var t=Math.abs(~~(e/E.Exchange.CENTS_IN_DOLLAR)),n=Math.abs(e%E.Exchange.CENTS_IN_DOLLAR),i=0>e?"−":"";return n<T.cBASE_10&&(n="0"+n),i+t+"."+n},createKarmaString:function(e,t){if(void 0===e||isFinite(e)===!1)return"0";e=parseInt(e);var n="",i="";t&&(n="<karma>",i="</karma><karmaunit></karmaunit>");var a=e.toLocaleString();return n+a+i},createPercentString:function(e,t){if(void 0===e||isFinite(e)===!1)return"0%";void 0===t&&(t=0);var n=0>e?"−":"";return n+Math.abs(100*e).toFixed(t)+"%"},setRarityClass:function(e,t){for(var n=0;n<E.cNUM_ITEM_RARITIES;n++)e.removeClass("rarity"+n.toString());void 0!==E.Rarity[t]&&e.addClass("rarity"+E.Rarity[t].toString())},getRarityClass:function(e){return"rarity"+E.Rarity[e]},animateValue:function(e,t,n){t>n?e.css({color:"#ff2200"}).animate({color:"#ffeebb"},5e3):n>t?e.css({color:"#44dd44"}).animate({color:"#ffeebb"},5e3):e.css({"border-radius":32}).animate({"border-radius":4},1e3)},updateCoinInGem:function(){return $.getJSON(U.URL_API.GemPrice+E.Exchange.COIN_SAMPLE,function(e){void 0!==e.quantity&&(E.Exchange.CoinInGem=E.Exchange.COIN_SAMPLE/e.quantity)})},updateGemInCoin:function(){return $.getJSON(U.URL_API.CoinPrice+E.Exchange.GEM_SAMPLE,function(e){void 0!==e.quantity&&(E.Exchange.GemInCoin=E.Exchange.GEM_SAMPLE/e.quantity)})},deductTax:function(e){return parseInt(e-e*E.Exchange.TAX_TOTAL)},convertGemToMoney:function(e){return E.createMoneyString(Math.round(e*E.Exchange.DOLLAR_PER_GEM))},convertMoneyToGem:function(e){return parseInt(e*E.Exchange.GEM_PER_DOLLAR)},calculateTrading:function(e){var t=E.parseCoinString(e.find(".trdBuy").val()),n=E.parseCoinString(e.find(".trdSell").val()),i=E.parseQuantityString(e.find(".trdQuantity").val()),a=e.find(".trdCost"),r=e.find(".trdTax"),o=e.find(".trdRevenue"),s=e.find(".trdProfit"),c=e.find(".trdBreak"),l=e.find(".trdMargin"),u=(n-n*E.Exchange.TAX_TOTAL-t)*i,d=(n-n*E.Exchange.TAX_SOLD)*i,h=t*i,p=n*E.Exchange.TAX_LIST*i,m=n*E.Exchange.TAX_SOLD*i;a.val("−"+E.createCoinString(Math.round(h))),r.val("−"+E.createCoinString(Math.round(p))+" + −"+E.createCoinString(Math.round(m))),c.val(E.createCoinString(Math.round(t/E.Exchange.TAX_INVERSE))),o.val(E.createCoinString(Math.round(d))),s.val(E.createCoinString(Math.round(u))),l.val(E.createPercentString(d/(h+p)-1,2)),$([s,l]).each(function(){var e=Math.round(u);$(this).removeClass("trdZero trdGain trdLoss"),0===e?$(this).addClass("trdZero"):e>0?$(this).addClass("trdGain"):0>e&&$(this).addClass("trdLoss")})},updateTradingDetails:function(e){var t=e.find(".trdName").val(),n=e.find(".trdItem").val();isFinite(parseInt(n))!==!1&&0!==t.length&&$.ajax({dataType:"json",url:U.URL_API.ItemDetails+n,cache:!1,success:function(t){E.setRarityClass(e.find(".trdName"),t.rarity),e.attr("data-rarity",t.rarity),e.find(".trdIcon").attr("src",t.icon),e.find(".trdLink").val(U.getChatlinkFromItemID(n))}})},updateTradingPrices:function(e){var t=e.find(".trdName").val(),n=e.find(".trdItem").val();if(isFinite(parseInt(n))!==!1&&0!==t.length){var i=0,a=0,r=0,o=0,s=e.find(".trdName"),c=e.find(".trdCurrentBuy"),l=e.find(".trdCurrentSell"),u=e.find(".trdNotifyBuyLow"),d=e.find(".trdNotifyBuyHigh"),h=e.find(".trdNotifySellLow"),p=e.find(".trdNotifySellHigh"),m=E.parseCoinString(u.val()),g=E.parseCoinString(d.val()),C=E.parseCoinString(h.val()),f=E.parseCoinString(p.val());$.ajax({dataType:"json",url:U.URL_API.ItemPrices+n,cache:!1,success:function(t){i=E.parseCoinString(e.find(".trdCurrentBuy").first().val()),a=E.parseCoinString(e.find(".trdCurrentSell").first().val()),void 0!==t.buys&&(r=parseInt(t.buys.unit_price)),void 0!==t.sells&&(o=parseInt(t.sells.unit_price)),c.val(E.createCoinString(r)),l.val(E.createCoinString(o)),X.getChecklistItem(X.Checklists.TradingOverwrite,U.getSubintegerFromHTMLID(e))===X.ChecklistEnum.Checked&&(e.find(".trdBuy").val(c.val()).trigger("input"),e.find(".trdSell").val(l.val()).trigger("input"))}}).done(function(){E.animateValue(c,i,r),E.animateValue(l,a,o),X.isChecked(X.Checklists.TradingNotify,e)&&(s.removeClass("trdMatched"),m>=r&&0!==m&&0!==r?(s.addClass("trdMatched"),u.addClass("trdMatched"),D.speak(D.getPhraseTitle("buy low")+" "+t)):u.removeClass("trdMatched"),r>=g&&0!==g&&0!==r?(s.addClass("trdMatched"),d.addClass("trdMatched"),D.speak(D.getPhraseTitle("buy high")+" "+t)):d.removeClass("trdMatched"),C>=o&&0!==C&&0!==o?(s.addClass("trdMatched"),h.addClass("trdMatched"),D.speak(D.getPhraseTitle("sell low")+" "+t)):h.removeClass("trdMatched"),o>=f&&0!==f&&0!==o?(s.addClass("trdMatched"),p.addClass("trdMatched"),D.speak(D.getPhraseTitle("sell high")+" "+t)):p.removeClass("trdMatched"))}).fail(function(){I.write("&quot;"+U.escapeHTML(e.find(".trdName").val())+"&quot; is not a tradeable item.")})}},updateAllTradingDetails:function(){$("#trdList .trdEntry").each(function(){E.updateTradingDetails($(this))})},updateAllTradingPrices:function(){$("#trdList .trdEntry").each(function(){E.updateTradingPrices($(this))})},clearCalculator:function(e){E.setRarityClass(e.find(".trdName")),e.find(".trdIcon").attr("src",U.URL_IMG.Placeholder),e.find(".trdItem").val("").trigger("change"),e.find(".trdCurrentBuy").val(""),e.find(".trdCurrentSell").val(""),e.find(".trdLink").val(""),e.find(".trdResultsContainer").remove(),e.find(".trdNotifyBuyLow").val("").trigger("change"),e.find(".trdNotifyBuyHigh").val("").trigger("change"),e.find(".trdNotifySellLow").val("").trigger("change"),e.find(".trdNotifySellHigh").val("").trigger("change"),E.clearMatched(e)},clearMatched:function(e){e.find(".trdName").removeClass("trdMatched"),e.find(".trdNotifyBuyLow").removeClass("trdMatched"),e.find(".trdNotifyBuyHigh").removeClass("trdMatched"),e.find(".trdNotifySellLow").removeClass("trdMatched"),e.find(".trdNotifySellHigh").removeClass("trdMatched")},initializeTrading:function(){var e,t,n,i,a,r="",o=function(e){var t=$("<div class='trdResultsContainer jsRemovable'></div>").insertAfter(e.find(".trdName"));return $("<div class='trdResults cntPopup'>"+I.cThrobber+"</div>").appendTo(t)},s=function(e,t,n){I.removeThrobber(".trdResults");var i=$("<dfn class='"+E.getRarityClass(e.rarity)+"' data-id='"+e.id+"'><img src='"+e.icon+"'>"+U.wrapSubstringHTML(e.name,t,"u")+"</dfn>").appendTo(n);i.click(function(){var e=$(this).parents(".trdResultsContainer"),t=e.parents(".trdEntry");t.find(".trdItem").val($(this).data("id")).trigger("change"),t.find(".trdName").val($(this).text()).trigger("change"),E.updateTradingDetails(t),E.updateTradingPrices(t),e.remove()})};for(e=0;e<O.Options.int_numTradingCalculators;e++)r="#trdEntry_"+e,$("#trdList").append("<div id='trdEntry_"+e+"' class='trdEntry'><div class='trdAccordion trdAccordionShut'><samp><img class='trdIcon' src='"+U.URL_IMG.Placeholder+"' /></samp><div class='trdResultsFocus'><input class='trdName' type='text' /></div><div class='trdButtons'><button class='trdSearch' tabindex='-1'>S</button><button class='trdWiki' tabindex='-1'>W</button><br /></div><div class='trdExpand'><samp>$~O</samp><input class='trdBuy' type='text' /><samp>−$~</samp><input class='trdCost trdOutput' type='text' tabindex='-1' /><br /><samp>O~$</samp><input class='trdSell' type='text' /><samp>$=$</samp><input class='trdBreak trdOutput' type='text' tabindex='-1' /><br /><samp>×</samp><input class='trdQuantity' type='text' /><samp>−$%</samp><input class='trdTax trdOutput' type='text' tabindex='-1' /><br /><samp>+$</samp><input class='trdProfit trdOutput' type='text' tabindex='-1' /><samp>=$</samp><input class='trdRevenue trdOutput' type='text' tabindex='-1' /><br /><samp>+$%</samp><input class='trdMargin trdOutput' type='text' tabindex='-1' /><samp>[]</samp><input class='trdLink trdOutput' type='text' tabindex='-1' /><input class='trdItem trdOutput' type='text' /><br /><samp>$~!</samp><input class='trdNotifyBuyHigh' type='text' /><input class='trdCurrentBuy trdOutput' type='text' tabindex='-1' /><input class='trdNotifyBuyLow' type='text' /><label title='<dfn>"+D.getWordCapital("overwrite")+"</dfn>: Replace your buy and sell prices with the current prices when refreshing.'><input class='trdOverwrite' type='checkbox' tabindex='-1' />&zwnj;</label><br /><samp>!~$</samp><input class='trdNotifySellHigh' type='text' /><input class='trdCurrentSell trdOutput' type='text' tabindex='-1' /><input class='trdNotifySellLow' type='text' /><label title='<dfn>"+D.getWordCapital("notify")+"</dfn>: Turn on sound notification for this item.'><input class='trdNotify' type='checkbox' tabindex='-1' />&zwnj;</label><br /><br /></div></div><div class='trdPreview'><input class='trdCurrentBuy trdOutput' type='text' tabindex='-1' /><input class='trdCurrentSell trdOutput' type='text' tabindex='-1' /><div class='trdSwap'><button class='trdSwapUp' tabindex='-1'></button><button class='trdSwapDown' tabindex='-1'></button></div></div></div>"),I.qTip.init($(r+" .trdOverwrite").parent()),I.qTip.init($(r+" .trdNotify").parent()),t=$(r+" .trdName"),n=$(r+" .trdBuy"),i=$(r+" .trdSell"),a=$(r+" .trdQuantity"),$(r+" input").click(function(){$(this).select()}),$(r+" .trdWiki").click(function(){var e=$(this).parents(".trdEntry").find(".trdName").val();U.openExternalURL(U.getWikiLink(e))}),$(r+" .trdSearch").click(function(){var e=$(this).parents(".trdEntry").find(".trdItem").val(),t=$(this).parents(".trdEntry").find(".trdName").val();0===e.length?U.openExternalURL(U.getTradingSearchLink(t)):U.openExternalURL(U.getTradingItemLink(e,t))}),$([n,i,a]).each(function(){$(this).on("input",function(){E.calculateTrading($(this).parent())})}),$(r+" .trdCurrentBuy, "+r+" .trdCurrentSell").each(function(){$(this).dblclick(function(){var e=E.parseCoinString($(this).val());0!==e&&($(this).prev().val(E.createCoinString(e+1)).trigger("change"),$(this).next().val(E.createCoinString(e-1)).trigger("change"),E.updateTradingPrices($(this).parents(".trdEntry")))})}),$(r+" .trdSwap").hover(function(){$(this).parents(".trdEntry").find(".trdName").addClass("trdHovered"),E.SwapIndex=U.getSubintegerFromHTMLID($(this).parents(".trdEntry"))},function(){$(".trdName").removeClass("trdHovered")}),$(r+" .trdSwapUp, "+r+" .trdSwapDown").each(function(){$(this).click(function(){var e=E.SwapIndex,t=$(this).hasClass("trdSwapUp")?!0:!1;if((!t||0!==e)&&!t!==$(".trdEntry").length-1){var n=t?e-1:e+1,i=$("#trdEntry_"+e),a=$("#trdEntry_"+n),r=[],o=[],s=0,c=0;i.find("input[type='text']").each(function(){r.push($(this).val())}),a.find("input[type='text']").each(function(){o.push($(this).val())}),i.find("input[type='text']").each(function(){$(this).val(o[s]).trigger("change"),s++}),a.find("input[type='text']").each(function(){$(this).val(r[c]).trigger("change"),c++});var l=i.find(".trdIcon").attr("src"),u=a.find(".trdIcon").attr("src");i.find(".trdIcon").attr("src",u),a.find(".trdIcon").attr("src",l);var d=i.attr("data-rarity"),h=a.attr("data-rarity");i.attr("data-rarity",h),a.attr("data-rarity",d),E.setRarityClass(i.find(".trdName"),h),E.setRarityClass(a.find(".trdName"),d),E.clearMatched(i),E.clearMatched(a),i.find(".trdName").removeClass("trdHovered"),a.find(".trdName").addClass("trdHovered"),E.SwapIndex=t?E.SwapIndex-1:E.SwapIndex+1}})}),$(t).on("input",$.throttle(E.cSEARCH_LIMIT,function(){var e,t=$(this).val(),n=U.escapeHTML(t),i=$(this).parents(".trdEntry");if(t.length<3)return void E.clearCalculator(i);if(t.length>=3&&O.isInteger(t))return i.find(".trdResultsContainer").remove(),e=o(i),void $.getJSON(U.URL_API.ItemDetails+t,function(n){s(n,t,e)}).fail(function(){I.write("No results found for Item ID: "+n+"."),i.find(".trdResultsContainer").remove()});var a,r;O.Options.bol_useMainTPSearch?(a=U.URL_API.ItemSearch+t,r="data_id"):(a=U.URL_API.ItemSearchFallback+t,r="item_id"),$.ajax({dataType:"json",url:a,timeout:5e3,success:function(a){i.find(".trdResultsContainer").remove();var c,l,u,d=O.Options.bol_useMainTPSearch?a.results:a;if(d&&d.length>0)for(e=o(i),c=0;c<d.length&&c<O.Options.int_numTradingResults;c++)u=d[c],l=parseInt(u[r]),$.getJSON(U.URL_API.ItemDetails+l,function(n){s(n,t,e)});else I.write("No results found for &quot;"+n+"&quot;.")}}).fail(function(){I.write("Error retrieving search results. Current search provider may be down.<br />Switching to alternate provider..."),$("#opt_bol_useMainTPSearch").trigger("click")})})).onEnterKey(function(){U.openExternalURL(U.getTradingSearchLink($(this).val()))}).onEscapeKey(function(){$(this).parents(".trdEntry").find(".trdResultsContainer").remove()}).click(function(){$(this).trigger("input")});r="#trdEntry_0",$(r+" .trdIcon").attr("src","img/ui/question.png"),$(r+" .trdName").val("Bifrost"),$(r+" .trdBuy").val("4500.37.68"),$(r+" .trdSell").val("550037.68"),$(r+" .trdQuantity").val("1"),$(r).css("margin-bottom","6px");var c=function(e,t,n){n=void 0===n?"":": "+n,$(r+" .trd"+e).attr("title","<dfn>"+D.getPhraseTitle(t)+"</dfn>"+n)};c("Name","name"),c("Buy","your buy"),c("Sell","your sell"),c("Quantity","quantity"),c("Cost","cost","Money needed to buy the items."),c("Break","breakpoint","Sell higher than this to make a profit."),c("Tax","tax","Pay 5% fee of sell price to list, and deduct 10% tax of sell price when sold."),c("Profit","profit","Gains after losses from buying and tax."),c("Margin","margin","Revenue over cost and fee."),c("Revenue","revenue","What you will receive at the trader."),c("Link","chatlink","Paste this in game chat to see the item."),c("Item","ID","API item number."),c("NotifyBuyLow","notify if current buy < this buy"),c("NotifyBuyHigh","notify if this buy < current buy"),c("NotifySellLow","notify if current sell < this sell"),c("NotifySellHigh","notify if this sell < current sell"),c("CurrentBuy","current buy","Double click to flank price."),c("CurrentSell","current sell","Double click to flank price."),I.qTip.init($(r+" input")),X.initializeTextlist(X.Textlists.TradingItem,$("#trdList .trdItem"),null,16),X.initializeTextlist(X.Textlists.TradingName,$("#trdList .trdName"),null,64),X.initializeTextlist(X.Textlists.TradingBuy,$("#trdList .trdBuy"),null,16),X.initializeTextlist(X.Textlists.TradingSell,$("#trdList .trdSell"),null,16),X.initializeTextlist(X.Textlists.TradingQuantity,$("#trdList .trdQuantity"),null,16),X.initializeTextlist(X.Textlists.NotifyBuyLow,$("#trdList .trdNotifyBuyLow"),null,16),X.initializeTextlist(X.Textlists.NotifyBuyHigh,$("#trdList .trdNotifyBuyHigh"),null,16),X.initializeTextlist(X.Textlists.NotifySellLow,$("#trdList .trdNotifySellLow"),null,16),X.initializeTextlist(X.Textlists.NotifySellHigh,$("#trdList .trdNotifySellHigh"),null,16),X.initializeCheckboxlist(X.Checklists.TradingOverwrite,$("#trdList .trdOverwrite"),X.ChecklistJob.CheckAll),X.initializeCheckboxlist(X.Checklists.TradingNotify,$("#trdList .trdNotify"),X.ChecklistJob.CheckAll),$("#trdList .trdSell").trigger("input"),E.updateAllTradingDetails(),$("#trdToggle").click(function(){$("#trdEntry_0 .trdBuy").is(":visible")?($(".trdAccordion").addClass("trdAccordionShut").removeClass("trdAccordionOpen"),$(".trdPreview").removeClass("cssHidden")):($(".trdAccordion").removeClass("trdAccordionShut").addClass("trdAccordionOpen"),$(".trdPreview").addClass("cssHidden"))}),$("#trdRefresh").click($.throttle(E.cREFRESH_LIMIT,function(){E.loopRefresh(!0)})),$("#trdMute").click(function(){D.resetSpeechQueue()}),$("#trdPrint").click(function(){I.clear(),I.write("ItemID,Name,Buy,Sell,Quantity,BuyLow,BuyHigh,SellLow,SellHigh");for(var e=X.Textlists.TradingItem.value.length,t=0;e>t;t++)I.write(U.escapeHTML(X.Textlists.TradingItem.value[t])+","+U.escapeHTML(X.Textlists.TradingName.value[t])+","+U.escapeHTML(X.Textlists.TradingBuy.value[t])+","+U.escapeHTML(X.Textlists.TradingSell.value[t])+","+U.escapeHTML(X.Textlists.TradingQuantity.value[t])+","+U.escapeHTML(X.Textlists.NotifyBuyLow.value[t])+","+U.escapeHTML(X.Textlists.NotifyBuyHigh.value[t])+","+U.escapeHTML(X.Textlists.NotifySellLow.value[t])+","+U.escapeHTML(X.Textlists.NotifySellHigh.value[t]),30);
})},updateCoinTo:function(e){var t=0,n=0,i=0,a=0,r=0,o=0,s=0,c=0,l=$("#trdExchange .trdCoinTo"),u=$("#trdExchange .trdCoinToGem"),d=$("#trdExchange .trdCoinToMoney"),h=$("#trdExchange .trdCoinToGemInverse"),p=$("#trdExchange .trdCoinToMoneyInverse"),m=E.parseCoinString(l.val());0===m?(u.val(""),d.val(""),h.val(""),p.val("")):($.getJSON(U.URL_API.GemPrice+m,function(e){void 0!==e.quantity&&(t=parseInt(u.val()),i=E.parseMoneyString(d.val()),n=parseInt(e.quantity),a=Math.round(n*E.Exchange.DOLLAR_PER_GEM),u.val(n),d.val(E.createMoneyString(a)))}).always(function(){(void 0===e||e)&&(E.animateValue(u,t,n),E.animateValue(d,i,a)),0===n&&(u.val("0"),d.val("0"))}),E.updateGemInCoin().always(function(){0!==E.Exchange.GemInCoin&&(r=parseInt(h.val()),s=E.parseMoneyString(p.val()),o=Math.round(m*E.Exchange.GemInCoin),c=Math.round(o*E.Exchange.DOLLAR_PER_GEM),h.val(o),p.val(E.createMoneyString(c)),(void 0===e||e)&&(E.animateValue(h,r,o),E.animateValue(p,s,c)))}))},updateGemTo:function(e){var t=0,n=0,i=0,a=0,r=0,o=0,s=$("#trdExchange .trdGemTo"),c=$("#trdExchange .trdGemToCoin"),l=$("#trdExchange .trdGemToMoney"),u=$("#trdExchange .trdGemToCoinInverse"),d=s.val();0===d?(c.val(""),l.val("")):($.getJSON(U.URL_API.CoinPrice+d,function(e){void 0!==e.quantity&&(t=E.parseCoinString(c.val()),i=E.parseMoneyString(l.val()),n=parseInt(e.quantity),a=parseInt(d*E.Exchange.DOLLAR_PER_GEM),c.val(E.createCoinString(n)),l.val(E.createMoneyString(a)))}).always(function(){(void 0===e||e)&&(E.animateValue(c,t,n),E.animateValue(l,i,a)),0===n&&(c.val("0"),l.val("0"))}),E.updateCoinInGem().always(function(){0!==E.Exchange.CoinInGem&&(r=E.parseCoinString(u.val()),o=Math.round(d*E.Exchange.CoinInGem),u.val(E.createCoinString(o)),(void 0===e||e)&&E.animateValue(u,r,o))}))},updateMoneyTo:function(e){var t=0,n=0,i=0,a=0,r=$("#trdExchange .trdMoneyTo"),o=$("#trdExchange .trdMoneyToGem"),s=$("#trdExchange .trdMoneyToCoin"),c=E.parseMoneyString(r.val()),l=c*E.Exchange.GEM_PER_DOLLAR;0===c?(o.val(""),s.val("")):$.getJSON(U.URL_API.CoinPrice+l,function(e){void 0!==e.quantity&&(t=parseInt(o.val()),i=E.parseCoinString(s.val()),n=l,a=parseInt(e.quantity),o.val(l),s.val(E.createCoinString(a)))}).always(function(){(void 0===e||e)&&(E.animateValue(o,t,n),E.animateValue(s,i,a)),0===a&&(o.val("0"),s.val("0"))})},updateNotifyCoinTo:function(e){var t=0,n=0,i=$("#trdExchange .trdNotifyCoinTo"),a=$("#trdExchange .trdNotifyCoinToGem"),r=$("#trdExchange .trdNotifyCoinToGemHigh"),o=E.parseGemString(r.val()),s=E.parseCoinString(i.val());0===s?a.val(""):$.getJSON(U.URL_API.GemPrice+s,function(e){void 0!==e.quantity&&(t=parseInt(a.val()),n=parseInt(e.quantity),a.val(n))}).always(function(){(void 0===e||e)&&E.animateValue(a,t,n),0===n?a.val("0"):n>=o&&0!==o?(r.addClass("trdMatched"),D.speak(D.getPhraseTitle("buy gem high"))):r.removeClass("trdMatched")})},updateNotifyGemTo:function(e){var t=0,n=0,i=$("#trdExchange .trdNotifyGemTo"),a=$("#trdExchange .trdNotifyGemToCoin"),r=$("#trdExchange .trdNotifyGemToCoinHigh"),o=E.parseCoinString(r.val()),s=i.val();0===s?a.val(""):$.getJSON(U.URL_API.CoinPrice+s,function(e){void 0!==e.quantity&&(t=E.parseCoinString(a.val()),n=parseInt(e.quantity),a.val(E.createCoinString(n)))}).always(function(){(void 0===e||e)&&E.animateValue(a,t,n),0===n?a.val("0"):n>=o&&0!==o?(r.addClass("trdMatched"),D.speak(D.getPhraseTitle("buy coin high"))):r.removeClass("trdMatched")})},updateAllExchange:function(){E.updateCoinTo(),E.updateGemTo(),E.updateMoneyTo(),E.updateNotifyCoinTo(),E.updateNotifyGemTo()},initializeExchange:function(){var e=$("#trdExchange .trdCoinTo"),t=$("#trdExchange .trdGemTo"),n=$("#trdExchange .trdMoneyTo"),i=$("#trdExchange .trdNotifyCoinTo"),a=$("#trdExchange .trdNotifyGemTo"),r=$("#trdExchange .trdNotifyCoinToGemHigh"),o=$("#trdExchange .trdNotifyGemToCoinHigh");e.val("200.."),t.val("4000"),n.val("50");var s=function(e,t){$("#trdExchange .trd"+e).attr("title","<dfn>"+D.getPhraseTitle(t)+"</dfn>")};s("CoinTo","your coin"),s("GemTo","your gem"),s("MoneyTo","your dollar"),s("CoinToGem","your coin to gem"),s("GemToCoin","your gem to coin"),s("MoneyToGem","your dollar to gem"),s("CoinToMoney","your coin to dollar"),s("GemToMoney","your gem to dollar"),s("MoneyToCoin","your dollar to coin"),s("CoinToGemInverse","gem to your coin"),s("GemToCoinInverse","coin to your gem"),s("CoinToMoneyInverse","dollar to your coin"),s("NotifyCoinTo","your coin"),s("NotifyGemTo","your gem"),s("NotifyCoinToGem","your coin to current gem"),s("NotifyGemToCoin","your gem to current coin"),s("NotifyCoinToGemHigh","notify if current gem > this gem"),s("NotifyGemToCoinHigh","notify if current coin > this coin"),I.qTip.init($("#trdExchange input")),$("#trdExchange input").click(function(){$(this).select()}),e.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateCoinTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateCoinTo()})),t.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateGemTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateGemTo()})),n.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateMoneyTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateMoneyTo()})),i.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyCoinTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyCoinTo()})),a.on("input",$.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyGemTo(!1)})).onEnterKey($.throttle(E.cEXCHANGE_LIMIT,function(){E.updateNotifyGemTo()})),X.initializeTextlist(X.Textlists.ExchangeUnit,$([e,t,n,i,a,r,o]),null,16),$(".trdProgress").data("width",$(".trdProgress").width()),E.isTradingCalculatorsInitialized=!0,E.loopRefresh()},cancelLoopRefresh:function(){window.clearTimeout(E.ProgressTimeout),window.clearTimeout(E.RefreshTimeout),$(".trdProgress").width($(".trdProgress").data("width"))},animateProgress:function(){var e=$(".trdProgress");E.ProgressTick<E.ProgressWait&&e.width(e.width()-e.data("width")/E.ProgressWait),E.ProgressTick-=1,E.ProgressTimeout=setTimeout(E.animateProgress,T.cMILLISECONDS_IN_SECOND)},loopRefresh:function(e){if(E.cancelLoopRefresh(),(e===!0||O.Options.bol_refreshPrices)&&(E.updateAllTradingPrices(),E.updateAllExchange(),O.Options.bol_refreshPrices)){var t=O.Options.int_secTradingRefresh*T.cMILLISECONDS_IN_SECOND;E.ProgressTick=O.Options.int_secTradingRefresh,E.ProgressWait=O.Options.int_secTradingRefresh,E.animateProgress(),E.RefreshTimeout=setTimeout(E.loopRefresh,t)}},initializeCalculator:function(){$("#trdCalculation .trdCalculator").onEnterKey(function(){E.doCalculation($(this))}).click(function(){$(this).select()}),$("#trdCalculation .trdCalcSubmit").click(function(){E.doCalculation($(this).prev())});for(var e in E.CalculatorHistoryArray)E.CalculatorHistoryArray[e]="";$("#trdCalculation .trdCalculator").onArrowUpKey(function(){if(0===E.CalcHistoryIndex){var e=U.stripToCalculation($(this).val());E.CalculatorHistoryArray[0]!==$(this).val().toString()&&(E.CalculatorHistoryArray.pop(),E.CalculatorHistoryArray.unshift(e))}E.CalcHistoryIndex+1<E.CalculatorHistoryArray.length&&(E.CalcHistoryIndex++,$(this).val(E.CalculatorHistoryArray[E.CalcHistoryIndex]))}),$("#trdCalculation .trdCalculator").onArrowDownKey(function(){E.CalcHistoryIndex-1>=0&&(E.CalcHistoryIndex--,$(this).val(E.CalculatorHistoryArray[E.CalcHistoryIndex]))})},doCalculation:function(pCalculator){var expression=U.stripToCalculation(pCalculator.val()),result="";try{result=eval(expression)}catch(pException){}pCalculator.val(parseFloat(result)).select(),result.toString().length>0&&(E.CalculatorHistoryArray.pop(),E.CalculatorHistoryArray.unshift(expression),E.CalcHistoryIndex=0)}},D={Dictionary:{s_TEMPLATE:{de:"",es:"",fr:"",cs:"",it:"",pl:"",pt:"",ru:"",zh:""},s_w:{de:"w",es:"s",fr:"s",cs:"t",it:"s",pl:"t",pt:"s",ru:"н",zh:"週"},s_d:{de:"t",es:"d",fr:"j",cs:"d",it:"g",pl:"d",pt:"d",ru:"д",zh:"日"},s_h:{de:"h",es:"h",fr:"h",cs:"h",it:"o",pl:"g",pt:"h",ru:"ч",zh:"時"},s_m:{de:"m",es:"m",fr:"m",cs:"m",it:"m",pl:"m",pt:"m",ru:"м",zh:"分"},s_s:{de:"s",es:"s",fr:"s",cs:"s",it:"s",pl:"s",pt:"s",ru:"с",zh:"秒"},s_hour:{de:"stunde",es:"hora",fr:"heure",cs:"hodina",it:"ora",pl:"godzinę",pt:"hora",ru:"час",zh:"時"},s_minute:{de:"minute",es:"minuto",fr:"minute",cs:"minuta",it:"minuto",pl:"minuta",pt:"minuto",ru:"минута",zh:"分"},s_second:{de:"sekunde",es:"segundo",fr:"seconde",cs:"sekunda",it:"secondo",pl:"sekund",pt:"segundo",ru:"секунду",zh:"秒"},s_hours:{de:"studen",es:"horas",fr:"heures",cs:"hodin",it:"secondi",pl:"godzin",pt:"horas",ru:"часов",zh:"時"},s_minutes:{de:"minuten",es:"minutos",fr:"minutes",cs:"minut",it:"minuti",pl:"minut",pt:"minutos",ru:"минут",zh:"分"},s_seconds:{de:"sekunden",es:"segundos",fr:"secondes",cs:"sekund",it:"ore",pl:"sekund",pt:"segundos",ru:"секунд",zh:"秒"},s_half_an_hour:{de:"eine halbe stunde",es:"media hora",fr:"demi-heure",cs:"půl hodiny",it:"mezz'ora",pl:"pół godziny",pt:"meia hora",ru:"полчаса",zh:"半小時"},s_timers:{de:"zeitgeber",es:"temporizadores",fr:"minuteurs",cs:"časovače",it:"timer",pl:"czasomierzy",pt:"temporizadores",ru:"таймеров",zh:"計時器"},s_tools:{de:"extras",es:"herramientas",fr:"outils",cs:"nástroje",it:"strumenti",pl:"narzędzia",pt:"ferramentas",ru:"инструменты",zh:"工具"},s_help:{de:"hilfe",es:"ayuda",fr:"assistance",cs:"pomoci",it:"guida",pl:"pomoc",pt:"ajuda",ru:"помощь",zh:"輔助"},s_options:{de:"optionen",es:"opciónes",fr:"options",cs:"možnosti",it:"opzioni",pl:"opcje",pt:"opções",ru:"параметры",zh:"選項"},s_arrival:{de:"ankunft",es:"llegada",fr:"arrivée",cs:"příjezd",it:"arrivo",pl:"przyjazd",pt:"chegada",ru:"прибытие",zh:"到來"},s_world:{de:"welt",es:"mundo",fr:"monde",cs:"svět",it:"mondo",pl:"świat",pt:"mundo",ru:"босс",zh:"世界"},s_boss:{de:"boss",es:"jefe",fr:"chef",cs:"boss",it:"boss",pl:"szef",pt:"chefe",ru:"мировой",zh:"頭目"},s_event:{de:"event",es:"evento",fr:"événement",cs:"událost",it:"evento",pl:"wydarzenie",pt:"evento",ru:"собы́тие",zh:"事件"},s_section:{de:"paragraph",es:"sección",fr:"section",cs:"oddíl",it:"sezione",pl:"sekcja",pt:"seção",ru:"раздел",zh:"節"},s_map:{de:"karte",es:"mapa",fr:"carte",cs:"mapa",it:"mappa",pl:"mapa",pt:"mapa",ru:"ка́рта",zh:"地圖"},s_center:{de:"zentrum",es:"centro",fr:"centre",cs:"střed",it:"centro",pl:"środek",pt:"centro",ru:"центр",zh:"中心"},s_character:{de:"person",es:"personaje",fr:"personnage",cs:"postava",it:"personaggio",pl:"postać",pt:"personagem",ru:"персона́ж",zh:"人物"},s_completion:{de:"abschluss",es:"finalización",fr:"progression",cs:"dokončení",it:"completamento",pl:"ukończenie",pt:"progressão",ru:"завершение",zh:"完成"},s_route:{de:"route",es:"ruta",fr:"route",cs:"trasa",it:"percorso",pl:"trasa",pt:"rota",ru:"маршру́т",zh:"路線"},s_pins:{de:"stecknadel",es:"alfileres",fr:"épingles",cs:"špendlík",it:"spilli",pl:"szpilka",pt:"alfinetes",ru:"була́вка",zh:"大頭針"},s_lock:{de:"sperre",es:"bloqueo",fr:"verrou",cs:"zámek",it:"blocco",pl:"zablokuj",pt:"bloqueio",ru:"блокировка",zh:"鎖定"},s_Vista:{de:"Aussichtspunkt",es:"Vista",fr:"Panorama",zh:"鳥瞰點"},s_Hero_Challenge:{de:"Heldenherausforderung",es:"Desafío de héroe",fr:"Défi de héros",zh:"技能點"},s_checklist:{de:"prüfliste",es:"lista de comprobación",fr:"liste de contrôle",cs:"kontrolní seznam",it:"elenco di controllo",pl:"lista kontrolna",pt:"lista de verificação",ru:"контрольный список",zh:"檢查清單"},s_subscription:{de:"abonnement",es:"suscripción",fr:"abonnement",cs:"předplatné",it:"sottoscrizione",pl:"abonament",pt:"assinatura",ru:"подписка",zh:"訂閱"},s_alarm:{de:"alarm",es:"alarma",fr:"alarme",cs:"alarmu",it:"allarme",pl:"alarmu",pt:"alarme",ru:"будильника",zh:"鬧鐘"},s_mode:{de:"modus",es:"modo",fr:"mode",cs:"režim",it:"modalità",pl:"tryb",pt:"modo",ru:"режим",zh:"方式"},s_chatlink:{de:"chatlink",es:"vínculo chat",fr:"lien chat",cs:"chat odkaz",it:"collegamento chat",pl:"czat łącze",pt:"link bate-papo",ru:"чат связь",zh:"連結聊天"},s_wvw:{de:"WvW",es:"McM",fr:"McM",cs:"SpS",it:"McM",pl:"SkS",pt:"McM",ru:"МпМ",zh:"世界戰場"},s_stopwatch:{de:"stoppuhr",es:"cronómetro",fr:"chronomètre",cs:"stopky",it:"cronografo",pl:"stoper",pt:"cronômetro",ru:"секундомер",zh:"碼錶"},s_is:{de:"ist",es:"es",fr:"est",cs:"je",it:"è",pl:"jest",pt:"é",ru:"является",zh:"是"},s_subscribe:{de:"abonnieren",es:"subscribir",fr:"abonner",cs:"předplatit si",it:"sottoscrivere",pl:"abonować",pt:"assinar",ru:"подписаться",zh:"訂閱"},s_will_start:{de:"wird starten",es:"se iniciará",fr:"débutera",cs:"začne",it:"inizierà",pl:"rozpocznie się",pt:"começará",ru:"начнется",zh:"開始"},s_click:{de:"klicken",es:"clic",fr:"cliquer",cs:"kliknout",it:"clic",pl:"klikać",pt:"clicar",ru:"щелкнуть",zh:"按一下"},s_load:{de:"laden",es:"cargar",fr:"charger",cs:"načíst",it:"caricare",pl:"załaduj",pt:"carregar",ru:"загрузить",zh:"載入"},s_save:{de:"speichern",es:"guardar",fr:"enregistrer",cs:"uložit",it:"salvare",pl:"zapisać",pt:"salvar",ru:"сохранить",zh:"儲存"},s_clear:{de:"löschen",es:"borrar",fr:"effacer",cs:"vymazat",it:"cancella",pl:"wyczyść",pt:"limpar",ru:"очистить",zh:"清除"},s_toggle:{de:"umschalten",es:"alternar",fr:"basculer",cs:"přepnout",it:"alterna",pl:"przełączanie",pt:"alternar",ru:"переключить",zh:"切換"},s_expand:{de:"erweitern",es:"expandir",fr:"développer",cs:"rozbalit",it:"espandere",pl:"rozwinąć",pt:"expandir",ru:"развернуть",zh:"展開"},s_collapse:{de:"reduzieren",es:"contraer",fr:"réduire",cs:"sbalit",it:"comprimere",pl:"zwinąć",pt:"recolher",ru:"свернуть",zh:"摺疊"},s_draw:{de:"zeichnen",es:"dibujar",fr:"dessiner",cs:"kreslit",it:"disegnare",pl:"rysować",pt:"desenhar",ru:"рисова́ть",zh:"画"},s_undo:{de:"rückgängig",es:"deshacer",fr:"annuler",cs:"zpět",it:"annullare",pl:"cofnąć",pt:"desfazer",ru:"отменить",zh:"復原"},s_optimize:{de:"optimieren",es:"optimizar",fr:"optimiser",cs:"optimalizovat",it:"ottimizzare",pl:"optymalizować",pt:"otimizar",ru:"оптимизировать",zh:"最佳化"},s_ago:{de:"vor",es:"hace",fr:"il ya",cs:"před",it:"fa",pl:"temu",pt:"há",ru:"назад",zh:"前"},s_also:{de:"auch",es:"también",fr:"aussi",cs:"také",it:"anche",pl:"też",pt:"também",ru:"то́же",zh:"也"},s_checked:{de:"abgehakt",es:"visto",fr:"coché",cs:"odškrtnout",it:"controllato",pl:"zakończony",pt:"marcado",ru:"включен",zh:"勾掉"},s_current:{de:"aktuelle",es:"actual",fr:"actuel",cs:"současný",it:"corrente",pl:"bieżący",pt:"corrente",ru:"текущий",zh:"活期"},s_daily:{de:"täglich",es:"diaria",fr:"quotidien",cs:"denní",it:"giornaliero",pl:"dzienny",pt:"diário",ru:"ежедневно",zh:"每天"},s_next:{de:"nächste",es:"siguiente",fr:"prochain",cs:"příští",it:"seguente",pl:"następny",pt:"próximo",ru:"следующий",zh:"下一"},s_off:{de:"aus",es:"desactivado",fr:"désactivé",cs:"vypnuto",it:"disattivato",pl:"wyłączany",pt:"desativado",ru:"выключено",zh:"關"},s_predicted:{de:"vorhergesagt",es:"previsto",fr:"prédit",cs:"předpovídal",it:"previsto",pl:"przewiduje",pt:"predito",ru:"предсказанный",zh:"預測"},s_subscribed:{de:"abonniert",es:"suscrito",fr:"souscrit",cs:"odebírané",it:"sottoscritti",pl:"subskrypcji",pt:"assinado",ru:"подписан",zh:"訂閱"},s_then:{de:"dann",es:"luego",fr:"puis",cs:"pak",it:"poi",pl:"potem",pt:"então",ru:"затем",zh:"接著"},s_at:{de:"um",es:"a",fr:"à",cs:"v",it:"a",pl:"o",pt:"a",ru:"в",zh:"在"},s_and:{de:"und",es:"y",fr:"et",cs:"a",it:"e",pl:"i",pt:"e",ru:"и",zh:"和"},s_if:{de:"wenn",es:"si",fr:"si",cs:"jestliže",it:"se",pl:"jeśli",pt:"se",ru:"если",zh:"如果"},s_in:{de:"in",es:"en",fr:"en",cs:"za",it:"in",pl:"w",pt:"em",ru:"в",zh:"在"},s_to:{de:"zu",es:"a",fr:"contre",cs:"ku",it:"a",pl:"na",pt:"a",ru:"до",zh:"比"},s_Scheduled_Bosses:{de:"Geplant",es:"Programado",fr:"Planifié",cs:"Plánované",it:"Pianificata",pl:"Zaplanowane",pt:"Agendado",ru:"Запланирован",zh:"已排程"},s_Dry_Top:{de:"Trockenkuppe",es:"Cima Seca",fr:"Cimesèche",zh:"干涸高地"},s_Legacy_Bosses:{de:"Legacy",es:"Heredado",fr:"Hérité",cs:"Starší",it:"Legacy",pl:"Starsze",pt:"Herdado",ru:"Устаревший",zh:"舊版"},s_Orr_Temples:{de:"Tempel",es:"Templos",fr:"Temples",cs:"Chrámy",it:"Templi",pl:"Świątynie",pt:"Templos",ru:"Храмы",zh:"寺廟"},s_Full_Timetable:{de:"Zeitplan",es:"Horario",fr:"Horaire",cs:"Plán",it:"Programma",pl:"Harmonogram",pt:"Horário",ru:"Расписание",zh:"時間表"},s_Gem_Store_Promotions:{de:"Edelsteinshop Aktionen",es:"Promociones gemas",fr:"Promotions gemmes",cs:"Drahokam Prodejna Propagace",it:"Negozio gemma promozioni",pl:"Klejnot Sklep Promocje",pt:"Loja gema promoções",ru:"Самоцве́т Магази́н Продвижения",zh:"寶石商店促銷"},s_forum:{de:"forum",es:"foro",fr:"forum",cs:"fórum",it:"forum",pl:"forum",pt:"fórum",ru:"форум",zh:"論壇"},s_simple:{de:"einfach",es:"simple",fr:"simple",cs:"prostý",it:"semplice",pl:"prosty",pt:"simples",ru:"простой",zh:"簡單"},s_mobile:{de:"mobil",es:"móvil",fr:"mobile",cs:"mobilní",it:"mobile",pl:"mobilna",pt:"móvel",ru:"мобильный",zh:"行動"},s_tile:{de:"kachel",es:"mosaico",fr:"mosaïque",cs:"dlaždice",it:"affianca",pl:"sąsiadująco",pt:"ladrilho",ru:"замостить",zh:"磚"},s_this:{de:"dieses",es:"esto",fr:"ce",cs:"toto",it:"questo",pl:"to",pt:"isto",ru:"это",zh:"這"},s_your:{de:"dein",es:"tu",fr:"ton",cs:"tvůj",it:"tuo",pl:"twój",pt:"teu",ru:"твой",zh:"你的"},s_name:{de:"namen",es:"nombre",fr:"nom",cs:"název",it:"nome",pl:"nazwa",pt:"nome",ru:"имя",zh:"名"},s_buy:{de:"kaufen",es:"comprar",fr:"acheter",cs:"koupit",it:"comprare",pl:"kupić",pt:"comprar",ru:"купить",zh:"買"},s_sell:{de:"verkaufen",es:"vender",fr:"vendre",cs:"prodat",it:"vendere",pl:"sprzedać",pt:"vender",ru:"продать",zh:"賣"},s_quantity:{de:"quantität",es:"cantidad",fr:"quantité",cs:"množství",it:"quantità",pl:"ilość",pt:"quantidade",ru:"количество",zh:"量"},s_profit:{de:"gewinn",es:"beneficio",fr:"profit",cs:"zisk",it:"profitto",pl:"zysk",pt:"lucro",ru:"прибыль",zh:"利潤"},s_cost:{de:"kosten",es:"costo",fr:"coût",cs:"náklady",it:"costo",pl:"koszt",pt:"custo",ru:"стоимость",zh:"成本"},s_breakpoint:{de:"gewinnschwelle",es:"punto muerto",fr:"seuil de rentabilité",cs:"bod zvratu",it:"punto di pareggio",pl:"próg rentowności",pt:"ponto de equilíbrio",ru:"точка безубыточности",zh:"收支平衡點"},s_tax:{de:"steuer",es:"impuestos",fr:"impôt",cs:"daň",it:"fiscale",pl:"podatek",pt:"fiscal",ru:"налог",zh:"稅"},s_revenue:{de:"einnahmen",es:"ingresos",fr:"revenus",cs:"příjmy",it:"entrate",pl:"dochody",pt:"receita",ru:"доходов",zh:"收入"},s_margin:{de:"marge",es:"margen",fr:"marge",cs:"marže",it:"margine",pl:"marża",pt:"margem",ru:"валовая",zh:"邊際"},s_low:{de:"niedrigen",es:"bajo",fr:"bas",cs:"nízký",it:"bassa",pl:"niski",pt:"baixa",ru:"низкая",zh:"低"},s_high:{de:"hohen",es:"alta",fr:"haut",cs:"vysoký",it:"alta",pl:"wysoki",pt:"alta",ru:"высокая",zh:"高"},s_notify:{de:"benachrichtigen",es:"notificar",fr:"notifier",cs:"oznámit",it:"notifica",pl:"powiadom",pt:"notificar",ru:"уведомить",zh:"通知"},s_overwrite:{de:"überschreiben",es:"sobrescribir",fr:"remplacer",cs:"přepsat",it:"sovrascrivi",pl:"zastąp",pt:"substituir",ru:"перезаписать",zh:"覆寫"},s_gem:{de:"edelsteine",es:"gema",fr:"gemme",cs:"klenot",it:"gemma",pl:"klejnot",pt:"gema",ru:"самоцвет",zh:"寶石"},s_coin:{de:"münze",es:"moneda",fr:"monnaie",cs:"mince",it:"moneta",pl:"moneta",pt:"moeda",ru:"монета",zh:"硬幣"},s_dollar:{de:"dollar",es:"dólar",fr:"dollar",cs:"dolar",it:"dollaro",pl:"polar",pt:"dólar",ru:"доллар",zh:"元"}},getTranslation:function(e){if(D.isLanguageDefault())return e;var t,n,i=e;-1!==i.indexOf(" ")&&(i=i.replace(/ /g,"_"));var t=D.Dictionary["s_"+i];return t&&(n=t[O.Options.enu_Language])?n:e},getWord:function(e){return D.isLanguageDefault()?e:D.Dictionary["s_"+e][O.Options.enu_Language]},getWordCapital:function(e){return U.toFirstUpperCase(D.getTranslation(e))},getPhrase:function(e,t){void 0===t&&(t=U.CaseEnum.None);var n=e.split(" ");if(t===U.CaseEnum.Original)for(var i in n)n[i]=D.duplicateCase(n[i],D.getTranslation(n[i].toLowerCase()));else for(var i in n)n[i]=D.getTranslation(n[i]);var a=D.isLanguageLogographic()?n.join(""):n.join(" ");return t===U.CaseEnum.None||t===U.CaseEnum.Original?a:U.toCase(a,t)},getPhraseTitle:function(e){return D.getPhrase(e,U.CaseEnum.Every)},getPhraseOriginal:function(e){return O.Options.enu_Language!==O.OptionEnum.Language.Default?D.getPhrase(e,U.CaseEnum.Original):e},getModifiedWord:function(e,t,n){return D.getPhrase(D.orderModifier(e,t),n)},orderModifier:function(e,t){return D.isLanguageModifierFirst()?t+" "+e:e+" "+t},duplicateCase:function(e,t){var n=e.charAt(0);if(n===n.toLowerCase())return t;if(e.length>2&&t.length>2){var i=e.charAt(1);if(n===n.toUpperCase()&&i===i.toUpperCase())return t.toUpperCase()}return t.charAt(0).toUpperCase()+t.slice(1)},translateElements:function(){O.Options.enu_Language!==O.OptionEnum.Language.Default&&($(".jsTranslate").each(function(){$(this).text(D.getPhraseOriginal($(this).text())).removeClass("jsTranslate")}),$(".jsTranslateCompound").each(function(){$(this).text(D.getTranslation($(this).text())).removeClass("jsTranslateCompound")}))},translateAfter:function(){O.Options.enu_Language!==O.OptionEnum.Language.Default&&($("#paneMenu kbd").each(function(){$(this).attr("title","<dfn>"+D.getPhraseOriginal($(this).find(".jsTranslate").text())+"</dfn>"),I.qTip.init($(this))}),$(".mapHUDButton").each(function(){$(this).attr("title",D.getPhraseOriginal($(this).attr("title")))}),D.translateElements()),I.qTip.init(".mapHUDButton")},isLanguageFullySupported:function(){return O.Options.enu_Language===O.OptionEnum.Language.English||O.Options.enu_Language===O.OptionEnum.Language.German||O.Options.enu_Language===O.OptionEnum.Language.Spanish||O.Options.enu_Language===O.OptionEnum.Language.French?!0:!1},isLanguageDefault:function(){return O.Options.enu_Language===O.OptionEnum.Language.Default},getFullySupportedLanguage:function(){return D.isLanguageFullySupported()?O.Options.enu_Language:O.OptionEnum.Language.Default},getPartiallySupportedLanguage:function(){return D.isLanguageFullySupported()||O.Options.enu_Language===O.OptionEnum.Language.Mandarin?O.Options.enu_Language:O.OptionEnum.Language.Default},getNameKey:function(){return"name_"+D.getFullySupportedLanguage()},getURLKey:function(){return"url_"+D.getFullySupportedLanguage()},getObjectName:function(e){return void 0!==e["name_"+O.Options.enu_Language]?e["name_"+O.Options.enu_Language]:D.getObjectDefaultName(e)},getObjectNick:function(e){return void 0!==e["nick_"+O.Options.enu_Language]?e["nick_"+O.Options.enu_Language]:D.getObjectDefaultNick(e)},getObjectDefaultName:function(e){return e["name_"+O.OptionEnum.Language.Default]},getObjectDefaultNick:function(e){return e["nick_"+O.OptionEnum.Language.Default]},getObjectURL:function(e){return e["url_"+D.getFullySupportedLanguage()]},isLanguageSecondary:function(){return O.Options.enu_Language===O.OptionEnum.Language.German||O.Options.enu_Language===O.OptionEnum.Language.Spanish||O.Options.enu_Language===O.OptionEnum.Language.French?!0:!1},isLanguageModifierFirst:function(){return O.Options.enu_Language===O.OptionEnum.Language.French||O.Options.enu_Language===O.OptionEnum.Language.Spanish||O.Options.enu_Language===O.OptionEnum.Language.Italian||O.Options.enu_Language===O.OptionEnum.Language.Portuguese||O.Options.enu_Language===O.OptionEnum.Language.Mandarin?!1:!0},isLanguageLogographic:function(){return O.Options.enu_Language===O.OptionEnum.Language.Mandarin?!0:!1},getChainTitle:function(e){return D.isLanguageDefault()?e.title:D.getObjectName(e)},getChainAlias:function(e){return D.isLanguageDefault()?e.alias:D.getChainTitle(e)},speechWait:0,speak:function(e,t){if(I.isSpeechSynthesisEnabled){var n=new SpeechSynthesisUtterance(e);return n.lang=O.LanguageCode[O.Options.enu_Language],n.volume=O.Options.int_setVolume/T.cPERCENT_100,n.rate=.8,void window.speechSynthesis.speak(n)}var i=function(e){var t=document.getElementById("jsTTSAudio");t.src=U.URL_API.TextToSpeech+e,t.volume=O.Options.int_setVolume/T.cPERCENT_100,t.load(),t.play()};if(void 0===t){var a=D.isLanguageLogographic()?4:12;t=1+Math.round(e.length/a)}var r=t*T.cMILLISECONDS_IN_SECOND;0===D.speechWait?(D.speechWait+=r,i(e),setTimeout(function(){D.speechWait-=r},r)):(D.speechWait+=r,setTimeout(function(){D.speechWait>0&&(i(e),D.speechWait-=r)},D.speechWait-r))},isSpeaking:function(){return 0===D.speechWait?!1:!0},stopSpeech:function(){I.isSpeechSynthesisEnabled?window.speechSynthesis.cancel():document.getElementById("jsTTSAudio").src=""},resetSpeechQueue:function(e){void 0===e&&(e=0),D.speechWait>e*T.cMILLISECONDS_IN_SECOND&&(D.speechWait=0,D.stopSpeech())},getSpeechWord:function(e,t){return t?D.getModifiedWord(e,t):D.getPhrase(e)},getSpeechInitials:function(e,t){var n=e.charAt(e.length-1);if(n===n.toLowerCase())return e;t&&(e=e.replace(/ /g,"")),e=e.toUpperCase();for(var i="",a="",r=0;r<e.length;r++)a=e.charAt(r),i+=" "===a?a:a+".";return i},getPluralTime:function(e,t){return e>1&&(t+="s")," "+D.getWord("in")+" "+e+" "+D.getWord(t)},getChainPronunciation:function(e){return D.isLanguageDefault()||I.BrowserCurrent!==I.BrowserEnum.Chrome?C.Chains[e.nexus].pronunciation:D.getChainTitle(e)},sortObjects:function(e){var t=D.getNameKey();e.sort(function(e,n){return e[t]>n[t]?1:e[t]<n[t]?-1:0})}},C={Chains:GW2T_CHAIN_DATA,ChainAssociation:{},UnscheduledChainsLength:GW2T_CHAIN_ADD_LENGTH,DryTop:{},cIndexSynonym:"nexus",ChainToday:null,ChainTomorrow:null,ChainDummy:{alias:"dummy"},CurrentChainSD:{},NextChainSD1:{},NextChainSD2:{},NextChainSD3:{},NextChainSD4:{},CurrentChainHC:{},NextChainHC1:{},NextChainHC2:{},NextChainHC3:{},NextChainHC4:{},NextChainLS1:{},NextChainLS2:{},NextChainsMS1:[],NextChainsMS2:[],CurrentChains:[],CurrentChainsSD:[],PreviousChains1:[],PreviousChains2:[],NextChains1:[],cEventTitleCharLimit:44,cEventNameWidth:320,TempleChains:[],LegacyChains:[],UnscheduledChains:[],ScheduledChains:[],RegularChains:[],MiscellaneousChains:[],DryTopChains:[],LivingStoryChains:[],ChainSeriesEnum:{Temple:0,Legacy:1,ScheduledCutoff:2,Standard:2,Hardcore:3,WorldBossCuttoff:3,Miscellaneous:4,DryTop:5,LivingStory:6},EventPrimacyEnum:{Optional:0,Normal:1,Primary:2,Boss:3},isUnscheduledChainsLoaded:!1,isDryTopGenerated:!1,isDryTopIconsShown:!1,isTimetableGenerated:!1,getChainByAlias:function(e){return C.Chains[C.ChainAssociation[e.toLowerCase()]]},getChainRegion:function(e){return M.getZoneRegion(e.zone)},isChainToday:function(e){return C.ChainToday&&e.nexus===C.ChainToday.nexus?!0:!1},refreshChainDailyIcon:function(){for(var e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)C.isChainToday(C.CurrentChainsSD[e])?K["WpChain"+e].addClass("clkWaypointDaily"):K["WpChain"+e].removeClass("clkWaypointDaily");$(".chnDaily").hide(),C.ChainToday&&$(".chnDaily_"+C.ChainToday.nexus).show(),C.updateTimetable()},isChainScheduled:function(e){return e.series>=C.ChainSeriesEnum.ScheduledCutoff?!0:!1},isChainWorldBoss:function(e){return e.series<=C.ChainSeriesEnum.WorldBossCuttoff?!0:!1},isChainRegular:function(e){return e.series===C.ChainSeriesEnum.Standard||e.series===C.ChainSeriesEnum.Hardcore||e.series===C.ChainSeriesEnum.Miscellaneous||e.series===C.ChainSeriesEnum.LivingStory?!0:!1},parseChainAlias:function(e){return-1!==e.indexOf("XXX")?e.split("XXX")[0]:e},getEventStepNumber:function(e){if(1===e.length)return e;var t,n="";for(t=0;t<e.length;t++){if(!isFinite(e.charAt(t)))return n;n+=e.charAt(t)}return n},initializeChain:function(e){var t,n,i,a="",r=D.getObjectName(e);for(t in e.events)e.events[t].step=parseInt(C.getEventStepNumber(e.events[t].num))-1;if(e.isSorted=!1,e.primaryEvents=[],e.scheduleKeys=[],void 0!==e.waypoint&&(a="<input class='chnWaypoint' type='text' value='"+e.waypoint+" "+r+"' />  ("+e.level+")<a"+U.convertExternalAnchor(U.getYouTubeLink(D.getObjectDefaultName(e)+" "+I.cGameNick))+"><ins class='s16 s16_youtube' title='Recommended level. Click for YouTube videos.'></ins></a> "),void 0!==e.reward)for(t in e.reward)a+=e.reward[t]+"<ins class='s16 s16_"+t+"' title='"+t+"'></ins> ";$(e.htmllist).append("<div id='chnBar_"+e.nexus+"' class='chnBar'><div class='chnTitle'><img id='chnIcon_"+e.nexus+"' src='img/chain/"+C.parseChainAlias(e.alias).toLowerCase()+I.cPNG+"' /><samp id='chnCheck_"+e.nexus+"' class='chnCheck'></samp><h1 id='chnTitle_"+e.nexus+"'>"+r+"</h1><time id='chnTime_"+e.nexus+"' class='chnTimeFutureFar'></time><aside><img class='chnDaily chnDaily_"+e.nexus+"' src='img/ui/daily.png' /></aside></div><div id='chnDetails_"+e.nexus+"' class='chnDetails'><ol id='chnEvents_"+e.nexus+"' class='chnEvents'></ol><div class='chnDetailsExtra'>"+a+"<kbd id='chnDelete_"+e.nexus+"' title='Permanently hide this event chain (can undo in ▼ icon above).'></kbd></div></div></div>");var o=function(e,t){var n=t,i="&lt;br /&gt;",a=function(e){return"&lt;dfn&gt;"+e+"&lt;/dfn&gt;"},r="";r=e.series===C.ChainSeriesEnum.DryTop?a("Event Number: ")+n.num+i+a("Start Time: ")+n.lim+i+i+"&amp;quot;"+D.getObjectName(n).replace(/["']/g,"")+"&amp;quot;":a("Event Number: ")+n.num+i+a("If Success Go To: ")+n.sGotoNum+i+a("If Failure Go To: ")+n.fGotoNum+i+a("If Success Wait: ")+n.sInterim+i+a("If Failure Wait: ")+n.fInterim+i+a("Time Limit: ")+n.lim+i+a("Avg to Complete: ")+n.avg+i+a("Min to Complete: ")+n.min+i+a("Max to Complete: ")+n.max+i+i+"&amp;quot;"+D.getObjectName(n).replace(/["']/g,"")+"&amp;quot;";var o="",s=C.cEventTitleCharLimit,c=function(){o="chnSubstep",s=C.cEventTitleCharLimit-4},l=C.getEventStepNumber(n.num);if(l.length!==n.num.length){var u=n.num.slice(l.length);-1!==n.num.indexOf(".")?c():2===n.num.length?-1===u.indexOf("A")&&-1===u.indexOf("a")&&c():-1===u.indexOf("A1")&&-1===u.indexOf("a1")&&c()}$("#chnEvents_"+e.nexus).append("<li id='chnEvent_"+e.nexus+"_"+n.num+"' class='chnStep_"+e.nexus+"_"+n.step+" "+o+"'><ins class='evt_"+n.icon+"' title='"+r+"'></ins><span>"+U.truncateString(D.getObjectName(n),s,"..")+"</span></li>")};for(t in e.events)if(i=e.events[t],i.primacy===C.EventPrimacyEnum.Primary)e.primaryEvents.push(i);else if(i.primacy===C.EventPrimacyEnum.Boss){e.primaryEvents.push(i),e.primaryEvents[0].minSum=0,e.primaryEvents[0].avgSum=0,e.primaryEvents[0].minavgSum=0;break}for(t=1;t<e.primaryEvents.length;t++){var s=T.parseEventTime(e.primaryEvents[t-1].sInterim[0]);e.primaryEvents[t].minSum=T.parseEventTime(e.primaryEvents[t-1].min)+s+e.primaryEvents[t-1].minSum,e.primaryEvents[t].avgSum=T.parseEventTime(e.primaryEvents[t-1].avg)+s+e.primaryEvents[t-1].avgSum,e.primaryEvents[t].minavgSum=e.primaryEvents[t].minSum+~~(Math.abs(e.primaryEvents[t].avgSum-e.primaryEvents[t].minSum)/2)}if(t--,e.minFinish=e.primaryEvents[t].minSum+T.parseEventTime(e.primaryEvents[t].min),e.avgFinish=e.primaryEvents[t].avgSum+T.parseEventTime(e.primaryEvents[t].avg),e.minavgFinish=e.minFinish+~~(Math.abs(e.avgFinish-e.minFinish)/2),n=0,C.isChainScheduled(e)){for(t in e.events)if(e.events[t].primacy!==C.EventPrimacyEnum.Optional&&(C.getEventStepNumber(e.events[t].num)!==C.getEventStepNumber(e.primaryEvents[n].num)&&n++,o(e,e.events[t])),e.events[t].primacy===C.EventPrimacyEnum.Boss)break}else for(t in e.events)o(e,e.events[t]);I.ModeCurrent!==I.ModeEnum.Tile&&($("#chnTitle_"+e.nexus).click(function(){$(this).parent().next().slideToggle(100)}),$("#chnDetails_"+e.nexus).hide()),D.isLanguageDefault()&&I.isMapEnabled&&$("#chnBar_"+e.nexus).hover(function(){$("#chnTitle_"+e.nexus).text(D.getChainTitle(e))},function(){$("#chnTitle_"+e.nexus).text(D.getObjectName(e))}),$("#chnDetails_"+e.nexus+" .chnWaypoint").click(function(){$(this).select()}),I.qTip.init($("#chnDetails_"+e.nexus+" ins")),I.qTip.init($("#chnDetails_"+e.nexus+" kbd")),X.initializeChainChecklist(e)},initializeScheduledChains:function(){for(var e,t=C.Chains.length,n=0;t>n;n++){switch(e=C.Chains[n],e.nexus=n,C.ChainAssociation[e.alias.toLowerCase()]=e.nexus,e.series){case C.ChainSeriesEnum.Standard:e.htmllist="#sectionChains_Scheduled",C.RegularChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.Hardcore:e.htmllist="#sectionChains_Scheduled",C.RegularChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.DryTop:e.htmllist="#sectionChains_Drytop",C.DryTopChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.Miscellaneous:e.htmllist="#sectionChains_Scheduled",C.MiscellaneousChains.push(e),C.ScheduledChains.push(e);break;case C.ChainSeriesEnum.LivingStory:if(!B.isDashboardStoryEnabled)continue;e.htmllist=I.isProgramEmbedded||I.ModeCurrent!==I.ModeEnum.Website&&I.ModeCurrent!==I.ModeEnum.Overlay?"#sectionChains_Scheduled":"#dsbStory",C.LivingStoryChains.push(e),
C.ScheduledChains.push(e),T.insertChainToSchedule(e)}C.initializeChain(e)}},initializeUnscheduledChains:function(){C.isUnscheduledChainsLoaded===!1&&$.getScript(U.URL_DATA.Unscheduled).done(function(){if(!C.isUnscheduledChainsLoaded){for(var e=GW2T_CHAIN_UNSCHEDULED,t=C.Chains.length,n=0;n<e.length;n++)C.Chains.push(e[n]);for(var i,a=C.Chains.length,n=t;a>n;n++){switch(i=C.Chains[n],i.nexus=n,i.series){case C.ChainSeriesEnum.Temple:i.htmllist="#sectionChains_Temple",C.TempleChains.push(i),C.UnscheduledChains.push(i);break;case C.ChainSeriesEnum.Legacy:i.htmllist="#sectionChains_Legacy",C.LegacyChains.push(i),C.UnscheduledChains.push(i)}C.initializeChain(i),P.drawChainPaths(i)}C.isUnscheduledChainsLoaded=!0}})},isChainCurrent:function(e){for(var t in C.CurrentChains)if(e.nexus===C.CurrentChains[t].nexus)return!0;return!1},isChainUnchecked:function(e){return X.getChainChecklistState(e)===X.ChecklistEnum.Unchecked?!0:!1},isChainSubscribed:function(e){return X.getChecklistItem(X.Checklists.ChainSubscription,e.nexus)===X.ChecklistEnum.Checked?!0:!1},updateChainsTimeHTML:function(){var e,t,n,i,a="<dfn>"+D.getPhraseTitle("click to <br/> subscribe")+"</dfn><br />";for(e in C.ScheduledChains){t=C.ScheduledChains[e];var r,o="";if(t.series!==C.ChainSeriesEnum.DryTop){for(var s in t.scheduleKeys)r=0===parseInt(s)?a:" <br /> ",o=o+r+T.getTimeFormatted({wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(t.scheduleKeys[s])});$("#chnTime_"+t.nexus).prop("title",o)}C.isChainCurrent(t)||(n=T.getTimeFormatted({wantLetters:!0,wantSeconds:!1,customTimeInSeconds:T.getSecondsUntilChainStarts(t)}),i=T.getTimeFormatted({wantLetters:!1,wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(t.scheduleKeys[0])}),$("#chnTime_"+t.nexus).html(n+"<br /><sup>"+i+"</sup>"))}I.qTip.init(".chnTitle time")},updateCurrentChainTimeHTML:function(e){var t=T.getCurrentTimeframeElapsedTime(),n=e.countdownToFinish-t,i=n,a=I.Symbol.ArrowUp+" ";if(e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated){var r=T.getDryTopMinute(),o=T.getDryTopMinute(1);i=T.getTimeFormatted({reference:T.ReferenceEnum.UTC,want24:!0,wantHours:!1}),$("#chnTime_"+e.nexus).text("(:"+r+") "+i),C.isDryTopIconsShown&&$("#mapDryTopTimer").html("<var style='color:"+T.getCurrentDryTopColor()+"'>:"+r+"</var> "+i+" <var style='color:"+T.getCurrentDryTopColor(1)+"'>:"+o+"</var>")}else 0>=n&&(i=T.cSECONDS_IN_TIMEFRAME-t,a=I.Symbol.ArrowDown+" "),$("#chnTime_"+e.nexus).text(a+T.getTimeFormatted({wantLetters:!0,customTimeInSeconds:i}))},initializeTimetableHTML:function(){if(C.isTimetableGenerated!==!1){$("#sectionChains_Timetable").empty();var e,t,n,i,a;for(e in T.Schedule){n=T.getScheduleSlotChainsByKey(e);for(t in n){if(i=n[t],i.series!==C.ChainSeriesEnum.Standard&&i.series!==C.ChainSeriesEnum.Hardcore&&i.series!==C.ChainSeriesEnum.Miscellaneous)break;a=T.getTimeFormatted({wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(e)}),$("#sectionChains_Timetable").append("<div class='chnSlot chnSlotTime_"+e+" chnSlot_"+i.nexus+"' data-"+C.cIndexSynonym+"='"+i.nexus+"' data-timeframe='"+e+"'><div class='chnTitle'><img src='img/chain/"+C.parseChainAlias(i.alias).toLowerCase()+I.cPNG+"' /><samp class='chnCheck'></samp><h1>"+D.getObjectName(i)+"</h1><time>"+a+"</time><aside><img class='chnDaily chnDaily_"+i.nexus+"' src='img/ui/daily.png' /></aside></div></div>")}}for(var e in C.RegularChains){i=C.RegularChains[e];var r=$(".chnSlot_"+i.nexus),o=r.find(".chnCheck"),s=r.find("time");X.reapplyChainBarState(i.nexus,r,o,s)}$(".chnTitle h1").hover(function(){$(".chnSlot_"+$(this).parent().parent().data(C.cIndexSynonym)).addClass("chnBarHover")},function(){$(".chnSlot").removeClass("chnBarHover")}),$(".chnSlot samp").click(function(){$("#chnCheck_"+C.Chains[$(this).parent().parent().data(C.cIndexSynonym)].nexus).trigger("click")}),$(".chnSlot time").click(function(){$("#chnTime_"+C.Chains[$(this).parent().parent().data(C.cIndexSynonym)].nexus).trigger("click")}),$(".chnSlotTime_0").addClass("chnBarReset"),C.refreshChainDailyIcon()}},updateTimetable:function(){if(C.isTimetableGenerated!==!1){var e=T.getTimeframeKey(-1),t=T.getTimeframeKey(),n=T.getTimeframeKey(1);$(".chnSlotTime_"+e).removeClass("chnBarCurrent"),$(".chnSlotTime_"+t).addClass("chnBarCurrent"),$(".chnSlotTime_"+e+" .chnTitle h1").removeClass("chnTitleCurrent"),$(".chnSlotTime_"+t+" .chnTitle h1").removeClass("chnTitleFuture").addClass("chnTitleCurrent"),$(".chnSlotTime_"+n+" .chnTitle h1").addClass("chnTitleFuture");var i=T.getCurrentTimeframe();$(".chnSlot").each(function(){return T.convertScheduleKeyToUTCMinutes($(this).data("timeframe"))<i?void $(this).appendTo("#sectionChains_Timetable"):!1}),C.ChainToday&&$("#sectionChains_Timetable .chnDaily_"+C.ChainToday.nexus).each(function(){T.convertScheduleKeyToUTCMinutes($(this).closest(".chnSlot").data("timeframe"))<i&&$(this).hide()})}},sortChainsListHTML:function(){for(var e,t,n=0,i=C.ScheduledChains.length,a=0,r=0;i>n;){e=T.getTimeframeChains(a);for(r in e){if(n>=i)break;t=e[r],t.isSorted===!1&&($("#chnBar_"+t.nexus).appendTo(t.htmllist),t.isSorted=!0,t.scheduleKeyImmediate=T.getTimeframeKey(a),n++)}a++}for(a in C.ScheduledChains){t=C.ScheduledChains[a],t.isSorted=!1;for(r in t.scheduleKeys)if(t.scheduleKeys[r]===t.scheduleKeyImmediate){t.scheduleKeys=t.scheduleKeys.slice(r,t.scheduleKeys.length).concat(t.scheduleKeys.slice(0,r));break}}C.updateChainsTimeHTML();for(a in C.CurrentChains)t=C.CurrentChains[a],$("#chnBar_"+t.nexus).addClass("chnBarCurrent"),C.isChainUnchecked(t)&&O.Options.bol_expandWB&&I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+t.nexus).show("fast",function(){I.updateScrollbar()}),$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleFuture chnTitleFutureFar").addClass("chnTitleCurrent"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeFuture chnTimeFutureFar").addClass("chnTimeCurrent");for(a in C.PreviousChains1)t=C.PreviousChains1[a],$("#chnBar_"+t.nexus).removeClass("chnBarCurrent").addClass("chnBarPrevious"),O.Options.bol_collapseChains&&I.ModeCurrent!==I.ModeEnum.Tile&&$("#chnDetails_"+t.nexus).hide(),$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleCurrent").addClass("chnTitleFutureFar"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeCurrent").addClass("chnTimeFutureFar");for(a in C.PreviousChains2)t=C.PreviousChains2[a],$("#chnBar_"+t.nexus).removeClass("chnBarPrevious");for(a in C.NextChains1)t=C.NextChains1[a],$("#chnBar_"+t.nexus+" h1").first().removeClass("chnTitleFutureFar").addClass("chnTitleFuture"),$("#chnBar_"+t.nexus+" time").first().removeClass("chnTimeFutureFar").addClass("chnTimeFuture")},queueEventsHighlight:function(e){var t,n,i=e,a=T.getCurrentTimeframeElapsedTime(),r=!1;if(a>0){for(t in i.primaryEvents)if(n=C.getSumBasedOnOptions(i,t),n>=a&&t>0){C.highlightEvents(i,parseInt(t-1)),r=!0;break}r===!1&&(n=C.getSumBasedOnOptions(i,-1),n>=a?C.highlightEvents(i,t):C.highlightEvents(i,-1))}for(t in i.primaryEvents)n=C.getSumBasedOnOptions(i,t),n>=a&&(n-=a,setTimeout(function(e,t){return function(){C.highlightEvents(e,t)}}(i,parseInt(t)),n*T.cMILLISECONDS_IN_SECOND));n=C.getSumBasedOnOptions(i,-1),n>=a&&(n-=a,setTimeout(function(e){return function(){C.highlightEvents(e,-1)}}(i),n*T.cMILLISECONDS_IN_SECOND))},highlightEvents:function(e,t){var n,i,a=500,r=C.cEventNameWidth,o=e.primaryEvents.length-1,s=C.isChainRegular(e);if(e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated&&(P.LayerArray.DryTopActive=null,P.LayerArray.DryTopActive=[],C.isDryTopIconsShown))for(n in e.events)i=e.events[n],M.toggleLayer(i.eventicon,!1),M.toggleLayer(i.eventring,!1);if(t>-1){for(e.CurrentPrimaryEvent=e.primaryEvents[t],n=0;t>n;n++)$(".chnStep_"+e.nexus+"_"+n).removeClass("chnEventCurrent");if($(".chnStep_"+e.nexus+"_"+(t-1)).css({opacity:1}).animate({opacity:.5},a,function(){e.series===C.ChainSeriesEnum.DryTop&&$(this).hide()}),$(".chnStep_"+e.nexus+"_"+t).each(function(){$(this).removeClass("chnEventFuture").addClass("chnEventCurrent").show().css({width:0,opacity:.5}).animate({width:r,opacity:1},a).css({width:"auto"}),e.series===C.ChainSeriesEnum.DryTop&&C.isDryTopGenerated&&(i=e.events[$(this).attr("data-eventindex")],P.LayerArray.DryTopActive.push(i.eventicon),P.LayerArray.DryTopActive.push(i.eventring),C.isDryTopIconsShown&&M.toggleLayerArray(P.LayerArray.DryTopActive,!0))}),t<e.primaryEvents.length)for(n=t+1;n<e.primaryEvents.length;n++)$(".chnStep_"+e.nexus+"_"+n).show().removeClass("chnEventCurrent").addClass("chnEventFuture");O.Options.bol_tourPrediction&&I.ModeCurrent!==I.ModeEnum.Overlay&&I.PageCurrent===I.PageEnum.Chains&&M.isMapAJAXDone&&C.isChainUnchecked(e)&&s&&C.isDryTopIconsShown===!1&&$("#chnEvent_"+e.nexus+"_"+e.CurrentPrimaryEvent.num).trigger("click"),t===o&&O.Options.bol_alertArrival&&s&&(O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&C.isChainUnchecked(e)||O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&C.isChainSubscribed(e)&&C.isChainUnchecked(e))&&D.speak(D.getChainPronunciation(e)+" "+D.getSpeechWord("arrival predicted"))}else{if(e.CurrentPrimaryEvent=e.primaryEvents[o],$("#chnEvents_"+e.nexus+" li").show().removeClass("chnEventCurrent"),$(".chnStep_"+e.nexus+"_"+o).css({opacity:1}).animate({opacity:.5},a),O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&O.Options.bol_alertAtEnd&&I.isProgramLoaded&&e.nexus===C.CurrentChainSD.nexus&&s){var c=", "+D.getSpeechWord("checked"),l="",u="",d=O.objToBool(C.NextChainSD1),h=O.objToBool(C.NextChainHC1),p=D.getSpeechWord("next "+D.orderModifier("boss","world")+" is")+" ";C.NextChainSD1&&!C.isChainUnchecked(C.NextChainSD1)&&(l=c),C.NextChainHC1&&!C.isChainUnchecked(C.NextChainHC1)&&(u=c),O.Options.bol_alertChecked===!1&&(l.length>0&&(d=!1),u.length>0&&(h=!1)),d&&h?(D.speak(p+D.getChainPronunciation(C.NextChainSD1)+l,5),D.speak(D.getSpeechWord("also")+", "+D.getChainPronunciation(C.NextChainHC1)+u,3)):d?D.speak(p+D.getChainPronunciation(C.NextChainSD1)+l,5):h&&D.speak(p+D.getChainPronunciation(C.NextChainHC1)+u,5),(d||h)&&D.speak(T.getTimeTillChainFormatted(C.NextChainSD1,"speech"),3)}O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&O.Options.bol_alertUnsubscribe&&I.isProgramLoaded&&C.isChainWorldBoss(e)&&C.isChainSubscribed(e)&&$("#chnTime_"+e.nexus).trigger("click")}},getSumBasedOnOptions:function(e,t){if(C.isChainToday(e))return t>-1?e.primaryEvents[t].minSum:(e.countdownToFinish=e.minFinish,e.minFinish);var n=T.getTimeSinceMidnight(T.ReferenceEnum.Local,T.UnitEnum.Hours);if(t>-1){switch(O.Options.int_setPredictor){case O.IntEnum.Predictor.Auto:if(n>=12&&18>n)return e.primaryEvents[t].minSum;if(n>=18)return e.primaryEvents[t].minavgSum;if(n>=0&&6>n)return e.primaryEvents[t].avgSum;if(n>=6&&12>n)return e.primaryEvents[t].minavgSum;break;case O.IntEnum.Predictor.Min:return e.primaryEvents[t].minSum;case O.IntEnum.Predictor.MinAvg:return e.primaryEvents[t].minavgSum;case O.IntEnum.Predictor.Avg:return e.primaryEvents[t].avgSum}return e.primaryEvents[t].minavgSum}switch(O.Options.int_setPredictor){case O.IntEnum.Predictor.Auto:if(n>=12&&18>n)return e.countdownToFinish=e.minFinish,e.minFinish;if(n>=18)return e.countdownToFinish=e.minavgFinish,e.minavgFinish;if(n>=0&&6>n)return e.countdownToFinish=e.avgFinish,e.avgFinish;if(n>=6&&12>n)return e.countdownToFinish=e.minavgFinish,e.minavgFinish;break;case O.IntEnum.Predictor.Min:return e.countdownToFinish=e.minFinish,e.minFinish;case O.IntEnum.Predictor.MinAvg:return e.countdownToFinish=e.minavgFinish,e.minavgFinish;case O.IntEnum.Predictor.Avg:return e.countdownToFinish=e.avgFinish,e.avgFinish}return e.countdownToFinish=e.minavgFinish,e.minavgFinish}},M={MapEnum:"map",OptionSuffix:"",Zones:GW2T_ZONE_DATA,ZoneAssociation:GW2T_ZONE_ASSOCIATION,Regions:GW2T_REGION_DATA,Submaps:GW2T_SUBMAP_DATA,cInitialZone:"lion",Map:{},Floors:[],ZoneCurrent:{},numPins:0,cICON_SIZE_STANDARD:32,cRING_SIZE_MAX:256,isMapInitialized:!1,isMouseOnHUD:!1,isUserDragging:!1,isZoneLocked:!1,isMapAJAXDone:!1,isAPIRetrieved_MAPFLOOR:!1,isItineraryRetrieved:!1,isMappingIconsGenerated:!1,isEventIconsGenerated:!1,ContextLatLng:null,cMAP_NUMFLOORS:4,cMAP_BOUND:32768,cMAP_CENTER:[16384,16384],cMAP_CENTER_INITIAL:[-1024,1024],cMAP_MOUSEMOVE_RATE:100,cInertiaThreshold:100,cZoomFactor:2,ZoomEnum:{Adaptive:-2,Same:-1,Min:0,Overview:3,Default:3,Space:3,Sky:5,Bird:6,Ground:7,Max:7},cZIndexRaise:999999,cZIndexBury:-999999,cMETER_TO_INCH:39.3701,cCIRCLE_RIGHT_DEGREE:90,cCIRCLE_HALF_DEGREE:180,cCIRCLE_FULL_DEGREE:360,cRADIAN_TO_DEGREE:180/Math.PI,cUNITS_TO_POINTS:.0416,cPOINTS_TO_UNITS:5e3/208,GPSPreviousCoord:[],GPSPreviousAngleCharacter:0,GPSPreviousAngleCamera:0,Layer:{Overview:new L.layerGroup,Pin:new L.layerGroup,PersonalPin:new L.layerGroup,PersonalPath:new L.layerGroup},Pin:{Program:{},Event:{},Over:{},Character:{},Camera:{}},MappingEnum:{Sector:0,Waypoint:1,Landmark:2,Vista:3,Challenge:4,Heart:5,EventIcon:6,EventRing:7},APIPOIEnum:{Sector:"sectors",Waypoint:"waypoint",Landmark:"landmark",Vista:"vista",Challenge:"skill_challenges",Heart:"tasks"},initializeMap:function(){var e=this,t="#"+this.MapEnum,n=O.Options["int_setInitialZoom"+P.SuffixCurrent];this.Map=L.map(this.MapEnum+"Pane",{minZoom:this.ZoomEnum.Min,maxZoom:this.ZoomEnum.Max,inertiaThreshold:this.cInertiaThreshold,doubleClickZoom:!1,touchZoom:!1,zoomControl:I.isTouchEnabled,attributionControl:!1,crs:L.CRS.Simple}).setView(this.cMAP_CENTER_INITIAL,n),this.Map.touchZoom.disable(),this.Map.tap&&this.Map.tap.disable();var i;for(var a in this.Zones)i=this.Zones[a],i.center=this.computeZoneCenter(a),i.nick=a,i.Layers={Path:new L.layerGroup,Waypoint:new L.layerGroup,Landmark:new L.layerGroup,Vista:new L.layerGroup,Challenge:new L.layerGroup,Heart:new L.layerGroup,Sector:new L.layerGroup,EventIcon:new L.layerGroup,EventRing:new L.layerGroup},e.MapEnum===P.MapEnum.Tyria&&P.LayerArray.ChainPath.push(i.Layers.Path);this.ZoneCurrent=this.Zones[this.cInitialZone];var r;switch(this.MapEnum){case P.MapEnum.Tyria:r=1,this.createPins(),P.populateMap(M),P.drawZoneBorders(),P.drawZoneGateways(),C.ScheduledChains.forEach(P.drawChainPaths);break;case P.MapEnum.Mists:r=2,L.tileLayer(U.URL_API.TilesMists,{continuousWorld:!0}).addTo(W.Map),this.createPins(),P.populateMap(W)}for(var a=0;a<this.cMAP_NUMFLOORS;a++)this.Floors.push(L.tileLayer("https://tiles.guildwars2.com/"+r+"/"+a+"/{z}/{x}/{y}.jpg",{continuousWorld:!0}));I.isTouchEnabled||this.bindMapClicks(),$(t+"CoordinatesCopy").onEnterKey(function(){var t=$(this).val();U.interpretCommand(t,e,e.ZoomEnum.Ground,e.Pin.Program)}),$(t+"GPSButton").click(function(){P.updateCharacter(1)}).dblclick(function(){e.Map.getZoom()!==e.ZoomEnum.Ground?e.Map.setZoom(e.ZoomEnum.Ground):e.Map.setZoom(e.ZoomEnum.Default)}),$(t+"DisplayButton").click(function(){$("#opt_bol_showPanel").trigger("click")}),$(t+"CompassButton").one("mouseenter",e.bindZoneList(e)).click(function(){e.goToDefault()}).dblclick(function(){e.Map.setZoom(e.Map.getZoom()-1)}),this.isMapInitialized=!0,this.refreshMap()},createPins:function(){if(I.isMapEnabled){var e=this;this.Pin.Program=this.createPin("img/map/pin_blue.png"),this.Pin.Event=this.createPin("img/map/pin_green.png"),this.Pin.Over=this.createPin("img/map/pin_over.png",[128,128]),this.Pin.Character=this.createPin("img/map/pin_character.png",[40,40]),this.Pin.Camera=this.createPin("img/map/pin_camera.png",[256,256],{clickable:!1}),this.Layer.Pin.eachLayer(function(t){e.bindMarkerCoordBehavior(t,"click"),e.bindMarkerZoomBehavior(t,"contextmenu"),t.on("dblclick",function(){e.movePin(this)})}),this.Pin.Character.on("contextmenu",function(){e.movePin(this),e.movePin(e.Pin.Camera)}),this.toggleLayer(this.Layer.Pin,!1)}},bindMapClicks:function(){var e=this,t="#"+e.MapEnum;this.Map.on("click",function(n){if(!e.isMouseOnHUD){var i=e.convertLCtoGC(n.latlng);$(t+"CoordinatesCopy").val(P.formatCoord(i)).select()}}),this.Map.on("dblclick",function(t){e.isMouseOnHUD||(e.saveBackupPins(),e.createPersonalPin(t.latlng,!0,!0))}),this.Map.on("contextmenu",function(n){e.ContextLatLng=n.latlng,$(t+"Context").css({top:I.posY,left:I.posX}).show()}),$(t+"Context").click(function(){$(this).hide()}),$(t+"ContextCenter").click(function(){e.goToDefault()}),$(t+"ContextToggleHUD").click(function(){$(t+"HUDBoxes").toggle()}),$(t+"ContextPins").one("mouseenter",function(){var n=8,i=D.getWordCapital("load"),a=D.getWordCapital("save");e.initializeStoredPins(n);for(var r=0;n>r;r++)$(t+"ContextLoadPins").append("<li data-index='"+r+"'>"+i+" #"+(r+1)+"</li>"),$(t+"ContextSavePins").append("<li data-index='"+r+"'>"+a+" #"+(r+1)+"</li>");$(t+"ContextLoadPins li").click(function(){e.loadStoredPins($(this).attr("data-index"))}),$(t+"ContextSavePins li").click(function(){e.saveStoredPins($(this).attr("data-index"))})}),$(t+"ContextUndoPins").click(function(){e.loadBackupPins()}),$(t+"ContextClearPins").click(function(){e.clearPersonalPins()}),$(t+"ContextChatlinkPins").click(function(){e.isPersonalPinsLaid()&&P.printClosestWaypoints()}),$(t+"ContextOptimizePins").click(function(){e.isPersonalPinsLaid()&&e.optimizePersonalPath()}),$(t+"ContextToggleLock").click(function(){e.isZoneLocked=!e.isZoneLocked,e.isZoneLocked?I.write("Map locked to zone: "+D.getObjectName(e.ZoneCurrent)):I.write("Map zoning unlocked.")}),$(t+"ContextToggleCompletion").click(function(){$("#opt_bol_showWorldCompletion"+e.OptionSuffix).trigger("click")}),$(t+"ContextDrawCompletion").click(function(){P.drawCompletionRoute()})},bindMapVisualChanges:function(){var e=this,t="#"+e.MapEnum;$(t+"HUDPane").hover(function(){e.isMouseOnHUD=!0},function(){e.isMouseOnHUD=!1}),$(t+"Context").hover(function(){e.isMouseOnHUD=!0},function(){e.isMouseOnHUD=!1}),this.Map.on("dragstart",function(){e.isUserDragging=!0}),this.Map.on("dragend",function(){e.isUserDragging=!1}),this.Map.on("mousemove",$.throttle(e.cMAP_MOUSEMOVE_RATE,function(t){e.isMouseOnHUD||e.isUserDragging||e.showCurrentZone(e.convertLCtoGC(t.latlng))})),this.Map.on("zoomend",function(t){e.adjustZoomMapping(),e.MapEnum===P.MapEnum.Tyria&&P.adjustZoomDryTop()})},changeFloor:function(e){for(var t=0;t<this.Floors.length;t++)this.Map.removeLayer(this.Floors[t]);this.Floors[e].addTo(this.Map)},refreshMap:function(){this.isMapInitialized&&this.Map.invalidateSize()},isZoneValid:function(e){return void 0===this.ZoneAssociation[e]?!1:!0},getZoneFromID:function(e){return this.Zones[this.ZoneAssociation[e]]},getZoneName:function(e){var t;if("string"==typeof e&&this.Zones[e])t=this.Zones[e];else{if("object"!=typeof e)return"nozonename";t=e}return D.getObjectName(t)},getZoneRegion:function(e){return this.Zones[e.toLowerCase()].region},getZoneFromCoord:function(e){for(var t in this.Zones)if(e[0]>=this.Zones[t].continent_rect[0][0]&&e[1]>=this.Zones[t].continent_rect[0][1]&&e[0]<=this.Zones[t].continent_rect[1][0]&&e[1]<=this.Zones[t].continent_rect[1][1])return this.Zones[t];return null},showCurrentZone:function(e){var t=this,n=t.MapEnum;if(document.getElementById(n+"CoordinatesMouse").value=e[0]+", "+e[1],!(e[0]>=this.ZoneCurrent.continent_rect[0][0]&&e[1]>=this.ZoneCurrent.continent_rect[0][1]&&e[0]<=this.ZoneCurrent.continent_rect[1][0]&&e[1]<=this.ZoneCurrent.continent_rect[1][1]||this.isZoneLocked===!0)){var i,a="",r=this.getZoneFromCoord(e);if(null!==r){i=this.Zones[this.ZoneCurrent.nick];for(var o in i.Layers)this.Map.removeLayer(i.Layers[o]);switch(this.ZoneCurrent=r,a=this.getZoneName(this.ZoneCurrent),document.getElementById(n+"CoordinatesName").value=a,t.MapEnum){case P.MapEnum.Tyria:O.Options.bol_showChainPaths&&I.PageCurrent!==I.PageEnum.Map&&this.ZoneCurrent.Layers.Path.addTo(this.Map),O.Options.bol_displayWaypoints&&this.ZoneCurrent.Layers.Waypoint.addTo(this.Map),O.Options.bol_displayPOIs&&this.ZoneCurrent.Layers.Landmark.addTo(this.Map),O.Options.bol_displayVistas&&this.ZoneCurrent.Layers.Vista.addTo(this.Map),O.Options.bol_displayChallenges&&this.ZoneCurrent.Layers.Challenge.addTo(this.Map),O.Options.bol_displayHearts&&this.ZoneCurrent.Layers.Heart.addTo(this.Map),O.Options.bol_displaySectors&&this.ZoneCurrent.Layers.Sector.addTo(this.Map),O.Options.bol_displayEvents&&(this.ZoneCurrent.Layers.EventIcon.addTo(this.Map),this.ZoneCurrent.Layers.EventRing.addTo(this.Map));break;case P.MapEnum.Mists:O.Options.bol_displayWaypointsWvW&&this.ZoneCurrent.Layers.Waypoint.addTo(this.Map),O.Options.bol_displayPOIsWvW&&this.ZoneCurrent.Layers.Landmark.addTo(this.Map),O.Options.bol_displayVistasWvW&&this.ZoneCurrent.Layers.Vista.addTo(this.Map),O.Options.bol_displayChallengesWvW&&this.ZoneCurrent.Layers.Challenge.addTo(this.Map),O.Options.bol_displaySectorsWvW&&this.ZoneCurrent.Layers.Sector.addTo(this.Map)}I.qTip.init(".leaflet-marker-icon"),this.adjustZoomMapping()}}},refreshCurrentZone:function(){var e=this.ZoneCurrent.center;switch(this.MapEnum){case P.MapEnum.Tyria:this.showCurrentZone(this.getZoneCenter("verdant")),this.showCurrentZone(this.getZoneCenter("auric"));break;case P.MapEnum.Mists:this.showCurrentZone(this.getZoneCenter("edge")),this.showCurrentZone(this.getZoneCenter("eternal"))}this.showCurrentZone(e)},computeZoneCenter:function(e){var t=this.Zones[e].continent_rect,n=t[0][0]+~~((t[1][0]-t[0][0])/2),i=t[0][1]+~~((t[1][1]-t[0][1])/2);return[n,i]},getZoneCenter:function(e){return this.Zones[e].center},getEventCenter:function(e){var t=this.getZoneFromID(e.map_id),n=e.location.center;return this.convertEventCoord(n,t)},scaleDimension:function(e,t){return t=t||this.Map.getZoom(),parseInt(e/Math.pow(this.cZoomFactor,this.ZoomEnum.Max-t))},invertZoomLevel:function(e){return this.ZoomEnum.Max-e},adjustZoomMapping:function(){var e,t,n,i=this,a=this.Map.getZoom(),r=this.invertZoomLevel(a),o={waypoint:[40,32,26,20,16,12,0,0],landmark:[32,24,16,12,0,0,0,0],eventicon:[32,24,16,12,0,0,0,0],eventring:[256,128,64,32,0,0,0,0],sectorfont:[28,20,16,0,0,0,0,0],sectoropacity:[.9,.6,.3,0,0,0,0,0],objicon:[38,38,38,38,32,24,16,0],objtimerfont:[18,17,16,15,14,13,12,0],objinfofont:[14,13,12,11,10,9,0,0],objumbrella:[96,96,96,96,64,32,24,0]},s=function(e){return o[e][r]},c=s("waypoint"),l=s("landmark"),u=s("eventicon"),d=s("eventring"),h=s("sectorfont"),p=s("sectoropacity"),m=s("objicon"),g=s("objtimerfont"),C=s("objinfofont"),f=s("objumbrella");switch(this.MapEnum){case P.MapEnum.Tyria:O.Options.bol_displayEvents&&(this.ZoneCurrent.Layers.EventIcon.eachLayer(function(e){i.changeMarkerIcon(e,e._icon.src,u),e._icon&&(e._icon.style.zIndex=M.cZIndexRaise)}),this.ZoneCurrent.Layers.EventRing.eachLayer(function(e){i.changeMarkerIcon(e,e._icon.src,d),e._icon&&(e._icon.style.zIndex=M.cZIndexBury)})),t=O.Options.bol_showZoneOverview,e=O.Options.bol_showWorldCompletion,n=O.Options.bol_displaySectors;break;case P.MapEnum.Mists:$(".objIcon").css({width:m,height:m}),$(".objProgressBar").css({width:m}),$(".objTimer").css({fontSize:g}),$(".objInfo").css({fontSize:C}),$(".objUmbrella").css({width:f,height:f}),t=O.Options.bol_showZoneOverviewWvW,e=O.Options.bol_showWorldCompletionWvW,n=O.Options.bol_displaySectorsWvW}e&&t&&a===this.ZoomEnum.Overview?(this.toggleLayer(this.Layer.Overview,!0),this.Layer.Overview.eachLayer(function(e){e._icon.style.display="table"})):this.toggleLayer(this.Layer.Overview,!1),this.ZoneCurrent.Layers.Waypoint.eachLayer(function(e){i.changeMarkerIcon(e,U.URL_IMG.Waypoint,c)}),this.ZoneCurrent.Layers.Landmark.eachLayer(function(e){i.changeMarkerIcon(e,U.URL_IMG.Landmark,l),e._icon&&(e._icon.style.opacity=a<i.ZoomEnum.Max?.6:.8)}),this.ZoneCurrent.Layers.Vista.eachLayer(function(e){i.changeMarkerIcon(e,U.URL_IMG.Vista,l)}),this.ZoneCurrent.Layers.Challenge.eachLayer(function(e){i.changeMarkerIcon(e,U.URL_IMG.Challenge,l)}),this.ZoneCurrent.Layers.Heart.eachLayer(function(e){i.changeMarkerIcon(e,U.URL_IMG.Heart,l)}),this.ZoneCurrent.Layers.Sector.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=h+"px",e._icon.style.opacity=p,e._icon.style.zIndex=i.cZIndexBury+1,n&&(e._icon.style.display="table"))}),P.updateCharacter(-1)},createStandardIcon:function(e){return L.icon({iconUrl:e,iconSize:[32,32],iconAnchor:[16,16]})},createPin:function(e,t,n){void 0===t&&(t=[32,32]);var i={icon:L.icon({iconUrl:e,iconSize:t,iconAnchor:[t[0]/2,t[1]/2]}),draggable:!0};if(void 0!==n)for(var a in n)i[a]=n[a];var r=L.marker(this.convertGCtoLC([0,0]),i);return this.Layer.Pin.addLayer(r),r},saveBackupPins:function(){var e=O.Utilities["BackupPins"+this.OptionSuffix];localStorage[e.key]=JSON.stringify(this.getPersonalCoords())},loadBackupPins:function(){var e=O.Utilities["BackupPins"+this.OptionSuffix];try{e.value=JSON.parse(localStorage[e.key])}catch(t){}this.redrawPersonalPath(e.value,null)},initializeStoredPins:function(e){var t=O.Utilities["StoredPins"+this.OptionSuffix];t.value=new Array(e);var n=t.key;try{t.value=JSON.parse(localStorage[n])}catch(i){}},saveStoredPins:function(e){var t=O.Utilities["StoredPins"+this.OptionSuffix],n=this.getPersonalCoords();n.length>0?(t.value[e]=n,localStorage[t.key]=JSON.stringify(t.value)):this.isPersonalPinsLaid()},loadStoredPins:function(e){var t=O.Utilities["StoredPins"+this.OptionSuffix];this.redrawPersonalPath(t.value[e])},createPersonalPin:function(e,t){var n=this,i=0===this.numPins?"img/map/pin_red.png":"img/map/pin_white.png",a=L.marker(e,{icon:L.icon({iconUrl:i,iconSize:[32,32],iconAnchor:[16,16]}),draggable:!0,opacity:.9});this.toggleLayer(a,!0),this.Layer.PersonalPin.addLayer(a),this.numPins++,t&&this.drawPersonalPath(),this.bindMarkerCoordBehavior(a,"click"),a.on("click",function(){void 0===this.options.isMarked||this.options.isMarked===!1?(this.options.isMarked=!0,this.setOpacity(.3)):(this.options.isMarked=!1,this.setOpacity(1))}),a.on("dblclick",function(){n.toggleLayer(this,!1),n.Layer.PersonalPin.removeLayer(this),n.drawPersonalPath(),n.numPins--}),a.on("contextmenu",function(){n.GPSPreviousCoord.length>0?n.movePin(this,n.GPSPreviousCoord):n.movePin(this,n.Map.getCenter()),n.drawPersonalPath()}),a.on("dragend",function(){n.drawPersonalPath()})},insertPersonalPin:function(e,t){var n=[],i=0;this.Layer.PersonalPin.eachLayer(function(a){n.push(a.getLatLng()),i===e&&n.push(t),i++}),this.clearPersonalPins();for(i in n)this.createPersonalPin(n[i]);this.drawPersonalPath()},clearPersonalPins:function(){var e=this;this.Layer.PersonalPin.eachLayer(function(t){e.toggleLayer(t,!1)}),this.Layer.PersonalPin.clearLayers(),this.drawPersonalPath(),this.numPins=0},drawPersonalPath:function(){var e=this,t="#"+e.MapEnum;if(O.Options.bol_showPersonalPaths){var n,i=[],a=[],r=0;if(this.Layer.PersonalPin.eachLayer(function(e){i.push(e.getLatLng()),a.push(P.getLayerId(e)),r++}),r>1){this.Layer.PersonalPath.clearLayers();for(var o=0;r-1>o;o++)n=L.polyline([i[o],i[o+1]],{color:"white",opacity:.4,precede:o}),n.on("click",function(){$(t+"CoordinatesCopy").val(e.getPersonalString()).select()}),n.on("dblclick",function(t){e.saveBackupPins(),e.insertPersonalPin(this.options.precede,t.latlng)}),this.Layer.PersonalPath.addLayer(n);this.toggleLayer(this.Layer.PersonalPath,!0)}else this.Layer.PersonalPath.clearLayers(),this.toggleLayer(this.Layer.PersonalPath,!1)}else this.Layer.PersonalPath.clearLayers(),this.toggleLayer(this.Layer.PersonalPath,!1)},parsePersonalPath:function(e){var t=this.parseCoordinatesMulti(e);return null!==t?(this.redrawPersonalPath(t),!0):!1},redrawPersonalPath:function(e,t){if(void 0!==e&&null!==e&&e.length>0){this.clearPersonalPins();for(var n in e)this.createPersonalPin(this.convertGCtoLC(e[n]));this.drawPersonalPath(),null!==t&&(void 0===t?this.goToArguments(e[0]):this.goToArguments(t))}else I.write("Path unavailable for this.")},isPersonalPinsLaid:function(){return 0===this.Layer.PersonalPin.getLayers().length?(I.write("No personal pins to work with. Double click on the map to lay pins."),!1):!0},optimizePersonalPath:function(e){this.redrawPersonalPath(P.getGreedyPath(this.getPersonalCoords(),e))},drawRandom:function(e){if(0!==e&&void 0!==e){for(var t,n,i=0;e>i;i++)t=T.getRandomIntRange(0,this.cMAP_BOUND),n=T.getRandomIntRange(0,this.cMAP_BOUND),this.createPersonalPin(this.convertGCtoLC([t,n]));this.drawPersonalPath()}},getPersonalCoords:function(){var e=this,t=[];return this.Layer.PersonalPin.eachLayer(function(n){t.push(e.convertLCtoGC(n.getLatLng()))}),t},getPersonalString:function(){return JSON.stringify(this.getPersonalCoords())},getClosestLocation:function(e,t){var n,i=this,a=Number.POSITIVE_INFINITY,r=null;return t.eachLayer(function(t){n=P.getDistanceBetweenCoords(e,i.convertLCtoGC(t.getLatLng())),a>n&&(a=n,r=t)}),r},changeMarkerIcon:function(e,t,n){void 0===n&&(n=this.cICON_SIZE_STANDARD),e.setIcon(new L.icon({iconUrl:t,iconSize:[n,n],iconAnchor:[n/2,n/2]}))},toggleLayer:function(e,t){void 0!==e&&(void 0===t&&(t=!this.Map.hasLayer(e)),t?e.addTo(this.Map):this.Map.removeLayer(e))},toggleLayerArray:function(e,t){for(var n in e)this.toggleLayer(e[n],t)},toggleSubmap:function(e,t){var n=this.Submaps[e];void 0===n.ImageOverlay?(n.ImageOverlay=L.imageOverlay(n.img,this.convertGCtoLCMulti(n.bounds)),this.toggleSubmap(e,t)):(void 0===t&&(t=!this.Map.hasLayer(n.ImageOverlay)),t?n.ImageOverlay.addTo(this.Map).bringToBack():this.Map.removeLayer(n.ImageOverlay))},toggleSubmapArray:function(e,t){for(var n in e)this.toggleSubmap(e[n],t)},movePin:function(e,t){void 0===t?this.toggleLayer(e,!1):(this.toggleLayer(e,!0),Array.isArray(t)?e.setLatLng(this.convertGCtoLC(t)):e.setLatLng(t),e._icon.style.zIndex=this.cZIndexRaise)},goToView:function(e,t,n){void 0!==n&&this.movePin(n,e),void 0===t?t=this.ZoomEnum.Ground:t===this.ZoomEnum.Same?t=this.Map.getZoom():t===this.ZoomEnum.Adaptive?t=this.getAdaptiveZoom():"object"==typeof t&&void 0!==t.offset&&(t=this.getAdaptiveZoom(t.offset)),this.Map.setView(this.convertGCtoLC(e),t),this.showCurrentZone(e)},goToLatLng:function(e,t){void 0===t&&(t=this.ZoomEnum.Ground),t===this.ZoomEnum.Same&&(t=this.Map.getZoom()),this.Map.setView(e,t),this.showCurrentZone(this.convertLCtoGC(e))},goToZone:function(e,t){var n=this.getZoneCenter(e);this.showCurrentZone(n),this.goToView(n,t)},getAdaptiveZoom:function(e){void 0===e&&(e=0);var t,n=$(window).width();return t=n>=I.ScreenWidth.Huge?this.ZoomEnum.Default+1:n>=I.ScreenWidth.Large?this.ZoomEnum.Default:n>=I.ScreenWidth.Medium?this.ZoomEnum.Default-1:this.ZoomEnum.Default-2,t+e},goToDefault:function(e){void 0===e&&(e=this.getAdaptiveZoom()),this.Map.setView(this.convertGCtoLC(this.cMAP_CENTER),e)},goToArguments:function(e,t,n){var i,a,r=[];if(e)if(r=this.parseCoordinates(e),2===r.length)isFinite(r[0])&&isFinite(r[1])&&this.goToView(r,t,n);else if(r.length>=3){if(isFinite(r[0])&&isFinite(r[1])&&isFinite(r[2])){var o=this.invertZoomLevel(r[2]);this.goToView([r[0],r[1]],o,n)}}else if(a=e.toLowerCase(),"default"===a)this.goToDefault();else for(i in this.Zones)if(-1!==a.indexOf(i)){this.goToView(this.getZoneCenter(i),this.ZoomEnum.Sky);break}},convertGCtoLC:function(e){return this.Map.unproject(e,this.Map.getMaxZoom())},convertGCtoLCMulti:function(e,t){t=t||0;var n,i=[];for(n=t;n<e.length;n++)i.push(this.convertGCtoLC(e[n]));return i},convertGCtoLCDual:function(e){return[this.convertGCtoLC(e[0]),this.convertGCtoLC(e[1])]},convertLCtoGC:function(e){var t=this.Map.project(e,this.ZoomEnum.Max);return[Math.round(t.x),Math.round(t.y)]},convertLCtoGCMulti:function(e){for(var t=[],n=0;n<e.length;n++)t.push(this.convertLCtoGC(e[n]));return t},convertEventCoord:function(e,t){var n=t.continent_rect,i=t.map_rect;return"988"===t.id&&(n=t.continent_rect_actual),[~~(n[0][0]+(n[1][0]-n[0][0])*(e[0]-i[0][0])/(i[1][0]-i[0][0])),~~(n[0][1]+(n[1][1]-n[0][1])*(1-(e[1]-i[0][1])/(i[1][1]-i[0][1])))]},convertGPSCoord:function(e,t){var n=this.getZoneFromID(t),i=new Array(3);return i[0]=e[0]*this.cMETER_TO_INCH,i[1]=e[2]*this.cMETER_TO_INCH,i[2]=e[1]*this.cMETER_TO_INCH,this.convertEventCoord(i,n)},convertGPSAngle:function(e){return Math.atan2(e[2],e[0])*this.cRADIAN_TO_DEGREE},parseCoordinates:function(e){var t=e.toString().replace(/[^\d,-.]/g,"");return t.split(",")},parseCoordinatesMulti:function(e){var t,n=13,i=e.replace(/\s/g,""),a=[],r=[];if(i.length>=n&&"["===i.charAt(0)&&"["===i.charAt(1)&&"]"===i.charAt(i.length-1)&&"]"===i.charAt(i.length-2)){
i=i.substring(2,i.length-2),a=i.split("],[");for(var o in a)t=a[o].split(","),2===t.length&&(t[0]=Math.round(t[0]),t[1]=Math.round(t[1]),r.push(t));return r}return null},convertLatLngs:function(e){var t=this.convertLCtoGCMulti(e);this.printCoordinates(t)},getElementCoordinates:function(e){var t=e.attr("data-coord");return this.Zones[t]?this.getZoneCenter(t):this.parseCoordinates(t)},bindMapLinks:function(e,t){if(I.isMapEnabled!==!1){var n=this;$(e+" dfn").each(function(){$(this).text("["+$(this).text()+"]"),n.bindMapLinkBehavior($(this),t,n.Pin.Program)})}},bindMapLinkBehavior:function(e,t,n){if(I.isMapEnabled!==!1){var i=this;e.click(function(){var e=$(this).attr("data-coord");U.interpretCommand(e,i,t,n)}),e.dblclick(function(){var e=i.getElementCoordinates($(this));i.Map.getZoom()===i.ZoomEnum.Max?i.goToView(e,i.ZoomEnum.Default,n):i.goToView(e,i.ZoomEnum.Ground,n)}),e.mouseover(function(){var e=i.getElementCoordinates($(this));i.movePin(i.Pin.Over,e)}),e.mouseout(function(){i.movePin(i.Pin.Over)})}},bindOverviewBehavior:function(e,t){var n=this;e.on(t,function(t){n.goToZone(e.options.mappingzone,n.ZoomEnum.Sky)})},bindMarkerZoomBehavior:function(e,t,n){var i=this;void 0===n&&(n=i.ZoomEnum.Default),e.on(t,function(e){if(i.Map.getZoom()===i.ZoomEnum.Max){var t=i.Map.getCenter();~~t.lat===~~e.latlng.lat&&~~t.lng===~~e.latlng.lng?i.Map.setZoom(n):i.Map.setView(e.latlng,i.Map.getZoom())}else i.Map.setView(e.latlng,i.ZoomEnum.Max)})},bindMarkerCoordBehavior:function(e,t){var n=this,i="#"+n.MapEnum;e.on(t,function(){var e=n.convertLCtoGC(this.getLatLng());$(i+"CoordinatesCopy").val(P.formatCoord(e)).select()})},bindMarkerWikiBehavior:function(e,t){e.on(t,function(e){var t=this.options.wiki;t.indexOf(".")===t.length-1&&(t=t.slice(0,-1)),U.openExternalURL(U.getWikiLink(t))})},bindZoneList:function(e){var t=e,n="#"+t.MapEnum;$(n+"ZoneList li").each(function(){var e=$(this).attr("data-zone");$(this).text(t.getZoneName(e)),$(this).attr("data-coord",t.getZoneCenter(e).toString()),t.bindMapLinkBehavior($(this),{offset:1})}),$(n+"ZoneList h2").each(function(){var e=$(this).attr("data-region");$(this).text(D.getObjectName(t.Regions[e]))})}},P={SuffixCurrent:"",MapCurrent:"map",GPSCurrent:null,MapEnum:{Tyria:"map",Mists:"wvw"},Layer:{ZoneBorder:new L.layerGroup,ZoneGateway:new L.layerGroup,DryTopNicks:new L.layerGroup,Chest:new L.layerGroup},LayerArray:{ChainPath:[],Resource:[],JP:[],Guild_Bounty:[],Guild_Trek:[],Guild_Challenge:[],Guild_Rush:[],Guild_Puzzle:[],DryTopIcons:[],DryTopRings:[],DryTopActive:[]},Events:{},DryTopTimer:{},Resources:{},JPs:{},Chests:{},Collectibles:{},Guild:{},GPSTimeout:{},initializeMap:function(){I.isMapEnabled&&M.initializeMap()},populateMap:function(e){if(I.isMapEnabled){var t,n=e,i="#"+n.MapEnum,a=O.Options["bol_showWorldCompletion"+n.OptionSuffix];switch(n.MapEnum){case P.MapEnum.Tyria:t=U.URL_API.MapFloorTyria;break;case P.MapEnum.Mists:if(t=U.URL_API.MapFloorMists,a===!1)return}$.getJSON(t,function(e){var t,r,o,s,c,l,u,d,h,p,m,g,C=D.getTranslation("Vista"),f=D.getTranslation("Hero Challenge");for(r in e.regions){o=e.regions[r];for(s in o.maps)if(n.ZoneAssociation[s]){c=o.maps[s],u=n.getZoneFromID(s);var T=0,y=0,v=0,S=0,I=0;for(d=c.points_of_interest.length,t=0;d>t;t++){switch(l=c.points_of_interest[t],l.type){case n.APIPOIEnum.Waypoint:y++,p=U.URL_IMG.Waypoint,m="mapWp",g=l.name;break;case n.APIPOIEnum.Landmark:if(a===!1)continue;v++,p=U.URL_IMG.Landmark,m="mapPoi",g=l.name;break;case n.APIPOIEnum.Vista:if(a===!1)continue;I++,p=U.URL_IMG.Vista,m="mapPoi",g=C;break;default:continue}switch(h=L.marker(n.convertGCtoLC(l.coord),{title:"<span class='"+m+"'>"+g+"</span>",markername:l.name,icon:L.icon({iconUrl:p,iconSize:[16,16],iconAnchor:[8,8]}),id:l.poi_id}),l.type){case n.APIPOIEnum.Waypoint:h.on("mouseout",function(){try{this._icon.src=U.URL_IMG.Waypoint}catch(e){}}),h.on("mouseover",function(){this._icon.src=U.URL_IMG.WaypointOver}),u.Layers.Waypoint.addLayer(h);break;case n.APIPOIEnum.Landmark:h.on("mouseout",function(){try{this._icon.src=U.URL_IMG.Landmark}catch(e){}}),h.on("mouseover",function(){this._icon.src=U.URL_IMG.LandmarkOver}),u.Layers.Landmark.addLayer(h);break;case n.APIPOIEnum.Vista:u.Layers.Vista.addLayer(h)}l.type===n.APIPOIEnum.Waypoint||l.type===n.APIPOIEnum.Landmark?(h.on("click",function(){$(i+"CoordinatesCopy").val(U.getChatlinkFromPoiID(this.options.id)).select(),$(i+"CoordinatesName").val(this.options.markername)}),h.on("dblclick",function(e){U.openExternalURL(U.getWikiLanguageLink(this.options.markername))}),n.bindMarkerZoomBehavior(h,"contextmenu",n.ZoomEnum.Sky)):(n.bindMarkerZoomBehavior(h,"click",n.ZoomEnum.Sky),n.bindMarkerZoomBehavior(h,"contextmenu",n.ZoomEnum.Sky))}if(a){for(d=c.skill_challenges.length,S=d,t=0;d>t;t++)l=c.skill_challenges[t],h=L.marker(n.convertGCtoLC(l.coord),{title:"<span class='mapPoi'>"+f+"</span>",icon:L.icon({iconUrl:U.URL_IMG.Challenge,iconSize:[16,16],iconAnchor:[8,8]})}),n.bindMarkerZoomBehavior(h,"click",n.ZoomEnum.Sky),n.bindMarkerZoomBehavior(h,"contextmenu",n.ZoomEnum.Sky),u.Layers.Challenge.addLayer(h);for(d=c.tasks.length,T=d,t=0;d>t;t++)l=c.tasks[t],h=L.marker(n.convertGCtoLC(l.coord),{title:"<span class='mapPoi'>"+l.objective+" ("+l.level+")</span>",wiki:l.objective,icon:L.icon({iconUrl:U.URL_IMG.Heart,iconSize:[16,16],iconAnchor:[8,8]})}),M.bindMarkerWikiBehavior(h,"click"),M.bindMarkerZoomBehavior(h,"contextmenu",n.ZoomEnum.Sky),u.Layers.Heart.addLayer(h);for(d=c.sectors.length,t=0;d>t;t++)l=c.sectors[t],h=L.marker(n.convertGCtoLC(l.coord),{clickable:!1,icon:L.divIcon({className:"mapSec",html:"<span class='mapSecIn'>"+l.name+"</span>",iconSize:[512,64],iconAnchor:[256,32]})}),u.Layers.Sector.addLayer(h);n.isMappingIconsGenerated=!0}a&&(h=L.marker(n.convertGCtoLC(u.center),{mappingzone:u.nick,riseOnHover:!0,icon:L.divIcon({className:"mapOverview",html:"<span class='mapOverviewIn'><var class='mapOverviewName'>"+D.getObjectName(u)+"</var>"+(c.min_level>0?"<var class='mapOverviewLevel'>"+(80===c.min_level?c.max_level:c.min_level+" - "+c.max_level)+"</var>":"")+(T>0?"<img src='img/map/heart.png' />"+T+" ":"")+(y>0?"<img src='img/map/waypoint.png' />"+y+" ":"")+(v>0?"<img src='img/map/landmark.png' />"+v+" ":"")+(S>0?"<img src='img/map/challenge.png' />"+S+" ":"")+(I>0?"<img src='img/map/vista.png' />"+I:"")+"</span>",iconSize:[256,64],iconAnchor:[128,32]})}),n.bindOverviewBehavior(h,"click"),n.bindOverviewBehavior(h,"contextmenu"),n.Layer.Overview.addLayer(h),n.toggleLayer(n.Layer.Overview,!0))}}}).done(function(){n.isAPIRetrieved_MAPFLOOR=!0,n.MapEnum===P.MapEnum.Tyria&&O.Options.bol_displayEvents===!1&&P.donePopulation()}).fail(function(){I.ModeCurrent===I.ModeEnum.Website&&I.write("Guild Wars 2 API server is unreachable.<br />Reasons could be:<br />- The ArenaNet server is down for maintenance.<br />- Your browser is too old (if IE then need 11+).<br />- Your computer's time is out of sync.<br />- This website's code encountered a bug.<br />Map features will be limited.<br />",20)}).always(function(){switch(n.MapEnum){case P.MapEnum.Tyria:O.Options.bol_displayEvents===!0?P.populateEvents():P.finishPopulation();break;case P.MapEnum.Mists:W.finishPopulation()}})}},populateEvents:function(){var e=function(e){return-1!==e.indexOf("guild")||-1!==e.indexOf("subdue")||-1!==e.indexOf("hero ch")||-1!==e.indexOf("offshoot")||-1!==e.indexOf("vigil en")||-1!==e.indexOf("haunted")?!0:!1},t=function(e){return-1!==e.indexOf("free")?"img/event/release.png":-1!==e.indexOf("rescue")?"img/event/release.png":-1!==e.indexOf("capture")?"img/event/flag.png":-1!==e.indexOf("retake")?"img/event/flag.png":-1!==e.indexOf("reclaim")?"img/event/flag.png":-1!==e.indexOf("liberate")?"img/event/flag.png":-1!==e.indexOf("protect")?"img/event/shield.png":-1!==e.indexOf("defend")?"img/event/shield.png":-1!==e.indexOf("escort")?"img/event/shield.png":-1!==e.indexOf("kill")?"img/event/boss.png":-1!==e.indexOf("slay")?"img/event/boss.png":-1!==e.indexOf("defeat")?"img/event/boss.png":-1!==e.indexOf("collect")?"img/event/collect.png":-1!==e.indexOf("help")?"img/event/star.png":-1!==e.indexOf("destroy")?"img/event/cog.png":-1!==e.indexOf("gather")?"img/event/collect.png":-1!==e.indexOf("bring")?"img/event/collect.png":-1!==e.indexOf("recover")?"img/event/collect.png":-1!==e.indexOf("return")?"img/event/collect.png":-1!==e.indexOf("retrieve")?"img/event/collect.png":-1!==e.indexOf("salvage")?"img/event/collect.png":-1!==e.indexOf("burglar")?"img/event/fist.png":"img/event/swords.png"},n=function(e){var t=e.location.radius;switch(e.location.type){case"sphere":return 2e3>t?"img/ring/c_s.png":"img/ring/c_m.png";case"cylinder":return"img/ring/e_m_h.png";case"poly":return"img/ring/e_l_h.png"}return"img/ring/c_m.png"};$.getJSON(U.URL_API.EventNames,function(e){var t;for(t in e)P.Events[e[t].id]={},P.Events[e[t].id].name=e[t].name}).done(function(){$.getJSON(U.URL_API.EventDetails,function(i){var a,r,o,s,c,l,u;for(a in i.events)r=i.events[a],o=r.name.toLowerCase(),s=void 0!==P.Events[a]?P.Events[a].name:r.name,u=M.getZoneFromID(r.map_id),void 0===P.Events[a]||void 0===u||e(o)||988===r.map_id||50===r.map_id||(l=M.convertGCtoLC(M.getEventCenter(r)),c=L.marker(l,{clickable:!1,icon:L.icon({iconUrl:n(r),iconSize:[256,256],iconAnchor:[128,128]})}),u.Layers.EventRing.addLayer(c),c=L.marker(l,{title:"<span class='mapPoi'>"+s+" ("+r.level+")</span>",wiki:r.name,icon:L.icon({iconUrl:t(o),iconSize:[48,48],iconAnchor:[24,24]})}),M.bindMarkerWikiBehavior(c,"click"),M.bindMarkerZoomBehavior(c,"contextmenu"),u.Layers.EventIcon.addLayer(c));M.isEventIconsGenerated=!0}).done(function(){P.donePopulation()}).fail(function(){}).always(function(){P.finishPopulation()})}).fail(function(){P.finishPopulation()}).always(function(){})},donePopulation:function(){P.wantZoomToFirstEvent()&&(M.showCurrentZone(M.getZoneCenter(M.cInitialZone)),$("#chnEvent_"+C.CurrentChainSD.nexus+"_"+C.CurrentChainSD.CurrentPrimaryEvent.num).trigger("click"))},finishPopulation:function(){M.isMapAJAXDone=!0,M.bindMapVisualChanges(),M.adjustZoomMapping(),P.adjustZoomDryTop();var e=U.Args[U.KeyEnum.Go],t=U.Args[U.KeyEnum.Draw];void 0!==e&&(M.goToArguments(e,M.ZoomEnum.Ground,M.Pin.Program),U.Args[U.KeyEnum.Go]=null),void 0!==t&&M.parsePersonalPath(t),I.ModeCurrent===I.ModeEnum.Overlay&&P.tickGPS()},wantZoomToFirstEvent:function(){return I.isMapEnabled&&O.Options.bol_tourPrediction&&I.ModeCurrent!==I.ModeEnum.Overlay&&I.PageCurrent===I.PageEnum.Chains&&void 0===U.Args[U.KeyEnum.Go]?!0:!1},getLayerId:function(e){return e._leaflet_id},getLayerGroup:function(e){return e._layers},sortCoordinates:function(e,t){var n;for(var i in e)n=e[i],n[0]=Math.round(n[0]),n[1]=Math.round(n[1]);if(e.sort(function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}),!t)return e;for(var i in e)this.printNumberedCoordinates(e[i],i)},roundCoordinates:function(e){var t;for(var n in e)t=e[n],t[0]=Math.round(t[0]),t[1]=Math.round(t[1]);this.printCoordinates(e)},printNeedles:function(e){for(var t in e)this.printNumberedCoordinates(e[t].c,t)},printNodes:function(e,t){for(var n=0;n<e.length;n++){var i=t?"n: "+(n+1)+", ":"";I.write("{"+i+"c: ["+e[n][0]+", "+e[n][1]+"]},",0)}},printNumberedCoordinates:function(e,t){I.write("{n: "+(parseInt(t)+1)+", c: ["+e[0]+", "+e[1]+"]},",0)},formatCoord:function(e){return"["+e[0]+", "+e[1]+"]"},compileCoordinates:function(e){for(var t="",n=0;n<e.length;n++)t+=null===e[n]?"null,":"["+e[n][0]+","+e[n][1]+"],";return t=t.substring(0,t.length-1),"["+t+"]"},printCoordinates:function(e){I.write(this.compileCoordinates(e),0)},printClosestWaypoints:function(){var e,t,n,i,a=12,r=500,o="",s=[""],c=[0,0],l=0;if(M.Layer.PersonalPin.eachLayer(function(a){t=M.convertLCtoGC(a.getLatLng()),n=M.getZoneFromCoord(t),null!==n&&(i=M.getClosestLocation(t,n.Layers.Waypoint),e="",null!==i&&(e=U.getChatlinkFromPoiID(i.options.id),l=P.getDistanceBetweenCoords(t,c),s[s.length-1]!==e&&l>r&&s.push(e),c=t))}),s.shift(),s.length>0){for(var u=Math.ceil(s.length/a),d=0,o="<div id='jsWaypointLinks'>Copy the codes below and<br />paste them in game chat to <br />follow the route:<br />",h=0;u>h;h++){o+="<input type='text'  class='cssInputText' value='";for(var p=a*h;a*(h+1)>p&&!(d>=s.length);p++)o+=" "+(p+1)+"-&gt;"+s[p],d++;o+="' /> Message "+(h+1)+"<br />"}o+="</div>",I.write(o,0,!0),$("#jsWaypointLinks .cssInputText").click(function(){$(this).select()})}else I.write("Pins must first be placed and be inside zones in order to create chatlinks.");return d},getDistanceBetweenCoords:function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},getGreedyPath:function(e,t){var n=e;if(void 0!==t){var i=n[0];n[0]=n[t],n[t]=i}for(var a=n[0],r=0,o=n.length,s=0;o>s;s++){for(var c=Number.POSITIVE_INFINITY,l=s;o>l;l++){var u=P.getDistanceBetweenCoords(a,n[l]);c>=u&&(r=l,c=u)}a=n[r],n[r]=n[s],n[s]=a}return n},drawDirectedPath:function(e,t,n){void 0===t&&(t=!0);var i=M.convertGCtoLCMulti(e),a=new L.layerGroup,r=8,o=t?0:r-1;n=n||"lime";for(var s=0;s<i.length-1;s++)a.addLayer(L.polyline([i[s],i[s+1]],{color:n,weight:2*(o+2)})),o=t?o+1:o-1,t&&o>=r?o=0:!t&&0>o&&(o=r-1);return a},drawSpots:function(e,t){var n=M.convertGCtoLCMulti(e),i=new L.layerGroup,a={radius:10,color:"lime",weight:4};if(void 0!==t)for(var r in t)a[r]=t[r];for(var r in n)i.addLayer(L.circleMarker(n[r],a));return i},drawCompletionRoute:function(){M.isItineraryRetrieved?M.redrawPersonalPath(M.ZoneCurrent.path):$.getScript(U.URL_DATA.Itinerary).done(function(){for(var e in GW2T_COMPLETION_DATA)M.Zones[e].path=GW2T_COMPLETION_DATA[e].path;M.isItineraryRetrieved=!0,P.drawCompletionRoute()})},printZoneEvents:function(){M.isEventIconsGenerated?M.ZoneCurrent.Layers.EventIcon.eachLayer(function(e){I.write("<input type='text' class='cssInputText' value='["+M.convertLCtoGC(e.getLatLng())+"]' /> "+e.options.task,0)}):I.write("Event icons have not been generated.")},drawZoneBorders:function(){if(O.Options.bol_showZoneBorders&&0===P.Layer.ZoneBorder.getLayers().length)for(var e in M.Zones){var t=M.Zones[e];P.Layer.ZoneBorder.addLayer(L.rectangle(M.convertGCtoLCMulti(t.continent_rect),{fill:!1,color:M.Regions[t.region].color,weight:2,clickable:!1}))}M.toggleLayer(P.Layer.ZoneBorder,O.Options.bol_showZoneBorders)},drawZoneGateways:function(){if(O.Options.bol_showZoneGateways&&0===P.Layer.ZoneGateway.getLayers().length){var e,t,n=GW2T_GATEWAY_CONNECTION.interzones,i=GW2T_GATEWAY_CONNECTION.intergates,a=function(e,t){return L.marker(M.convertGCtoLC(e),{clickable:!1,icon:L.icon({iconUrl:t,iconSize:[32,32],iconAnchor:[16,16]}),opacity:.6})};for(var r in n)for(var o in n[r])e=a(n[r][o],"img/map/gateway_zone.png"),P.Layer.ZoneGateway.addLayer(e);for(var r in i){for(var o in i[r])e=a(i[r][o],"img/map/gateway_gate.png"),P.Layer.ZoneGateway.addLayer(e);t=L.polyline(M.convertGCtoLCDual(i[r]),{color:"purple",opacity:.2}),P.Layer.ZoneGateway.addLayer(t)}}M.toggleLayer(P.Layer.ZoneGateway,O.Options.bol_showZoneGateways)},drawChainPaths:function(e){if(I.isMapEnabled!==!1){var t,n,i,a,r,o;if(C.isChainWorldBoss(e))for(t=0;t<e.primaryEvents.length;t++){switch(i=e.primaryEvents[t],t){case 0:a="red";break;case 1:a="orange";break;case 2:a="yellow";break;case 3:a="lime";break;case 4:a="cyan";break;case 5:a="blue";break;case 6:a="violet";break;case 7:a="purple";break;default:a="white"}r=M.convertGCtoLCMulti(i.path,1),o=L.polyline(r,{color:a}),M.Zones[e.zone].Layers.Path.addLayer(o)}var s;for(t in e.events)n=e.events[t],s=n.num,-1!==s.indexOf(".")&&(s=s.replace(".","\\.")),$("#chnEvent_"+e.nexus+"_"+s).each(function(){var e=n.path[0];$(this).attr("data-coord",e[0]+","+e[1]),$(this).attr("data-eventindex",t),I.ModeCurrent!==I.ModeEnum.Mobile&&M.bindMapLinkBehavior($(this),M.ZoomEnum.Ground,M.Pin.Event)})}},generateDryTop:function(){$.getScript(U.URL_DATA.DryTop).done(function(){C.DryTop=GW2T_DRYTOP_DATA;var e,t,n,i,a;for(e in C.DryTop)i=C.DryTop[e],a=L.marker(M.convertGCtoLC(i.coord),{clickable:!1,icon:L.divIcon({className:"mapNick",html:"<span class='mapNickIn'>"+D.getObjectName(i)+"<br /><ins style='color:"+i.color+"'>"+i.time+"</ins></span>",iconSize:[512,64],iconAnchor:[256,32]})}),P.Layer.DryTopNicks.addLayer(a);M.toggleLayer(P.Layer.DryTopNicks,!0),P.DryTopTimer=L.marker(M.convertGCtoLC(M.getZoneCenter("dry")),{clickable:!1,icon:L.divIcon({className:"mapNick",html:"<div class='mapNickIn' id='mapDryTopInfo'><span id='mapDryTopTimer'></span><br /><input id='mapDryTopClip0' type='text' /> <input id='mapDryTopClip1' type='text' /></div>",iconSize:[512,64],iconAnchor:[256,32]})}),M.toggleLayer(P.DryTopTimer,!0);for(e in C.DryTopChains){n=C.DryTopChains[e];for(t in n.events)i=n.events[t],i.eventring=L.marker(M.convertGCtoLC(i.path[0]),{zIndexOffset:M.cZIndexBury,clickable:!1,image:"img/ring/"+i.ring+I.cPNG,icon:L.icon({iconUrl:"img/ring/"+i.ring+I.cPNG,iconSize:[32,32],iconAnchor:[16,16]})}),i.eventicon=L.marker(M.convertGCtoLC(i.path[0]),{title:"<span class='mapEvent'>"+D.getObjectName(i)+"</span>",image:"img/event/"+i.icon+I.cPNG,wiki:D.getObjectName(i),icon:L.icon({iconUrl:"img/event/"+i.icon+I.cPNG,iconSize:[16,16],iconAnchor:[8,8]})}),M.bindMarkerWikiBehavior(i.eventicon,"click"),M.bindMarkerZoomBehavior(i.eventicon,"contextmenu"),$("#chnEvent_"+n.nexus+"_"+i.num).hasClass("chnEventCurrent")&&(P.LayerArray.DryTopActive.push(i.eventicon),P.LayerArray.DryTopActive.push(i.eventring),M.toggleLayer(i.eventring,!0),M.toggleLayer(i.eventicon,!0)),P.LayerArray.DryTopRings.push(i.eventring),P.LayerArray.DryTopIcons.push(i.eventicon)}I.qTip.init(".leaflet-marker-icon"),C.isDryTopGenerated=!0,T.initializeDryTopStrings(),P.toggleDryTopIcons(!0)})},toggleDryTopIcons:function(e){C.isDryTopGenerated&&(C.isDryTopIconsShown=e,M.toggleLayer(P.Layer.DryTopNicks,e),M.toggleLayer(P.DryTopTimer,e),e?(M.toggleLayerArray(P.LayerArray.DryTopActive,e),P.adjustZoomDryTop(),K.updateDryTopClipboard(),I.qTip.init($("#mapDryTopClip0, #mapDryTopClip1").click(function(){$(this).select()}).hover(function(){M.isMouseOnHUD=!0},function(){M.isMouseOnHUD=!1}))):(M.toggleLayerArray(P.LayerArray.DryTopIcons,e),M.toggleLayerArray(P.LayerArray.DryTopRings,e)))},adjustZoomDryTop:function(){if(C.isDryTopIconsShown){var e,t,n,i,a,r,o=M.Map.getZoom();switch(o){case 7:n=32,a=20,r=.9;break;case 6:n=28,a=16,r=.8;break;case 5:n=24,a=12,r=.6;break;case 4:n=20,a=0,r=0;break;case 3:n=16,a=0,r=0;break;default:n=0,a=0,r=0}i=M.scaleDimension(M.cRING_SIZE_MAX);for(e in P.LayerArray.DryTopIcons)t=P.LayerArray.DryTopIcons[e],M.changeMarkerIcon(t,t.options.image,n),t=P.LayerArray.DryTopRings[e],M.changeMarkerIcon(t,t.options.image,i);P.Layer.DryTopNicks.eachLayer(function(e){e._icon&&(e._icon.style.fontSize=a+"px",e._icon.style.opacity=r,e._icon.style.zIndex=M.cZIndexBury+1,e._icon.style.display="table")}),P.DryTopTimer._icon.style.fontSize=2*a+"px",P.DryTopTimer._icon.style.opacity=r,P.DryTopTimer._icon.style.zIndex=M.cZIndexRaise+1,P.DryTopTimer._icon.style.display="table"}},switchMapCheck:function(){if(void 0!==GPSIdentityJSON&&null!==GPSIdentityJSON){var e=P.GPSCurrent,t=GPSIdentityJSON.map_id,n="#"+P.MapCurrent;void 0!==M.ZoneAssociation[t]?P.GPSCurrent=P.MapEnum.Tyria:void 0!==W.ZoneAssociation[t]&&(P.GPSCurrent=P.MapEnum.Mists),P.GPSCurrent!==e&&P.GPSCurrent!==P.MapCurrent&&$(n+"SwitchButton").trigger("click")}},updateCharacter:function(e){var t,n=O.Options["bol_followCharacter"+P.SuffixCurrent],i=O.Options["bol_displayCharacter"+P.SuffixCurrent];switch(P.MapCurrent){case P.MapEnum.Tyria:t=M;break;case P.MapEnum.Mists:t=W}if(void 0!==GPSPositionArray&&null!==GPSPositionArray&&3===GPSPositionArray.length&&!t.isUserDragging&&void 0!==GPSIdentityJSON&&null!==GPSIdentityJSON){if(t.isZoneValid(GPSIdentityJSON.map_id)===!1)return t.movePin(t.Pin.Character),void t.movePin(t.Pin.Camera);var a=t.convertGPSCoord(GPSPositionArray,GPSIdentityJSON.map_id);if(!(a[0]>t.cMAP_BOUND||a[0]<=0||a[1]>t.cMAP_BOUND||a[1]<=0)&&((n&&t.GPSPreviousCoord[0]!==a[0]&&t.GPSPreviousCoord[1]!==a[1]||e>=0)&&(t.Map.setView(t.convertGCtoLC(a),t.Map.getZoom()),t.showCurrentZone(a),t.GPSPreviousCoord=a,e=-1),i)){var r=-t.convertGPSAngle(GPSDirectionArray),o=-t.convertGPSAngle(GPSCameraArray);if(t.GPSPreviousAngleCharacter!==r||t.GPSPreviousAngleCamera!==o||0>=e){t.movePin(t.Pin.Character,a),t.movePin(t.Pin.Camera,a),t.Pin.Camera._icon.style.zIndex=t.cZIndexBury;var s=t.Pin.Character._icon.style.transform.toString(),c=t.Pin.Camera._icon.style.transform.toString();-1===s.indexOf("rotate")&&(t.Pin.Character._icon.style.transform=s+" rotate("+r+"deg)"),-1===c.indexOf("rotate")&&(t.Pin.Camera._icon.style.transform=c+" rotate("+o+"deg)"),t.GPSPreviousAngleCharacter=r,t.GPSPreviousAngleCamera=o}}}},tickGPS:function(){(O.Options["bol_followCharacter"+P.SuffixCurrent]||O.Options["bol_displayCharacter"+P.SuffixCurrent])&&(P.updateCharacter(),window.clearTimeout(P.GPSTimeout),P.GPSTimeout=setTimeout(function(){P.tickGPS()},O.Options.int_msecGPSRefresh))}},G={generateAndInitializeDailies:function(){var e=new Date,t=function(){$("#dlyCalendar div:first").addClass("dlyCurrent").next().addClass("dlyNext"),$("#dlyCalendar .dlyEvent").each(function(){M.bindMapLinkBehavior($(this),M.ZoomEnum.Sky)}),I.bindPseudoCheckbox("#dlyCalendar ins"),I.qTip.init("#dlyCalendar ins")};$("#dlyHeader, #dlyCalendar, #dlyActivity").empty(),I.removeThrobber("#dlyContainer"),$("#dlyHeader").html(e.toLocaleString(window.navigator.language,{year:"numeric",month:"numeric",day:"numeric",weekday:"long"}));var n=T.Daily.Activity,i=n.Schedule[e.getUTCDay()],a=D.getObjectName(n.Activities[i]);$("#dlyActivity").html("<h2><img src='img/daily/activities/"+i+I.cPNG+"' /> <a"+U.convertExternalAnchor(U.getWikiLanguageLink(a))+">"+a+"</a> <ins class='dly dly_pve_activity'></ins></h2>"),$("#dlyCalendar").after(I.cThrobber),T.getDaily().done(function(){G.insertDailyDay(T.DailyToday,e),T.getDaily({getTomorrow:!0}).done(function(){I.removeThrobber("#dlyContainer"),G.insertDailyDay(T.DailyTomorrow,T.addDaysToDate(e,1)),t()})}).fail(function(){I.write("Unable to retrieve daily API.")}),$.getJSON(U.URL_API.Fractal,function(e){var t=T.Daily.Fractal,n=T.DailyAssociation[e.achievements[0]],i=T.DailyAssociation[e.achievements[4]];void 0!==n&&void 0!==i&&($("#dlyHeader").append(" <ins class='dly dly_pve_fractal'></ins><a title='"+D.getObjectName(t.Scale)+"' "+U.convertExternalAnchor(D.getObjectURL(t))+">"+n+"+"+i+"</a>"),I.qTip.init("#dlyHeader a"))}).fail(function(){I.write("Unable to retrieve daily fractal API.")})},insertDailyDay:function(e,t){var n,i,a,r,o,s,c,l="",u="",d="",h="",p="",m="",g="",f="</ins>",y="",v="</ins>",S="";switch(n=e.pve,i=e.pvp,a=e.wvw,r=n[0].split(" "),o=n[1].split(" "),h="<ins class='dlyRegion dly_region_"+r[1].toLowerCase()+"'>","Vista"===o[0]&&(p="<ins class='dlyRegion dly_region_"+o[1].toLowerCase()+"'>",y="</ins>"),m="<ins class='dlyRegion dly_region_"+M.getZoneRegion(n[2])+"'>",null!==n[3]&&(u="dly_pve_boss",g="<ins class='dlyRegion dly_region_"+C.getChainRegion(C.getChainByAlias(n[3]))+"'>",S="</ins>",d="<em><img src='img/chain/"+n[3].toLowerCase()+I.cPNG+"' /></em>"),s=i[2].split(" "),c=i[3].split(" "),t.getUTCDay()){case T.DayEnum.Sunday:l="dlySunday";break;case T.DayEnum.Saturday:l="dlySaturday"}$("#dlyCalendar").append("<div><aside></aside>"+d+"<var class='"+l+"'>"+t.getUTCDate()+"</var><span><ins class='dly_daily_pve'></ins>"+h+"<ins class='dly_pve_"+r[0].toLowerCase()+"' title='"+n[0]+"'></ins>"+f+p+"<ins class='dly_pve_"+o[0].toLowerCase()+"' title='"+n[1]+"'></ins>"+y+m+"<ins class='dly_pve_event dlyEvent curZoom' title='"+n[2]+" Events'data-coord='"+n[2].toLowerCase()+"'></ins>"+v+g+"<ins class='"+u+"' title='"+n[3]+"'></ins>"+S+"</span><span><ins class='dly_daily_pvp'></ins><ins class='dly_pvp_"+i[0].toLowerCase()+"' title='"+i[0]+"'></ins><ins class='dly_pvp_"+i[1].toLowerCase()+"' title='"+i[1]+"'></ins><ins class='dly_pvp_profession_"+s[0].toLowerCase()+"_0' title='"+i[2]+"'><ins class='dly_pvp_profession_"+s[1].toLowerCase()+"_1'></ins></ins><ins class='dly_pvp_profession_"+c[0].toLowerCase()+"_0' title='"+i[3]+"'><ins class='dly_pvp_profession_"+c[1].toLowerCase()+"_1'></ins></ins></span><span><ins class='dly_daily_wvw'></ins><ins class='dly_wvw_"+a[0].toLowerCase()+"' title='"+a[0]+"'></ins><ins class='dly_wvw_"+a[1].toLowerCase()+"' title='"+a[1]+"'></ins><ins class='dly_wvw_"+a[2].toLowerCase()+"' title='"+a[2]+"'></ins><ins class='dly_wvw_"+a[3].toLowerCase()+"' title='"+a[3]+"'></ins></span></div>")},generateAndInitializeResources:function(){var e=.3,t=function(e){return X.getChecklistItem(X.Checklists["Resource"+e.options.grade],e.options.index)},n=function(e,t){X.setChecklistItem(X.Checklists["Resource"+e.options.grade],e.options.index,t)},i=function(){for(var n in P.LayerArray.Resource)P.LayerArray.Resource[n].eachLayer(function(n){n instanceof L.Marker&&t(n)===X.ChecklistEnum.Checked&&n.setOpacity(e)})},a=function(i){M.bindMarkerZoomBehavior(i,"contextmenu"),M.bindMarkerCoordBehavior(i,"dblclick"),i.on("click",function(){t(i)===X.ChecklistEnum.Checked?(n(i,X.ChecklistEnum.Unchecked),this.setOpacity(1)):(n(i,X.ChecklistEnum.Checked),this.setOpacity(e))})},r=function(){for(var e in P.Resources){var t=P.Resources[e].item;null!==t&&!function(e){$.ajax({dataType:"json",url:U.URL_API.ItemPrices+t,cache:!1,success:function(t){var n=E.deductTax(t.sells.unit_price);$("#nodPrice_"+e).html(E.createCoinString(n,!0)),P.Resources[e].price=n}})}(e)}},o=function(e,t){return GW2T_RESOURCE_YIELD[e.type][t]},s=function(){var e,t,n,r,s,c,l=0;for(e in P.Resources){n=P.Resources[e],P.Resources[e].price=0;var u=e.toLowerCase();if(void 0!==n.riches&&n.riches.length>0){r=new L.layerGroup;for(t in n.riches)s=L.marker(M.convertGCtoLC(n.riches[t].c),{grade:"Rich",name:e,quantity:o(n,"Rich"),index:l,coord:n.riches[t].c,icon:L.divIcon({className:"nodRich",html:"<img src='img/node/"+u+I.cPNG+"' />",iconSize:[32,32],iconAnchor:[16,16]}),isNode:!0}),a(s),r.addLayer(s),void 0!==n.riches[t].p&&(c=L.polyline(M.convertGCtoLCMulti(n.riches[t].p),{color:"white",dashArray:"5,10",opacity:.3}),r.addLayer(c)),l++;M.toggleLayer(r),P.Layer["Resource_Rich_"+e]=r,P.LayerArray.Resource.push(r)}}X.initializeChecklist(X.Checklists.ResourceRich,l),i()},c=function(){var e,t,n,r,s,c=0,l=0;for(e in P.Resources){n=P.Resources[e],P.Resources[e].price=0;var u=e.toLowerCase();if(void 0!==n.regulars&&n.regulars.length>0){r=new L.layerGroup;for(t in n.regulars)s=L.marker(M.convertGCtoLC(n.regulars[t].c),{grade:"Regular",name:e,quantity:o(n,"Regular"),index:c,coord:n.regulars[t].c,icon:L.divIcon({className:"nodRegular",html:"<img src='img/node/"+u+I.cPNG+"' />",iconSize:[24,24],iconAnchor:[12,12]}),isNode:!0}),a(s),r.addLayer(s),c++;M.toggleLayer(r),P.Layer["Resource_Regular_"+e]=r,P.LayerArray.Resource.push(r)}if(void 0!==n.hotspots){r=new L.layerGroup;for(t in n.hotspots)s=L.marker(M.convertGCtoLC(n.hotspots[t].c),{grade:"Hotspot",name:e,quantity:o(n,"Hotspot"),index:l,coord:n.hotspots[t].c,icon:L.divIcon({className:"nodHotspot",html:"<img src='img/node/"+u+I.cPNG+"' />",iconSize:[24,24],iconAnchor:[12,12]}),isNode:!0}),a(s),r.addLayer(s),l++;M.toggleLayer(r),P.Layer["Resource_Hotspot_"+e]=r,P.LayerArray.Resource.push(r)}}X.initializeChecklist(X.Checklists.ResourceRegular,c),X.initializeChecklist(X.Checklists.ResourceHotspot,l),i()};$.getScript(U.URL_DATA.Resource).done(function(){var e,n;P.Resources=GW2T_RESOURCE_DATA,s();for(e in P.Resources)n=P.Resources[e],$("#nodResource_"+n.type).append("<label><input id='nod_"+e+"' type='checkbox' checked='checked' /> <img src='img/node/"+e.toLowerCase()+I.cPNG+"' /> <var>"+D.getObjectName(n)+"</var><samp id='nodPrice_"+e+"'></samp></label>");for(e in P.Resources)$("#nod_"+e).change(function(){var e=U.getSubstringFromHTMLID($(this)),t=$(this).prop("checked"),n=$("#nodShowPossible").prop("checked");M.toggleLayer(P.Layer["Resource_Rich_"+e],t),M.toggleLayer(P.Layer["Resource_Regular_"+e],t&&n),M.toggleLayer(P.Layer["Resource_Hotspot_"+e],t&&n)});$("#mapToggle_Resource").data("checked",!0).click(function(){var t=I.toggleButtonState($(this));for(e in P.Resources)$("#nod_"+e).prop("checked",t).trigger("change")}),$("#nodRoute").click(function(){M.clearPersonalPins();var e,n,i=0,a=[],r=Number.POSITIVE_INFINITY,o=$("#nod_int_coinWaypointAverage").val(),s=$("#nod_int_secNodeVisitAverage").val(),c=0,l=0,u=0;M.Map.eachLayer(function(o){o instanceof L.Marker&&o.options.isNode&&t(o)===X.ChecklistEnum.Unchecked&&(u+=P.Resources[o.options.name].price*o.options.quantity,a.push(o.options.coord),e=a[i][0],r>e&&(r=e,n=i),i++)});var d=a.length;if(d>0){M.redrawPersonalPath(P.getGreedyPath(a,n),"default"),c=P.printClosestWaypoints()*o,l=d*s;var h="Gather Profit: <span class='cssRight'>"+E.createCoinString(u,!0)+"</span><br />Waypoint Cost: <span class='cssRight'>"+E.createCoinString(c,!0)+"</span><br /></br >Net Profit: <span class='cssRight'>"+E.createCoinString(u-c,!0)+"</span><br /><br />Nodes to Visit: <span class='cssRight'>"+d+"</span><br />Estimated Time: <span class='cssRight'>"+T.getTimeFormatted({customTimeInSeconds:l,wantLetters:!0})+"</span>";I.write(h,0)}}),$("#nodToggle_ResourceMetal").click(function(){$("#nodResource_Metal input").trigger("click")}),$("#nodToggle_ResourcePlant").click(function(){$("#nodResource_Plant input").trigger("click")}),$("#nodToggle_ResourceWood").click(function(){$("#nodResource_Wood input").trigger("click")}),$("#nodShowPossible").one("click",function(){c()}),$("#nodShowPossible").change(function(){var e=$(this).prop("checked");for(var t in P.Resources){var n=$("#nod_"+t).prop("checked");M.toggleLayer(P.Layer["Resource_Regular_"+t],n&&e),M.toggleLayer(P.Layer["Resource_Hotspot_"+t],n&&e)}}).trigger("change"),$("#nodUncheck").click(function(){for(var e in P.LayerArray.Resource)P.LayerArray.Resource[e].eachLayer(function(e){e instanceof L.Marker&&e.setOpacity(1)});X.clearChecklist(X.Checklists.ResourceRich),X.clearChecklist(X.Checklists.ResourceRegular),X.clearChecklist(X.Checklists.ResourceHotspot)}),$("#nodRefresh").click(function(){r(),I.write("Prices refreshed.")}),r()})},generateAndInitializeJPs:function(){var e=function(e,t){e.setIcon(new L.icon({className:"jpzDifficulty"+t,iconUrl:"img/map/jp.png",iconSize:[32,32],iconAnchor:[16,16]}))};$.getScript(U.URL_DATA.JP).done(function(){P.JPs=GW2T_JP_DATA,X.Checklists.JP.length=O.getObjectLength(P.JPs),P.LayerArray.JP=new Array(X.Checklists.JP.length);for(var t in P.JPs){var n=P.JPs[t],i=4===n.difficulty?"Explorer":"JP",a=L.marker(M.convertGCtoLC(n.coord),{id:n.id,difficulty:n.difficulty,title:"<div class='mapLoc'><dfn>"+i+":</dfn> "+D.getObjectName(n)+"<img src='"+U.getImageHosted(n.img)+"' /></div>"});e(a,n.difficulty),P.LayerArray.JP[n.id]=a,M.toggleLayerArray(P.LayerArray.JP,!0);var r=D.getObjectName(n);$("#jpzList_"+n.difficulty).append("<dt id='jpz_"+n.id+"' data-coord='"+n.coord+"'>"+r+"</dt><label><input type='checkbox' id='jpzCheck_"+n.id+"' /></label>&nbsp;<cite><a href='"+U.getYouTubeLink(r+" "+I.cGameNick)+"'>[Y]</a> <a href='"+U.getWikiLanguageLink(r)+"'>[W]</a></cite><dd>"+n.description+"</dd>");var o=$("#jpz_"+n.id);o.attr("title","<div class='mapLoc'><img src='"+U.getImageHosted(n.img)+"' /></div>"),M.bindMapLinkBehavior(o,M.ZoomEnum.Same)}M.bindMapLinks(".jpzList"),U.convertExternalLink(".jpzList a"),I.qTip.init(".jpzList dt"),$("#jpzToggleJP").change(function(){var t=$(this).prop("checked");if(M.toggleLayerArray(P.LayerArray.JP,t),t)for(var n in P.LayerArray.JP){var i=P.LayerArray.JP[n],t=X.getChecklistItem(X.Checklists.JP,i.options.id);t===X.ChecklistEnum.Unchecked?e(i,i.options.difficulty):e(i,0)}}),$("#mapToggle_JP").data("checked",!0).click(function(){var e=I.toggleButtonState($(this));$("#jpzToggleJP").prop("checked",e).trigger("change"),$("#jpzToggleChest").prop("checked")&&$("#jpzToggleChest").prop("checked",e).trigger("change")}),I.qTip.init(".leaflet-marker-icon"),X.initializeChecklist(X.Checklists.JP,X.Checklists.JP.length);for(var s=function(){var e=X.countChecklist(X.Checklists.JP,X.ChecklistEnum.Checked),t=X.Checklists.JP.length;$("#jpzCounter").text(e+"/"+t)},t=0;t<X.Checklists.JP.length;t++)$("#jpzCheck_"+t).each(function(){
var n=X.getChecklistItem(X.Checklists.JP,t,O.TypeEnum.isBoolean);$(this).prop("checked",n),n===!1?$(this).parent().prev().removeClass("jpzListNameChecked"):($(this).parent().prev().addClass("jpzListNameChecked"),e(P.LayerArray.JP[t],0))}).change(function(){var t=X.getCheckboxEnumState($(this)),n=U.getSubintegerFromHTMLID($(this));t===X.ChecklistEnum.Unchecked?($(this).parent().prev().removeClass("jpzListNameChecked"),e(P.LayerArray.JP[n],P.LayerArray.JP[n].options.difficulty)):($(this).parent().prev().addClass("jpzListNameChecked"),e(P.LayerArray.JP[n],0)),X.setChecklistItem(X.Checklists.JP,n,t),s()}).parent().hover(function(){$(this).prev().css({"text-decoration":"underline"}).trigger("mouseenter")},function(){$(this).prev().css({"text-decoration":"none"}).trigger("mouseleave")}),function(e){var t=P.LayerArray.JP[e];t.on("click",function(){$("#jpzCheck_"+e).trigger("click"),I.scrollToElement("#jpz_"+this.options.id,"#plateMap")}),M.bindMarkerZoomBehavior(t,"contextmenu")}(t);$("#jpzUncheckJP").click(function(){for(t=0;t<X.Checklists.JP.length;t++)$("#jpzCheck_"+t).prop("checked",!1).parent().prev().removeClass("jpzListNameChecked"),e(P.LayerArray.JP[t],P.LayerArray.JP[t].options.difficulty);X.clearChecklist(X.Checklists.JP),s()}),s(),G.generateAndInitializeChests()})},generateAndInitializeChests:function(){P.Chests=GW2T_CHEST_DATA;var e=P.Chests.Basic.length+P.Chests.Splendid.length;X.initializeChecklist(X.Checklists.Chest,e);var t,n,i=0,a=.3,r=function(e){return X.getChecklistItem(X.Checklists.Chest,e.options.index)},o=function(e,t){X.setChecklistItem(X.Checklists.Chest,e.options.index,t)},s=function(){P.Layer.Chest.eachLayer(function(e){r(e)===X.ChecklistEnum.Checked?e.setOpacity(a):e.setOpacity(1)})},c=function(e,t,n){var i=null;e.t&&(i=e.t);var s=L.marker(M.convertGCtoLC(e.c),{index:n,icon:L.divIcon({className:"mapChest"+t,html:"<img src='img/map/chest.png' />",iconSize:[32,32],iconAnchor:[16,16]}),title:i});s.on("click",function(){r(this)===X.ChecklistEnum.Checked?(o(this,X.ChecklistEnum.Unchecked),this.setOpacity(1)):(o(this,X.ChecklistEnum.Checked),this.setOpacity(a))}),M.bindMarkerZoomBehavior(s,"contextmenu"),P.Layer.Chest.addLayer(s)};for(t in P.Chests)for(n in P.Chests[t])c(P.Chests[t][n],t,i),i++;$("#jpzToggleChest").change(function(){M.toggleLayer(P.Layer.Chest,$(this).prop("checked")),s()}),$("#jpzUncheckChest").click(function(){X.clearChecklist(X.Checklists.Chest),s()})},generateCollectiblesUI:function(){$.getScript(U.URL_DATA.Collectible).done(function(){P.Collectibles=GW2T_COLLECTIBLE_DATA;var e,t,n,i;for(e in P.Collectibles)t=P.Collectibles[e],n=D.getObjectName(t),i=D.getObjectDefaultName(t),$("#cltList").append("<div><label style='color:"+t.color+"'><ins class='clt_"+e.toLowerCase()+"'></ins><input id='ned_"+e+"' type='checkbox' /> "+n+"</label><span><cite><a href='"+U.getYouTubeLink(i+" "+I.cGameNick)+"'>[Y]</a>&nbsp;<a href='"+t.wiki+"'>[W]</a>&nbsp;<a href='"+t.credit+"'>[C]</a>&nbsp;&nbsp;-&nbsp;&nbsp;</cite><a id='nedUncheck_"+e+"'>Reset</a></span></div>"),$("#ned_"+e).one("click",function(){var e=U.getSubstringFromHTMLID($(this));G.generateCollectibles(e),M.goToArguments(P.Collectibles[e].view)}),I.ArticleCurrent&&I.ArticleCurrent.toLowerCase()===X.Collectibles[e].urlkey&&($("#ned_"+e).trigger("click"),I.ArticleCurrent=null);U.convertExternalLink("#cltList cite a"),$("#mapToggle_Collectible").data("checked",!1).data("hideonly",!0).click(function(){for(e in P.Collectibles)$("#ned_"+e).prop("checked")&&$("#ned_"+e).trigger("click")}),I.scrollToElement("#headerMap_Collectible","#plateMap")})},generateCollectibles:function(e){var t,n,i,a,r,o,s,c,l,u=U.Args[X.Collectibles[e].urlkey],d=P.Collectibles[e],h=D.getObjectName(d),p=function(e,t){e.setIcon(new L.divIcon({className:"mapNeedle"+t+" mapNeedleExtreme"+e.options.needleExtreme,html:"<span style='color:"+e.options.needleColor+"'>"+e.options.needleLabel+"</span>",iconSize:[16,16],iconAnchor:[8,8]}))};for(X.Collectibles[e].length=P.Collectibles[e].needles.length,X.initializeChecklist(X.Collectibles[e],X.Collectibles[e].length,u),P.LayerArray[e]=[],P.Layer[e]=new L.layerGroup,t=0;t<d.needles.length;t++)n=t+1,a=d.needles[t],r=X.getChecklistItem(X.Collectibles[e],t),l="<div class='mapLoc'><dfn>"+h+":</dfn> #"+n,a.i?l+="<img src='"+a.i+"' />":a.t&&(l+="<br /><span class='mapTip'>"+a.t+"</span>"),l+="</div>",i=0===t||t===d.needles.length-1?0:void 0===a.e?"":a.e,o=L.marker(M.convertGCtoLC(a.c),{needleExtreme:i,needleIndex:t,needleType:e,needleKey:X.Collectibles[e].urlkey,needleColor:d.color,needleLabel:void 0===a.l?n:a.l,title:l}),p(o,r),o.on("click",function(e){var t=X.trackChecklistItem(X.Collectibles[this.options.needleType],this.options.needleIndex);p(this,t);var n=X.getCheckedIndexes(X.Collectibles[this.options.needleType]);0===n.length?U.updateQueryString():U.updateAddressBar("?"+this.options.needleKey+"="+n)}),M.bindMarkerZoomBehavior(o,"contextmenu"),P.LayerArray[e].push(o),t<d.needles.length-1&&(c=2===a.e?"5,15":"1",s=L.polyline(M.convertGCtoLCDual([a.c,d.needles[t+1].c]),{color:"lime",dashArray:c,opacity:.5}),P.Layer[e].addLayer(s));M.toggleLayerArray(P.LayerArray[e],!0),M.toggleLayer(P.Layer[e],!0),$("#ned_"+e).change(function(){var e=$(this).prop("checked"),t=U.getSubstringFromHTMLID($(this));M.toggleLayerArray(P.LayerArray[t],e),M.toggleLayer(P.Layer[t],e),e&&(M.goToArguments(P.Collectibles[t].view),I.qTip.init(".leaflet-marker-icon"))}),$("#nedUncheck_"+e).click(function(){var e=U.getSubstringFromHTMLID($(this)),t=P.LayerArray[e];for(var n in t)p(t[n],X.ChecklistEnum.Unfound);X.clearChecklist(X.Collectibles[e]),U.updateQueryString()})},generateGuildUI:function(){hideGuildMapDrawings=function(e){M.toggleLayerArray(P.LayerArray["Guild_"+e],!1),$("#gldBook_"+e+" dfn").each(function(){I.toggleHighlight($(this),!1)}),void 0!==P.Guild[e].usedSubmaps&&M.toggleSubmapArray(P.Guild[e].usedSubmaps,!1)},finalizeGuildBook=function(e){U.convertExternalLink("#gldBook_"+e+" a"),I.qTip.init("#gldBook_"+e+" dfn"),$("#gldBook_"+e+" .cssWaypoint").each(function(){new ZeroClipboard($(this)[0]).on("aftercopy",function(e){I.write(K.cZeroClipboardSuccessText+e.data["text/plain"],5)})})},$.getScript(U.URL_DATA.Guild).done(function(){P.Guild=GW2T_GUILD_DATA;var e;for(e in P.Guild){var t=P.Guild[e],n=D.getObjectName(t);$("#gldButtons").append("<div><button class='gldButton curToggle' id='gldButton_"+e+"' title='<dfn>"+n+"</dfn><br />gw2timer.com/guild/"+e.toLowerCase()+"'><img src='img/guild/"+e.toLowerCase()+I.cPNG+"' /></button><a class='cssButton' href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"'>Y</a>&nbsp;<a class='cssButton' href='"+D.getObjectURL(t)+"'>W</a></div>"),$("#gldBooks").append("<div class='gldBook' id='gldBook_"+e+"'></div>")}if($(".gldBook").hide(),I.qTip.init("#gldButtons button"),U.convertExternalLink("#gldButtons a"),$(".gldButton").click(function(){var e=U.getSubstringFromHTMLID($(this)),t=!0;$("#gldBook_"+e).is(":visible")&&(hideGuildMapDrawings(e),t=!1),$(".gldBook").hide(),t&&$("#gldBook_"+e).show(),I.updateScrollbar()}),$("#mapToggle_Guild").data("hideonly",!0).click(function(){$(".gldButton").each(function(){hideGuildMapDrawings(U.getSubstringFromHTMLID($(this))),$(".gldBook").hide(),I.updateScrollbar()}),M.movePin(M.Pin.Program)}),$("#gldButton_Bounty").one("click",function(){D.sortObjects(P.Guild.Bounty.data);for(var e in P.Guild.Bounty.data){var t=P.Guild.Bounty.data[e],n=D.getObjectDefaultName(t),i=D.getObjectName(t);$("#gldBook_Bounty").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Bounty)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldBounty_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"'>[Y]</a> <a href='"+U.getWikiLink(n)+"'>[W]</a></div>");var a=new L.layerGroup;if(void 0!==t.paths)for(var r in t.paths)a.addLayer(P.drawDirectedPath(t.paths[r]));void 0!==t.spawn&&a.addLayer(P.drawSpots(t.spawn)),P.LayerArray.Guild_Bounty.push(a);var o=$("#gldBounty_"+e);o.attr("title","<div class='mapLoc'><img src='"+t.img+"' /></div>").click(function(){I.toggleHighlight($(this)),M.toggleLayer(P.LayerArray.Guild_Bounty[U.getSubintegerFromHTMLID($(this))])}),M.bindMapLinkBehavior(o,M.invertZoomLevel(t.coord[2]))}finalizeGuildBook("Bounty")}),$("#gldButton_Trek").one("click",function(){D.sortObjects(P.Guild.Trek.data);for(var e in P.Guild.Trek.data){var t=P.Guild.Trek.data[e],n=D.getObjectName(t);$("#gldBook_Trek").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Trek)+": "+n+"' src='img/ui/placeholder.png' /> <dfn id='gldTrek_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+n+"</dfn></div>");var i=new L.layerGroup;i.addLayer(L.polyline(M.convertGCtoLCMulti(t.path),{color:"gold"})),P.LayerArray.Guild_Trek.push(i);var a=$("#gldTrek_"+e);a.attr("title","<div class='mapLoc'><img src='"+t.img+"' /></div>").click(function(){I.toggleHighlight($(this)),M.toggleLayer(P.LayerArray.Guild_Trek[U.getSubintegerFromHTMLID($(this))])}),M.bindMapLinkBehavior(a,M.ZoomEnum.Same,M.Pin.Program)}finalizeGuildBook("Trek")}),$("#gldButton_Challenge").one("click",function(){P.Guild.Challenge.usedSubmaps=[],D.sortObjects(P.Guild.Challenge.data);for(var e in P.Guild.Challenge.data){var t=P.Guild.Challenge.data[e],n=D.getObjectDefaultName(t),i=D.getObjectName(t);$("#gldBook_Challenge").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Challenge)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldChallenge_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+" - "+t.limit+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"'>[Y]</a> <a href='"+U.getWikiLink(n)+"'>[W]</a></div>"),void 0!==t.submap&&(M.toggleSubmap(t.submap,!1),P.Guild.Challenge.usedSubmaps.push(t.submap));var a=new L.layerGroup;a.addLayer(L.polyline(M.convertGCtoLCMulti(t.path),{color:"gold"})),a.addLayer(P.drawSpots(t.spawn,{color:"gold"})),P.LayerArray.Guild_Challenge.push(a);var r=$("#gldChallenge_"+e);r.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Challenge.data[e].submap,n=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,n),M.toggleLayer(P.LayerArray.Guild_Challenge[e])}),M.bindMapLinkBehavior(r,M.ZoomEnum.Ground,M.Pin.Program)}finalizeGuildBook("Challenge")}),$("#gldButton_Rush").one("click",function(){P.Guild.Rush.usedSubmaps=[],D.sortObjects(P.Guild.Rush.data);for(var e in P.Guild.Rush.data){var t=P.Guild.Rush.data[e],n=D.getObjectDefaultName(t),i=D.getObjectName(t);$("#gldBook_Rush").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Rush)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldRush_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"'>[Y]</a> <a href='"+U.getWikiLink(n)+"'>[W]</a></div>"),void 0!==t.submap&&(M.toggleSubmap(t.submap,!1),P.Guild.Rush.usedSubmaps.push(t.submap));var a=new L.layerGroup;a.addLayer(L.polyline(M.convertGCtoLCMulti(t.path),{color:"gold"})),a.addLayer(L.polyline(M.convertGCtoLCMulti(t.track),{color:"lime",dashArray:"5,10"})),a.addLayer(L.marker(M.convertGCtoLC(t.finish),{icon:M.createStandardIcon("img/map/chest.png")})),void 0!==t.traps0&&a.addLayer(P.drawSpots(t.traps0,{radius:5,color:"red",weight:1,opacity:1})),void 0!==t.traps1&&a.addLayer(P.drawSpots(t.traps1,{radius:10,color:"red",weight:1,opacity:1})),a.addLayer(P.drawSpots(t.flags,{radius:2,color:"gold",weight:2,opacity:1})),P.LayerArray.Guild_Rush.push(a);var r=$("#gldRush_"+e);r.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Rush.data[e].submap,n=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,n),M.toggleLayer(P.LayerArray.Guild_Rush[e])}),M.bindMapLinkBehavior(r,M.ZoomEnum.Ground,M.Pin.Program)}finalizeGuildBook("Rush")}),$("#gldButton_Puzzle").one("click",function(){P.Guild.Puzzle.usedSubmaps=[],D.sortObjects(P.Guild.Puzzle.data);for(var e in P.Guild.Puzzle.data){var t=P.Guild.Puzzle.data[e],n=D.getObjectDefaultName(t),i=D.getObjectName(t);$("#gldBook_Puzzle").append("<div><img class='cssWaypoint' "+K.cZeroClipboardDataAttribute+"='"+t.wp+" "+D.getObjectName(P.Guild.Puzzle)+": "+i+"' src='img/ui/placeholder.png' /> <dfn id='gldPuzzle_"+e+"' data-coord='["+t.coord[0]+","+t.coord[1]+"]'>"+i+" - "+t.limit+"</dfn> <a href='"+U.getYouTubeLink(n+" "+I.cGameNick)+"'>[Y]</a> <a href='"+U.getWikiLink(n)+"'>[W]</a></div>"),void 0!==t.submap&&(M.toggleSubmap(t.submap,!1),P.Guild.Puzzle.usedSubmaps.push(t.submap));var a=new L.layerGroup;a.addLayer(P.drawSpots(t.interactions,{color:"gold"})),a.addLayer(L.marker(M.convertGCtoLC(t.finish),{icon:M.createStandardIcon("img/map/chest.png")})),P.LayerArray.Guild_Puzzle.push(a);var r=$("#gldPuzzle_"+e);r.click(function(){var e=U.getSubintegerFromHTMLID($(this)),t=P.Guild.Puzzle.data[e].submap,n=I.toggleHighlight($(this));void 0!==t&&M.toggleSubmap(t,n),M.toggleLayer(P.LayerArray.Guild_Puzzle[e])}),M.bindMapLinkBehavior(r,M.ZoomEnum.Ground,M.Pin.Program)}finalizeGuildBook("Puzzle")}),I.ArticleCurrent)for(e in P.Guild)if(I.ArticleCurrent.toLowerCase()===e.toLowerCase()){$("#gldButton_"+e).trigger("click"),I.ArticleCurrent=null;break}})}},W={MapEnum:"wvw",OptionSuffix:"WvW",ZoneAssociation:GW2T_LAND_ASSOCIATION,cInitialZone:"eternal",cMAP_BOUND:16384,cMAP_CENTER:[10750,12414],cMAP_CENTER_INITIAL:[-193.96875,167.96875],cMAP_CENTER_ACTUAL:[8192,8192],ZoomEnum:{Adaptive:-2,Same:-1,Min:0,Overview:2,Default:3,Space:3,Sky:4,Bird:5,Ground:6,Max:6},Layer:{Overview:new L.layerGroup,PersonalPin:new L.layerGroup,PersonalPath:new L.layerGroup,Pin:new L.layerGroup,Objective:new L.layerGroup},LayerArray:{},Pin:{Program:{},Event:{},Over:{},Character:{},Camera:{}},ServerRegionThreshold:{Range:99,Americas:1e3,Europe:2e3,France:2100,Germany:2200,Spain:2300},ServerRegionEnum:{Americas:1,Europe:2},isWvWLoaded:!1,Metadata:{},Servers:{},ServersCurrent:null,Objectives:{},ObjectiveTimeout:{},MapType:{},LandEnum:{},ObjectiveEnum:{},isObjectiveTickEnabled:!1,isObjectiveTimerTickEnabled:!1,cSECONDS_IMMUNITY:300,cMILLISECONDS_IMMUNITY:3e5,MatchFinishTime:null,initializeWvW:function(){$.extend(W,$.extend({},M,W)),W.Zones=GW2T_LAND_DATA,W.Regions=GW2T_REALM_DATA,W.Servers=GW2T_SERVER_DATA,W.Objectives=GW2T_OBJECTIVE_DATA,W.Metadata=GW2T_OBJECTIVE_METADATA,W.MapType=W.Metadata.MapType,W.LandEnum=W.Metadata.LandEnum,W.ObjectiveEnum=W.Metadata.ObjectiveEnum,W.initializeMap(),W.populateWvW(),W.initializeLog(),W.reinitializeObjectives(),W.generateServerList(),I.styleContextMenu("#wvwContext"),W.isWvWLoaded=!0},populateWvW:function(){var e,t;for(var n in W.Objectives)e=W.Objectives[n],t=L.marker(this.convertGCtoLC(e.coord),{clickable:!0,riseOnHover:!0,icon:L.divIcon({className:"",html:"<div id='obj_"+e.id+"' class='objContainer'><span class='objUmbrellaContainer'><span class='objUmbrellaOuter'><samp id='objUmbrella_"+e.id+"' class='objUmbrella'></samp></span></span><time id='objTimer_"+e.id+"' class='objTimer'></time><span class='objProgressContainer'><span id='objProgressBar_"+e.id+"' class='objProgressBar'><var id='objProgress_"+e.id+"' class='objProgress'></var></span></span><span class='objIconContainer'><img id='objIcon_"+e.id+"' class='objIcon' data-src='img/wvw/objectives/"+e.type.toLowerCase()+"_' src='img/ui/placeholder.png'/></span><span class='objInfo'><cite id='objClaim_"+e.id+"'></cite> <cite id='objAge_"+e.id+"'></cite></span></div>",iconSize:[38,38],iconAnchor:[19,19]})}),e.Marker=t,this.Layer.Objective.addLayer(t);this.toggleLayer(this.Layer.Objective,!0),O.Options.bol_showWorldCompletionWvW===!1&&W.finishPopulation()},finishPopulation:function(){W.bindMapVisualChanges(),W.adjustZoomMapping(),I.ModeCurrent===I.ModeEnum.Overlay&&P.tickGPS()},getName:function(e){return D.getObjectName(W.Metadata[e])},getNick:function(e){return D.getObjectNick(W.Metadata[e])},getServerFromOwner:function(e){var t=W.ServersCurrent[e.toLowerCase()];return W.Servers[t]},getBorderlandsString:function(e,t,n){var i,a,r=e,o=e.map_type;if(void 0!==o){var s=W.MapType[o];if("center"===s)return W.getNick("Center");r=W.Servers[W.ServersCurrent[s]]}return i=t?D.getObjectName(r):D.getObjectNick(r),a=n?W.getName("Borderlands"):W.getNick("Borderlands"),D.isLanguageModifierFirst()?i+" "+a:a+" "+i},getObjectiveNick:function(e,t){if(void 0!==e.direction){var n=t?W.getName(e.direction):W.getNick(e.direction),i=W.getName(e.type);return n+" "+i}return D.getObjectNick(e)},generateServerList:function(){var e=[];for(var t in W.Servers)e.push(W.Servers[t]);D.sortObjects(e);var n,i,a=$("#wvwServerList");for(var t in e)n=e[t],i=n.id===O.Options.enu_Server?"selected":"",a.append("<option value='"+n.id+"' "+i+">"+D.getObjectName(n)+"</option>");$("#wvwServerList").change(function(){var e=$(this).val();O.Options.enu_Server=e,localStorage.enu_Server=O.Options.enu_Server,U.updateQueryString("enu_Server="+e),W.reinitializeObjectives()})},generateScoreboard:function(){},initializeLog:function(){$("#wvwLogContainer").show(),$("#logWindow").data("oldHeight",$("#logWindow").height()),$("#logToggle").click(function(){$("#wvwLog").toggle("fast")}),$("#logExpand").click(function(){var e=$("#logWindow"),t=$(window).height(),n=e.data("oldHeight"),i=t-n;e.data("isExpanded")===!0?e.show().animate({height:n},200,function(){I.updateScrollbar(e)}).data("isExpanded",!1):(n>i&&(i=n),e.show().animate({height:i},200,function(){I.updateScrollbar(e)}).data("isExpanded",!0))}),I.initializeScrollbar("#logWindow");for(var e in W.MapType)!function(e){$("#opt_bol_log"+e).change(function(){O.Options["bol_log"+e]?$(".logEntry"+e).show("fast",function(){I.updateScrollbar("#logWindow")}):$(".logEntry"+e).hide("fast",function(){I.updateScrollbar("#logWindow")})}).parent().dblclick(function(){$("#logFilters input:checkbox").each(function(){X.setCheckboxEnumState($(this),X.ChecklistEnum.Unchecked)}),X.setCheckboxEnumState($("#opt_bol_log"+e),X.ChecklistEnum.Checked)})}(e);$("#opt_bol_narrateRedHome").next().html(D.orderModifier(W.getName("Borderlands"),W.getName("Red"))),$("#opt_bol_narrateGreenHome").next().html(D.orderModifier(W.getName("Borderlands"),W.getName("Green"))),$("#opt_bol_narrateBlueHome").next().html(D.orderModifier(W.getName("Borderlands"),W.getName("Blue"))),$("#opt_bol_narrateCenter").next().html(W.getName("Center")),$("#opt_bol_narrateCamp").next().html(W.getName("Camp")),$("#opt_bol_narrateTower").next().html(W.getName("Tower")),$("#opt_bol_narrateKeep").next().html(W.getName("Keep")),$("#opt_bol_narrateCastle").next().html(W.getName("Castle")),$("#opt_bol_narrateClaimed").next().html(W.getName("Claimed")),$("#logTime").click(function(){$("#opt_bol_use24Hour").trigger("click"),$("#logWindow li time").each(function(){var e=T.getTimeFormatted({customTimeInDate:new Date($(this).attr("data-time"))});$(this).html(e)})})},readjustLog:function(){$("#wvwLog").height()>$(window).height()&&$("#logExpand").trigger("click").trigger("click")},addLogEntry:function(e,t,n,i){e=e||"",n=n||"";var a="";void 0===t?(a=T.getTimeFormatted(),t=(new Date).toISOString()):a=T.getTimeFormatted({customTimeInDate:new Date(t)});var r=$("<li class='logEntry logRecent "+n+"'><time data-time='"+t+"'>"+a+"</time><samp>"+e+"</samp></li>").prependTo("#logWindow");if(i===!1)r.hide();else{var o=r.width();r.removeClass("logRecent").css({width:0}).animate({width:o},400)}var s=$(".logEntry");s.length>O.Options.int_numLogEntries&&s.last().remove(),I.updateScrollbar("#logWindow")},addLogEntryObjective:function(e,t){var n,i="<img src='img/wvw/objectives/"+(e.type+"_"+e.prevowner).toLowerCase()+I.cPNG+"' />",a="<img src='img/wvw/objectives/"+(e.type+"_"+e.owner).toLowerCase()+I.cPNG+"' />",r=W.getObjectiveNick(e,!1);t?(i=a,a="<cite>["+e.tag+"]</cite>",n=e.claimed_at):n=e.last_flipped;var o=i+" ⇒ "+a+" "+r,s=e.map_type,c="logEntry"+s,l=!0;(s===W.LandEnum.RedHome&&O.Options.bol_logRedHome===!1||s===W.LandEnum.GreenHome&&O.Options.bol_logBlueHome===!1||s===W.LandEnum.BlueHome&&O.Options.bol_logGreenHome===!1||s===W.LandEnum.Center&&O.Options.bol_logCenter===!1)&&(l=!1),W.addLogEntry(o,n,c,l),O.Options.bol_logNarrate&&W.narrateLog(e,t)},narrateLog:function(e,t){var n=e.map_type,i=e.type;if(!(t&&O.Options.bol_narrateClaimed===!1||n===W.LandEnum.RedHome&&O.Options.bol_narrateRedHome===!1||n===W.LandEnum.GreenHome&&O.Options.bol_narrateGreenHome===!1||n===W.LandEnum.BlueHome&&O.Options.bol_narrateBlueHome===!1||n===W.LandEnum.Center&&O.Options.bol_narrateCenter===!1||i===W.ObjectiveEnum.Camp&&O.Options.bol_narrateCamp===!1||i===W.ObjectiveEnum.Tower&&O.Options.bol_narrateTower===!1||i===W.ObjectiveEnum.Keep&&O.Options.bol_narrateKeep===!1||i===W.ObjectiveEnum.Castle&&O.Options.bol_narrateCastle===!1)){var a=W.getObjectiveNick(e,!0),r=t?D.getSpeechInitials(e.tag):D.getObjectName(W.getServerFromOwner(e.owner)),o=$("#logNarrateLand input:checked").length>1?W.getBorderlandsString(e,!0,!0)+". ":"",s=t?W.getName("Claimed"):W.getName("Captured"),c=o+a,l=s+" "+r;D.speak(c),D.speak(l)}},updateParticipants:function(){if(null!==W.ServersCurrent){var e=W.Servers[W.ServersCurrent.red],t=W.Servers[W.ServersCurrent.green],n=W.Servers[W.ServersCurrent.blue];$("#opt_bol_logRedHome").next().html(W.getBorderlandsString(e,!0,!1)),$("#opt_bol_logGreenHome").next().html(W.getBorderlandsString(t,!0,!1)),$("#opt_bol_logBlueHome").next().html(W.getBorderlandsString(n,!0,!1)),$("#opt_bol_logCenter").next().html(W.getName("Center")),W.addLogEntry(D.getObjectNick(e)+" : "+D.getObjectNick(t)+" : "+D.getObjectNick(n))}},reinitializeObjectives:function(){for(var e in W.Objectives){var t=W.Objectives[e];t.isImmune=!1,t.owner=null,t.last_flipped=null,t.last_flipped_msec=null,t.claimed_by="null",t.claimed_at=null}W.MatchFinishTime=null,W.ServersCurrent=null,$(".objUmbrellaContainer").hide(),$(".objTimer").empty(),$(".objProgressBar").hide(),$("#logWindow").empty(),W.toggleObjectiveTick(!1),W.toggleObjectiveTick(!0)},updateObjectives:function(){var e=(new Date).getTime();$.ajax({dataType:"json",url:U.URL_API.Match+O.Options.enu_Server,cache:!1,success:function(t){var n,i;for(var a in t.maps)for(var r in t.maps[a].objectives)i=t.maps[a].objectives[r],n=W.Objectives[i.id],n.last_flipped!==i.last_flipped&&(n.last_flipped=i.last_flipped,n.last_flipped_msec=new Date(i.last_flipped).getTime(),n.prevowner=n.owner,n.owner=i.owner,W.updateObjectiveIcon(n),W.updateObjectiveAge(n),$("#objClaim_"+n.id).empty(),e-n.last_flipped_msec<W.cMILLISECONDS_IMMUNITY&&(W.Objectives[n.id].isImmune=!0,$("#objProgressBar_"+n.id).show())),n.claimed_by!==i.claimed_by&&(n.prevclaimed_by=n.claimed_by,n.claimed_by=i.claimed_by,n.claimed_at=i.claimed_at,W.updateObjectiveClaim(n));null===W.MatchFinishTime&&(W.MatchFinishTime=t.end_time,W.ServersCurrent=t.worlds,W.updateParticipants())}}).fail(function(){I.write("Unable to retrieve WvW data. ArenaNet API servers may be down.")})},updateObjectiveIcon:function(e){var t=2e3,n=$("#objUmbrella_"+e.id),i=$("#objIcon_"+e.id),a=i.css("width");if(null!==e.prevowner){var r=W.Metadata[e.prevowner].color,o=W.Metadata[e.owner].color;n.parent().parent().show(),n.css({borderColor:r,boxShadow:"0px 0px 10px "+r}),I.bloatElement(n,1e3,100),function(e,n,r){i.css({width:a}).animate({width:0},t,function(){n.css({borderColor:r,boxShadow:"0px 0px 10px "+r}),$(this).attr("src",$(this).attr("data-src")+e+I.cPNG).animate({width:a},t,function(){n.parent().parent().hide(),W.adjustZoomMapping()})})}(e.owner,n,o),W.addLogEntryObjective(e)}else i.attr("src",i.attr("data-src")+e.owner+I.cPNG)},updateObjectiveTimers:function(){var e,t,n,i=(new Date).getTime();for(var a in W.Objectives)e=W.Objectives[a],e.isImmune&&(t=W.cMILLISECONDS_IMMUNITY-(i-e.last_flipped_msec),n=t/W.cMILLISECONDS_IMMUNITY*T.cPERCENT_100,t>0?(document.getElementById("objTimer_"+e.id).innerHTML=T.formatMilliseconds(t),document.getElementById("objProgress_"+e.id).style.width=n+"%"):($("#objTimer_"+e.id).html(""),$("#objProgressBar_"+e.id).css({opacity:1}).animate({opacity:0},2e3,function(){$(this).css({opacity:1}).hide()}),$("#objIcon_"+e.id).css({opacity:0}).animate({opacity:1},2e3),e.isImmune=!1,W.updateObjectiveAge(e)))},updateObjectiveAge:function(e){var t=(new Date).getTime()-e.last_flipped_msec;$("#objAge_"+e.id).html(T.getShorthandTime(t))},updateAllObjectiveAge:function(){for(var e in W.Objectives)W.updateObjectiveAge(W.Objectives[e])},updateObjectiveClaim:function(e){null!==e.claimed_by&&$.getJSON(U.URL_API.GuildDetails+e.claimed_by,function(t){e.guild_name=t.guild_name,e.tag=t.tag;var n=$("#objClaim_"+e.id),i=n.css("color");n.html("["+e.tag+"]"),"null"!==e.prevclaimed_by&&(I.blinkElement(n,2e3,200),n.css({color:"#ffffff"}).animate({color:i},4e3),W.addLogEntryObjective(e,!0))})},updateObjectiveTooltip:function(e){},toggleObjectiveTick:function(e){e?(W.isObjectiveTickEnabled=e,W.tickObjectives(),W.isObjectiveTimerTickEnabled=e):(window.clearTimeout(W.ObjectiveTimeout),W.isObjectiveTickEnabled=e,W.isObjectiveTimerTickEnabled=e)},tickObjectives:function(){W.isObjectiveTickEnabled&&(W.updateObjectives(),window.clearTimeout(W.ObjectiveTimeout),W.ObjectiveTimeout=setTimeout(function(){W.tickObjectives()},O.Options.int_secWvWRefresh*T.cMILLISECONDS_IN_SECOND))}},T={Daily:GW2T_DAILY_DATA,DailyAssociation:GW2T_DAILY_ASSOCIATION,DailyToday:null,DailyTomorrow:null,Schedule:{},DryTopSets:{},DryTopCodes:{},DST_IN_EFFECT:0,SECONDS_TILL_RESET:0,TIMESTAMP_UNIX_SECONDS:0,cUTC_OFFSET_USER:0,cUTC_OFFSET_SERVER:-8,cUTC_OFFSET_HAWAII:-10,cUTC_OFFSET_EASTERN:-4,cMILLISECONDS_IN_SECOND:1e3,cMILLISECONDS_IN_MINUTE:6e4,cSECONDS_IN_MINUTE:60,cSECONDS_IN_HOUR:3600,cSECONDS_IN_DAY:86400,cSECONDS_IN_WEEK:604800,cMINUTES_IN_HOUR:60,cMINUTES_IN_2_HOURS:120,cMINUTES_IN_DAY:1440,cHOURS_IN_MERIDIEM:12,cHOURS_IN_DAY:24,cDAYS_IN_WEEK:7,cSECONDS_IN_TIMEFRAME:900,cMINUTES_IN_TIMEFRAME:15,cMINUTES_IN_MINIFRAME:5,cNUM_TIMEFRAMES_IN_HOUR:4,cSECS_MARK_0:0,cSECS_MARK_1:900,cSECS_MARK_2:1800,cSECS_MARK_3:2700,cSECS_MARK_4:3599,cBASE_10:10,cPERCENT_100:100,WEEKLY_RESET_DAY:1,cDAYTIME_DAY_MINUTES:80,cDAYTIME_NIGHT_MINUTES:40,cDAYTIME_DAY_START:25,cDAYTIME_NIGHT_START:45,ReferenceEnum:{UTC:0,Local:1,Server:2},UnitEnum:{Milliseconds:0,Seconds:1,Minutes:2,Hours:3},DayEnum:{Sunday:0,Monday:1,Tuesday:2,Wednesday:3,Thursday:4,Friday:5,Saturday:6},secondsTillResetWeekly:-1,isCountdownToResetStarted:!1,getCurrentDryTopEvents:function(e){return T.DryTopCodes[T.getDryTopMinute(e)].chat+I.siteTagCurrent},getCurrentDryTopColor:function(e){return T.DryTopCodes[T.getDryTopMinute(e)].color},getDryTopMinute:function(e){e=e||0;var t=new Date,n=t.getUTCMinutes(),i=~~(n/T.cMINUTES_IN_MINIFRAME)*T.cMINUTES_IN_MINIFRAME+e*T.cMINUTES_IN_MINIFRAME;return i=T.wrapInteger(i,T.cMINUTES_IN_HOUR),i<T.cBASE_10&&(i="0"+i),i},initializeDryTopStrings:function(){getDryTopSet=function(e){var t=T.DryTopSets[e],n="";for(var i in t)n+=D.getObjectName(t[i])+"@"+t[i].wp+" ";return n.trim()},T.DryTopSets=[[C.DryTop.Victims,C.DryTop.Crystals,C.DryTop.Supplies,C.DryTop.Rustbucket,C.DryTop.Shaman,C.DryTop.TendrilW,C.DryTop.TendrilSE,C.DryTop.Tootsie],[C.DryTop.MineE,C.DryTop.Serene,C.DryTop.Insects,C.DryTop.Bridge,C.DryTop.Experiment,C.DryTop.Golem,C.DryTop.Nochtli,C.DryTop.Colocal],[C.DryTop.MineNE,C.DryTop.Basket,C.DryTop.Suit,C.DryTop.Leyline,C.DryTop.Town],[C.DryTop.Mites,C.DryTop.Haze,C.DryTop.Eway,C.DryTop.Skritts0,C.DryTop.Skritts1,C.DryTop.Skritts2,C.DryTop.Skritts3,C.DryTop.Explosives,C.DryTop.Giant],[C.DryTop.Devourer],[C.DryTop.Mites,C.DryTop.Haze,C.DryTop.Twister,C.DryTop.Chriikkt,C.DryTop.Eway,C.DryTop.Skritts0,C.DryTop.Skritts1,C.DryTop.Skritts2,C.DryTop.Skritts3,C.DryTop.Chickenado],[C.DryTop.Beetle,C.DryTop.Monster]],T.DryTopCodes={"00":{chat:":00 "+getDryTopSet(0),color:"red"},"05":{chat:":05 "+getDryTopSet(1),color:"orange"},10:{chat:":10 "+getDryTopSet(2),color:"yellow"},15:{chat:":15 "+getDryTopSet(0),color:"red"},20:{chat:":20 "+getDryTopSet(1),color:"orange"},25:{chat:":25 "+getDryTopSet(2),color:"yellow"},30:{chat:":30 "+getDryTopSet(0),color:"red"},35:{chat:":35 "+getDryTopSet(1),color:"orange"},40:{chat:":40 "+getDryTopSet(3),color:"lime"},45:{chat:":45 "+getDryTopSet(4),color:"limegreen"},50:{chat:":50 "+getDryTopSet(5),color:"dodgerblue"},55:{chat:":55 "+getDryTopSet(6),color:"orchid"}},K.updateDryTopClipboard(),$("#itemDryTopClip").show()},initializeScheduleSlot:function(e){void 0===T.Schedule[e]&&(T.Schedule[e]={SchedTime:e,SchedChains:[]})},insertChainToSchedule:function(e){var t=0,n=e.timing;if(Array.isArray(n))for(var i in n)t=T.parseChainTime(n[i]),T.initializeScheduleSlot(t),T.Schedule[t].SchedChains.push(e);else for(t=n.hourInitial*T.cMINUTES_IN_HOUR+n.minuteOffset;t<T.cMINUTES_IN_DAY;t+=n.hourMultiplier*T.cMINUTES_IN_HOUR)T.initializeScheduleSlot(t),T.Schedule[t].SchedChains.push(e)},initializeSchedule:function(){var e,t,n,i;B.DashboardStory.isEnabled&&T.isTimely(B.DashboardStory,new Date)&&(B.isDashboardStoryEnabled=!0),X.initializeChecklist(X.Checklists.Chain,C.Chains.length+C.UnscheduledChainsLength),X.initializeChecklist(X.Checklists.ChainSubscription,C.Chains.length+C.UnscheduledChainsLength),C.initializeScheduledChains(),I.initializeChainsUI(),$("#sectionChains_Scheduled .chnBar h1, #sectionChains_Drytop .chnBar h1, #dsbStory .chnBar h1").addClass("chnTitleFutureFar");for(e in C.ScheduledChains)T.insertChainToSchedule(C.ScheduledChains[e]);for(e in T.Schedule){i=T.Schedule[e];for(t in C.ScheduledChains)for(n in i.SchedChains)if(C.ScheduledChains[t].nexus===i.SchedChains[n].nexus){C.ScheduledChains[t].scheduleKeys.push(e);break}}C.CurrentChainSD=T.getStandardChain()},getScheduleSlotTime:function(e){return T.Schedule[e].SchedTime},getScheduleSlotChainsByKey:function(e){return T.Schedule[e].SchedChains},getCurrentTimeframe:function(){var e=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Minutes);return e-e%T.cMINUTES_IN_TIMEFRAME},getTimeframe:function(e){e=e||0;var t=T.getCurrentTimeframe()+e*T.cMINUTES_IN_TIMEFRAME;return T.wrapInteger(t,T.cMINUTES_IN_DAY)},getTimeframeChains:function(e){return T.Schedule[T.getTimeframe(e)].SchedChains},getTimeframeChainBySeries:function(e,t){var n=T.getTimeframeChains(e);for(var i in n)if(n[i].series===t)return n[i];return null},getTimeframeChainsBySeries:function(e,t){var n=T.getTimeframeChains(e),i=[];for(var a in n)n[a].series===t&&i.push(n[a]);return i},getStandardChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.Standard)},getHardcoreChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.Hardcore)},getLivingStoryChain:function(e){return T.getTimeframeChainBySeries(e,C.ChainSeriesEnum.LivingStory)},getMiscellaneousChains:function(e){return T.getTimeframeChainsBySeries(e,C.ChainSeriesEnum.Miscellaneous)},getTimeframeKey:function(e){return T.getTimeframe(e).toString()},convertScheduleKeyToLocalSeconds:function(e){var t=T.getScheduleSlotTime(e)*T.cSECONDS_IN_MINUTE-(new Date).getTimezoneOffset()*T.cSECONDS_IN_MINUTE;return T.wrapInteger(t,T.cSECONDS_IN_DAY)},convertScheduleKeyToUTCMinutes:function(e){return parseInt(e)},getCurrentTimeframeElapsedTime:function(e){var t=new Date,n=t.getUTCMinutes(),i=t.getUTCSeconds();return e===T.UnitEnum.Minutes?n%T.cMINUTES_IN_TIMEFRAME:n%T.cMINUTES_IN_TIMEFRAME*T.cSECONDS_IN_MINUTE+i},getSecondsUntilChainStarts:function(e){var t=T.convertScheduleKeyToLocalSeconds(e.scheduleKeys[0]),n=T.getTimeSinceMidnight(T.ReferenceEnum.Local,T.UnitEnum.Seconds),i=T.cSECONDS_IN_TIMEFRAME*T.cNUM_TIMEFRAMES_IN_HOUR;return t>=T.cSECONDS_IN_DAY-i&&i>=n?T.cSECONDS_IN_DAY-t+n:n>=T.cSECONDS_IN_DAY-i&&i>=t?T.cSECONDS_IN_DAY-n+t:t-n},getTimeTillChainFormatted:function(e,t){var n=T.getSecondsUntilChainStarts(e),i=~~(n/T.cSECONDS_IN_MINUTE)%T.cSECONDS_IN_MINUTE,a=~~(n/T.cSECONDS_IN_HOUR),r=D.getTranslation("m"),o=D.getTranslation("h");return"speech"===t&&(r=" "+D.getSpeechWord("minute"),o=" "+D.getSpeechWord("hour"),Math.abs(i)>1&&(r=" "+D.getSpeechWord("minutes")),Math.abs(a)>1&&(o=" "+D.getSpeechWord("hours")),0===a&&30===Math.abs(i)&&(i=D.getTranslation("half an hour"),
r="",o="")),o+=" ",i+=r,Math.abs(n)>=T.cSECONDS_IN_HOUR?a+=o:a="",0>n?" "+a+i+" "+D.getTranslation("ago"):" "+D.getTranslation("in")+" "+a+i},getRandomIntRange:function(e,t){return Math.floor(Math.random()*(t-e+1))+e},getMinMax:function(e,t){for(var n,i=!(void 0===t),a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,o=0;o<e.length;o++)n=i?e[o][t]:e[o],a>n&&(a=n),n>r&&(r=n);return[a,r]},wrapInteger:function(e,t){var n=e;return n%=t,0>n&&(n=t+n),n},stepFunction:function(e,t,n,i,a){var r=~~(e/i)*a+t;return r>n?n:r},parseEventTime:function(e){var t=[];return-1!==e.indexOf("~")?(t=e.split("~"),T.parseEventTime(t[0])+~~(T.parseEventTime(t[1])/2)):"*"===e?0:-1===e.indexOf(":")?parseInt(e,T.cBASE_10):(t=e.split(":"),2===t.length?parseInt(t[0],T.cBASE_10)*T.cSECONDS_IN_MINUTE+parseInt(t[1],T.cBASE_10):3===t.length?parseInt(t[0])*T.cSECONDS_IN_HOUR+parseInt(t[1],T.cBASE_10)*T.cSECONDS_IN_MINUTE+parseInt(t[2],T.cBASE_10):NaN)},parseChainTime:function(e){var t=e.split(":");return parseInt(t[0],T.cBASE_10)*T.cMINUTES_IN_HOUR+parseInt(t[1],T.cBASE_10)},checkDST:function(){Date.prototype.stdTimezoneOffset=function(){var e=new Date(this.getFullYear(),0,1),t=new Date(this.getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},Date.prototype.dst=function(){return this.getTimezoneOffset()<this.stdTimezoneOffset()};var e=new Date;T.DST_IN_EFFECT=e.dst()&&O.Options.bol_detectDST?1:0},getTimeFormatted:function(e){e=e||{},void 0===e.reference&&(e.reference=T.ReferenceEnum.Local),void 0===e.want24&&(e.want24=O.Options.bol_use24Hour),void 0===e.wantSeconds&&(e.wantSeconds=!0),void 0===e.wantHours&&(e.wantHours=!0),void 0===e.wantLetters&&(e.wantLetters=!1);var t,n,i,a;if(a=void 0===e.customTimeInDate?new Date:e.customTimeInDate,void 0===e.customTimeInSeconds)switch(e.reference){case T.ReferenceEnum.Local:t=a.getSeconds(),n=a.getMinutes(),i=a.getHours();break;case T.ReferenceEnum.Server:t=a.getSeconds(),n=a.getMinutes(),i=a.getUTCHours()+T.cUTC_OFFSET_SERVER+T.DST_IN_EFFECT,i=T.wrapInteger(i,T.cHOURS_IN_DAY);break;case T.ReferenceEnum.UTC:t=a.getUTCSeconds(),n=a.getUTCMinutes(),i=a.getUTCHours()}else e.customTimeInSeconds=T.wrapInteger(e.customTimeInSeconds,T.cSECONDS_IN_DAY),t=e.customTimeInSeconds%T.cSECONDS_IN_MINUTE,n=~~(e.customTimeInSeconds/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,i=~~(e.customTimeInSeconds/T.cSECONDS_IN_HOUR);var r="";if(r=e.wantSeconds?e.wantLetters?0===i&&0===n?t+D.getWord("s"):n+D.getWord("m")+" "+t+D.getWord("s"):e.wantHours===!1?n+":"+(t<T.cBASE_10?"0"+t:t):(n<T.cBASE_10?"0"+n:n)+":"+(t<T.cBASE_10?"0"+t:t):e.wantLetters?n+D.getWord("m"):n<T.cBASE_10?"0"+n:n,e.wantLetters)return 0===i||e.wantHours===!1?r:i+D.getWord("h")+" "+r;if(e.want24)return e.wantHours===!1?r:(i<T.cBASE_10?"0"+i:i)+":"+r;var o=" AM";return i>=T.cHOURS_IN_MERIDIEM?(i>T.cHOURS_IN_MERIDIEM&&(i%=T.cHOURS_IN_MERIDIEM),o=" PM"):0===i&&(i=T.cHOURS_IN_MERIDIEM),i+":"+r+o},getShorthandTime:function(e){var t=~~(e/T.cMILLISECONDS_IN_SECOND);return t<T.cSECONDS_IN_MINUTE?0+D.getWord("m"):t<T.cSECONDS_IN_HOUR?~~(t/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR+D.getWord("m"):~~(t/T.cSECONDS_IN_HOUR)+D.getWord("h")},formatMilliseconds:function(e,t){var n,i,a,r,o=~~(e/T.cMILLISECONDS_IN_SECOND),s="",c="",l="",u="",d="",h="";if(0>o&&(o=-1*o,h="−"),o>=T.cSECONDS_IN_DAY&&(n=~~(o/T.cSECONDS_IN_DAY),s=n+"::"),o>=T.cSECONDS_IN_HOUR&&(i=~~(o/T.cSECONDS_IN_HOUR)%T.cHOURS_IN_DAY,c=i+":",""!==s&&i<T.cBASE_10&&(c="0"+c)),o>=T.cSECONDS_IN_MINUTE?(a=~~(o/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,l=a+":",""!==c&&a<T.cBASE_10&&(l="0"+l)):l="0:",r=o%T.cSECONDS_IN_MINUTE,u=r.toString(),r<T.cBASE_10&&(u="0"+u),t){var p=~~(e%T.cMILLISECONDS_IN_SECOND/T.cBASE_10);d="."+p,p<T.cBASE_10&&(d=".0"+p)}return h+s+c+l+u+d},formatSeconds:function(e,t){var n,i,a,r,o,s=e,c="",l="",u="",d="",h="",p="";return 0>s&&(s=-1*s,p="−"),s>=T.cSECONDS_IN_WEEK&&(n=~~(s/T.cSECONDS_IN_WEEK),c=n+D.getWord("w")+" "),s>=T.cSECONDS_IN_DAY&&(i=~~(s/T.cSECONDS_IN_DAY)%T.cDAYS_IN_WEEK,l=i+D.getWord("d")+" "),s>=T.cSECONDS_IN_HOUR&&(a=~~(s/T.cSECONDS_IN_HOUR)%T.cHOURS_IN_DAY,u=a+D.getWord("h")+" "),s>=T.cSECONDS_IN_MINUTE&&(r=~~(s/T.cSECONDS_IN_MINUTE)%T.cMINUTES_IN_HOUR,d=r+D.getWord("m")+" "),t&&(o=s%T.cSECONDS_IN_MINUTE,h=o.toString()+D.getWord("s")),p+c+l+u+d+h},formatMinutes:function(e){return T.formatSeconds(e*T.cSECONDS_IN_MINUTE)},isTimely:function(e,t){return t>=e.Start&&t<=e.Finish?!0:!1},isDaylight:function(){var e=new Date,t=e.getUTCHours(),n=e.getUTCMinutes();if(t%2===0){if(n>=T.cDAYTIME_DAY_START)return!0}else if(n<T.cDAYTIME_NIGHT_START)return!0;return!1},getDayPeriodRemaining:function(){var e=new Date,t=e.getUTCHours(),n=e.getUTCMinutes(),i="";return i=t%2===0?n>=T.cDAYTIME_DAY_START?T.cDAYTIME_DAY_START+T.cDAYTIME_DAY_MINUTES-n:T.cDAYTIME_DAY_START-n:n<T.cDAYTIME_NIGHT_START?T.cDAYTIME_NIGHT_START-n:T.cDAYTIME_NIGHT_START+T.cDAYTIME_NIGHT_MINUTES-n,i+D.getWord("m")},getUTCMidnight:function(){return(new Date).setUTCHours(0,0,0,0)},getTimeSinceMidnight:function(e,t){t=t||T.UnitEnum.Seconds,e=e||T.ReferenceEnum.UTC;var n=new Date,i=n.getUTCHours(),a=n.getUTCMinutes(),r=n.getUTCSeconds();switch(e){case T.ReferenceEnum.Server:i=i+T.cUTC_OFFSET_SERVER+T.DST_IN_EFFECT;break;case T.ReferenceEnum.UTC:break;case T.ReferenceEnum.Local:i=n.getHours(),a=n.getMinutes(),r=n.getSeconds()}return i=T.wrapInteger(i,T.cHOURS_IN_DAY),t===T.UnitEnum.Hours?i:t===T.UnitEnum.Minutes?i*T.cMINUTES_IN_HOUR+a:i*T.cSECONDS_IN_HOUR+a*T.cSECONDS_IN_MINUTE+r},getUNIXSeconds:function(){return~~((new Date).getTime()/T.cMILLISECONDS_IN_SECOND)},addDaysToDate:function(e,t){var n=new Date(e);return n.setDate(e.getDate()+t),n},getCurrentBihourlyMinutesUTC:function(){var e=new Date;return e.getUTCHours()%2*T.cMINUTES_IN_HOUR+e.getUTCMinutes()},getCurrentBihourlyTimestampLocal:function(e){var t=new Date,n=t.getUTCHours(),i=n%2===0?n:n-1,a=i*T.cMINUTES_IN_HOUR-t.getTimezoneOffset();return a=T.wrapInteger(a,T.cMINUTES_IN_DAY),T.getTimeFormatted({customTimeInSeconds:(a+e)*T.cSECONDS_IN_MINUTE,wantSeconds:!1})},getSecondsTillUTCWeekday:function(e,t){void 0===t&&(t=0);var n=new Date,i=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Seconds),a=T.cSECONDS_IN_DAY-i,r=n.getUTCDay(),o=0;return e>r?(o=(e-r-1)*T.cSECONDS_IN_DAY,a+o+t):r>e?(o=(T.cDAYS_IN_WEEK-1-r+e)*T.cSECONDS_IN_DAY,a+o+t):t>=i?t-i:T.cSECONDS_IN_WEEK-(i-t)},updateCountdownToReset:function(){T.secondsTillResetWeekly<0&&(T.secondsTillResetWeekly=T.getSecondsTillUTCWeekday(T.WEEKLY_RESET_DAY)),$("#chlCountdownToReset").text(T.formatSeconds(T.secondsTillResetWeekly,!0)),T.secondsTillResetWeekly--},convertDailyObject:function(e){for(var t={},n=T.DailyAssociation,i=e.pve.length-1;i>=0;i--)e.pve[i].level.max<I.cLevelMax&&e.pve.splice(i,1);return t.pve=[n[e.pve[0].id],n[e.pve[1].id],n[e.pve[2].id],n[e.pve[3].id]],t.pvp=[n[e.pvp[0].id],n[e.pvp[1].id],n[e.pvp[2].id],n[e.pvp[3].id]],t.wvw=[n[e.wvw[0].id],n[e.wvw[1].id],n[e.wvw[2].id],n[e.wvw[3].id]],t},extractDailyChain:function(e){var t=e.pve[3];return t=void 0!==t&&null!==t?t.toLowerCase():null,null!==t&&void 0!==C.ChainAssociation[t]?C.getChainByAlias(t):null},getDaily:function(e){e=e||{};var t=3,n=U.URL_API.Daily;return(e.getTomorrow||e.setTomorrow)&&(n=U.URL_API.Tomorrow),$.getJSON(n,function(n){if(e.getTomorrow)T.DailyTomorrow=T.convertDailyObject(n),C.ChainTomorrow=T.extractDailyChain(T.DailyTomorrow);else{T.DailyToday=T.convertDailyObject(n);var i,a=T.extractDailyChain(T.DailyToday),r=T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Minutes);if(null!==a)if(i=T.convertScheduleKeyToUTCMinutes(a.scheduleKeys[0]),e.setTomorrow)C.ChainToday=a;else{if(null!==C.ChainToday&&e.isReset){var o=C.ChainToday.alias;if(C.ChainToday=null,C.refreshChainDailyIcon(),a.alias===o)return void setTimeout(function(){T.getDaily({isReset:!0})},t*T.cMILLISECONDS_IN_MINUTE)}i+T.cMINUTES_IN_TIMEFRAME>=r?C.ChainToday=a:T.getDaily({setTomorrow:!0})}else C.ChainToday=null;if(C.ChainToday&&(C.refreshChainDailyIcon(),e.isReset===!0&&(O.isServerReset&&I.greet(D.getModifiedWord("boss","daily",U.CaseEnum.Sentence)+" "+D.getObjectName(C.ChainToday)+" "+D.getTranslation("will start")+" "+D.getTranslation("at")+" "+T.getTimeFormatted({wantSeconds:!1,customTimeInSeconds:T.convertScheduleKeyToLocalSeconds(C.ChainToday.scheduleKeys[0])})+" "+D.getTranslation("in")+" "+T.getTimeFormatted({wantLetters:!0,wantSeconds:!1,customTimeInSeconds:T.getSecondsUntilChainStarts(C.ChainToday)}),15),O.Options.bol_alertAutosubscribe&&O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription))){var s=$("#chnTime_"+C.ChainToday.nexus);s.hasClass("chnTimeSubscribed")||s.trigger("click")}}})}},B={DashboardAnnouncement:GW2T_DASHBOARD_DATA.Announcement,DashboardCountdown:GW2T_DASHBOARD_DATA.Countdowns,DashboardStory:GW2T_DASHBOARD_DATA.Story,DashboardSale:GW2T_DASHBOARD_DATA.Sale,DashboardSupply:GW2T_DASHBOARD_DATA.Supply,isDashboardEnabled:!0,isDashboardAnnouncementEnabled:!1,isDashboardCountdownEnabled:!1,isDashboardCountdownTickEnabled:!1,isDashboardStoryEnabled:!1,isDashboardSaleEnabled:!1,isDashboardSupplyEnabled:!1,Timeline:GW2T_TIMELINE,isTimelineEnabled:!0,isTimelineGenerated:!1,initializeDashboard:function(){var e=new Date;for(var t in B.DashboardCountdown)if(e<B.DashboardCountdown[t].Finish){B.isDashboardCountdownEnabled=!0;break}if(B.DashboardAnnouncement.content.length>0&&T.isTimely(B.DashboardAnnouncement,e)&&(U.convertExternalLink($("#dsbAnnouncement").html(B.DashboardAnnouncement.content).find("a")),M.bindMapLinks("#dsbAnnouncement"),B.isDashboardAnnouncementEnabled=!0),B.DashboardSale.Items.length>0&&T.isTimely(B.DashboardSale,e)&&(B.isDashboardSaleEnabled=!0),T.isTimely(B.DashboardSupply,e)&&(B.isDashboardSupplyEnabled=!0),B.isDashboardCountdownEnabled===!1&&B.isDashboardAnnouncementEnabled===!1&&B.isDashboardSaleEnabled===!1&&B.isDashboardSupplyEnabled===!1||B.isDashboardEnabled===!1||I.isMapEnabled===!1||O.Options.bol_showDashboard===!1)return void(B.isDashboardEnabled=!1);if(B.isDashboardCountdownTickEnabled=!0,$("#dsbClose").click(function(){B.toggleDashboard(!1),B.isDashboardEnabled=!1}),B.isDashboardCountdownEnabled){B.toggleDashboard(!0);var n,i,a,r=D.getNameKey(),o=D.getURLKey();for(var t in B.DashboardCountdown)n=B.DashboardCountdown[t],n.isTimely=!0,n.StartStamp=n.Start.toLocaleString(),n.FinishStamp=n.Finish.toLocaleString(),i=void 0===n.name?n[r]:n.name,a=void 0===n.official?n[o]:U.getGW2OfficialLink(n.official),a=void 0===a?n.url:a,-1!==a.indexOf(I.cSiteURL)?n.Anchor="<a href='"+a+"'>"+i+"</a>":n.Anchor="<a"+U.convertExternalAnchor(a)+">"+i+"</a>",$("#dsbCountdown").append("<div id='dsbCountdown_"+t+"' class='dsbCountdownEntry'><code>"+I.Symbol.Block+"</code>"+n.Anchor+" <time id='dsbCountdownTime_"+t+"'></time> <var></var> <samp></samp></div>");I.qTip.init("#dsbCountdown"),B.refreshDashboard(e)}if(B.isDashboardStoryEnabled&&($("#dsbStory").before("<div id='dsbStoryTitle'>"+D.getObjectName(B.DashboardStory)+"</div>").show(),I.initializeScrollbar("#dsbStory")),B.isDashboardSaleEnabled){var s=T.getMinMax(B.DashboardSale.Items,"pricenew");$("#dsbSale").append("<div><kbd id='dsbSaleHeader' class='curToggle'><img src='img/ui/gemstore.png' /> <u>"+B.DashboardSale.Items.length+" "+D.getTranslation("Gem Store Promotions")+"</u> (<span class='dsbSalePriceNew'>"+s[0]+"-"+s[1]+"<ins class='s16 s16_gem'></ins></span>)<img id='dsbSaleToggleIcon' src='img/ui/toggle.png' /></kbd>⇓@ "+B.DashboardSale.Finish.toLocaleString()+"</div><div id='dsbSaleTable' class='jsScrollable'></div>");var c=0,l=0;for(var t in B.DashboardSale.Items)0===B.DashboardSale.Items[t].col?c++:l++;l>c?(B.DashboardSale.Padding.col=0,B.DashboardSale.Items.unshift(B.DashboardSale.Padding)):c>l&&(B.DashboardSale.Padding.col=1,B.DashboardSale.Items.unshift(B.DashboardSale.Padding)),$("#dsbSaleHeader").click(function(){B.generateDashboardSale()}),I.toggleToggleIcon("#dsbSaleToggleIcon",B.DashboardSale.isPreshown),B.DashboardSale.isPreshown===!0&&B.generateDashboardSale()}B.isDashboardSupplyEnabled&&B.generateDashboardSupplyHeader()},generateDashboardSale:function(){var e=200,t=$("#dsbSaleTable");t.is(":empty")===!1?(I.toggleToggleIcon("#dsbSaleToggleIcon",!1),t.animate({height:0},e,function(){$(this).css({height:"auto"}).empty()})):(t.append(I.cThrobber),E.updateCoinInGem().always(function(){if(I.toggleToggleIcon("#dsbSaleToggleIcon",!0),t.empty(),B.DashboardSale.note.length>0&&t.append("<div>Note: "+B.DashboardSale.note+"</div>"),t.append("<div id='dsbSaleCol0'></div><div id='dsbSaleCol1'></div>"),0!==E.Exchange.CoinInGem)for(var n in B.DashboardSale.Items){var i=B.DashboardSale.Items[n],a=i.quantity>1?i.quantity+"/ ":"",r=i.pricenew<i.priceold?"<span class='dsbSalePriceOld'><del>"+a+i.priceold+"</del></span> ":"",o=void 0!==i.col?i.col:parseInt(n)%2;$("#dsbSaleCol"+o).append("<div class='dsbSaleEntry'><a"+U.convertExternalAnchor(i.url)+"><img class='dsbSaleIcon' src='"+i.img+"' /></a> "+r+"<span class='dsbSalePriceNew'>"+a+i.pricenew+"<ins class='s16 s16_gem'></ins></span><span class='dsbSalePriceCoin'> ≈ "+E.createCoinString(Math.round(i.pricenew*E.Exchange.CoinInGem),!0)+"</span><span class='dsbSalePriceMoney'> = "+E.convertGemToMoney(i.pricenew)+"<ins class='s16 s16_money'></ins></span></div>")}var s=t.height();t.css({height:0}).animate({height:s},e,function(){$(this).css({height:"auto"}),I.initializeScrollbar("#dsbSaleTable"),I.updateScrollbar("#dsbSaleTable")})}))},generateDashboardSupplyHeader:function(){var e=B.getDashboardSupplyWeekday(),t=D.getObjectName(B.DashboardSupply),n="";for(var i in B.DashboardSupply.Codes)n+=i+"@"+B.DashboardSupply.Codes[i][e]+" ";n+="- "+t,$("#dsbSupply").empty().append("<div><kbd id='dsbSupplyHeader' class='curToggle' title='<dfn>Updated:</dfn> "+B.DashboardSupply.Start.toLocaleString(window.navigator.language,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",weekday:"long"})+"'><img src='img/map/vendor_karma.png' /> <u>"+t+"</u><img id='dsbSupplyToggleIcon' src='img/ui/toggle.png' /></kbd><a"+U.convertExternalAnchor("http://wiki.guildwars2.com/wiki/Pact_Supply_Network_Agent")+"title='Items restock at daily reset.<br />Vendors relocate 8 hours after that.<br />Limit 1 purchase per vendor.'>Info</a> <u class='curZoom' id='dsbSupplyDraw'>"+D.getPhrase("draw route",U.CaseEnum.Sentence)+"</u><input id='dsbSupplyCodes' class='cssInputText' type='text' value='"+n+"' /> </div><div id='dsbSupplyTable' class='jsScrollable'></div>"),$("#dsbSupplyCodes").click(function(){$(this).select()}),$("#dsbSupplyHeader").click(function(){B.generateDashboardSupply()}),$("#dsbSupplyDraw").click(function(){if($(this).data("hasDrawn")!==!0){var t=[];for(var n in B.DashboardSupply.Coords){var i=B.DashboardSupply.Coords[n][e];void 0!==i&&t.push(i)}M.redrawPersonalPath(P.getGreedyPath(t),"default"),$(this).data("hasDrawn",!0)}else M.clearPersonalPins(),$(this).data("hasDrawn",!1)}),I.toggleToggleIcon("#dsbSupplyToggleIcon",B.DashboardSale.isPreshown)},generateDashboardSupply:function(){var e=200,t=B.getDashboardSupplyWeekday(),n=$("#dsbSupplyTable"),i=O.getObjectLength(B.DashboardSupply.Offers);if(n.is(":empty")===!1)I.toggleToggleIcon("#dsbSupplyToggleIcon",!1),n.animate({height:0},e,function(){$(this).css({height:"auto"}).empty()});else{I.toggleToggleIcon("#dsbSupplyToggleIcon",!0),n.empty(),n.append(I.cThrobber);for(var a in B.DashboardSupply.Offers)!function(e){var a=B.DashboardSupply.Offers[e];$.getJSON(U.URL_API.ItemDetails+a.id+U.URL_API.LangKey,function(i){var r=D.isLanguageDefault()?i.name:a.id;n.append("<div class='dsbSupplyEntry'><a"+U.convertExternalAnchor(U.getWikiSearchLink(r))+"><img class='dsbSupplyIcon' src='"+i.icon+"' /></a> <span id='dsbSupplyItem_"+e+"' class='dsbSupplyItem curZoom "+E.getRarityClass(i.rarity)+"' data-coord='"+B.DashboardSupply.Coords[e][t]+"'>"+i.name+"</span> <span class='dsbSupplyPriceKarma'>"+E.createKarmaString(a.price,!0)+"</span><span class='dsbSupplyPriceCoin' id='dsbSupplyPriceCoin_"+e+"'></span></div>"),$.getJSON(U.URL_API.ItemPrices+a.id,function(t){$("#dsbSupplyPriceCoin_"+e).html(" ≈ "+E.createCoinString(E.deductTax(t.sells.unit_price),!0))}).fail(function(){$("#dsbSupplyPriceCoin_"+e).html(" = "+E.createCoinString(0,!0))}),M.bindMapLinkBehavior($("#dsbSupplyItem_"+e),M.ZoomEnum.Ground,M.Pin.Program)}).done(function(){$(".dsbSupplyEntry").length===i&&r()}).fail(function(){n.empty(),I.write("Unable to retrieve item: <a"+U.convertExternalAnchor(U.getWikiSearchLink(a.id))+">"+a.id+"</a>. ArenaNet API servers may be down.",0)})}(a)}var r=function(){$(".dsbSupplyItem").each(function(){M.bindMapLinkBehavior($(this))});var t=n.height();n.css({height:0}).animate({height:t},e,function(){$(this).css({height:"auto"}),I.initializeScrollbar("#dsbSupplyTable"),I.updateScrollbar("#dsbSupplyTable")}),I.removeThrobber(n)}},getDashboardSupplyWeekday:function(){var e=new Date,t=e.getUTCDay(),n=e.getUTCHours();return n<B.DashboardSupply.resetHour?T.wrapInteger(t-1,T.cDAYS_IN_WEEK):t},updateDashboardCountdown:function(e){for(var t in B.DashboardCountdown){var n=B.DashboardCountdown[t];if(n.isTimely){var i=T.formatSeconds(~~((n.DesiredTime.getTime()-e.getTime())/T.cMILLISECONDS_IN_SECOND),!0);document.getElementById("dsbCountdownTime_"+t).innerHTML=i}}},refreshDashboard:function(e){var t=e.getUTCHours(),n=e.getUTCMinutes();for(var i in B.DashboardCountdown){var a=B.DashboardCountdown[i];if(a.isTimely){var r,o,s,c=$("#dsbCountdown_"+i);e<a.Start?(a.DesiredTime=a.Start,r="dsbCountdownDormant",o=I.Symbol.ArrowUp+"@",s=a.StartStamp):e<a.Finish?(a.DesiredTime=a.Finish,r="dsbCountdownActive",o=I.Symbol.ArrowDown+"@",s=a.FinishStamp):(a.isTimely=!1,c.remove()),a.isTimely&&(c.find("code").removeClass().addClass(r),c.find("var").text(o),c.find("samp").text(s))}}T.isTimely(B.DashboardStory,e)===!1&&(B.isDashboardStoryEnabled=!1,$("#dsbStory").hide()),T.isTimely(B.DashboardSale,e)===!1&&(B.isDashboardSaleEnabled=!1,$("#dsbSale").hide()),T.isTimely(B.DashboardSupply,e)&&t===B.DashboardSupply.resetHour&&0===n&&B.generateDashboardSupplyHeader()},toggleDashboard:function(e){void 0===e&&(e=!$("#itemDashboard").is(":visible")),O.Options.bol_showDashboard&&B.isDashboardEnabled&&(B.isDashboardCountdownTickEnabled=e,e?$("#itemDashboard").show().css({opacity:0}).animate({opacity:1},200):$("#itemDashboard").hide())},generateTimeline:function(){B.isTimelineGenerated=!0;var e=$("#itemTimeline").show().append("<div class='tmlLine curToggle' id='tmlLegend'></div>");B.updateTimelineLegend(),$("#tmlLegend").click(function(){$("#opt_bol_use24Hour").trigger("click")});for(var t in B.Timeline){var n=B.Timeline[t],i=void 0===n.zone?D.getObjectName(n):U.escapeHTML(M.getZoneName(n.zone)),a=$("<div class='tmlLine' title='<dfn>"+i+"</dfn>'></div>").appendTo(e);for(var r in n.Segments){var o=n.Segments[r],s="";switch(o.primacy){case C.EventPrimacyEnum.Normal:s=I.Symbol.Ellipsis;break;case C.EventPrimacyEnum.Boss:s=I.Symbol.Star+" "}var c=0===parseInt(r)?"<b class='tmlLineName'>"+i+"</b>":"";o.duration=T.parseChainTime(o.duration),o.time=T.parseChainTime(o.time);var l=o.duration/T.cMINUTES_IN_2_HOURS*T.cPERCENT_100;a.append("<div class='tmlSegment' style='width:"+l+"%' data-start='"+o.time+"' data-finish='"+(o.time+o.duration)+"'><div class='tmlSegmentContent'>"+c+"<span class='tmlSegmentName'>"+s+D.getObjectName(o)+"</span><span class='tmlSegmentCountdown'></span></div></div>")}}$("#tmlClose").click(function(){B.toggleTimeline(!1),B.isTimelineEnabled=!1}),$("#tmlDelete").click(function(){$("#opt_bol_showTimeline").prop("checked",!1).trigger("change"),$("#tmlClose").trigger("click")}),$("#tmlToggle").click(function(){$("#opt_bol_showTimelineOpaque").trigger("click")}),I.qTip.init(".tmlLine"),B.updateTimelineSegments(),B.updateTimelineIndicator()},updateTimelineIndicator:function(){if(B.isTimelineGenerated){var e=T.getCurrentBihourlyMinutesUTC(),t=e/T.cMINUTES_IN_2_HOURS*T.cPERCENT_100;$("#tmlIndicator").css({left:t+"%"}),$(".tmlLineName").css({left:t+"%"}),$(".tmlSegment").each(function(){var t=$(this).find(".tmlSegmentCountdown");$(this).hasClass("tmlSegmentActive")?t.html(I.Symbol.ArrowUp+T.formatMinutes($(this).data("finish")-e)):t.html(I.Symbol.ArrowDown+T.formatMinutes(T.wrapInteger($(this).data("start")-e,T.cMINUTES_IN_2_HOURS)))})}},updateTimelineSegments:function(){if(B.isTimelineGenerated){var e=T.getCurrentBihourlyMinutesUTC();if($(".tmlSegment").each(function(){e>=$(this).data("start")&&e<$(this).data("finish")?$(this).hasClass("tmlSegmentActive")||($(this).css({opacity:0}).animate({opacity:1},1e3),$(this).addClass("tmlSegmentActive")):$(this).removeClass("tmlSegmentActive")}),0===e)B.updateTimelineLegend();else{var t=e-T.cMINUTES_IN_MINIFRAME;$("#tmlSegmentTimestamp_"+t).html(T.getCurrentBihourlyTimestampLocal(t+T.cMINUTES_IN_2_HOURS)).addClass("tmlSegmentTimestampFutureFar").parent().css({opacity:0}).animate({opacity:1},1e3)}}},updateTimelineLegend:function(){if(B.isTimelineGenerated)for(var e,t,n=T.getCurrentBihourlyMinutesUTC(),i=$("#tmlLegend").empty(),a=T.cMINUTES_IN_2_HOURS/T.cMINUTES_IN_MINIFRAME,r=a/2,o=0;a>o;o++){var s=T.cPERCENT_100/a,c=0===o||o===r?"tmlSegmentTimestampHour":"",l="";e=T.cMINUTES_IN_MINIFRAME*o,e<n-T.cMINUTES_IN_MINIFRAME?(t=T.getCurrentBihourlyTimestampLocal(e+T.cMINUTES_IN_2_HOURS),l="tmlSegmentTimestampFutureFar"):t=T.getCurrentBihourlyTimestampLocal(e),i.append("<div class='tmlSegment' style='width:"+s+"%'><div class='tmlSegmentContent'><span id='tmlSegmentTimestamp_"+e+"' class='tmlSegmentTimestamp "+c+" "+l+"'>"+t+"</span></div></div>")}},toggleTimeline:function(e){void 0===e&&(e=!$("#itemTimeline").is(":visible")),O.Options.bol_showTimeline&&B.isTimelineEnabled?e?$("#itemTimeline").show().css({opacity:0}).animate({opacity:1},200):$("#itemTimeline").hide():O.Options.bol_showTimeline===!1&&$("#itemTimeline").hide()}},K={tickerFrequency:250,tickerSecondPrevious:null,stopwatchFrequency:50,awakeTimestampPrevious:0,awakeTimestampTolerance:5,currentFrameOffsetMinutes:0,currentPredictionColor:"",currentDaytimeSymbol:"",iconOpacityChecked:.4,iconOpacitySpeed:200,oldQuadrantAngle:0,cDEGREES_IN_CIRCLE:360,cDEGREES_IN_QUADRANT:90,handSecond:{},handMinute:{},handHour:{},clockBackground:{},clockCircumference:{},timeProgress0:{},timeProgress1:{},timeDaylight:{},timeLocal:{},timeDaytime:{},timeSimple:{},timeMap:{},timeWvW:{},timeLog:{},timestampUTC:{},timestampLocal:{},timestampServer:{},timestampReset:{},stopwatchUp:{},stopwatchDown:{},WpChain0:{},WpChain1:{},WpChain2:{},WpChain3:{},IconSD0:{},IconSD1:{},IconSD2:{},IconSD3:{},IconHC0:{},IconHC1:{},IconHC2:{},IconHC3:{},IconsStandard:[],IconsHardcore:[],wpClipboards:[],lsClipboards:[],cZeroClipboardDataAttribute:"data-clipboard-text",cZeroClipboardSuccessText:"Chat link copied to clipboard :)<br />",TickerTimeout:{},StopwatchTimeout:{},StopwatchTimestamp:0,StopwatchTimesleep:0,isStopwatchPaused:!1,StopwatchTimerStart:0,StopwatchTimerFinish:0,initializeClock:function(){K.handSecond=$("#clkSecondHand")[0],K.handMinute=$("#clkMinuteHand")[0],K.handHour=$("#clkHourHand")[0],K.clockBackground=$("#paneClockBackground")[0],K.clockCircumference=$("#clkCircumference")[0],K.timeProgress0=$("#chnProgress0")[0],K.timeProgress1=$("#chnProgress1")[0],K.timeLocal=$("#itemTimeLocalActual")[0],K.timeDaytime=$("#itemTimeDayTime")[0],K.timeSimple=$("#itemSimpleTime")[0],K.timeMap=$("#mapTime")[0],K.timeWvW=$("#wvwTime")[0],K.timeLog=$("#logTime")[0],K.timestampUTC=$("#optTimestampUTC")[0],K.timestampLocal=$("#optTimestampLocalReset")[0],K.timestampServer=$("#optTimestampServerReset")[0],K.timestampReset=$("#optTimeTillReset")[0],K.stopwatchUp=$("#watUp")[0],K.stopwatchDown=$("#watDown")[0],B.initializeDashboard(),K.updateTimeFrame(new Date),T.getDaily(),K.updateDaytimeIcon(),K.tickFrequent(),K.updateDigitalClockMinutely(),K.initializeClipboard(),$("#itemTimeLocalActual").click(function(){$("#opt_bol_use24Hour").trigger("click")})},setClock:function(){var e=200,t=0;switch(O.Options.int_setClock){case O.IntEnum.Clock.Compact:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime, #itemLanguage, #itemSocial").show(),I.bulkAnimate([{s:"#clock",p:{top:"0px",left:"70px",width:"220px",height:"220px"}},{s:"#paneClockFace",p:{width:"360px",height:"360px",top:"-70px",left:"0px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"32px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"24px"}},{s:"#clkIconSD0",p:{top:"4px",left:"290px"}},{s:"#clkIconSD1",p:{top:"148px",left:"290px"}},{s:"#clkIconSD2",p:{top:"148px",left:"4px"}},{s:"#clkIconSD3",p:{top:"4px",left:"4px"}},{s:"#clkIconHC0",p:{top:"52px",left:"306px"}},{s:"#clkIconHC1",p:{top:"132px",left:"306px"}},{s:"#clkIconHC2",p:{top:"132px",left:"20px"}},{s:"#clkIconHC3",p:{top:"52px",left:"20px"}},{s:"#clkWaypoint0",p:{top:"24px",left:"274px"}},{s:"#clkWaypoint1",p:{top:"164px",left:"274px"}},{s:"#clkWaypoint2",p:{top:"164px",left:"52px"}},{s:"#clkWaypoint3",p:{top:"24px",left:"52px"}}],e),$("#paneClockIcons .iconHC").css({width:"32px",height:"32px"}),$("#itemTimeLocal").css({width:"100%",right:"auto",bottom:"90px","text-align":"center",color:"#eee",opacity:.5}),$("#itemTimeDaytime").css({width:"100%",top:"90px",bottom:"auto",left:"auto","text-align":"center",color:"#eee",opacity:.5}),$("#itemLanguage").css({bottom:"72px",left:"10px"}),$("#itemSocial").css({bottom:"100px",right:"10px"}),t=I.cPANE_CLOCK_HEIGHT_COMPACT;break;case O.IntEnum.Clock.Full:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime, #itemLanguage, #itemSocial").show(),I.bulkAnimate([{s:"#clock",p:{top:"70px",left:"70px",width:"220px",height:"220px"}},{s:"#paneClockFace",p:{width:"360px",height:"360px",top:"0px",left:"0px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"12px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"12px"}},{s:"#clkIconSD0",p:{top:"4px",left:"148px"}},{s:"#clkIconSD1",p:{top:"148px",left:"290px"}},{s:"#clkIconSD2",p:{top:"290px",left:"148px"}},{s:"#clkIconSD3",p:{top:"148px",left:"4px"}},{s:"#clkIconHC0",p:{top:"12px",left:"212px"}},{s:"#clkIconHC1",p:{top:"212px",left:"298px"}},{s:"#clkIconHC2",p:{top:"298px",left:"100px"}},{s:"#clkIconHC3",p:{top:"100px",left:"12px"}},{s:"#clkWaypoint0",p:{top:"52px",left:"164px"}},{s:"#clkWaypoint1",p:{top:"164px",left:"274px"}},{s:"#clkWaypoint2",p:{top:"274px",left:"164px"}},{s:"#clkWaypoint3",p:{top:"164px",left:"52px"}}],e),$("#paneClockIcons .iconHC").css({width:"48px",height:"48px"}),$("#itemTimeLocal").css({width:"auto",right:"10px",bottom:"10px","text-align":"left",color:"#bbcc77",opacity:1}),$("#itemTimeDaytime").css({width:"auto",top:"auto",bottom:"10px",left:"10px","text-align":"left",color:"#bbcc77",opacity:1}),$("#itemLanguage").css({bottom:"0px",left:"10px"}),$("#itemSocial").css({bottom:"28px",right:"10px"}),t=I.cPANE_CLOCK_HEIGHT;break;case O.IntEnum.Clock.Bar:$("#paneClock").show(),$("#itemTimeLocal, #itemTimeDaytime, #itemLanguage, #itemSocial").hide(),I.bulkAnimate([{s:"#clock",p:{top:"0px",left:"0px",width:"85px",height:"85px"}},{s:"#paneClockFace",p:{width:"132px",height:"132px",top:"-24px",left:"-24px"}},{s:"#paneClockIcons .iconSD",p:{"border-radius":"32px"}},{s:"#paneClockIcons .iconHC",p:{"border-radius":"24px"}},{s:"#clkIconSD0",p:{top:"0px",left:"82px"}},{s:"#clkIconSD1",p:{top:"0px",left:"152px"}},{s:"#clkIconSD2",p:{top:"0px",left:"222px"}},{s:"#clkIconSD3",p:{top:"0px",left:"292px"}},{s:"#clkIconHC0",p:{top:"48px",left:"98px"}},{s:"#clkIconHC1",p:{top:"48px",left:"168px"}},{s:"#clkIconHC2",p:{top:"48px",left:"238px"}},{s:"#clkIconHC3",p:{top:"48px",left:"308px"}},{s:"#clkWaypoint0",p:{top:"-8px",left:"98px"}},{s:"#clkWaypoint1",p:{top:"-8px",left:"168px"}},{s:"#clkWaypoint2",p:{top:"-8px",left:"238px"}},{s:"#clkWaypoint3",p:{top:"-8px",left:"308px"}}],e),$("#paneClockIcons .iconHC").css({width:"32px",height:"32px"}),t=I.cPANE_CLOCK_HEIGHT_BAR;break;case O.IntEnum.Clock.None:$("#paneMenu").animate({top:0},e),$("#paneContent").animate({top:I.cPANE_MENU_HEIGHT,"min-height":I.cPANEL_HEIGHT_MIN-I.cPANE_MENU_HEIGHT+"px"},e,function(){$("#paneClock").hide()})}switch(I.CLOCK_AND_MENU_HEIGHT=t+I.cPANE_MENU_HEIGHT,O.Options.int_setClock!==O.IntEnum.Clock.None&&($("#paneMenu").animate({top:t},e),$("#paneClock, #paneClockWall, #paneClockBackground, #paneClockIcons, #paneClockCanvas").animate({height:t},e),$("#paneContent").animate({top:t+I.cPANE_MENU_HEIGHT,"min-height":I.cPANEL_HEIGHT_MIN-(t+I.cPANE_MENU_HEIGHT)+"px"},e)),I.ModeCurrent){case I.ModeEnum.Overlay:$("#itemSocial").hide()}},setMarkerAngle:function(e,t){$(e).attr("transform","rotate("+t/10+", 50, 50)")},rotateClockElement:function(e,t){e.setAttribute("transform","rotate("+t+", 50, 50)")},reapplyFilters:function(){if(I.BrowserCurrent===I.BrowserEnum.Firefox){var e=$("#clkCircumference"),t=$("#clkHands"),n="url(#clkFilterShadowOuter)",i="url(#clkGradientCircumference)",a="url(#clkFilterShadowHand)";e.removeAttr("filter").attr("filter",n),e.css("stroke",i),t.removeAttr("filter").attr("filter",a)}},initializeClockItems:function(){K.IconsStandard=null,K.IconsHardcore=null,K.IconsStandard=new Array(K.IconSD0,K.IconSD1,K.IconSD2,K.IconSD3),K.IconsHardcore=new Array(K.IconHC0,K.IconHC1,K.IconHC2,K.IconHC3);var e,t,n="click",i="dblclick";for(I.ModeCurrent===I.ModeEnum.Website&&I.isProgramEmbedded===!1&&(n="dblclick",i="click"),e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)$([K.IconsStandard[e],K.IconsHardcore[e]]).each(function(){$(this).unbind(i).on(i,function(){var e=C.Chains[$(this).data(C.cIndexSynonym)].primaryEvents;t=e[e.length-1].path[0],M.goToView(t,M.ZoomEnum.Ground,M.Pin.Event)}).unbind(n).on(n,function(){$("#chnCheck_"+C.Chains[$(this).data(C.cIndexSynonym)].nexus).trigger("click")})})},checkoffChainIcon:function(e){var t,n,i,a=C.Chains[e];if(a.series===C.ChainSeriesEnum.Standard||a.series===C.ChainSeriesEnum.Hardcore)for(t=0;t<T.cNUM_TIMEFRAMES_IN_HOUR;t++){switch(a.series){case C.ChainSeriesEnum.Standard:n=T.getStandardChain(t),i=K.IconsStandard[t];break;case C.ChainSeriesEnum.Hardcore:n=T.getHardcoreChain(t),i=K.IconsHardcore[t]}n&&e===n.nexus&&(X.getChainChecklistState(n)!==X.ChecklistEnum.Unchecked?i.css({opacity:1}).animate({opacity:K.iconOpacityChecked},K.iconOpacitySpeed):i.css({opacity:K.iconOpacityChecked}).animate({opacity:1},K.iconOpacitySpeed))}},colorPrediction:function(e){e!==K.currentPredictionColor&&(K.currentPredictionColor=e,K.handMinute.style.stroke=e,K.timeProgress0.style.background="linear-gradient(to right, black 0%, "+e+" 100%)")},tickFrequent:function(){var e=new Date,t=e.getSeconds();return K.tickerSecondPrevious===t?void(K.TickerTimeout=setTimeout(K.tickFrequent,K.tickerFrequency)):(K.tickerSecondPrevious=t,void K.tickSecond(e))},tickSecond:function(e){var t=T.getTimeFormatted(),n=e.getSeconds();T.TIMESTAMP_UNIX_SECONDS=T.getUNIXSeconds(),T.SECONDS_TILL_RESET=T.cSECONDS_IN_DAY-T.getTimeSinceMidnight(T.ReferenceEnum.UTC,T.UnitEnum.Seconds);var i=e.getMinutes(),a=e.getHours()%T.cHOURS_IN_MERIDIEM,r=60*i+n,o=6*n,s=6*i+n/10,c=30*a+i/60*30;K.rotateClockElement(K.clockCircumference,s),K.rotateClockElement(K.handSecond,o),K.rotateClockElement(K.handMinute,s),K.rotateClockElement(K.handHour,c);var l=1-(i%T.cMINUTES_IN_TIMEFRAME*60+n)/T.cSECONDS_IN_TIMEFRAME,u=T.cPERCENT_100*l;if(K.timeProgress0.style.width=u+"%",K.timeProgress1.style.width=100-u+"%",i%T.cMINUTES_IN_TIMEFRAME===0&&0===n)0===O.Options.int_setDimming&&I.ModeCurrent!==I.ModeEnum.Simple&&$(K.clockBackground).fadeTo(800,1),$(K.timeProgress0).css({width:"0%"}).animate({width:"100%"},800),$(K.timeProgress1).css({width:"100%"}).animate({width:"0%"},800),K.updateTimeFrame(e);else{var d=T.TIMESTAMP_UNIX_SECONDS;K.awakeTimestampPrevious<d-K.awakeTimestampTolerance&&K.updateTimeFrame(e),K.awakeTimestampPrevious=d,0===O.Options.int_setDimming&&I.ModeCurrent!==I.ModeEnum.Simple&&(K.clockBackground.style.opacity=l)}switch(C.CurrentChains.forEach(C.updateCurrentChainTimeHTML),0===n&&(i%T.cMINUTES_IN_MINIFRAME===0&&(K.updateDaytimeIcon(),K.updateDryTopClipboard(),B.updateTimelineSegments(),B.isDashboardEnabled&&B.refreshDashboard(e)),K.updateDigitalClockMinutely(),B.updateTimelineIndicator(),C.updateChainsTimeHTML(),K.updateWaypointsClipboard(),O.Options.int_setAlarm===O.IntEnum.Alarm.Subscription&&(K.doSubscribedSpeech(O.Options.int_alertSubscribedFirst),
K.doSubscribedSpeech(O.Options.int_alertSubscribedSecond))),I.ModeCurrent){case I.ModeEnum.Simple:K.timeSimple.innerHTML=T.getTimeFormatted({want24:!0,wantHours:!1,wantLetters:!0,customTimeInSeconds:T.cSECONDS_IN_TIMEFRAME-T.getCurrentTimeframeElapsedTime()});break;case I.ModeEnum.Overlay:P.switchMapCheck()}K.timeLocal.innerHTML=t,K.timestampUTC.innerHTML=T.TIMESTAMP_UNIX_SECONDS,K.timestampLocal.innerHTML=O.Utilities.lastLocalResetTimestamp.value,K.timestampServer.innerHTML=T.TIMESTAMP_UNIX_SECONDS+T.SECONDS_TILL_RESET,K.timestampReset.innerHTML=T.getTimeFormatted({customTimeInSeconds:T.SECONDS_TILL_RESET,want24:!0}),r>=K.currentFrameOffsetMinutes&&r<K.currentFrameOffsetMinutes+C.CurrentChainSD.minFinish?K.colorPrediction("lime"):r>=K.currentFrameOffsetMinutes+C.CurrentChainSD.minFinish&&r<K.currentFrameOffsetMinutes+C.CurrentChainSD.avgFinish?K.colorPrediction("orange"):r>=K.currentFrameOffsetMinutes+C.CurrentChainSD.avgFinish&&K.colorPrediction("red"),T.isCountdownToResetStarted&&T.updateCountdownToReset(),B.isDashboardCountdownTickEnabled&&B.updateDashboardCountdown(e),0!==K.StopwatchTimerStart&&K.tickStopwatchDown(),W.isObjectiveTimerTickEnabled&&(K.timeLog.innerHTML=t,W.updateObjectiveTimers(),0===n&&W.updateAllObjectiveAge()),K.TickerTimeout=setTimeout(K.tickFrequent,K.tickerFrequency)},doSubscribedSpeech:function(e){if(e>0){var t=T.cMINUTES_IN_TIMEFRAME-T.getCurrentTimeframeElapsedTime(T.UnitEnum.Minutes),n=C.NextChainSD1,i=C.NextChainHC1,a=C.NextChainLS1,r=!1,o=!1,s=!1,c=!1,l="",u="";if(e>T.cMINUTES_IN_TIMEFRAME&&(n=C.NextChainSD2,i=C.NextChainHC2,a=C.NextChainLS2,t+=T.cMINUTES_IN_TIMEFRAME),e===t){var d=" "+D.getSpeechWord("and")+" ",h=" "+D.getSpeechWord("will start")+D.getPluralTime(t,"minute");l=D.getSpeechWord(D.orderModifier(D.orderModifier("boss","world"),"subscribed"))+" ",r=O.objToBool(n)&&C.isChainSubscribed(n)&&C.isChainUnchecked(n),o=O.objToBool(i)&&C.isChainSubscribed(i)&&C.isChainUnchecked(i),s=O.objToBool(a)&&C.isChainSubscribed(a)&&C.isChainUnchecked(a),(r||o)&&(r&&o?l+=D.getChainPronunciation(n)+d+D.getChainPronunciation(i):r?l+=D.getChainPronunciation(n):o&&(l+=D.getChainPronunciation(i)),D.speak(l),D.speak(h));var p,m=e>T.cMINUTES_IN_TIMEFRAME?C.NextChainsMS2:C.NextChainsMS1;if(m.length>0){u=D.getSpeechWord("event","subscribed")+" ";for(var g=0;g<m.length;g++)p=m[g],O.objToBool(p)&&C.isChainSubscribed(p)&&C.isChainUnchecked(p)&&(u+=D.getChainPronunciation(p),g+1<m.length&&m.length>1&&(u+=d),c=!0);c&&(u+=h,D.speak(u))}B.isDashboardStoryEnabled&&s&&(D.speak(D.getSpeechWord("event","subscribed")+" "+D.getChainPronunciation(a)),D.speak(h))}}},updateTimeFrame:function(e){if(O.checkResetTimestamp(e),C.CurrentChainSD=T.getStandardChain(),C.NextChainSD1=T.getStandardChain(1),C.NextChainSD2=T.getStandardChain(2),C.NextChainSD3=T.getStandardChain(3),C.NextChainSD4=T.getStandardChain(4),C.CurrentChainsSD=[C.CurrentChainSD,C.NextChainSD1,C.NextChainSD2,C.NextChainSD3],C.CurrentChainHC=T.getHardcoreChain(),C.NextChainHC1=T.getHardcoreChain(1),C.NextChainHC2=T.getHardcoreChain(2),C.NextChainHC3=T.getHardcoreChain(3),C.NextChainHC4=T.getHardcoreChain(4),B.isDashboardStoryEnabled&&(C.NextChainLS1=T.getLivingStoryChain(1),C.NextChainLS2=T.getLivingStoryChain(2)),C.NextChainsMS1=T.getMiscellaneousChains(1),C.NextChainsMS2=T.getMiscellaneousChains(2),C.PreviousChains2=T.getTimeframeChains(-2),C.PreviousChains1=T.getTimeframeChains(-1),C.CurrentChains=T.getTimeframeChains(),C.NextChains1=T.getTimeframeChains(1),C.sortChainsListHTML(),C.CurrentChains.forEach(C.queueEventsHighlight),I.ModeCurrent===I.ModeEnum.Simple&&($("#itemSimpleCurrentSD").text(D.getObjectName(C.CurrentChainSD)),$("#itemSimpleNextSD").text(D.getObjectName(C.NextChainSD1)),$("#itemSimpleCurrentHC").text(""),$("#itemSimpleNextHC").text(""),C.CurrentChainHC||C.NextChainHC1?($("#itemSimpleHC").show(),C.CurrentChainHC&&$("#itemSimpleCurrentHC").text(D.getObjectName(C.CurrentChainHC)),C.NextChainHC1&&$("#itemSimpleNextHC").text(D.getObjectName(C.NextChainHC1))):$("#itemSimpleHC").hide()),O.Options.int_setAlarm===O.IntEnum.Alarm.Checklist&&O.Options.bol_alertAtEnd){var t=", "+D.getSpeechWord("checked"),n="",i="",a="",r="",o=O.objToBool(C.CurrentChainSD),s=O.objToBool(C.CurrentChainHC),c=O.objToBool(C.NextChainSD1),l=O.objToBool(C.NextChainHC1),u=D.getSpeechWord("world boss","current")+" "+D.getSpeechWord("is")+" ";C.CurrentChainSD&&!C.isChainUnchecked(C.CurrentChainSD)&&(n=t),C.CurrentChainHC&&!C.isChainUnchecked(C.CurrentChainHC)&&(a=t),C.NextChainSD1&&!C.isChainUnchecked(C.NextChainSD1)&&(i=t),C.NextChainHC1&&!C.isChainUnchecked(C.NextChainHC1)&&(r=t),O.Options.bol_alertChecked===!1&&(n.length>0&&(o=!1),a.length>0&&(s=!1),i.length>0&&(c=!1),r.length>0&&(l=!1)),o&&s?(D.speak(u+D.getChainPronunciation(C.CurrentChainSD)+n,5),D.speak(D.getSpeechWord("and")+", "+D.getChainPronunciation(C.CurrentChainHC)+a,4)):o?D.speak(u+D.getChainPronunciation(C.CurrentChainSD)+n,5):s&&D.speak(u+D.getChainPronunciation(C.CurrentChainHC)+a,5),(o||s)&&(c&&l?(D.speak(D.getSpeechWord("then")+", "+D.getChainPronunciation(C.NextChainSD1)+i,4),D.speak(D.getSpeechWord("and")+", "+D.getChainPronunciation(C.NextChainHC1)+r,4)):c?D.speak(D.getSpeechWord("then")+", "+D.getChainPronunciation(C.NextChainSD1)+i,4):l&&D.speak(D.getSpeechWord("then")+", "+D.getChainPronunciation(C.NextChainHC1)+r,4))}var d=e.getSeconds(),h=e.getMinutes(),p=60*h+d;$("#clkMarkers line").each(function(){$(this).attr("stroke","black")}),$("#paneClockIcons .iconSD").removeClass("clkIconCurrent clkIconNext"),$("#paneClockIcons .iconHC").removeClass("clkIconCurrent clkIconNext");var m=function(e,t,n,i,a,r,o,s,c,l,u,d,h,p){$([K.IconSD0,K.IconHC0]).each(function(){$(this).addClass("clkIconCurrent")}),$([K.IconSD1,K.IconHC1]).each(function(){$(this).addClass("clkIconNext")}),K.setMarkerAngle(t,C.CurrentChainSD.minFinish+u),K.setMarkerAngle(n,C.CurrentChainSD.avgFinish+u),K.setMarkerAngle(a,C.NextChainSD1.minFinish+d),K.setMarkerAngle(r,C.NextChainSD1.avgFinish+d),K.setMarkerAngle(o,C.NextChainSD2.minFinish+h),K.setMarkerAngle(s,C.NextChainSD2.avgFinish+h),K.setMarkerAngle(c,C.NextChainSD3.minFinish+p),K.setMarkerAngle(l,C.NextChainSD3.avgFinish+p);var m=function(e,t){e?(t.show(),t.attr("src","img/chain/"+e.alias.toLowerCase()+I.cPNG),t.data(C.cIndexSynonym,e.nexus),I.ModeCurrent===I.ModeEnum.Simple&&(t.attr("title",D.getObjectName(e)),I.qTip.init(t)),X.getChainChecklistState(e)!==X.ChecklistEnum.Unchecked?t.css({opacity:K.iconOpacityChecked}):t.css({opacity:1})):t.hide()};m(C.CurrentChainSD,K.IconSD0),m(C.NextChainSD1,K.IconSD1),m(C.NextChainSD2,K.IconSD2),m(C.NextChainSD3,K.IconSD3),m(C.CurrentChainHC,K.IconHC0),m(C.NextChainHC1,K.IconHC1),m(C.NextChainHC2,K.IconHC2),m(C.NextChainHC3,K.IconHC3),$(e).attr("stroke","lime"),$(t).attr("stroke","orange"),$(n).attr("stroke","red"),$(i).attr("stroke","green")},g=function(e){var t,n,i,a;switch(e){case T.cSECS_MARK_0:t="0",n="1",i="2",a="3";break;case T.cSECS_MARK_1:t="1",n="2",i="3",a="0";break;case T.cSECS_MARK_2:t="2",n="3",i="0",a="1";break;case T.cSECS_MARK_3:t="3",n="0",i="1",a="2"}K.currentFrameOffsetMinutes=e,K.WpChain0=$("#clkWaypoint"+t),K.IconSD0=$("#clkIconSD"+t),K.WpChain1=$("#clkWaypoint"+n),K.IconSD1=$("#clkIconSD"+n),K.WpChain2=$("#clkWaypoint"+i),K.IconSD2=$("#clkIconSD"+i),K.WpChain3=$("#clkWaypoint"+a),K.IconSD3=$("#clkIconSD"+a),K.IconHC0=$("#clkIconHC"+t),K.IconHC1=$("#clkIconHC"+n),K.IconHC2=$("#clkIconHC"+i),K.IconHC3=$("#clkIconHC"+a),C.refreshChainDailyIcon(),m($("#clkMarker"+t),$("#clkMarker"+t+"A"),$("#clkMarker"+t+"B"),$("#clkMarker"+n),$("#clkMarker"+n+"A"),$("#clkMarker"+n+"B"),$("#clkMarker"+i+"A"),$("#clkMarker"+i+"B"),$("#clkMarker"+a+"A"),$("#clkMarker"+a+"B"),T["cSECS_MARK_"+t],T["cSECS_MARK_"+n],T["cSECS_MARK_"+i],T["cSECS_MARK_"+a]);var r=document.getElementById("clkQuadrant"),o=parseInt(t)*K.cDEGREES_IN_QUADRANT;0===o&&0!==K.oldQuadrantAngle&&(o=K.cDEGREES_IN_CIRCLE),$({angle:K.oldQuadrantAngle}).animate({angle:o},{duration:600,step:function(){K.rotateClockElement(r,this.angle)},done:function(){K.rotateClockElement(r,o)}}),o===K.cDEGREES_IN_CIRCLE&&(o=0),K.oldQuadrantAngle=o};p>=T.cSECS_MARK_0&&p<T.cSECS_MARK_1?g(T.cSECS_MARK_0):p>=T.cSECS_MARK_1&&p<T.cSECS_MARK_2?g(T.cSECS_MARK_1):p>=T.cSECS_MARK_2&&p<T.cSECS_MARK_3?g(T.cSECS_MARK_2):p>=T.cSECS_MARK_3&&p<=T.cSECS_MARK_4&&g(T.cSECS_MARK_3),K.updateWaypointsClipboard(),K.updateDryTopClipboard(),K.initializeClockItems()},initializeClipboard:function(){ZeroClipboard.config({swfPath:"bin/ZeroClipboard.swf"});for(var e=0;e<T.cNUM_TIMEFRAMES_IN_HOUR;e++)K.wpClipboards.push(new ZeroClipboard(document.getElementById("clkWaypoint"+e))),K.wpClipboards[e].on("aftercopy",function(e){I.write(K.cZeroClipboardSuccessText+e.data["text/plain"],5)});if(C.DryTopChains.length>0)for(var e=0;2>e;e++)K.lsClipboards.push(new ZeroClipboard(document.getElementById("chnDryTopWaypoint"+e))),K.lsClipboards[e].on("aftercopy",function(e){I.write(K.cZeroClipboardSuccessText+e.data["text/plain"],5)})},updateDaytimeIcon:function(){var e=T.isDaylight()?I.Symbol.Day:I.Symbol.Night;K.currentDaytimeSymbol=e,$("#itemTimeDayIcon").text(e)},updateDigitalClockMinutely:function(){var e=T.getDayPeriodRemaining();K.timeDaytime.innerHTML=e;var t=T.getTimeFormatted({wantSeconds:!1})+" "+K.currentDaytimeSymbol+e;K.timeMap.innerHTML=t,K.timeWvW.innerHTML=t,K.timeLocal.title=(new Date).toLocaleString()+"<br /><dfn>Anet:</dfn> "+T.getTimeFormatted({reference:T.ReferenceEnum.Server,wantSeconds:!1})+"<br /><dfn>UTC:</dfn> "+T.getTimeFormatted({reference:T.ReferenceEnum.UTC,wantSeconds:!1,want24:!0})+"<br /><dfn>Reset:</dfn> "+T.getTimeFormatted({customTimeInSeconds:T.SECONDS_TILL_RESET,wantSeconds:!1,wantLetters:!0}),I.qTip.init(K.timeLocal)},updateWaypointsClipboard:function(){var e=function(e,t,n,i,a){var r="",o=C.getChainByAlias("triplewurm");r+=t.waypoint+" "+D.getChainAlias(t),n&&n.nexus!==o.nexus?n.nexus!==o.nexus&&(r+=" "+D.getTranslation("and")+" "+n.waypoint+" "+D.getChainAlias(n)+T.getTimeTillChainFormatted(n)):r+=T.getTimeTillChainFormatted(t),r+=", "+D.getTranslation("then")+" "+i.waypoint+" "+D.getChainAlias(i),a&&a.nexus!==o.nexus?a.nexus!==o.nexus&&(r+=" "+D.getTranslation("and")+" "+a.waypoint+" "+D.getChainAlias(a)+T.getTimeTillChainFormatted(a)):r+=T.getTimeTillChainFormatted(i),r+=I.siteTagCurrent,e.attr(K.cZeroClipboardDataAttribute,r)};e(K.WpChain0,C.CurrentChainSD,C.CurrentChainHC,C.NextChainSD1,C.NextChainHC1),e(K.WpChain1,C.NextChainSD1,C.NextChainHC1,C.NextChainSD2,C.NextChainHC2),e(K.WpChain2,C.NextChainSD2,C.NextChainHC2,C.NextChainSD3,C.NextChainHC3),e(K.WpChain3,C.NextChainSD3,C.NextChainHC3,C.NextChainSD4,C.NextChainHC4)},updateDryTopClipboard:function(){if(C.isDryTopIconsShown){var e=T.getCurrentDryTopEvents(),t=T.getCurrentDryTopEvents(1);document.getElementById("chnDryTopWaypoint0").setAttribute(K.cZeroClipboardDataAttribute,e),document.getElementById("chnDryTopWaypoint1").setAttribute(K.cZeroClipboardDataAttribute,t),$("#mapDryTopClip0").val(e),$("#mapDryTopClip1").val(t)}},initializeStopwatch:function(){$("#watToggle").click(function(){$("#itemStopwatch").toggle("fast")}),$("#watStart").click(function(){$("#watToggle").show(),$("#itemStopwatch").show().css("font-size",O.Options.int_sizeStopwatchFont);var e=(new Date).getTime();0===K.StopwatchTimestamp?(K.StopwatchTimestamp=(new Date).getTime(),K.tickStopwatchUp()):K.isStopwatchPaused?(K.isStopwatchPaused=!1,K.StopwatchTimestamp=K.StopwatchTimestamp+(e-K.StopwatchTimesleep),K.tickStopwatchUp()):(window.clearTimeout(K.StopwatchTimeout),K.StopwatchTimesleep=e,K.isStopwatchPaused=!0)}),$("#watStop").click(function(){0===K.StopwatchTimerStart&&$("#watToggle").hide(),window.clearTimeout(K.StopwatchTimeout),K.isStopwatchPaused=!1,K.StopwatchTimestamp=0,K.stopwatchUp.innerHTML=""}),$("#watLap").click(function(){0!==K.StopwatchTimestamp?I.write(K.stopwatchUp.innerHTML,0):I.write("Stopwatch must be running to lap time.")}),$("#watTimerStart").click(function(){$("#watToggle").show(),$("#itemStopwatch").show().css("font-size",O.Options.int_sizeStopwatchFont),K.StopwatchTimerStart=(new Date).getTime(),K.StopwatchTimerFinish=K.StopwatchTimerStart+O.Options.int_minStopwatchAlert*T.cMILLISECONDS_IN_MINUTE,K.tickStopwatchDown()}),$("#watTimerStop").click(function(){0===K.StopwatchTimestamp&&$("#watToggle").hide(),K.StopwatchTimerStart=0,K.stopwatchDown.innerHTML=""}),$("#chnOptionsStopwatchDown input").click(function(){$(this).select()})},tickStopwatchUp:function(){var e=(new Date).getTime()-K.StopwatchTimestamp;K.stopwatchUp.innerHTML=T.formatMilliseconds(e,!0),K.StopwatchTimeout=setTimeout(function(){K.tickStopwatchUp()},K.stopwatchFrequency)},tickStopwatchDown:function(){var e=K.StopwatchTimerFinish-(new Date).getTime();if(e>0)K.stopwatchDown.innerHTML=T.getTimeFormatted({customTimeInSeconds:parseInt(e/T.cMILLISECONDS_IN_SECOND),wantLetters:!0});else{$("#watTimerStop").trigger("click");var t=O.Options.str_textStopwatchAlert;D.speak(t)}},refreshFestival:function(){var e=144,t=document.getElementById("paneClockCanvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var i,a,r=0;e>r;r++)i=T.getRandomIntRange(0,t.width),a=T.getRandomIntRange(0,t.height),n.fillStyle="rgba(255,255,255,255)",n.fillRect(i,a,1,1)}},I={cSiteName:"GW2Timer.com",cSiteURL:"http://gw2timer.com/",cImageHost:"http://i.imgur.com/",cGameName:"Guild Wars 2",cGameNick:"GW2",cLevelMax:80,cAJAXGlobalTimeout:3e4,cPNG:".png",cThrobber:"<div class='itemThrobber'><em></em></div>",cConsoleCommandPrefix:"/",cTextDelimiterChar:"|",cTextDelimiterRegex:/[|]/g,consoleTimeout:{},siteTagDefault:" - gw2timer.com",siteTagCurrent:" - gw2timer.com",Symbol:{ArrowUp:"⇑",ArrowDown:"⇓",TriUp:"▲",TriDown:"▼",TriRight:"►",TriLeft:"◄",Block:"■",Star:"☆",Ellipsis:"…",Day:"☀",Night:"☽",Expand:"[+]",Collapse:"[−]",Help:"[?]"},cPANEL_WIDTH:360,cPANEL_HEIGHT_MIN:220,cPANE_CLOCK_HEIGHT:360,cPANE_CLOCK_HEIGHT_COMPACT:220,cPANE_CLOCK_HEIGHT_BAR:85,cPANE_MENU_HEIGHT:48,cTOOLTIP_WIDTH_MAX:360,cTOOLTIP_OVERFLOW_WIDTH:240,cTOOLTIP_OVERFLOW_MAX:10,cTOOLTIP_DEFAULT_OFFSET_X:-180,cTOOLTIP_DEFAULT_OFFSET_Y:30,cTOOLTIP_ALTERNATE_OFFSET_X:24,cTOOLTIP_ADD_OFFSET_Y:42,cTOOLTIP_ADD_OFFSET_X:36,cTOOLTIP_MOUSEMOVE_RATE:20,CLOCK_AND_MENU_HEIGHT:0,posX:0,posY:0,isMouseOnPanel:!1,isProgramLoaded:!1,isProgramEmbedded:!1,isMapEnabled:!0,isTouchEnabled:!1,isScrollEnabled:!1,isSpeechSynthesisEnabled:!1,ModeCurrent:null,ModeEnum:{Website:"Website",Mobile:"Mobile",Simple:"Simple",Tile:"Tile",Overlay:"Overlay"},cPagePrefix:"#plate",cMenuPrefix:"#menu",PageCurrent:"",PagePrevious:"",PageEnum:{Chains:"Chains",Map:"Map",Help:"Help",Options:"Options"},SpecialPageEnum:{WvW:"WvW",DryTop:"DryTop"},SectionEnum:{Chains:{Scheduled:"Scheduled",DryTop:"DryTop",Legacy:"Legacy",Temple:"Temple",Timetable:"Timetable"},Map:{Daily:"Daily",Resource:"Resource",JP:"JP",Collectible:"Collectible",Guild:"Guild",TP:"TP",Notepad:"Notepad",Personal:"Personal"},Help:{FAQ:"FAQ",About:"About",Embed:"Embed",Schedules:"Schedules",Legacies:"Legacies",Temples:"Temples",Dungeons:"Dungeons"}},ArticleCurrent:null,contentCurrentPlate:"",isContentLoaded_Map:!1,isContentLoaded_Help:!1,isSectionLoaded_Daily:!1,sectionPrefix:"sectionCurrent_",cHeaderPrefix:"#header",BrowserCurrent:-1,BrowserEnum:{Unknown:-1,IE:0,Opera:1,Firefox:2,Chrome:3},ScreenWidth:{Huge:2560,Large:1024,Medium:640},cSMALL_DEVICE_WIDTH:800,cSMALL_DEVICE_HEIGHT:600,cBIG_DISPLAY_HEIGHT:1200,initializeFirst:function(){D.stopSpeech(),window!==window.top&&(I.isProgramEmbedded=!0),I.isTouchEnabled="undefined"!=typeof window.ontouchstart,U.enforceURLArgumentsFirst(),I.enforceProgramMode(),U.updateLanguageLinks(),T.checkDST(),T.cUTC_OFFSET_USER=-((new Date).getTimezoneOffset()/T.cMINUTES_IN_HOUR),T.cUTC_OFFSET_USER<=T.cUTC_OFFSET_EASTERN&&T.cUTC_OFFSET_USER>=T.cUTC_OFFSET_HAWAII&&(O.Options.bol_use24Hour=!1);var e=T.getUNIXSeconds(),t=parseInt(localStorage[O.Utilities.lastLocalResetTimestamp.key]);void 0===localStorage[O.Utilities.lastLocalResetTimestamp.key]||isFinite(t)===!1||t>e?(O.Utilities.lastLocalResetTimestamp.value=e,localStorage[O.Utilities.lastLocalResetTimestamp.key]=O.Utilities.lastLocalResetTimestamp.value):O.Utilities.lastLocalResetTimestamp.value=t,K.awakeTimestampPrevious=e,localStorage.removeItem("int_setInitialZoomWvW"),screen.height>=800?O.Options.int_setInitialZoomWvW=3:screen.height>=480?O.Options.int_setInitialZoomWvW=4:O.Options.int_setInitialZoomWvW=5;var n=navigator.userAgent;-1!==n.indexOf("MSIE")||-1!==n.indexOf("Trident")?I.BrowserCurrent=I.BrowserEnum.IE:-1!==n.indexOf("Chrome")?(I.BrowserCurrent=I.BrowserEnum.Chrome,I.isSpeechSynthesisEnabled=!0):-1!==n.indexOf("Firefox")?I.BrowserCurrent=I.BrowserEnum.Firefox:-1!==n.indexOf("Opera")&&(I.BrowserCurrent=I.BrowserEnum.Opera),$.ajaxSetup({timeout:I.cAJAXGlobalTimeout}),$("#plateMap, #plateWvW, #plateHelp").each(function(){$(this).append(I.cThrobber)}),I.qTip.start(),I.PageCurrent=I.PageEnum.Chains},initializeLast:function(){I.initializeTooltip(),I.bindHelpButtons("#plateOptions"),I.bindWindowResize(),I.initializeUIforMenu(),I.initializeUIForHUD(),I.styleContextMenu("#mapContext"),$("#mapSwitchButton").one("click",function(){I.loadStylesheet("wvw"),$.getScript(U.URL_DATA.WvW).done(function(){W.initializeWvW()})}).click(function(){I.toggleMap(P.MapEnum.Mists)}),$("#wvwSwitchButton").click(function(){I.toggleMap(P.MapEnum.Tyria)}),U.enforceURLArgumentsLast(),I.PageCurrent===I.PageEnum.Chains&&U.openSectionFromURL(),$("#itemWarning").remove(),$("#cslClose").click(function(){I.clear()}),$("#cslSelect").click(function(){I.selectText("#cslContent")}),$("#cslToggle").click(function(){$("#cslContent").toggle("fast")}),$(".mapHUDContainer").one("mouseenter",function(){$(this).find("img").each(function(){$(this).attr("src",$(this).attr("data-src"))})}),$("#chnOptions").one("mouseenter",function(){I.loadImg($(this)),K.initializeStopwatch(),$("#optAlarmSpeaker").click(function(){D.speak(D.getWord("alarm"))}),$("#optMute").click(function(){D.stopSpeech()})}),U.convertExternalLink(".linkExternal"),I.BrowserCurrent!==I.BrowserEnum.IE&&$("head").append("<style>.leaflet-clickable{cursor: url('img/cursor/pointer.cur'), pointer;}</style>"),$(document).mouseup(function(e){$(".jsRemovable, .jsHidable").each(function(){$(this).is(e.target)||0!==$(this).has(e.target).length||($(this).hasClass("jsHidable")&&$(this).hide(),$(this).hasClass("jsRemovable")&&$(this).remove())})}),$("#itemLanguage").hover(function(){$("#paneClock").css("z-index",3)},function(){$("#paneClock").css("z-index",1)}),I.isMapEnabled&&I.initializeScrollbar("#cslContent, #plateChains, #plateOptions"),O.cleanLocalStorage(),O.enforceProgramVersion(),D.translateAfter(),P.wantZoomToFirstEvent()?$("#chnEvent_"+C.CurrentChainSD.nexus+"_"+C.CurrentChainSD.CurrentPrimaryEvent.num).trigger("click"):I.isMapEnabled&&M.goToDefault(O.Options.int_setInitialZoom),I.isMapEnabled&&M.changeFloor(O.Options.int_setFloor),I.isProgramLoaded=!0},initializeChainsUI:function(){$("#plateChains header").click(function(){var e=U.getSubstringFromHTMLID($(this));$(this).next().slideToggle("fast",function(){if($(this).is(":visible")){I.updateScrollbar();var t=$(I.cPagePrefix+I.PageEnum.Chains),n=$(this).prev();n.find("kbd").html(I.Symbol.Collapse),I.scrollToElement(n,t,"fast"),"sectionChains_Drytop"===$(this).attr("id")?(M.goToZone("dry",M.ZoomEnum.Bird),I.PageCurrent=I.SpecialPageEnum.DryTop,U.updateTitle(I.SpecialPageEnum.DryTop),P.toggleDryTopIcons(!0),$("#mapHUDBoxes").hide()):I[I.sectionPrefix+I.PageEnum.Chains]=e}else I.updateScrollbar(),$(this).prev().find("kbd").html(I.Symbol.Expand),"sectionChains_Drytop"===$(this).attr("id")&&(I.PageCurrent=I.PageEnum.Chains,P.toggleDryTopIcons(!1),$("#mapHUDBoxes").show()),I[I.sectionPrefix+I.PageEnum.Chains]="";U.updateQueryString()})}),$("#plateChains header:not(:first)").each(function(){$(this).next().toggle(0),$(this).find("kbd").html(I.Symbol.Expand)}),$("#plateChains header:first").each(function(){$(this).find("kbd").html(I.Symbol.Collapse)}),I.ModeCurrent!==I.ModeEnum.Tile?$("#headerChains_Drytop").one("click",function(){P.generateDryTop()}):$("#headerChains_Drytop").hide(),$("#headerChains_Legacy").one("click",function(){C.initializeUnscheduledChains(C.LegacyChains),I.readjustTile()}),$("#headerChains_Temple").one("click",function(){C.initializeUnscheduledChains(C.TempleChains),I.readjustTile()}),$("#headerChains_Timetable").one("click",function(){C.isTimetableGenerated=!0,C.initializeTimetableHTML(),I.readjustTile()}),I.readjustTile()},write:function(e,t,n){$("#itemConsole").show();var i=$("#cslContent").show(),a=18;e=void 0===e?"undefinedstring":null===e?"nullstring":e.toString(),void 0===n&&(n=!1),n===!0&&i.empty(),isFinite(t)===!1&&(t=3+parseInt(e.length/a)),i.append(e+"<br />"),I.updateScrollbar(i),window.clearTimeout(I.consoleTimeout),0!==t&&(I.consoleTimeout=setTimeout(function(){i.css({opacity:1}).animate({opacity:0},600,function(){$(this).empty().css({opacity:1}),$("#itemConsole").hide()})},t*T.cMILLISECONDS_IN_SECOND))},greet:function(e,t,n){I.isProgramEmbedded===!1&&I.write(e,t,n)},clear:function(){window.clearTimeout(I.consoleTimeout),$("#itemConsole").hide(),$("#cslContent").empty()},log:function(e,t){I.write(e,0,t)},selectText:function(e){var t=document.querySelector(e),n=window.getSelection(),i=document.createRange();i.selectNodeContents(t),n.removeAllRanges(),n.addRange(i)},scrollToElement:function(e,t,n){switch(e=$(e),I.ModeCurrent){case I.ModeEnum.Mobile:$("body").scrollTop(e.offset().top);break;case I.ModeEnum.Tile:$("#windowMain").animate({scrollTop:e.offset().top-$("#windowMain").offset().top+$("#windowMain").scrollTop()},n||0);break;default:t?(t=$(t),t.animate({scrollTop:e.offset().top-t.offset().top+t.scrollTop()},n||0)):e.scrollTop(0)}},removeThrobber:function(e){$(e).find(".itemThrobber").remove()},bulkAnimate:function(e,t){for(var n in e){var i=e[n];$(i.s).animate(i.p,{duration:t,queue:!1})}},toggleToggleIcon:function(e,t){t?$(e).animate({rotation:0},200):$(e).animate({rotation:-90},200)},bloatElement:function(e,t,n){var i=parseInt(t/n);i=i%2===0?i:i+1;for(var a=!0,r=0;i>r;r++)a?$(e).hide(n):$(e).show(n),a=!a},blinkElement:function(e,t,n){var i=parseInt(t/n);i=i%2===0?i:i+1;var a=!0,r=1,o=$(e),s=setInterval(function(){a?o.css({visibility:"hidden"}):o.css({visibility:"visibile"}),a=!a,r===i&&clearInterval(s),r++},n)},toggleHighlight:function(e,t){return void 0===t?e.hasClass("cssHighlight")?(e.removeClass("cssHighlight"),!1):(e.addClass("cssHighlight"),!0):t?(e.addClass("cssHighlight"),!0):(e.removeClass("cssHighlight"),!1)},styleContextMenu:function(e){$(e).addClass("jsHidable").find("li").each(function(){if($(this).hasClass("itemContextSubmenu")===!1)O.Options.enu_Language!==O.OptionEnum.Language.Default&&$(this).text(D.getPhraseOriginal($(this).text()));else{var e=$(this).find("> span");e.html(D.getPhraseOriginal(e.text())).append(" <kbd>"+I.Symbol.TriRight+"</kbd>")}$(this).prepend("<ins class='s16 s16_bullet'></ins> ")})},initializeScrollbar:function(e){if(I.isScrollEnabled===!1)try{var t=1;switch(I.BrowserCurrent){case I.BrowserEnum.Opera:t=5;break;case I.BrowserEnum.Firefox:t=3}$(e).perfectScrollbar({wheelSpeed:t,suppressScrollX:!0})}catch(n){}},updateScrollbar:function(e){if(I.isScrollEnabled===!1)if(I.isMapEnabled)try{void 0===e?($("#plateMap").perfectScrollbar("update"),$("#plateChains").perfectScrollbar("update"),$("#plateHelp").perfectScrollbar("update"),$("#plateOptions").perfectScrollbar("update")):$(e).perfectScrollbar("update")}catch(t){}else $("#windowMain").perfectScrollbar("update")},generateSectionMenu:function(e){if(!($(e+" header.jsSection").length<=0)){var t=e.substring(I.cPagePrefix.length,e.length),n="menuBeam_"+t,i=$("<div class='menuBeamContainer'></div>").prependTo(e),a=$("<div class='menuBeam' id='"+n+"'></div>").prependTo(i);$(e+" header.jsSection").each(function(){var n=$(this),i=$(this).children("var").first(),r=i.data(O.Options.enu_Language)||n.text();i.text(r),n.next().hide(),n.wrapInner("<span></span>"),n.append("<sup>"+I.Symbol.Expand+"</sup>"),n.click(function(){var n=!1,i=U.getSubstringFromHTMLID($(this));$(e+" .menuBeamIcon").removeClass("menuBeamIconActive"),$(this).next().is(":visible")?($(this).children("sup").text(I.Symbol.Expand),I.displaySectionMarkers(i,!1),I[I.sectionPrefix+t]="",$(e+" header.jsSection").show(),$(e+" header.cntHeader").show()):(n=!0,$(this).children("sup").text(I.Symbol.Collapse),$(e+" .menuBeamIcon[data-section='"+i+"']").addClass("menuBeamIconActive"),I.displaySectionMarkers(i,!0),I[I.sectionPrefix+t]=i,$(this).data("beamclicked")===!0&&($(e+" header.jsSection").not(this).hide(),$(e+" header.cntHeader").hide(),$(this).removeData("beamclicked")),$(this).hasClass("jsMapDefault")&&M.goToDefault()),U.updateQueryString(),$(this).data("donotanimate")!==!0?I.ModeCurrent===I.ModeEnum.Website?$(this).next().toggle("fast",function(){I.updateScrollbar(e)}):($(this).next().toggle(),I.updateScrollbar(e)):$(this).next().toggle(),$(this).removeData("donotanimate"),n&&I.scrollToElement($(this),e,"fast")}),n.one("click",function(){I.loadImg($(this).next())}),$("<div class='curClick jsSectionDone'><img src='img/ui/close.png' />"+r+"</div>").appendTo(n.next()).click(function(){$(this).parent().prev().trigger("click")});var o=U.getSubstringFromHTMLID(n),s=n.find("img:eq(0)").attr("src");(I.isMapEnabled||n.hasClass("mapOnly")===!1)&&$("<img class='menuBeamIcon' data-section='"+o+"' src='"+s+"' title='&lt;dfn&gt;"+D.getWordCapital("section")+": &lt;/dfn&gt;"+r+"' />").appendTo(a).click(function(){$(e+" header.jsSection").each(function(){$(this).next().is(":visible")&&$(this).attr("id")!==n.attr("id")&&($(this).data("donotanimate",!0),$(this).trigger("click"))}),n.data("beamclicked",!0),n.trigger("click")})}),$("<img class='menuBeamIcon menuBeamIconCollapse' src='img/ui/exit.png' title='&lt;dfn&gt;"+D.getPhraseTitle("collapse section")+"&lt;/dfn&gt;' />").prependTo(a).click(function(){$(e+" header.jsSection").each(function(){$(this).next().is(":visible")&&$(this).trigger("click")}),$(e+" .menuBeamIcon").removeClass("menuBeamIconActive")}),I.qTip.init(e+" .menuBeamIcon")}},displaySectionMarkers:function(e,t){var n,i,a=$("#mapToggle_"+e);a.length&&(n=a.data("checked"),i=a.data("hideonly"),i?t||a.trigger("click"):t?n||(a.trigger("click"),a.data("checked",!0)):n&&(a.trigger("click"),a.data("checked",!1)))},loadStylesheet:function(e){e!==I.ModeEnum.Website&&$("head").append("<link rel='stylesheet' type='text/css' href='style/"+e.toLowerCase()+".css' />")},loadImg:function(e){e.find("img").each(function(){$(this).attr("data-src")&&($(this)[0].src=$(this).data("src"))})},bindHelpButtons:function(e){$(e+" .jsHelpCollapsible").each(function(){$(this).text("[?+]").attr("title","<dfn>More Info</dfn>"),$(this).next().hide(),$(this).click(function(){$(this).next().toggle(),$(this).next().is(":visible")?$(this).text("[?-]"):$(this).text("[?+]")})}),$(e+" .jsHelpTooltip").each(function(){var e="<dfn>Info:</dfn> "+$(this).attr("title");$(this).text(I.Symbol.Help).attr("title",e)}),I.qTip.init(e+" .jsHelpCollapsible"),I.qTip.init(e+" .jsHelpTooltip")},toggleButtonState:function(e){var t=!e.data("checked");return e.data("checked",t),t},bindPseudoCheckbox:function(e,t){void 0===t&&(t=.3),$(e).click(function(){$(this).data("checked")!==!0?($(this).css({opacity:t}),$(this).data("checked",!0)):($(this).css({opacity:1}),$(this).data("checked",!1))})},initializeUIforMenu:function(){!function(){var e=200,t=.5;$("#paneMenu").hover(function(){$("#paneMenu kbd").each(function(){$(this).is(":hover")||$(this).animate({opacity:t},e)})},function(){$("#paneMenu kbd").finish().each(function(){$(this).animate({opacity:1},e)})}),$("#paneMenu kbd").hover(function(){$(this).animate({opacity:1},e)},function(){$(this).animate({opacity:t},e)}).mousedown(function(){$(this).finish().css({opacity:t})}).mouseup(function(){$(this).finish().css({opacity:1})})}(),$("#paneMenu kbd").each(function(){$(this).click(function(){var e=$(this).attr("id");switch(I.PageCurrent=e.substring(I.cMenuPrefix.length-1,e.length),I.contentCurrentPlate=I.cPagePrefix+I.PageCurrent,P.MapCurrent===P.MapEnum.Mists&&(I.PagePrevious=I.PageCurrent),I.PageCurrent){case I.PageEnum.Chains:O.Options.bol_hideHUD&&$("#mapHUDBoxes").show();break;case I.PageEnum.Map:I.isMapEnabled&&M.movePin(M.Pin.Event)}$("#paneContent article").hide(),I.PageCurrent!==I.PageEnum.Chains&&O.Options.bol_hideHUD&&$("#mapHUDBoxes").hide(),I.ModeCurrent===I.ModeEnum.Website&&($(I.contentCurrentPlate+" .cntHeader").css({opacity:0}).animate({opacity:1},400),$(I.contentCurrentPlate).animate({width:"show"},200)),$(I.contentCurrentPlate).show(),U.updateQueryString(),I.isMapEnabled&&M.toggleLayer(M.ZoneCurrent.Layers.Path,I.PageCurrent!==I.PageEnum.Map&&O.Options.bol_showChainPaths)})}),$("#menuMap").one("click",I.loadMapPlate),$("#menuHelp").one("click",I.loadHelpPlate)},toggleMap:function(e){switch(e){case P.MapEnum.Tyria:$("#wvwPane").hide(),$("#mapPane").show(),M.refreshMap(),I.PageCurrent=I.PagePrevious,I.PagePrevious=I.SpecialPageEnum.WvW,P.MapCurrent=P.MapEnum.Tyria,P.SuffixCurrent=M.OptionSuffix;break;case P.MapEnum.Mists:$("#mapPane").hide(),$("#wvwPane").show(),W.isMapInitialized&&W.refreshMap(),I.PagePrevious=I.PageCurrent,I.PageCurrent=I.SpecialPageEnum.WvW,P.MapCurrent=P.MapEnum.Mists,P.SuffixCurrent=W.OptionSuffix}U.updateQueryString()},bindAfterAJAXContent:function(e){var t=I.cPagePrefix+e;I.generateSectionMenu(t),I.isMapEnabled&&I.initializeScrollbar(t),I.bindHelpButtons(t),M.bindMapLinks(t),U.convertExternalLink(t+" a"),I.qTip.init("button"),U.openSectionFromURL(),D.translateElements()},loadMapPlate:function(){I.loadStylesheet("features"),$("#plateMap").load(U.getPageSrc("map"),function(){I.bindAfterAJAXContent(I.PageEnum.Map),I.ModeCurrent===I.ModeEnum.Mobile&&$(".mapOnly").remove(),$("#headerMap_Daily").one("click",function(){G.generateAndInitializeDailies(),I.isSectionLoaded_Daily=!0}),$("#headerMap_Resource").one("click",function(){G.generateAndInitializeResources()}),$("#headerMap_JP").one("click",function(){G.generateAndInitializeJPs()}),$("#headerMap_Personal").one("click",function(){X.initializePersonalChecklist()}),$("#headerMap_TP").one("click",function(){E.initializeCalculator(),E.initializeTrading(),E.initializeExchange()}),$("#headerMap_Notepad").one("click",function(){X.initializeNotepad()}),$("#headerMap_Collectible").one("click",function(){G.generateCollectiblesUI()}),$("#headerMap_Guild").one("click",function(){G.generateGuildUI()}),I.qTip.init("#plateMap label")})},loadHelpPlate:function(){$("#plateHelp").load(U.getPageSrc("help"),function(){I.bindAfterAJAXContent(I.PageEnum.Help),$(".jsCopyCode").click(function(){$(this).select()})})},initializeUIForHUD:function(){var e=200;$(".mapHUDContainer").each(function(){$(this).hover(function(){$(this).find(".cntComposition").show().animate({opacity:.8},e)},function(){$(this).find(".cntComposition").animate({opacity:0},e)})})},showHomeLink:function(){I.qTip.init($("<a title='&lt;dfn&gt;Switch back to full site.&lt;/dfn&gt;' href='./'> <img id='iconSimpleHome' src='img/ui/about.png' /></a>").appendTo("#itemHome"))},enforceProgramMode:function(){switch(I.loadStylesheet(I.ModeCurrent),I.ModeCurrent){case I.ModeEnum.Website:$("head").append("<link rel='alternate' media='only screen and (max-width: 640px)' href='http://gw2timer.com/?mode=Mobile'>");break;case I.ModeEnum.Overlay:I.cPANE_MENU_HEIGHT=32;break;case I.ModeEnum.Simple:I.isMapEnabled=!1,I.showHomeLink(),$("#itemTimeline").appendTo("#panelApp"),I.readjustSimple();break;case I.ModeEnum.Mobile:I.isMapEnabled=!1,I.isScrollEnabled=!0,I.showHomeLink(),$("head").append("<meta name='viewport' content='width=device-width, initial-scale=1' />").append("<link rel='canonical' href='http://gw2timer.com' />");break;case I.ModeEnum.Tile:if(I.isMapEnabled=!1,K.iconOpacityChecked=.2,I.showHomeLink(),$("#itemLanguage").prependTo("#plateChains"),I.isProgramEmbedded)$("<style type='text/css'>.chnBar, .chnSlot {margin-bottom:4px !important; margin-right: 4px !important;}</style>").appendTo("head");else{
var e=parseInt($("#chnProgressBar").css("margin-top"));$("#itemTimeline").prependTo("#panelApp"),$("#windowMain").scroll(function(){$("#itemTimeline").is(":visible")?$("#chnProgressBar").css("margin-top",Math.max(-$("#itemTimeline").outerHeight(!0)+e,-$("#windowMain").scrollTop())):$("#chnProgressBar").css("margin-top",e)})}I.initializeScrollbar("#windowMain")}I.ModeCurrent===I.ModeEnum.Website&&I.isProgramEmbedded===!1?$("#paneClockIcons img").addClass("curZoom"):$("#paneClockIcons img").addClass("curClick"),I.isProgramEmbedded&&($("#itemWarning").remove(),$(".mapHUDLinks").hide(),B.isDashboardEnabled=!1),I.ModeCurrent!==I.ModeEnum.Website&&I.ModeCurrent!==I.ModeEnum.Overlay&&(B.isDashboardEnabled=!1)},bindWindowResize:function(){$(window).on("resize",$.throttle(200,function(){switch(I.ModeCurrent){case I.ModeEnum.Simple:I.readjustSimple();break;case I.ModeEnum.Tile:I.readjustTile()}W.isWvWLoaded&&W.readjustLog()}))},readjustSimple:function(){var e=$(window).height()/2,t=$(window).width()/2,n=I.cPANE_CLOCK_HEIGHT/2;$("#paneSimple").css({"margin-top":e-n-72}),$("#paneClock").css({"margin-top":e-n,"margin-left":t-n})},readjustTile:function(){if(I.ModeCurrent===I.ModeEnum.Tile){var e=T.stepFunction($(window).width(),14,22,400,3);$(".chnTitle h1").css({fontSize:e+"px"})}},initializeTooltip:function(){I.qTip.init("#chnOptions img, a, ins, kbd, span, time, fieldset, label, input, button"),$("#panelApp").hover(function(){I.isMouseOnPanel=!0},function(){I.isMouseOnPanel=!1})},qTip:{name:"qTip",offsetX:-180,offsetY:15,a:null,start:function(){if(!e)var e="qTip";var t=document.getElementById(e);t||(t=document.createElementNS?document.createElementNS("http://www.w3.org/1999/xhtml","div"):document.createElement("div"),t.setAttribute("id",e),document.getElementsByTagName("body").item(0).appendChild(t)),document.getElementById&&(this.a=document.getElementById(this.name),this.a&&(document.onmousemove=$.throttle(I.cTOOLTIP_MOUSEMOVE_RATE,function(e){I.qTip.move(e)})))},init:function(e){if(!I.isTouchEnabled){var t,n=document.getElementById("qTip");$(e).each(function(){t=$(this)[0],n=t.getAttribute("title"),t&&n&&(t.setAttribute("tiptitle",n),t.removeAttribute("title"),t.removeAttribute("alt"),t.onmouseover=function(){I.qTip.show(this.getAttribute("tiptitle"))},t.onmouseout=function(){I.qTip.hide()})})}},move:function(e){I.posX=e.pageX,I.posY=e.pageY;var t=$("#qTip").width(),n=$("#qTip").height(),i=$(window).width(),a=$(window).height();I.isMouseOnPanel?(n+I.posY+I.cTOOLTIP_ADD_OFFSET_Y>a?I.qTip.offsetY=-n-I.cTOOLTIP_ADD_OFFSET_Y:I.qTip.offsetY=I.cTOOLTIP_DEFAULT_OFFSET_Y,t>=I.cTOOLTIP_OVERFLOW_WIDTH&&I.isMapEnabled&&O.Options.bol_alignPanelRight?I.qTip.offsetX=i-I.posX-I.cPANEL_WIDTH-I.cTOOLTIP_OVERFLOW_MAX:i-I.posX>I.cPANEL_WIDTH/2?I.qTip.offsetX=I.cTOOLTIP_ALTERNATE_OFFSET_X:I.qTip.offsetX=I.cTOOLTIP_DEFAULT_OFFSET_X):(I.posX+I.cTOOLTIP_ADD_OFFSET_X+t>i&&t>I.cTOOLTIP_WIDTH_MAX?I.qTip.offsetX=-t-I.cTOOLTIP_ADD_OFFSET_X:I.qTip.offsetX=I.cTOOLTIP_ALTERNATE_OFFSET_X,n-I.cTOOLTIP_ALTERNATE_OFFSET_X+I.posY>a?I.qTip.offsetY=-n-I.cTOOLTIP_ADD_OFFSET_Y:I.posY<I.cTOOLTIP_ADD_OFFSET_Y?I.qTip.offsetY=I.cTOOLTIP_DEFAULT_OFFSET_Y:I.qTip.offsetY=-I.cTOOLTIP_ADD_OFFSET_Y),this.a.style.left=I.posX+this.offsetX+"px",this.a.style.top=I.posY+this.offsetY+"px"},show:function(e){this.a&&(this.a.innerHTML=e,this.a.style.display="block")},hide:function(){this.a&&(this.a.innerHTML="",this.a.style.display="none")}}},I.initializeFirst(),O.initializeOptions(),T.initializeSchedule(),P.initializeMap(),K.initializeClock(),I.initializeLast()});